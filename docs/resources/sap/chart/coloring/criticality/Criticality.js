/*
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/chart/coloring/criticality/measureValues/MeasureValues","sap/chart/coloring/criticality/DimensionValues","sap/chart/coloring/ColoringUtils","sap/chart/coloring/ColorPalette","sap/chart/coloring/CriticalityType","sap/chart/data/MeasureSemantics","sap/ui/thirdparty/jquery"],function(e,t,i,a,r,n,jQuery){"use strict";var s=["DimensionValues","MeasureValues"];var l=[r.Positive,r.Neutral,r.Critical,r.Negative,"Unmentioned"];var o=[r.Positive,r.Critical,r.Negative,r.Neutral];function u(e,t){var r=[];t.forEach(function(t){e.forEach(function(e){if(e.chartLog){throw e.chartLog}var n=e.parsed.callbacks[t]||[];n.forEach(function(s,l){var o,u;if(t==="Unmentioned"){o=i.assignUnmentionedColor(a.CRITICALITY.Neutral,n.length);u=e.parsed.legend[l]}else{o=i.assignColor(a.CRITICALITY[t],n.length);var c=e.parsed.legend[t];u=Array.isArray(c)?c[l]:c}var d={callback:s,properties:{color:o[l]},displayName:u};r.push(d)})})});return r}function c(e){var t=e[0];var r=t.parsed.legend;var n=[],s=[];var l=r.segments[0].upperBound>r.min;var o=r.segments.length<2||r.segments[r.segments.length-2].upperBound<r.max;r.segments.forEach(function(e){var t=i.assignColor(a.CRITICALITY[e.CriticalityType],1)[0];n.push(t);s.push(e.upperBound)});if(l){s=[r.min].concat(s)}else{n.splice(0,1)}if(o){s[s.length-1]=r.max}else{n.splice(n.length-1,1);s.splice(s.length-1,1)}var u=n.length;if(n.length===1){n=[n[0],n[0]];u=2}else if(n.length===0){return null}return{feed:"color",palette:n,numOfSegments:u,legendValues:s}}function d(e){var t;if(e&&e.legendTitle){t={title:{text:e.legendTitle,visible:true}}}return t}function f(e,t){return function(){var i,a;if(e.bMBC){i=c(e)}else{var r=u(e,t);a={plotArea:{dataPointStyle:{rules:r}},legend:d(e)}}return{colorScale:i,properties:a}}}function g(e,t){var i=[n.Actual,n.Projected,n.Reference];var a=[r.Positive,r.Neutral,r.Critical,r.Negative];var s=[];var l=[];var o=false;e.forEach(function(e){var a=false;var r=[];e.order=[];if(e.criticalityType){o=true}i.forEach(function(i){if(e[i]){var n=t.filter(function(t){return e[i]===t.msr.getName()})[0];if(n){a=true;e.order.push(i)}else{r.push(i)}}});e.order=e.order.concat(r);if(a){s.push(e)}else{l.push(e)}});if(o){s.sort(function(e,t){return a.indexOf(e.criticalityType)-a.indexOf(t.criticalityType)})}e.splice(0,e.length);e.push.apply(e,s.concat(l))}return{getCandidateSetting:function(a,r,n,u,c,d,p){var h=a.Criticality||{},v=r.parameters||{};var m=i.dimOrMsrUse(h,v,s,"Criticality");var y={additionalMeasures:[],additionalDimensions:[]};var C=d.bMBC,T,M,V;switch(m){case"DimensionValues":var b=v.dimension||Object.keys(h.DimensionValues);if(typeof b==="string"||b instanceof String){b=[b]}T=t.qualify(h.DimensionValues,b,u,d);if(T){y.qualifiedSettings=T;T.parsed=t.parse(T,u.aDim,c,p,d);y.contextHandler=t.getContextHandler(T,p,d);y.ruleGenerator=f([T],o)}break;case"MeasureValues":var x=v.measure||Object.keys(h.MeasureValues);if(typeof x==="string"||x instanceof String){x=[x]}T=e.qualify(h.MeasureValues,n,x,u,c,d);if(T.sMethod){jQuery.each(T,function(t,i){M=e.parse(i,u,c,d,p);jQuery.each(M.additionalMeasures,function(e,t){y.additionalMeasures.push(t)});jQuery.each(M.additionalDimensions,function(e,t){y.additionalDimensions.push(t)});i.parsed=M;if(i.settings.Legend&&i.settings.Legend.Title){T.legendTitle=i.settings.Legend.Title}});V=T.sMethod;y.contextHandler=e.getContextHandler(V,T,C,p);y.qualifiedSettings=T;y.ruleGenerator=f(T,l);T.bMBC=C;g(n,T)}break;default:return{}}if(T.length){y.subType=m}return y},getLegendProps:d}});
//# sourceMappingURL=Criticality.js.map