/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.define(["./common/BaseControl","./charttooltip/TooltipContainer","sap/ui/core/Popup","./common/utils/FormatDataUtil","sap/ui/thirdparty/jquery"],function(o,t,i,e,jQuery){"use strict";var n=o.extend("sap.viz.ui5.controls.VizTooltip",{metadata:{library:"sap.viz",properties:{formatString:{type:"any",defaultValue:null}}},renderer:{apiVersion:2,render:function(o,t){o.openStart("div",t).openEnd().close("div")}}});n.prototype.init=function(){o.prototype.init.apply(this,arguments);this._uid=null;this._oTooltipContainer=null;this._oPopup=null};n.prototype.exit=function(){o.prototype.exit.apply(this,arguments);var t=sap.ui.getCore().byId(this._uid);if(t){if(t._vizFrame){t._vizFrame.off("showInstantTooltip");t._vizFrame.off("hideInstantTooltip");var i=t._onConnectPopover()||{};if(i.ref===this){t._onConnectPopover(null)}}else{t._onConnectPopover(jQuery.proxy(function(o){if(!t._vizFrame){return}t._vizFrame.off("showInstantTooltip");t._vizFrame.off("hideInstantTooltip")},this))}}if(this._oPopup){this._oPopup.destroy();this._oPopup=null}if(this._oTooltipContainer){this._oTooltipContainer.destroy();this._oTooltipContainer=null}this._uid=null};n.prototype.connect=function(o){this._uid=o;if(!this._oPopup){this._createTooltip()}var t=sap.ui.getCore().byId(this._uid);var i=t.getUiConfig();if(!i||i.applicationSet!=="fiori"){return}var e=this;function n(){if(!t._vizFrame){return}e._chartType=t._vizFrame.type();t._vizFrame.off("showTooltip");t._vizFrame.off("hideTooltip");t._vizFrame.on("showInstantTooltip",function(o){e._prepareTooltip(o.data);e._oPopup.close(0);e._oPopup.open(0)});t._vizFrame.on("hideInstantTooltip",function(){e._oPopup.close(0)})}n.ref=this;if(t._vizFrame){n()}t._onConnectPopover(n)};n.prototype._createTooltip=function(o){this._oTooltipContainer=new t;this._oPopup=new i;this._oPopup.setContent(this._oTooltipContainer);this._oPopup.setShadow(false)};n.prototype._prepareTooltip=function(o){var t={formatString:this.getFormatString(),chartType:this._chartType,mode:"tooltip"};var n=e.formatData(o,t);this._oTooltipContainer.setContent(n);var p=i.Dock.CenterBottom;var r=i.Dock.LeftTop;var a=o.point.x;var s=10;var l=o.point.y;var u=0+" "+-s;var f=document.createEvent("MouseEvents");f.initMouseEvent("mousemove",true,true,window,0,0,0,a,l,false,false,false,false,0,null);f=jQuery.event.fix(f);this._oPopup.setPosition(p,r,f,u,"flipfit")};n.prototype.addStyleClass=function(){this._oTooltipContainer.addStyleClass.apply(this._oTooltipContainer,arguments)};n.prototype.removeStyleClass=function(){this._oTooltipContainer.removeStyleClass.apply(this._oTooltipContainer,arguments)};return n});
//# sourceMappingURL=VizTooltip.js.map