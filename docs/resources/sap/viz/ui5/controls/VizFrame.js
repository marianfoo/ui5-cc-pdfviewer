/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/viz/library","sap/viz/ui5/data/Dataset","sap/ui/core/theming/Parameters","sap/viz/ui5/theming/Util","sap/viz/ui5/utils/CommonUtil","./ResponsiveLegend","./common/BaseControl","./common/feeds/AnalysisObject","./common/feeds/FeedItem","./common/feeds/FeedHelper","./common/helpers/RuntimeOptionsHelper","./common/helpers/DefaultPropertiesHelper","./common/utils/Constants","./common/utils/SelectionDetailUtil","sap/base/Log","sap/ui/Device","sap/ui/thirdparty/jquery","./WorkerCode","require","./VizFrameRenderer"],function(e,t,i,r,s,a,n,o,p,l,h,d,_,c,u,f,jQuery,v,g){"use strict";var m=sap.viz.vizservices.__internal__.BindingService;var z=sap.viz.vizservices.__internal__.PropertyService;for(var y=0;y<_.CORE_CHART_TYPES.length;y++){var T=_.CORE_CHART_TYPES[y];z.getPropertiesDef(T)}var F=n.extend("sap.viz.ui5.controls.VizFrame",{metadata:{library:"sap.viz",properties:{vizType:{type:"string",group:"Misc",defaultValue:"column"},vizProperties:{type:"object",group:"Misc",defaultValue:null},vizScales:{type:"object",group:"Misc",defaultValue:null},vizCustomizations:{type:"object",group:"Misc",defaultValue:null},legendVisible:{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{dataset:{type:"sap.viz.ui5.data.Dataset",multiple:false},feeds:{type:"sap.viz.ui5.controls.common.feeds.FeedItem",multiple:true,singularName:"feed"}},events:{renderComplete:{},selectData:{},deselectData:{}}}});F.prototype.init=function(){n.prototype.init.apply(this,arguments);this._wrapApi("setModel",function(){this._invalidateDataset=true}.bind(this));this._wrapApi("setDataset",function(){this._invalidateDataset=true}.bind(this));this._wrapApi("destroyDataset",function(){this._invalidateDataset=true}.bind(this));this._wrapApi("addFeed",function(){this._invalidateFeeds=true}.bind(this));this._wrapApi("removeFeed",function(){this._invalidateFeeds=true}.bind(this));this._wrapApi("destroyFeeds",function(){this._invalidateFeeds=true}.bind(this));this._vizFrame=null;this._currentTheme=null;this._connectPopover=null;this._currentTemplate=null;this._errorType=null;this._bulletProperties={plotArea:{}};this._waterfallProperties={plotArea:{}};this._bReadyToRender=true;this._scalesOption=null;this._bSupressInvisibleRender=false;this._bDisableIntervalSizeCheck=true;this._clearVariables();this._templateCache={};this._isInitThememChanged=false;this.data("sap-ui-fastnavgroup","true",true)};F.prototype.exit=function(){n.prototype.exit.apply(this,arguments);this._clearVariables();if(this._vizFrame){this._vizFrame.destroy()}this._vizFrame=null};F.prototype._getDataRange=function(e,t){return this._vizFrame&&this._vizFrame._getDataRange(e,t)||{displayValues:{start:e,end:t}}};F.prototype._setTitleAria=function(e){if(this._vizFrame$.length){this._vizFrame$.attr("aria-hidden",true);jQuery(this._app$).attr("aria-label",e)}};F.prototype._clearVariables=function(){this._clearRequestedProperties();this._bulletProperties={plotArea:{}};this._waterfallProperties={plotArea:{}};this._cachedDataset=null;this._connectPopover=null;this._templateCache=null;this._bSupressInvisibleRender=false;this._bDisableIntervalSizeCheck=true};F.prototype._clearRequestedProperties=function(){this.setProperty("vizProperties",null);this.setProperty("vizScales",null);this.setProperty("vizCustomizations",null);this._scalesOption=null};F.prototype.getVizUid=function(){return this.getId()};F.prototype.setUiConfig=function(e){n.prototype.setUiConfig.apply(this,arguments);return this};F.prototype.setVizType=function(e){var t=this._getCalculatedType();if(e!==this.getVizType()){this._invalidateVizType=true}this.setProperty("vizType",e,true);var i=this._getCalculatedType();if(t!==i&&!this._pendingRerendering&&(this._vizFrame||this._errorType)){var r=this._userFeeds||{feeds:this.getFeeds(),vizType:t};if(r.vizType===i){this.destroyFeeds();r.feeds.forEach(function(e){this.addFeed(e)},this);this._userFeeds=null}else{this._switchFeeds(t,this._getCalculatedType(),r)}}else{this.invalidate()}return this};F.prototype._switchFeeds=function(e,t,i){var r=p.toLightWeightFmt(this.getFeeds());var s=sap.viz.vizservices.BVRService.switchFeeds(e,r,t).feedItems;var a=l.getFeedDefsMap(t);s.forEach(function(e){if(e.id&&a[e.id]){e.type=a[e.id].type}});var n=p.fromLightWeightFmt(s);i.feeds.forEach(function(e){this.removeFeed(e,true)},this);this.vizUpdate({feeds:n});this._userFeeds=i};F.prototype.invalidate=function(e){if(e instanceof t){this._invalidateDataset=true}if(e instanceof p){this._userFeeds=null}n.prototype.invalidate.call(this,e)};F.prototype.getVizProperties=function(){if(this._vizFrame){return this._mergeProperties(this._mergeProperties({},this._vizFrame.properties()||{}),this.getProperty("vizProperties")||{})}else{return this.getProperty("vizProperties")}};F.prototype.getVizScales=function(){if(this._vizFrame){return s.extendScales(this._vizFrame.scales()||[],this.getProperty("vizScales")||[])}else{return this.getProperty("vizScales")}};F.prototype.zoom=function(e){if(this._vizFrame){this._vizFrame.zoom({target:"plotArea",direction:e.direction})}};F.prototype.setVizProperties=function(e){var t=this._getCalculatedType();if(e&&(t==="info/bullet"||t==="info/vertical_bullet")){h.processBulletProperty(this._bulletProperties,e)}if(e&&t==="info/timeseries_waterfall"){h.processWaterfallProperty(this._waterfallProperties,e)}var i=sap.viz.api.serialization.migrate({type:this._getCalculatedType(),properties:e});if(this._vizFrame&&!this._pendingRerendering){if(this._errorType!==_.ERROR_TYPE.NODATA){this._updateDescription()}try{this._vizFrame.update(i)}catch(e){this._handleErr(e)}}else{this.setProperty("vizProperties",this._mergeProperties(this.getProperty("vizProperties")||{},i.properties||{}));this.setVizScales(i.scales,this._scalesOption)}return this};F.prototype.setVizScales=function(e,t){if(this._vizFrame&&!this._pendingRerendering){try{if(t){this._vizFrame.scales(e,{level:"user",replace:t.replace})}else{this._vizFrame.scales(e)}}catch(e){this._handleErr(e)}}else{if(t){this._scalesOption={level:"user",replace:t.replace}}if(t&&t.replace){this.setProperty("vizScales",e)}else{this.setProperty("vizScales",s.extendScales(this.getProperty("vizScales")||[],e||[]))}}return this};F.prototype.getLegendVisible=function(){return this.getVizProperties().legendGroup.computedVisibility};F.prototype.setLegendVisible=function(e){this.setVizProperties({legend:{visible:e},sizeLegend:{visible:e}});return this};F.prototype.vizSelection=function(e,t){if(this._vizFrame){try{var i=this._vizFrame.selection.apply(this._vizFrame,arguments);if(i===this._vizFrame){i=this}}catch(e){return null}return i}else{return null}};F.prototype.vizUpdate=function(e){if(this._vizFrame||this._errorType){if(e.data||e.feeds){if(e.properties){this.setVizProperties(e.properties)}if(e.scales){this.setVizScales(e.scales)}if(e.customizations){this.setVizCustomizations(e.customizations)}if(e.data){this.setDataset(e.data)}if(e.feeds){this.destroyFeeds();e.feeds.forEach(function(e){this.addFeed(e)}.bind(this))}}else{try{this._vizFrame.update(e)}catch(e){this._handleErr(e)}}}};F.prototype.setVizCustomizations=function(e){if(F._isCustomizationAPISupportedVizType(this._getCalculatedType())){if(this._vizFrame&&!this._pendingRerendering){try{this._vizFrame.customizations(e)}catch(e){this._handleErr(e)}}else{this.setProperty("vizCustomizations",this._mergeProperties(this.getProperty("vizCustomizations")||{},e||{}))}}return this};F.prototype.getVizCustomizations=function(){if(this._vizFrame){return this._mergeProperties(this._mergeProperties({},this._vizFrame.customizations()||{}),this.getProperty("vizCustomizations")||{})}else{return this.getProperty("vizCustomizations")}};F._isCustomizationAPISupportedVizType=function(e){return Array.prototype.indexOf.call(["info/column","info/dual_column","info/bar","info/dual_bar","info/stacked_bar","info/stacked_column","info/100_stacked_bar","info/100_stacked_column","info/100_dual_stacked_bar","info/100_dual_stacked_column","info/dual_stacked_bar","info/dual_stacked_column","info/line","info/horizontal_line","info/dual_line","info/dual_horizontal_line","info/bubble","info/scatter","info/combination","info/horizontal_combination","info/stacked_combination","info/horizontal_stacked_combination","info/dual_stacked_combination","info/dual_horizontal_stacked_combination","info/timeseries_combination","info/timeseries_stacked_combination","info/timeseries_bullet","info/dual_timeseries_combination","info/dual_combination","info/dual_horizontal_combination"],e)>-1};F.prototype.getResponsiveLegend=function(){if(this._vizFrame){return a.createInstance(this._vizFrame.responsiveLegend())}};F.prototype.exportToSVGString=function(e){var t='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%"/>';if(this._vizFrame){t=this._vizFrame.exportToSVGString(e)}return t};F.prototype._getScopeString=function(){var e=i.getActiveScopesFor(this);return JSON.stringify(e)};F.prototype._scopingChangedFun=function(e){var t=e.getParameter("element");var i=false;if(this===t){i=true}else{var r=this;while(r){r=r.getParent();if(r===t){i=true;break}}}if(i){var s=this._getScopeString();if(this._sCurrentScopeChain!==undefined&&this._sCurrentScopeChain!==s){this._themeChangedHandler(false,function(){this._themeLoadCompleted=true;this._renderVizFrame({forceThemeChange:true})}.bind(this))}}};F.prototype._createContainerDiv=function(){if(!this._vizFrame$){this._vizFrame$=jQuery(document.createElement("div"));this._vizFrame$.addClass(_.CSS_PREFIX+"-viz-frame");this._vizFrame$.appendTo(this._app$)}if(!this._description$){this._description$=jQuery(document.createElement("div"));this._description$.addClass(_.CSS_PREFIX+"-viz-description");this._description$.appendTo(this._app$);this._description$.attr("tabindex",0);this._descriptionTitle$=jQuery(document.createElement("div"));this._descriptionTitle$.addClass(_.CSS_PREFIX+"-viz-description-title");this._descriptionTitle$.appendTo(this._description$);this._descriptionDetail$=jQuery(document.createElement("div"));this._descriptionDetail$.addClass(_.CSS_PREFIX+"-viz-description-detail");this._descriptionDetail$.appendTo(this._description$);this._descriptionMessage$=jQuery(document.createElement("div"));this._descriptionMessage$.addClass(_.CSS_PREFIX+"-viz-description-message");this._descriptionMessage$.appendTo(this._description$)}};F.prototype._createVizFrame=function(e){sap.ui.getCore().attachThemeScopingChanged(this._scopingChangedFun,this);e.container=this._vizFrame$.get(0);var t=this._vizFrame=new sap.viz.vizframe.VizFrame(e,{controls:{morpher:{enabled:false}},throwError:true});t.on("selectData",function(e){this.fireEvent("selectData",e)}.bind(this));t.on("deselectData",function(e){this.fireEvent("deselectData",e)}.bind(this));t.on("initialized",function(e){var t=this._vizFrame$;t.on("focusin",function(e){e.preventDefault();t.addClass("sapMFocus")});t.on("focusout",function(e){e.preventDefault();t.removeClass("sapMFocus")});this.fireEvent("renderComplete",e)}.bind(this));t.on("scroll",function(e){this.fireEvent("_scroll",e)}.bind(this));t.on("_selectionDetails",function(e){c.appendShapeStrings(e.data);this.fireEvent("_selectionDetails",e)}.bind(this));t.on("_zoomDetected",function(e){this.fireEvent("_zoomDetected",e)}.bind(this));return t};F.prototype._migrate=function(e,t){t.forEach(function(t){var i=sap.viz.api.serialization.feedsIdToBindingId(e,t.getUid());if(i){t.setProperty("uid",i,true)}});if(e==="info/bullet"||e==="info/vertical_bullet"||e==="info/timeseries_bullet"){var i=false;t.forEach(function(e){i=i||e.getUid()==="actualValues"});if(!i){t.forEach(function(e){if(e.getUid()==="valueAxis"){e.setUid("actualValues");if(e.getValues().length>1){t.push(new p({uid:"additionalValues",type:"Measure",values:[e.getValues()[1]]}));e.setValues([e.getValues()[0]])}}})}}};function C(e){for(var t=e.length-1;t>=0;t--){var i=e[t];if(i.feed&&i.feed==="color"&&i.palette){return t}}return-1}F.prototype._checkProps=function(e,t,i){if(e==="fiori"){t.properties=h.decorateFiori(t,i,this.getVizProperties())}if(t.properties){t.properties=z.removeInvalid(t.type,t.properties)}if(t.type==="info/bullet"||t.type==="info/vertical_bullet"){t.properties=this._mergeProperties(t.properties||{},this._bulletProperties);h.decorateBullet(t,i)}if(t.type==="info/timeseries_bullet"){h.decorateTimeBullet(t)}if(t.type==="info/timeseries_waterfall"){h.decorateWaterfall(t,i);t.properties=this._mergeProperties(t.properties||{},this._waterfallProperties)}};function P(e,t,i,r,s,a){return new Promise(function(n){var o;try{o=new Worker(URL.createObjectURL(new Blob(["("+v.toString()+")()"],{type:"text/javascript"})))}catch(e){u.info("Failed to create worker via Blob (strict CSP?), falling back to separate script",null,"sap.viz.ui5.controls.VizFrame");o=new Worker(g.toUrl("./WorkerCode.js"))}o.postMessage({applicationSet:e,allPropDefs:t,allChartNames:_.CORE_CHART_TYPES,generalProps:d._general,specificProps:d._specified,defaultFioriProps:d.DEFAULT_FIORI_PROPS,dualFioriProps:d.FIORI_DUAL_PROPS,allUi5Theme:i,cvomTemplate:r,extraProp:s,defaultFormatString:a});o.onmessage=function(e){n(e.data)}})}function R(e,t,i){var s=z.mergeProperties;var a=r.readCSSParameters;var n=d.get(z,e,t);var o=d.getExtraProp(t);return s(e,n,a(e,i),o)}F.prototype._getTemplateProps=function(e,t,i){if(this._templateCache[i]){return Promise.resolve()}var s,a;return new Promise(function(n,o){if(typeof window.Worker!=="undefined"){var p=r.readCSSParameters;var l=d.getExtraProp(e);var h={};var c={};var u={};for(a=0;a<_.CORE_CHART_TYPES.length;a++){s=_.CORE_CHART_TYPES[a];if(e!=="fiori"){u[s]=d.applyDefaultFormatString({},s)}h[s]=z.getPropertiesDef(s);c[s]=p(s,this)}this._themeLoadCompleted=false;return P(e,h,c,t.properties,l,u).then(function(e){if(!this._templateCache){o()}else{this._templateCache[i]=e;n()}}.bind(this))}else{var f=z.mergeProperties;var v={};for(a=0;a<_.CORE_CHART_TYPES.length;a++){s=_.CORE_CHART_TYPES[a];v[s]=R(s,e,this)}if(t.properties){for(a=0;a<_.CORE_CHART_TYPES.length;a++){s=_.CORE_CHART_TYPES[a];v[s]=f(s,t.properties[s],v[s]);v[s]=z.removeInvalid(s,v[s])}}this._templateCache[i]=v;n()}}.bind(this))};F.prototype._getOptions=function(e,t){var i={type:e,properties:{}};if(this._invalidateDataset){i.data=this._getVizDataset();this._invalidateDataset=false}if(this._invalidateFeeds){i.bindings=this._getVizBindings(e,t);this._invalidateFeeds=false}if(this.getProperty("vizProperties")){i.properties=this.getProperty("vizProperties")}if(this.getProperty("vizScales")){i.scales=this.getProperty("vizScales")}if(this._scalesOption){i.scalesOption=this._scalesOption}if(this.getProperty("vizCustomizations")){i.customizations=this.getProperty("vizCustomizations")}if(this._aRuntimeScales){i.sharedRuntimeScales=this._aRuntimeScales}i.template=this._currentTemplate;return i};F.prototype._setCustomMessages=function(e){this._errorInfo=e;this._handleDescription(this._errorType)};F.prototype._realRenderVizFrame=function(e){if(!this._readyToRender()){return}var t=(this.getUiConfig()||{}).applicationSet;var i=this._getCalculatedType();var r=this.getFeeds();var s=z.mergeProperties;var a={_invalidateDataset:this._invalidateDataset,_invalidateVizType:this._invalidateVizType,_invalidateFeeds:this._invalidateFeeds};this._migrate(i,r);var n=false,o=sap.ui.getCore().getConfiguration().getTheme();if(e&&e.forceThemeChange||this._currentTheme!==o){n=true}a.theme=o;if(!(this._invalidateFeeds||this._invalidateDataset||n||this._invalidateVizType||this._localeChanged)||!this._isDataReady()){return}this._createContainerDiv();try{var p=this._getOptions(i,r);if(!p){return}this._currentTheme=o;if(this._isExtension()){var l=R(i,t);p.properties=s(i,l,p.properties)}this._checkProps(t,p,r,i);if(this._invalidateVizType){this._invalidateVizType=false}p.disableIntervalSizeCheck=this._bDisableIntervalSizeCheck;if(!this._vizFrame){if(p.data){this._createVizFrame(p);this._clearRequestedProperties()}}else{this._vizFrame.update(p);this._clearRequestedProperties()}if(this._connectPopover){this._connectPopover()}var h=this._getVizDataset();if(h&&h._FlatTableD&&!h._FlatTableD._data.length){throw _.ERROR_MESSAGE.NODATA}else{this._errorType=null;this._updateDescription()}this._localeChanged=false}catch(e){if(!this._vizFrame){this._invalidateDataset=a._invalidateDataset;this._invalidateVizType=a._invalidateVizType;this._invalidateFeeds=a._invalidateFeeds;this._currentTheme=a.theme}this._handleErr(e)}};F.prototype._renderVizFrame=function(e){if(!this._readyToRender()||this._isInitThememChanged&&!this._themeLoadCompleted){return}if(!this._isInitThememChanged){this._pendingRerendering=true;this._themeChangedHandler(false,function(){this._pendingRerendering=false;this._realRenderVizFrame(e);this._themeLoadCompleted=true}.bind(this))}else{this._realRenderVizFrame(e)}};F.prototype._themeChangedHandler=function(e,t){this._isInitThememChanged=true;var i=(this.getUiConfig()||{}).applicationSet;var r=i||"";var s="";this._sCurrentScopeChain=this._getScopeString();if(this._sCurrentScopeChain){s=this._sCurrentScopeChain}var a=sap.ui.getCore().getConfiguration().getTheme();var n=a+"_"+r+"_"+_.TEMPLATE_POSTFIX+s;if(this._currentTemplate===n&&!e){return}this._currentTemplate=n;var o=sap.viz.api.env.Template.get();var p=sap.viz.extapi.env.Template;if(!p.isRegistered(n)||e){p.unregister(n);var l;if(o.indexOf(_.TEMPLATE_POSTFIX)>-1){l=p.getPackage("standard_fiori")||p.getPackage("default")}else{l=p.current()}this._getTemplateProps(i,l,n).then(function(){var e=this._templateCache[n];l.properties=l.properties||{};l.scales=l.scales||{};for(var i in e){if(e.hasOwnProperty(i)){l.properties[i]=e[i];var r=l.scales[i];if(r){var s=C(r);if(s>-1){r.splice(s,1)}}}}l.id=n;l.name=n;p.register(l);t()}.bind(this)).catch(function(e){return})}else{t()}};F.prototype.onThemeChanged=function(e){if(this._app$&&this.$()){this._themeChangedHandler(e.triggeredBy&&e.triggeredBy==="themedesigner",function(){this.invalidate();this._themeLoadCompleted=true}.bind(this))}};F.prototype.onlocalizationChanged=function(){if(this._app$&&this.$()){sap.viz._applyLocale(function(){if(this._errorType){this._localeChanged=true;this.invalidate()}}.bind(this))}};F.prototype._isDataReady=function(){var e=this.getDataset();return!e||!e.isReady()?false:true};F.prototype._getVizDataset=function(){var e=this.getDataset();if(this._isExtension()){var t=this._getMetadata();if(t){if(t.dataType==="raw"){return e.getRawDataset()}else if(t.dataType==="sap.viz.api.data.CrosstableDataset"){l.updateAxis(e.getDimensions(),this._getCalculatedType(),this.getFeeds());return e.getVIZCrossDataset()}else{return e.getVIZFlatDataset()}}else{l.updateAxis(e.getDimensions(),this._getCalculatedType(),this.getFeeds());return e.getVIZCrossDataset()}}else{return e.getVIZFlatDataset()}};F.prototype._getVizBindings=function(e,t){if(t&&t.length){var i=p.toLightWeightFmt(t);i=sap.viz.vizservices.BVRService.suggestFeeds(e,i,[{id:"MND",type:"MND"}]).feedItems;if(this._isExtension()){var r=this._getMetadata();if(r){if(r.dataType==="sap.viz.api.data.CrosstableDataset"){return m.generateBindings(e,i,"CrossTableDataset")}else{return m.generateBindings(e,i,"FlatTableDataset")}}else{return m.generateBindings(e,i,"CrossTableDataset")}}else{return m.generateBindings(e,i,"FlatTableDataset")}}else{return null}};F.prototype._getMetadata=function(){var e;try{e=sap.viz.api.metadata.Viz.get(this._getCalculatedType())}catch(t){e=null}return e};F.prototype._onConnectPopover=function(e){if(arguments.length>0){this._connectPopover=e}return this._connectPopover};F.prototype._createChildren=function(){this._renderVizFrame()};F.prototype._updateChildren=function(){this._renderVizFrame()};F.prototype._suppressInvisibleRender=function(e){this._bSuppressInvisibleRender=!!e};F.prototype._disableIntervalSizeCheck=function(e){this._bDisableIntervalSizeCheck=!!e};F.prototype._validateSize=function(e){if(!this._app$||!this.$()||e&&e.size&&(e.size.height==0||e.size.width==0)||this._bSuppressInvisibleRender&&window.getComputedStyle(this.getDomRef(),null).visibility==="hidden"||this.$().prop("offsetHeight")===0){return}var t={width:this.$().width(),height:this.$().height()};if(this._vizFrame){var i=this._vizFrame.size();if(!i||i.width!==t.width||i.height!==t.height){this._vizFrame.size({width:t.width,height:t.height,auto:!this._bDisableIntervalSizeCheck,invisibleRender:true})}}};F.prototype._getCalculatedType=function(){if(this._isExtension()){return this.getVizType()}else{return this._getInfoType()}};F.prototype._isExtension=function(){return _.CORE_CHART_TYPES.indexOf(this._getInfoType())===-1};F.prototype._getInfoType=function(){var e=this.getVizType();if(e.indexOf("info/")===-1){return"info/"+e}else{return e}};F.prototype._mergeProperties=function(e,t){return z.mergeProperties(this._getCalculatedType(),e,t)};F.prototype._wrapApi=function(e,t){this[e]=function(){var i=F.prototype[e].apply(this,arguments);t();return i}.bind(this)};F.prototype._updateDescription=function(e){var t=this._description$;var i=this._descriptionTitle$;var r=this._descriptionDetail$;var s=this._descriptionMessage$;if(!this._description$.length){return}if(!e){t.hide()}else{t.show();i.empty();r.empty();s.empty();var a="";if(e.title){i.show().text(e.title);a+=e.title+". "}if(e.detail){r.show().text(e.detail);a+=e.detail+" "}if(e.message){s.show().text(e.message);a+=e.message}t.attr("aria-label",a)}};F.prototype._handleDescription=function(e,t){var i;if(!e){return}if(this._errorInfo&&this._errorInfo[e]){i={message:this._errorInfo[e]}}else if(e===_.ERROR_TYPE.INVALIDDATA){i={title:sap.viz.extapi.env.Language.getResourceString("IDS_ERROR_INVALIDE_DATA"),detail:sap.viz.extapi.env.Language.getResourceString("IDS_ERROR_INVALIDE_DATA_DESCRIPTION")}}else if(e===_.ERROR_TYPE.MULTIPLEUNITS){i={title:sap.viz.extapi.env.Language.getResourceString("IDS_ERROR_INVALIDE_DATA"),detail:sap.viz.extapi.env.Language.getResourceString("IDS_ERROR_INVALIDE_DATA_MULTIPLEUNITS")}}else if(e===_.ERROR_TYPE.NODATA){i={title:sap.viz.extapi.env.Language.getResourceString("IDS_ERROR_ISNODATA")}}else{i={message:t}}this._updateDescription(i)};F.prototype._handleErr=function(e){var t=(this.getUiConfig()||{}).showErrorMessage!==false;var i=true;if(t){if(e===_.ERROR_MESSAGE.NODATA){this._errorType=_.ERROR_TYPE.NODATA;i=false}else if(e===_.ERROR_MESSAGE.MULTIPLEUNITS){this._errorType=_.ERROR_TYPE.MULTIPLEUNITS;this._clearVizFrame()}else{this._errorType=e.toString().indexOf("[50060]")>=0?_.ERROR_TYPE.INVALIDDATA:_.ERROR_TYPE.OTHERS;if(this._vizFrame){this._vizFrame$.find(".v-info").remove()}else{this._clearVizFrame()}}this._handleDescription(this._errorType,e)}if(i){this.fireEvent("renderFail",{id:"renderFail",error:e})}};F.prototype._clearVizFrame=function(){if(this._vizFrame){this._vizFrame.destroy();this._vizFrame=null;this._invalidateFeeds=true}this._vizFrame$.empty();sap.ui.getCore().detachThemeScopingChanged(this._scopingChangedFun,this)};F.prototype._runtimeScales=function(e,t){if(arguments.length===0){return this._vizFrame?this._vizFrame.runtimeScales():this._aRuntimeScales}else if(e){this._aRuntimeScales=[].concat(e);if(!t){this.invalidate()}}};F.prototype._getZoomInfo=function(){var e,t,i,r,s=this._states();if(s){e=s.zoomInOut;if(e){t=e.enabled;i=e.currentZoomLevel}else{t=false;i=null}r={enabled:t,currentZoomLevel:i}}else{r={}}return r};F.prototype._states=function(){var e;if(this._vizFrame){e=this._vizFrame.states.apply(this._vizFrame,arguments)}return e===this._vizFrame?this:e};F.prototype._readyToRender=function(e){if(arguments.length===0){return this._bReadyToRender}else{this._bReadyToRender=e}};return F});
//# sourceMappingURL=VizFrame.js.map