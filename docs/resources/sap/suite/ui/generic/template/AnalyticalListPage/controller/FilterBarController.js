sap.ui.define(["sap/m/SegmentedButtonItem","sap/m/Button","sap/m/Text","sap/m/Dialog","sap/m/SegmentedButton","sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterDialogController","sap/ui/core/mvc/Controller","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/ui/Device","sap/suite/ui/generic/template/AnalyticalListPage/util/CommonUtil"],function(t,e,a,r,i,l,o,s,n,S){"use strict";var u="visual",h="group",F="sap.suite.ui.generic.template.customData",g="sap.suite.ui.generic.template.genericData",m="sap.suite.ui.generic.template.extensionData";var p=o.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.FilterBarController",{init:function(t){this.compactFilterData={};var e=this;e.oState=t;var a;if(n.system.phone){a=true}else{a=e.oState.oController.getOwnerComponent().getShowGoButtonOnFilterBar()?true:false}t.oSmartFilterbar.setShowGoOnFB(a);t.oSmartFilterbar.setLiveMode(!a);if(t.oSmartTable){t.oSmartTable.setEnableAutoBinding(!a)}if(!a){e.oState.oSmartFilterbar._oFiltersButton.setVisible(false)}t.oHeader=t.oPage.getHeader();t.oTitle=t.oPage.getTitle();if(t.alr_visualFilterBar){t.alr_visualFilterBar.setSmartFilterContext(this.oState.oSmartFilterbar);t.alr_visualFilterBar.attachFilterChange(this._onVisualFilterChange.bind(this))}t.oSmartFilterbar.attachAfterVariantLoad(this._afterVariantLoad.bind(this))},_updateFilterLink:function(){var t=this._getFilterDataCount(),e=this.oState.oController.getOwnerComponent().getModel("_templPriv");e.setProperty("/alp/filtersLink",t)},_getFilterDataCount:function(){var t=this.oState.oSmartFilterbar.retrieveFiltersWithValues(),e=t.length,a=this.oState.oSmartFilterbar.getBasicSearchControl();if(a&&a.getValue&&a.getValue()){e++}return e},_afterVariantLoad:function(t){if(this.oState.alr_visualFilterBar&&t.mParameters.context!=="CANCEL"){var e=this.oState.oSmartFilterbar.isDialogOpen();if(e){this.oState.alr_visualFilterBar.updateVisualFilterBindings.apply(this.oState.visualFilterDialogContainer,[true,true])}else{this.oState.alr_visualFilterBar.updateVisualFilterBindings(true)}}if(this.oState.oSmartFilterbar.isLiveMode()&&t.mParameters.context!="INIT"){this.oState.oSmartFilterbar.search()}},_afterSFBVariantLoad:function(){var t=this.oState.oSmartFilterbar.getFilterData();if(t._CUSTOM!==undefined){this.oState.oIappStateHandler.fnRestoreFilterState(t._CUSTOM)}else{var e=this.oState.oIappStateHandler.getFilterState();S.nullify(e[F]);S.nullify(e[g]);S.nullify(e[m]);this.oState.oIappStateHandler.fnRestoreFilterState(e)}this.oState.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL()},_onVisualFilterChange:function(t){if(t.getParameter("propertyName")&&t.getParameter("bVisible")!==undefined){var e=this.oState.oSmartFilterbar.determineFilterItemByName(t.getParameter("propertyName"));if(t.getParameter("bVisible")){if(!e.getPartOfCurrentVariant()){e.setPartOfCurrentVariant(true);e.setVisibleInFilterBar(true)}}else{e.setPartOfCurrentVariant(false);e.setVisibleInFilterBar(false)}}var a=this.oState.oSmartFilterbar.isDialogOpen();if(a&&this.oState.visualFilterDialogContainer){var r=this.oState.visualFilterDialogContainer.oVerticalBox.getModel("_dialogFilter");var i=r.getData();if(this.oState.oSmartFilterbar.getFilterData()._CUSTOM!==undefined){i._CUSTOM=this.oState.oSmartFilterbar.getFilterData()._CUSTOM}this.oState.oSmartFilterbar.setFilterData(i,true)}else{var l=this.oState.oController.getOwnerComponent().getModel("_filter");var o=l.getData();if(this.oState.oSmartFilterbar.getFilterData()._CUSTOM!==undefined){o._CUSTOM=this.oState.oSmartFilterbar.getFilterData()._CUSTOM}this.oState.oSmartFilterbar.setFilterData(o,true)}if(this.oState.oSmartFilterbar.isLiveMode()){if(!a){this.oState.oSmartFilterbar.search()}else{this.oState.visualFilterDialogContainer.bSearchPendingAfterDialogFilterChange=true}}},onGoFilter:function(){this.oState.oSmartFilterbar.search()},setDefaultFilter:function(t){var e=this.oState.oController.getOwnerComponent().getModel("_templPriv");e.setProperty("/alp/filterMode",t);this.handleFilterSwitch(t)},handleFilterSwitch:function(t,e){var a=this.oState.oController.getOwnerComponent();var r=a.getModel("_templPriv");if(this.oState.alr_visualFilterBar&&!this.oState.alr_visualFilterBar.getAssociateValueListsCalled()){this.oState.alr_visualFilterBar.setAssociateValueListsCalled(true);this.oState.oSmartFilterbar.associateValueLists()}if(r.getProperty("/alp/filterMode")===u){if(a.getLazyLoadVisualFilter()&&!this.oState.oSmartFilterbar.isDialogOpen()){this.oState.alr_visualFilterBar.updateVisualFilterBindings(true)}}},fnCheckMandatory:function(){this.oState.oSmartFilterbar.checkSearchAllowed(this.oState);var t=this.oState.oController.getOwnerComponent().getModel("_templPriv");if(this.oState.alr_visualFilterBar&&this.oState.alr_visualFilterBar.bIsInitialised&&t.getProperty("/alp/searchable")===false&&t.getProperty("/alp/filterMode")===u){this.oState.oSmartFilterbar.showAdaptFilterDialog(h)}},showDialog:function(){var t=this.oState.oController.getOwnerComponent().getModel("_templPriv");if(t.getProperty("/alp/filterMode")===u){if(this.oState.alr_visualFilterBar&&this.oState.alr_visualFilterBar.bIsInitialised&&t.getProperty("/alp/searchable")===false){this.oState.oSmartFilterbar.showAdaptFilterDialog(h)}else{this.oState.oSmartFilterbar.showAdaptFilterDialog(u)}}else{this.oState.oSmartFilterbar.showAdaptFilterDialog()}},clearFilters:function(){var t=this.oState.oSmartFilterbar.getFilterData();for(var e in t){if(t.hasOwnProperty(e)){delete t[e]}}this.oState.oSmartFilterbar.setFilterData(t,true);if(this.oState.chartController){this.oState.chartController._updateTable()}},changeVisibility:function(t){var e=t.getParameters().filterItem.filterItem,a=t.getParameters().added?true:false,r=this.oState.visualFilterDialogContainer;var i=r.oVerticalBox.getModel("_visualFilterDialogModel").getData().filterCompList;for(var l=0;l<i.length;l++){if(e&&e.getName()===i[l].component.properties.parentProperty){r.oConfig.filterCompList[l].shownInFilterDialog=a;r.oConfig.filterCompList[l].shownInFilterBar=a;r._updateVisualFilterConfigModel(l,"/shownInFilterDialog",a);r.selectCheckBox(l,a);break}}r._reloadForm()}});return p});
//# sourceMappingURL=FilterBarController.js.map