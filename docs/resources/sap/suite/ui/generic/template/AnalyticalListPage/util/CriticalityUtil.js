sap.ui.define(["sap/ui/base/Object","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/m/library","sap/suite/ui/generic/template/genericUtilities/FeLogger"],function(i,t,e,a){"use strict";var r=new a("AnalyticalListPage.CriticalityUtil").getLogger();var l="Positive",n="Negative",o="Critical",s="Neutral",u="Target",h="Maximize",c="Minimize",g=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY;var f=i.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.CriticalityUtil");f.setVals=function(i,t,e,a,r){this.deviationLow=e;this.deviationHigh=a;this.toleranceLow=i;this.toleranceHigh=t;this._value=r;this.state=undefined};f.setValuesForOmittedThresholds=function(i,t,e,a){this.deviationLow=e||e===0?e:d;this.deviationHigh=a||a===0?a:g;this.toleranceLow=i||i===0?i:this.deviationLow;this.toleranceHigh=t||t===0?t:this.deviationHigh};f.Maximize=function(){if(this.toleranceLow||this.deviationLow||this.toleranceLow===0||this.deviationLow===0){this.setValuesForOmittedThresholds(this.toleranceLow,this.toleranceHigh,this.deviationLow,this.deviationHigh);if(this._value>=this.toleranceLow){this.state=e.ValueColor.Good}else if(this._value<this.deviationLow){this.state=e.ValueColor.Error}else{this.state=e.ValueColor.Critical}}return this.state};f.Maximizing=function(){this.Maximize()};f.Minimize=function(){if(this.toleranceHigh||this.deviationHigh||this.toleranceHigh===0||this.deviationHigh===0){this.setValuesForOmittedThresholds(this.toleranceLow,this.toleranceHigh,this.deviationLow,this.deviationHigh);if(this._value<=this.toleranceHigh){this.state=e.ValueColor.Good}else if(this._value>this.deviationHigh){this.state=e.ValueColor.Error}else{this.state=e.ValueColor.Critical}}return this.state};f.Minimizing=function(){this.Minimize()};f.Target=function(){if(this.toleranceHigh||this.toleranceLow||this.deviationHigh||this.deviationLow||this.toleranceHigh===0||this.toleranceLow===0||this.deviationHigh===0||this.deviationLow===0){this.setValuesForOmittedThresholds(this.toleranceLow,this.toleranceHigh,this.deviationLow,this.deviationHigh);if(this._value>=this.toleranceLow&&this._value<=this.toleranceHigh){this.state=e.ValueColor.Good}else if(this._value<this.deviationLow||this._value>this.deviationHigh){this.state=e.ValueColor.Error}else if(this._value>=this.deviationLow&&this._value<this.toleranceLow||this._value<=this.deviationHigh&&this._value>this.toleranceHigh){this.state=e.ValueColor.Critical}}return this.state};f.getDataPoint=function(i,t){var e=i.getMetaModel(),a=e.getODataEntityType(e.getODataEntitySet(t.getEntitySet()).entityType),l=t.getChartQualifier()in a?a[t.getChartQualifier()]:undefined,n,o=0,s=l?l.MeasureAttributes:undefined;if(s){for(var u=0;u<s.length;u++){if(s[u].Measure&&s[u].Measure.PropertyPath===t.getMeasureField()){n=s[u].DataPoint?a[s[u].DataPoint.AnnotationPath.substring(1)]:undefined;if(n){o++;break}}}}if(o===0){r.info("There is no datapoint for the measure "+t.getMeasureField())}return n};f.getCriticalityRefProperties=function(i){var e=[];var a=i.Criticality;if(a){var r=t.readProperty(a,"Path");if(r){e.push(r)}}else{var l=i.CriticalityCalculation,n=t.readProperty(i,"CriticalityCalculation.ImprovementDirection.EnumMember")?t.getPrimitiveValue(i.CriticalityCalculation.ImprovementDirection):undefined,o=t.readProperty(l,"DeviationRangeLowValue.Path"),s=t.readProperty(l,"DeviationRangeHighValue.Path"),g=t.readProperty(l,"ToleranceRangeLowValue.Path"),d=t.readProperty(l,"ToleranceRangeHighValue.Path");if(n===h){if(o){e.push(o)}if(g){e.push(g)}}else if(n===c){if(d){e.push(d)}if(s){e.push(s)}}else if(n===u){if(o){e.push(o)}if(g){e.push(g)}if(s){e.push(s)}if(d){e.push(d)}}}return e.length>0?e:undefined};f.getCriticalityIndicatorFromEnum=function(i){var t;i=i.toString();if(i===s||i==="0"){t=e.ValueColor.Neutral}else if(i===n||i==="1"){t=e.ValueColor.Error}else if(i===o||i==="2"){t=e.ValueColor.Critical}else if(i===l||i==="3"){t=e.ValueColor.Good}return t};f.CalculateDimensionCriticality=function(i,e,a,r){var l=i.getMetaModel(),n=l.getODataEntityType(l.getODataEntitySet(a).entityType),o=l.getODataProperty(n,e);for(var s=0;s<r.results.length;s++){if(o&&o["com.sap.vocabularies.UI.v1.ValueCriticality"]){var u=o["com.sap.vocabularies.UI.v1.ValueCriticality"];var h=f.findDimensionCriticality(u,r.results[s][e].toString());if(h&&h.Criticality){h=t.getPrimitiveValue(h.Criticality);r.results[s].color=this.getCriticalityIndicatorFromEnum(h)}}}return r};f.findDimensionCriticality=function(i,t){return i.find(function(i){return i.Value.String.toString()===t})};f.CalculateCriticality=function(i,e,a){for(var r=0;r<e.results.length;r++){if(i&&i.Criticality){var l=i.Criticality.EnumMember||i.Criticality.Path?t.getPathOrPrimitiveValue(i.Criticality):undefined;if(l){if(l.indexOf("path")!==-1){l=i.Criticality.Path?e.results[r][i.Criticality.Path]:undefined}e.results[r].color=this.getCriticalityIndicatorFromEnum(l)}}else{var n=t.readProperty(i,"CriticalityCalculation.ImprovementDirection.EnumMember")?t.getPrimitiveValue(i.CriticalityCalculation.ImprovementDirection):undefined;if(n){if(t.readProperty(i,"CriticalityCalculation.ToleranceRangeLowValue")){var o=t.readProperty(i,"CriticalityCalculation.ToleranceRangeLowValue.Int")?Number(i.CriticalityCalculation.ToleranceRangeLowValue.Int):Number(e.results[r][i.CriticalityCalculation.ToleranceRangeLowValue.Path])}if(t.readProperty(i,"CriticalityCalculation.ToleranceRangeHighValue")){var s=t.readProperty(i,"CriticalityCalculation.ToleranceRangeHighValue.Int")?Number(i.CriticalityCalculation.ToleranceRangeHighValue.Int):Number(e.results[r][i.CriticalityCalculation.ToleranceRangeHighValue.Path])}if(t.readProperty(i,"CriticalityCalculation.DeviationRangeLowValue")){var u=t.readProperty(i,"CriticalityCalculation.DeviationRangeLowValue.Int")?Number(i.CriticalityCalculation.DeviationRangeLowValue.Int):Number(e.results[r][i.CriticalityCalculation.DeviationRangeLowValue.Path])}if(t.readProperty(i,"CriticalityCalculation.DeviationRangeHighValue")){var h=t.readProperty(i,"CriticalityCalculation.DeviationRangeHighValue.Int")?Number(i.CriticalityCalculation.DeviationRangeHighValue.Int):Number(e.results[r][i.CriticalityCalculation.DeviationRangeHighValue.Path])}if(isNaN(u)){u=undefined}if(isNaN(h)){h=undefined}if(isNaN(o)){o=undefined}if(isNaN(s)){s=undefined}var c=Number(e.results[r][a]);this.setVals(o,s,u,h,c);e.results[r].color=this[n]()}}}return e};return f},true);
//# sourceMappingURL=CriticalityUtil.js.map