sap.ui.define(["sap/ui/core/mvc/OverrideExecution","sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/AnalyticalListPage/controller/ControllerImplementation","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/AnalyticalListPage/controllerFrameworkExtensions","sap/suite/ui/generic/template/js/preparationHelper","sap/base/util/deepExtend","sap/suite/ui/generic/template/listTemplates/filterSettingsPreparationHelper","sap/suite/ui/generic/template/js/StableIdHelper","sap/suite/ui/generic/template/js/AnnotationHelper","sap/base/util/isEmptyObject","sap/suite/ui/generic/template/AnalyticalListPage/util/AnnotationHelper","sap/insights/CardHelper"],function(e,t,a,i,n,l,o,r,s,u,c,p,d){"use strict";function f(t,f){var g={};return{oControllerSpecification:{getMethods:a.getMethods.bind(null,g),oControllerDefinition:n,oControllerExtensionDefinition:{metadata:{methods:{onInitSmartFilterBar:{public:true,final:false,overrideExecution:e.After},provideExtensionAppStateData:{public:true,final:false,overrideExecution:e.After},restoreExtensionAppStateData:{public:true,final:false,overrideExecution:e.After},ensureFieldsForSelect:{public:true,final:false,overrideExecution:e.After},addFilters:{public:true,final:false,overrideExecution:e.After}}},onInitSmartFilterBar:function(e){},provideExtensionAppStateData:function(e){},restoreExtensionAppStateData:function(e){},ensureFieldsForSelect:function(e,t){},addFilters:function(e,t){}}},oComponentData:{templateName:"sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage",designtimePath:"sap/suite/ui/generic/template/designtime/AnalyticalListPage.designtime"},init:function(){var e=t.getModel("_templPriv");e.setProperty("/listReport",{});e.setProperty("/alp",{visualFilter:{}});var a=new i;t.setModel(a,"_filter")},onActivate:function(){g.onComponentActivate()},refreshBinding:function(){g.refreshBinding()},onSuspend:function(){g.onSuspend()},onRestore:function(){g.onRestore()},getUrlParameterInfo:function(){return g.getUrlParameterInfo()},getTemplateSpecificParameters:function(e,a,i,n,g,b){function m(t){var a={sLineItemQualifier:"",sChartQualifier:""};var i="";if(A.quickVariantSelectionX){var n=V[A.quickVariantSelectionX.variants[t].annotationPath];if(n&&n.PresentationVariant){var l;if(n.PresentationVariant.Path){var o=n.PresentationVariant.Path.split("@")[1];l=o&&V[o]}else{l=n.PresentationVariant}i=l.Visualizations&&l.Visualizations[0].AnnotationPath}else if(n&&n.Visualizations){i=n.Visualizations[0].AnnotationPath}if(i&&i.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1){a.sLineItemQualifier=i.split("#")[1]||""}}else{var r=V.$path+"/com.sap.vocabularies.UI.v1.SelectionPresentationVariant"+(A&&A.qualifier?"#"+A.qualifier:"");var s=e.getObject(r);r=p.getAnnotationfromSPV(V,r,s,r,A?A.qualifier:"","PresentationVariant");var u=e.getObject(r);if(u&&u.Visualizations){u.Visualizations.forEach(function(e){var t="/"+e.AnnotationPath.slice(1);if(t.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1){a.sLineItemQualifier=(V.$path+t).split("#")[1]||""}else if(!A.chartPresentationQualifier&&t.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1){a.sChartQualifier=(V.$path+t).split("#")[1]||""}})}}return a}function y(e){function t(t,a){var i={mAnnotatedActionsWithCommand:Object.create(null),mOutboundActionsWithCommand:Object.create(null)};t.forEach(function(t){switch(t.RecordType){case"com.sap.vocabularies.UI.v1.DataFieldForAction":var n=f.getToolbarDataFieldForActionCommandDetails(t,A,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[e]:undefined,undefined,a);if(!c(n)){i.mAnnotatedActionsWithCommand[n.id]=n}break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":var n=f.getToolbarDataFieldForIBNCommandDetails(t,A,g,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[e]:undefined,undefined,a);if(!c(n)){i.mOutboundActionsWithCommand[n.id]=n}break;default:break}});return i}var a=m(e);var i=t(V["com.sap.vocabularies.UI.v1.LineItem"+(a.sLineItemQualifier?"#"+a.sLineItemQualifier:"")]||[],false);var n=V["com.sap.vocabularies.UI.v1.Chart"+(a.sChartQualifier?"#"+a.sChartQualifier:"")];var l=t(n&&!c(n.Actions)?n.Actions:[],true);return{tableSettings:{commandExecution:o(i.mAnnotatedActionsWithCommand,i.mOutboundActionsWithCommand)},chartSettings:{commandExecution:o(l.mAnnotatedActionsWithCommand,l.mOutboundActionsWithCommand)}}}var S=f.getControllerExtensions();var v=e.getODataEntitySet(n);var h=l.getLineItemFromVariant(e,v.entityType,a.qualifier);var V=e.getODataEntityType(v.entityType);var A=o({},a);A.targetEntities={};A.targetEntities[v.entityType]=l.getTargetEntityForQuickView(e,v);A.tableSettings=l.getNormalizedTableSettings(e,a,i,n,S&&S.Actions,h);A.isSelflinkRequired=false;A.isIndicatorRequired=false;A.isSemanticallyConnected=true;A.controlConfigurationSettings=r.getControlConfigurationSettings(A,V,v,b);function P(t,a){var i=e.getODataEntitySet(t);var n=e.getODataEntityType(i.entityType);var l,o,r;o=a.annotationPath;r=!!o&&n[o];if(r&&r.PresentationVariant){if(r.PresentationVariant.Visualizations){l=r.PresentationVariant.Visualizations[0].AnnotationPath}else if(r.PresentationVariant.Path){var s=r.PresentationVariant.Path.split("@")[1];var u=s&&n[s];l=u.Visualizations[0].AnnotationPath}}else if(r&&r.Visualizations){l=r.Visualizations[0].AnnotationPath}return!!(l&&l.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1)}function E(t){if(!A.targetEntities[t.entityType]){A.targetEntities[t.entityType]=l.getTargetEntityForQuickView(e,t)}}function C(e,t){var a=f.getControllerExtensions();var i=[],n=[],l=Object.create(null),o=Object.create(null);Object.values(a&&a.Actions||{}).forEach(function(a){if(!a.global){var r=a.global?{type:"Action",subType:"Global",sAction:a.id}:{type:"ALPAction",subType:"ExtensionAction",sAction:a.id,sQuickVariantKey:e};var c=s.getStableId(r);a.enabled=u.getBreakoutActionEnabledKey(a,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[t]:undefined);if(a.command){var p={id:c,action:a.command,callbackName:a.press};a.press="cmd:"+a.command;a.id=c}if(a.filter==="chart"){if(p){o[a.id]=p}n.push(a)}else{if(p){l[a.id]=p}i.push(a)}}});return{tableSettings:{commandExecution:l,extensionActions:i},chartSettings:{commandExecution:o,extensionActions:n}}}if(A.quickVariantSelectionX){var T=l.getNormalizedTableSettings(e,A,i,n,S&&S.Actions,h);var I=A.quickVariantSelectionX.variants||{};for(var F in I){var O=I[F].entitySet||n;var v=e.getODataEntitySet(O);if(!v){delete I[F];continue}I[F].isSmartChart=P(O,I[F]);if(!I[F].isSmartChart){var h=l.getLineItemFromVariant(e,e.getODataEntitySet(O).entityType,I[F].annotationPath&&I[F].annotationPath.split("#")[1]);I[F].tableSettings=I[F].tableSettings||T;I[F].tableSettings=l.getNormalizedTableSettings(e,I[F],i,O,S&&S.Actions,h);I[F].tableSettings.selectAll=I[F].tableSettings.selectAll===undefined?false:I[F].tableSettings.selectAll;if(A.isResponsiveTable===undefined){A.isResponsiveTable=I[F].tableSettings.type==="ResponsiveTable"}var x=e.getODataEntityType(v.entityType);if(x&&x.property&&I[F].tableSettings&&I[F].tableSettings.createWithParameterDialog){A.quickVariantSelectionX.variants[F].tableSettings.createWithParameterDialog.id=s.getStableId({type:"ALPAction",subType:"CreateWithDialog",sQuickVariantKey:I[F].key})}E(v);I[F].tableSettings=o(I[F].tableSettings,C(I[F].key,F).tableSettings,y(F).tableSettings)}}delete A.tableSettings;if(A.isResponsiveTable===undefined){A.isResponsiveTable=true}}else{A.tableSettings=l.getNormalizedTableSettings(e,a,i,n,S&&S.Actions,h);A.tableSettings.selectAll=A.tableSettings.selectAll===undefined?false:A.tableSettings.selectAll;A.isResponsiveTable=A.tableSettings.type==="ResponsiveTable";if(A.tableSettings.enableMultiEditDialog&&A.isResponsiveTable&&!f.isDraftEnabled()&&!A.isWorklist&&!t.getAppComponent().getFlexibleColumnLayout()){A.multiEdit=true;if(v["Org.OData.Capabilities.V1.UpdateRestrictions"]&&v["Org.OData.Capabilities.V1.UpdateRestrictions"].Updatable&&v["Org.OData.Capabilities.V1.UpdateRestrictions"].Updatable.Bool==="false"){A.multiEdit=false}else if(A.tableSettings.mode==="None"){A.tableSettings.mode=A.tableSettings.multiSelect?"MultiSelect":"SingleSelectLeft"}}E(v);var D=C();var k=y();A.tableSettings=o(A.tableSettings,D.tableSettings,k.tableSettings);A.chartSettings=o(A.chartSettings,D.chartSettings,k.chartSettings)}A.bInsightsEnabled=false;d.getServiceAsync("UIService").then(function(e){A.bInsightsEnabled=true;var a=t.getModel("_templPriv");a.setProperty("/oInsightsInstance",e)}).catch(function(e){A.bInsightsEnabled=false});return A},overwrite:{updateBindingContext:function(){sap.suite.ui.generic.template.lib.TemplateComponent.prototype.updateBindingContext.apply(t,arguments)}},executeBeforeInvokeActionFromExtensionAPI:function(e,t){if(e.oSmartTable){e.oSmartTable.getTable().attachEventOnce("updateFinished",function(){t.setEnabledToolbarButtons(e.oSmartTable);t.setEnabledFooterButtons(e.oSmartTable)})}if(e.oSmartChart){e.oSmartChart.getChartAsync().then(function(a){a.attachEventOnce("updateFinished",function(){t.setEnabledToolbarButtons(e.oSmartChart);t.setEnabledFooterButtons(e.oSmartChart)})})}}}}return t.getTemplateComponent(f,"sap.suite.ui.generic.template.AnalyticalListPage",{metadata:{library:"sap.suite.ui.generic.template",properties:{qualifier:{type:"string",defaultValue:""},chartPresentationQualifier:{type:"string",defaultValue:""},gridTable:{type:"boolean",defaultValue:false},tableType:{type:"string",defaultValue:""},multiSelect:{type:"boolean",defaultValue:false},tableSettings:{type:"object",properties:{type:{type:"string",defaultValue:undefined},multiSelect:{type:"boolean",defaultValue:false},selectAll:{type:"boolean",defaultValue:true},selectionLimit:{type:"int",defaultValue:200}}},chartSettings:{type:"object",properties:{showDataLabel:{type:"boolean",defaultValue:false}}},smartVariantManagement:{type:"boolean",defaultValue:true},defaultContentView:{type:"string",defaultValue:"charttable"},lazyLoadVisualFilter:{type:"boolean",defaultValue:true},defaultFilterMode:{type:"string",defaultValue:"visual"},keyPerformanceIndicators:"array",autoHide:{type:"boolean",defaultValue:true},showAutoHide:{type:"boolean",defaultValue:true},hideVisualFilter:{type:"boolean",defaultValue:false},showGoButtonOnFilterBar:{type:"boolean",defaultValue:false},uniqueHierarchyNodeIDForTreeTable:{type:"string",defaultValue:""},showItemNavigationOnChart:{type:"boolean",defaultValue:false},condensedTableLayout:{type:"boolean",defaultValue:true},contentTitle:{type:"string",defaultValue:undefined},enableTableFilterInPageVariant:{type:"boolean",defaultValue:false},dshQueryName:{type:"string",defaultValue:undefined},filterDefaultsFromSelectionVariant:{type:"boolean",defaultValue:false},allFiltersAsInParameters:{type:"boolean",defaultValue:true},dataLoadSettings:{type:"object",properties:{loadDataOnAppLaunch:{type:"string",defaultValue:"ifAnyFilterExist"}}},filterSettings:r.getFilterSettingsMetadata(),refreshIntervalInMinutes:{type:"int"},quickVariantSelection:{type:"object",properties:{showCounts:{type:"boolean",defaultValue:false},variants:{type:"object",mapEntryProperties:{key:{type:"string",optional:true},annotationPath:{type:"string"}}}}},quickVariantSelectionX:{type:"object",properties:{showCounts:{type:"boolean",defaultValue:false},variants:{type:"object",mapEntryProperties:{key:{type:"string",optional:true},annotationPath:{type:"string"},entitySet:{type:"string",optional:true},tableSettings:{type:"object",properties:{type:{type:"string",defaultValue:undefined},multiSelect:{type:"boolean",defaultValue:false},selectAll:{type:"boolean",defaultValue:false},selectionLimit:{type:"int",defaultValue:200}}}}}}}},manifest:"json"}})});
//# sourceMappingURL=Component.js.map