sap.ui.define(["sap/ui/base/Object","sap/base/util/extend"],function(e,t){"use strict";function n(e){var t=e.oAppComponent.suppressDataLossPopup();var n;var a;function r(e,t,r,o,s){var i,l;n=e;a=t;var u=s?"sap.suite.ui.generic.template.fragments.DataLossTechnicalError":"sap.suite.ui.generic.template.fragments.DataLoss";r.getDialogFragmentAsync(u,{onDataLossOK:function(){l.close();n()},onDataLossCancel:function(){l.close();a()}},"dataLoss").then(function(e){l=e;i=l.getModel("dataLoss");i.setProperty("/isLeaving",o);l.open()})}function o(){var t=e.oNavigationControllerProxy.getActiveComponents();var n,a,r;t.forEach(function(t){var o=e.componentRegistry[t];if(o.utils.isDraftEnabled()){return}r=r||o;var s=o.oComponent.getModel("ui");if(s.getProperty("/editable")){n=n||o}if(o.aUnsavedDataCheckFunctions&&o.aUnsavedDataCheckFunctions.some(function(e){return e()})){a=a||o}});return{relevantRegistryEntry:a||n||r,hasExternalChanges:!!a}}function s(n,a,s,i){var l=o();var u=l.relevantRegistryEntry&&(l.hasExternalChanges||e.oAppComponent.getModel().hasPendingChanges());var c=l.relevantRegistryEntry?function(){l.relevantRegistryEntry.utils.cancelEdit(null,u);if(s){e.oNavigationControllerProxy.userHasAcceptedDataLoss()}n()}:n;var f=!t&&u;if(f){r(c,a,l.relevantRegistryEntry.oControllerUtils.oCommonUtils,s,i)}else{c()}}function i(t,n,a,r,o){var i=a.startsWith("Leave");var l=new Promise(function(a,l){var u=function(){var e=t();a(e)};var c=function(){n();l()};if(r){s(u,c,i,o)}else{e.oApplicationProxy.performAfterSideEffectExecution(s.bind(null,u,c,i,o),true)}});return l}function l(n){var a=!t&&e.oNavigationControllerProxy.unwantedDataLossPossible(n);if(a){var r=o();var s=r.relevantRegistryEntry&&(r.hasExternalChanges||e.oAppComponent.getModel().hasPendingChanges());return!!s}return false}return{performIfNoDataLoss:i,getShellDataLossPopup:l}}return e.extend("sap.suite.ui.generic.template.lib.DataLossHandler",{constructor:function(e){t(this,n(e))}})});
//# sourceMappingURL=DataLossHandler.js.map