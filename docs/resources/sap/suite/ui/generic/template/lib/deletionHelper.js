sap.ui.define(["sap/base/util/extend"],function(e){"use strict";function t(e){var t=e.oNavigationControllerProxy.getActiveComponents();var n=[];for(var r=0;r<t.length;r++){var o=t[r];var i=e.componentRegistry[o];var a=i.viewLevel;if(a>0){var l=i.oComponent.getBindingContext();if(l){n[a]=l.getPath()}}}return n}function n(e,t){var n=e.oNavigationControllerProxy.getActiveComponents();for(var r=0;r<n.length;r++){var o=n[r];var i=e.componentRegistry[o];var a=i.viewLevel;if(a===t){return i}}}function r(e,t){var r=n(e,0);if(r&&r.methods.displayNextObject){return r.methods.displayNextObject(t)}return Promise.reject()}function o(e,t){var r=e.oFlexibleColumnLayoutHandler&&e.oFlexibleColumnLayoutHandler.isNextObjectLoadedAfterDelete();if(r){var o=n(e,0);if(o){if(t){return[e.oApplicationProxy.getPathOfLastShownDraftRoot()]}return o.methods.getItems&&o.methods.getItems()}}return null}function i(e,t){e.oNavigationControllerProxy.navigateUpAfterDeletion(t)}function a(e,t,n,o){var a=[];var l;var v=[];var f;for(var u=0;u<n.length;u++){f=n[u].getBindingContextPath();v.push(f)}for(var s=0;s<v.length;s++){if(v[s]===t){a.push(v[s]);l=s;break}}if(l>=0){var c=v.slice(l+1,v.length);var g;if(l>0){g=v.slice(0,l);g.reverse()}a=a.concat(c,g)}else{a=v}o.then(function(){var t=r(e,a);t.catch(function(){i(e,0)})})}function l(e){return function(){var t=e.oTemplatePrivateGlobalModel.getProperty("/generic/forceFullscreenCreate");if(t){e.oNavigationControllerProxy.navigateBack()}else{var n=o(e,true);if(n){r(e,n)}else{i(e,0)}}}}function v(n,r,l){var v=t(n);var f=[];var u=null;var s;var c;var g;var p;var d;for(p in n.componentRegistry){d=n.componentRegistry[p];var h=d.viewLevel&&d.oComponent.getBindingContext();c=h&&h.getPath();g=c&&r[c];if(g){var m=n.oViewDependencyHelper.unbindChildren.bind(null,d.oComponent,true);g.then(m)}}var y=Object.create(null);var C=function(e,t){if(t){y[t]=true}return{deleted:!!t,position:e}};for(c in r){var x=c.substring(1,c.indexOf("("));g=r[c];n.oApplicationProxy.prepareDeletion(c,g);var P=v.indexOf(c);if(P===1){s=o(n);if(s){u=c}}var b=g.then(C.bind(null,P,x),C.bind(null,P,null));f.push(b)}if(u){a(n,u,s,r[u])}else{Promise.all(f).then(function(e){var t=-1;for(var r=0;r<e.length;r++){var o=e[r];if(o.deleted&&o.position>0){if(t<0||t>=o.position){t=o.position-1}}}if(t>=0){i(n,t)}})}if(!l){Promise.all(f).then(function(t){for(p in n.componentRegistry){d=n.componentRegistry[p];var r=d.mRefreshInfos;e(r,y);if(d.utils.isComponentActive()){d.utils.refreshBinding()}}})}}return{prepareDeletion:v,getNavigateAfterDeletionOfCreateDraft:l}});
//# sourceMappingURL=deletionHelper.js.map