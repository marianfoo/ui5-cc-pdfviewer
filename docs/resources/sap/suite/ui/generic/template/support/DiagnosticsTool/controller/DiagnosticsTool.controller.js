sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/suite/ui/generic/template/support/lib/Documentation","sap/suite/ui/generic/template/genericUtilities/polyFill"],function(e,t,o,a,r){"use strict";var i=new a("support.DiagnosticsTool.controller.DiagnosticsTool").getLogger();var n=window.diagnosticToolSpace;function s(){this.getView().attachAfterRendering(function(){g()})}function l(){var e=this.getView().getModel("data");if(e.getProperty("/status")==="Loading"){t.show("Application is still loading");return}var o=(new Date).toLocaleTimeString([],{hour12:false,hour:"2-digit",minute:"2-digit",second:"2-digit"});e.setData({properties:null,retrieval:o,copyEnabled:false});e.updateBindings();this.getView().getViewData().plugin.onRefresh()}function c(){var e="\r\n";var a="- ";var i=this.getView().getModel("data").getData();if(!(i&&i.properties&&i.url)){o.error("Could not copy data to your clipboard! No data collected",{title:"Error"});return}var n=i.properties;var s="*************+Extracted by SAP Fiori Elements Diagnostics Plugin [FEDiagnostic]+*************"+e;s+=a+"Extracted on "+(new Date).toUTCString()+e;s+=a+"Host: "+i.origin+e;s+=a+"Application status: "+i.status+e;if(i.statusMessage){s+=a+"Notice: "+i.statusMessage+e}s+=a+"Documentation: "+r.getDocuURL()+e;s+=e;s+="APP DATA"+e;for(var l=0,c=n.length;l<c;l++){if(n[l].type==="string"){s+=a+n[l].name+": "+n[l].value+e}else if(n[l].type==="link"){s+=a+n[l].name+": "+n[l].target+e}else if(n[l].type==="group"){s+="Group: "+n[l].name+e}}s+=e;s+="**************************"+e;s+=e;s+=e;s+="PROVIDE"+e;s+=a+"User/Password: <user>/<password>"+e;s+=a+"Steps to recreate the issue: <maybe also provide master data, pictures or video…>"+e;var u=this.getView().byId("CopyDataTextArea").getId();var d=document.getElementById(u);d.style.display="block";d.value=s;d.select();try{var p=document.execCommand("copy");if(p){t.show("Ticket relevant information copied to clip board")}else{o.error("Could not copy data to your clipboard! You can copy it manually from here: "+e+e+s,{title:"Error"})}}catch(t){o.error("Could not copy data to your clipboard! You can copy it manually from here: "+e+e+s,{title:"Error"})}finally{d.style.display="none"}}function u(){var e="<br>",a="</span>"+e,i="<span>",n=i+"- ",s=this.getView().getModel("data").getData();if(!(s&&s.properties&&s.url)){o.error("Could not copy data to your clipboard! No data collected",{title:"Error"});return}var l=s.properties,u=document.getElementById(this.getView().byId("CopyDataHTML").getId());var d=i+"*************+Extracted by SAP Fiori Elements Diagnostics Plugin [FEDiagnostic]+*************"+a;d+=n+"Extracted on "+(new Date).toUTCString()+a;d+=n+'Host: <a href="'+s.url+'" rel="noopener noreferrer">'+s.origin+"</a>"+a;d+=n+"Application status: "+s.status+a;if(s.statusMessage){d+=n+"Notice: "+s.statusMessage+a}d+=n+"Documentation: "+'<a href="'+r.getDocuURL()+'" rel="noopener noreferrer">'+r.getDocuURL()+"</a>"+a;d+=e;d+=i+"APP DATA"+a;for(var p=0,g=l.length;p<g;p++){if(l[p].type==="string"){d+=n+l[p].name+": "+l[p].value+a}else if(l[p].type==="link"){d+=n+l[p].name+': <a href="'+l[p].target+'" rel="noopener noreferrer">'+l[p].value+"</a>"+a}else if(l[p].type==="group"){d+=i+"Group: "+l[p].name+a}}d+=i+"**************************"+a;d+=e;d+=i+"PROVIDE"+a;d+=i+"User/Password: &lt;user&gt;/&lt;password&gt;"+a;d+=i+"Steps to recreate the issue: &lt;maybe also provide master data, pictures or video…&gt;"+a;function m(){try{document.getSelection().removeAllRanges()}catch(e){Function.prototype()}}u.innerHTML="";u.insertAdjacentHTML("beforeend",d);try{var f=document.createRange();m();f.selectNode(u);document.getSelection().addRange(f);document.execCommand("copy");m();t.show("Ticket relevant information copied to clip board with HTML format")}catch(e){m();c()}finally{u.innerHTML=""}}function d(){r.openDocumentation()}function p(e){e.parentNode.removeChild(e)}function g(){var e=document.querySelectorAll(".diagnosticPropertiesGroupHeaderContent");if(e.length===0){i.debug("No headers found which should be customized");return}var t,o;for(var a=0;a<e.length;a++){t=e[a];o=t.closest("td");o.classList.add("diagnosticPropertiesGroupHeader");o.colSpan=2;p(o.nextElementSibling)}}function m(e,t){var o=this.getView().getModel("data");o.setData({timeLeft:e,status:t})}function f(){if(n.fioriElementsPluginID){var e=document.getElementById(n.fioriElementsPluginID);if(e&&e.parentElement&&!e.parentElement.classList.contains("sapUiSupportHidden")){t.show("Data refreshed")}}}return e.extend("sap.suite.ui.generic.template.support.DiagnosticsTool.controller.DiagnosticsTool",{onInit:s,onRefreshData:l,onCopyDataPlain:c,onCopyDataHTML:u,onShowDocumentation:d,updateStatus:m,showDataRefreshed:f})});
//# sourceMappingURL=DiagnosticsTool.controller.js.map