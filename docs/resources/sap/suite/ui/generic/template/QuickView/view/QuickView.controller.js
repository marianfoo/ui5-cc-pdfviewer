sap.ui.define(["sap/ui/model/Context","../../js/QuickTemplates/QuickActionBaseController","../../js/QuickTemplates/AnnotationHelper","../../js/QuickTemplates/ODataModelHelper","sap/ui/model/json/JSONModel","sap/base/util/each"],function(e,t,i,r,a,o){"use strict";return t.extend("sap.suite.ui.generic.template.QuickView.view.QuickView",{onInit:function(){if(!this._bIsInitialized){t.prototype.onInit.apply(this);this.sEntityPath=decodeURIComponent(this.oComponent.getComponentData().startupParameters["entityPath"]);this.sEntityPath="/"+r.createKeyFromPath(this.sEntityPath,this.getView().getModel().getMetaModel(),this.sEntitySet);var e=new a({});e.setProperty("/badgeVisible",false);e.setProperty("/fallbackBadgeVisible",false);this._sBadgeModelName="badge";this.getView().setModel(e,this._sBadgeModelName)}},_onMetaModelLoaded:function(){var t=new e(this.getView().getModel(),this.sEntityPath);this.bindView(t);t.getModel().attachRequestCompleted(this._resolveBadgeModel,this)},bindView:function(e){var t=this._getFormatterInterface(e);var r=i.getNavigationPathsFromFacet(t,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name,"FieldGroup");var a=i.getNavigationPathsUsingAnnotationHeuristics(e,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name);var s={};o(r,function(e,t){s[t]=""});o(a,function(e,t){s[t]=""});var n=i.formatExpandPaths(Object.keys(s));this.oContext=e;this.getView().bindElement({path:e.getPath(),parameters:{expand:n}})},_resolveBadgeModel:function(){if(this._badgeResolved){this.oContext.getModel().detachRequestCompleted(this._resolveBadgeModel,this);return}var e=this.oContext;var t=this.oComponent.ContextualManagedObject;var i=this.getView().getModel(this._sBadgeModelName);if(t){var r=new t({serviceUrl:e.getModel().sServiceUrl?e.getModel().sServiceUrl:null,path:e.getPath(),entitytype:this.oEntitySetMeta.entityType,uiGroup:"Main Object",priority:"1"});r.setModel(e.getModel());r.setBindingContext(e);r.resolveAnnotations();i.setProperty("/imgUrlDefined",r.getProperty("imgUrl")!=undefined&&r.getProperty("imgUrl").indexOf("sap-icon")<0);i.setProperty("/imgUrl",r.getProperty("imgUrl"));i.setProperty("/typeImgUrlDefined",r.getProperty("typeImgUrl")!=undefined&&!i.getProperty("/imgUrlDefined"));i.setProperty("/typeImgUrl",r.getProperty("typeImgUrl"));if(!i.getProperty("/imgUrlDefined")&&!i.getProperty("/typeImgUrlDefined")){i.setProperty("/typeImgUrl","sap-icon://form");i.setProperty("/typeImgUrlDefined",true)}i.setProperty("/title",r.getProperty("title"));if(r.getProperty("typeName")){i.setProperty("/typeName",r.getProperty("typeName"))}else if(r.getProperty("titleMetadata")&&r.getProperty("titleMetadata")["sap:label"]){i.setProperty("/typeName",r.getProperty("titleMetadata")["sap:label"])}else{i.setProperty("/typeName","")}i.setProperty("/subtitle",r.getProperty("headline"));i.setProperty("/badgeVisible",true)}else{i.setProperty("/fallbackBadgeVisible",true)}this._badgeResolved=true}})},true);
//# sourceMappingURL=QuickView.controller.js.map