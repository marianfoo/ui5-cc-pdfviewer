sap.ui.define(["sap/base/util/extend","sap/base/util/deepExtend","sap/ui/model/odata/AnnotationHelper","sap/suite/ui/generic/template/js/StableIdHelper","sap/suite/ui/generic/template/js/staticChecksHelper","sap/suite/ui/generic/template/js/preparationHelper","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/suite/ui/generic/template/js/AnnotationHelper","sap/suite/ui/generic/template/ObjectPage/annotationHelpers/AnnotationHelperActionButtons","sap/suite/ui/generic/template/genericUtilities/FeError","sap/base/util/isEmptyObject","sap/suite/ui/generic/template/ObjectPage/annotationHelpers/AnnotationHelperSideContent"],function(t,e,a,n,i,o,r,c,s,l,d,u){"use strict";var b=new r("ObjectPage.templateSpecificPreparationHelper").getLogger();var f="ObjectPage.templateSpecificPreparationHelper";function p(r,p,g,m,v,y){function S(e,a){var n=t({},a);switch(e){case"com.sap.vocabularies.UI.v1.ReferenceFacet":if(!n["com.sap.vocabularies.UI.v1.PartOfPreview"]||n["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool!=="false"){n["com.sap.vocabularies.UI.v1.PartOfPreview"]={Bool:"true"}}break;default:break}return n}function I(t){if(!t.getObject().Target){return undefined}var e=a.resolvePath(p.getContext(t.sPath+"/Target"));return e&&p.getContext(e).getObject()}function P(e){e.subSections=e.subSections||[];if(e.subSections.find(function(t){return e.additionalData.facetId===t.additionalData.facetId})){return}var a=t({},e);delete a.subSections;a.blocks=[];e.subSections.push(a)}var h=0;function D(a,i,o,r){var c=[];var s=["sections","subSections","blocks"];o=o||0;var l=p.getObject(a);if(!Array.isArray(l)){return[]}l.forEach(function(l,d){var u={additionalData:{facetId:n.getStableId({type:"ObjectPage",subType:"Facet",sRecordType:l.RecordType,bIsHeaderFacet:i,sAnnotationPath:l.Target&&l.Target.AnnotationPath,sAnnotationId:l.ID&&l.ID.String})},temporaryData:{},annotations:{Facet:{annotation:e({},l)}},metaModelPath:a+"/"+d};u.facetIdAsObject={id:u.additionalData.facetId};u.fallbackIdByEnumerationForRuntime=u.additionalData.facetId||"missingStableId#"+h++;if(l.RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"){var f=D(a+"/"+d+"/Facets",i,o+1,u);if(o===0&&!u.subSections&&f.length===0){P(u)}else{var g=s[o+1]||"unsupportedNestingLevel";u[g]=u[g]||[];u[g]=u[g].concat(f)}}else if(l.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){u.fallbackIdByAnnotationPathForManifest=n.getStableId({type:"ObjectPage",subType:"Facet",sRecordType:l.RecordType,bIsHeaderFacet:i,sAnnotationPath:l.Target&&l.Target.AnnotationPath});u.annotations.Facet.annotation=S("com.sap.vocabularies.UI.v1.ReferenceFacet",l);var m=t({},u);m.targetAnnotation=I(p.getContext(a+"/"+d));var v;switch(o){case 0:if(l.Target&&!l.Target.AnnotationPath){return}v=t({},u);v.blocks=[m];u.subSections=[v];break;case 1:P(r);v=r.subSections.find(function(t){return t.additionalData.facetId===r.additionalData.facetId});v.blocks.push(m);return;case 2:u.targetAnnotation=m.targetAnnotation;r.temporaryData.potentiallySeparateForms=true;break;default:b.warning("UnSupported Nesting of Collectionfacets");break}}else{b.warning("UnSupported Facet annotation record type: "+l.RecordType);return}c.push(u)});return c}var A={};function F(t,e){if(!A[t.entityType]){A[t.entityType]=o.getTargetEntityForQuickView(p,t)}}F(p.getODataEntitySet(v));function E(t){switch(t&&t.variantManagement){case undefined:return"New";case true:return"Retain";case false:return"Remove";default:break}}function T(t){function e(){var e=n.getStableId({type:"ObjectPageAction",subType:"Delete",sFacet:t.additionalData.facetId});return{Create:{id:n.getStableId({type:"ObjectPageAction",subType:"Create",sFacet:t.additionalData.facetId}),text:"{i18n>CREATE_OBJECT}",press:"cmd:TableEntryAdd",action:"TableEntryAdd",callbackName:"._templateEventHandlers.addEntry('"+t.additionalData.facetId+"')",isStandardAction:true,enabled:true},Delete:{id:e,text:"{i18n>DELETE}",press:"cmd:TableEntryDelete",ariaHasPopup:sap.ui.core.aria.HasPopup.Dialog,action:"TableEntryDelete",callbackName:"._templateEventHandlers.deleteEntries('"+t.additionalData.facetId+"')",isStandardAction:true,enabled:"{_templPriv>/generic/controlProperties/"+e+"/enabled"+"}"}}}t.multiSelect=t.multiSelect||t.allTableMultiSelect;var c=a.gotoEntitySet(p.getContext(t.metaModelPath+"/Target"));var s=c&&p.getObject(c).name||v;var l=r.getControllerExtensions();var d=l&&l.Sections&&l.Sections[t.additionalData.facetId]&&l.Sections[t.additionalData.facetId].Actions;var u=function(){return t.additionalData.facetId+"::Table::Toolbar::SearchField"};var b=o.getNormalizedTableSettings(p,t,m,s,d,t.targetAnnotation,u);b.variantManagement=!(t.tableSettings&&t.tableSettings.variantManagement)||t.tableSettings.variantManagement;b.selectAll=t.tableSettings&&t.tableSettings.selectAll===false?false:true;if(b.onlyForDelete){b.mode=r.isDraftEnabled()?"{= ${ui>/editable} ? '"+b.mode+"' : 'None'}":"{= ${ui>/editable} ? 'None' : '"+b.mode+"'}"}var f=p.getODataEntitySet(s);if(b&&b.createWithParameterDialog&&b.createWithParameterDialog.fields){i.checkErrorforCreateWithDialog(p.getODataEntityType(f.entityType),b);b.createWithParameterDialog.id=n.getStableId({type:"ObjectPageAction",subType:"CreateWithDialog",sFacet:t.additionalData.facetId})}F(f);var g=x(t,f,b.type);var y=O(f);b.bExportToExcel=!r.isDraftEnabled()&&!t.sections?true:g;if(y){b.vShowPasteButton=g?"{= ${ui>/editable} && ${"+y+"}}":false}else{b.vShowPasteButton=g?"{ui>/editable}":false}b.commandExecution=e();b.persistencyKeyState=E(t.tableSettings);return b}function O(t){var e=p.getODataEntitySet(v);var a,n;var i=c.handleNavigationRestrictions(p,e,t,"Insertable");if(i){a=i["Insertable"]}else{n=t["Org.OData.Capabilities.V1.InsertRestrictions"];a=n&&n["Insertable"]}if(a&&a.Path){return a.Path}return false}function x(t,e,a){if(!r.isDraftEnabled()||["inline","creationRows"].indexOf(t.createMode)===-1){return false}var n,i,o;var s=p.getODataEntityType(e.entityType)&&p.getODataEntityType(e.entityType)["sap:semantics"];if(a==="TreeTable"||a==="AnalyticalTable"&&s==="aggregate"){return false}var l=p.getODataEntitySet(v);var d=c.handleNavigationRestrictions(p,l,e,"Insertable");if(d){n=d["Insertable"];i=l.entityType}else{o=e["Org.OData.Capabilities.V1.InsertRestrictions"];n=o&&o["Insertable"];i=e.entityType}if(!n){return true}var u=n.Bool?!n.Path:!!(n.Path&&c._isPropertyPathBoolean(p,i,n.Path));if(!u){b.error("Service Broken: Restrictions annotations for entity type "+e.entityType+" for section Insertable are invalid.")}if(n.Bool==="false"){return false}return u}function k(t){return{variantManagement:!(t.chartSettings&&t.chartSettings.variantManagement)||t.chartSettings.variantManagement,chartTitle:t.targetAnnotation&&t.targetAnnotation.Title,persistencyKeyState:E(t.chartSettings)}}function j(t){return t.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||t.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"}function H(t){return!t.apply(this,Array.prototype.slice.apply(arguments,[1]))}function w(n){var i=g.sections&&t({},g.sections[n.additionalData.facetId],g.sections[n.fallbackIdByAnnotationPathForManifest]);t(n,i,n);if(n.targetAnnotation||(n.additionalData.type==="SmartTable"||n.additionalData.type==="SmartChart")&&a.isMultiple(p.getContext(n.metaModelPath+"/Target"))){var o=e({},g,n);switch(n.additionalData.type){case"SmartTable":n.tableSettings=T(o);break;case"SmartChart":n.chartSettings=k(o);break;case"SmartForm":n.temporaryData.content=Array.isArray(n.targetAnnotation)?n.targetAnnotation.filter(H.bind(null,j)):n.targetAnnotation.Data;break;default:break}}}function N(t,e){if(e.blocks.length===1&&e.blocks[0].targetAnnotation){var a=e.blocks[0];var n=t.annotations.Facet.annotation.Label&&t.annotations.Facet.annotation.Label.String;var i=a.annotations.Facet.annotation.Target.AnnotationPath.split("@")[1].split("#")[0];var o=e.annotations.Facet.annotation.Label&&e.annotations.Facet.annotation.Label.String;var r;switch(i){case"com.sap.vocabularies.UI.v1.LineItem":r=o!==(a.tableSettings.headerInfo&&a.tableSettings.headerInfo.TypeNamePlural&&a.tableSettings.headerInfo.TypeNamePlural.String);if(!r){t.bShowTitle=n!==(a.tableSettings.headerInfo&&a.tableSettings.headerInfo.TypeNamePlural&&a.tableSettings.headerInfo.TypeNamePlural.String);a.tableSettings.bHeadingLevel=t.bShowTitle?"H4":"H3"}else{e.bHeadingLevel=r?"H4":"Auto";a.tableSettings.bHeadingLevel=r?"H5":"H4"}return r;case"com.sap.vocabularies.UI.v1.Chart":r=o!==(a.chartSettings.chartTitle&&a.chartSettings.chartTitle.String);if(!r){t.bShowTitle=n!==(a.chartSettings.chartTitle&&a.chartSettings.chartTitle.String);a.chartSettings.bHeadingLevel=t.bShowTitle?"H4":"H3"}else{e.bHeadingLevel=r?"H4":"Auto";a.chartSettings.bHeadingLevel=r?"H5":"H4"}return r;default:e.bHeadingLevel="H4";return true}}e.bHeadingLevel="H4";t.bShowTitle=true;return true}function C(e,a){var i={BeforeFacet:{withKey:{section:{type:"ObjectPageSection",subType:"BeforeFacetExtensionSectionWithKey"},subSection:{type:"ObjectPageSection",subType:"BeforeFacetExtensionSubSectionWithKey"}},withoutKey:{section:{type:"ObjectPageSection",subType:"BeforeFacetExtensionSection"},subSection:{type:"ObjectPageSection",subType:"BeforeFacetExtensionSubSection"}}},AfterFacet:{withKey:{section:{type:"ObjectPageSection",subType:"AfterFacetExtensionSectionWithKey"},subSection:{type:"ObjectPageSection",subType:"AfterFacetExtensionSubSectionWithKey"}},withoutKey:{section:{type:"ObjectPageSection",subType:"AfterFacetExtensionSection"},subSection:{type:"ObjectPageSection",subType:"AfterFacetExtensionSubSection"}}}};var o=i[e][a.sKey?"withKey":"withoutKey"];var r=t({},o.section);r.sEntitySet=a.sEntitySet;r.sFacet=a.sFacetId;r.sFacetExtensionKey=a.oExtensionDefinition.key||a.sKey;var c=n.getStableId(r);r.type=o.subSection.type;r.subType=o.subSection.subType;var s=n.getStableId(r);return{id:c,additionalData:{facetId:a.sFacetId},extensionPointName:a.sExtensionPointName,extensionPointNamePrefix:a.sExtensionPointNamePrefix,subSections:[{id:s,additionalData:{facetId:a.sFacetId},temporaryData:{},extensionPointName:a.sExtensionPointName,extensionPointNamePrefix:a.sExtensionPointNamePrefix,blocks:[]}]}}var B;function U(){if(!B){var t=r.getViewExtensions()||{};B=Object.keys(t).map(function(e){var a=e.split("|");return{sExtensionPointNamePrefix:a[0],sEntitySet:a[1],sFacetId:a[2],sKey:a[3],oExtensionDefinition:t[e],sExtensionPointName:e}}).filter(function(t){return t.sEntitySet===v})}return B}function R(t,e){var a=r.getControllerExtensions();if(e==="Section"){return a&&a.Sections&&a.Sections[t]&&a.Sections[t].Actions}if(e==="Header"){return a&&a.Header&&a.Header.Actions||[]}}function L(t){var e=U();var a=[];t.forEach(function(t){var n=e.filter(function(e){return e.sFacetId===t.additionalData.facetId&&e.sExtensionPointNamePrefix==="BeforeFacet"});var i=e.filter(function(e){return e.sFacetId===t.additionalData.facetId&&e.sExtensionPointNamePrefix==="AfterFacet"});a=a.concat(n.map(C.bind(null,"BeforeFacet")));a.push(t);a=a.concat(i.map(C.bind(null,"AfterFacet")))});return a}function M(t){var e=U();var a=e.find(function(e){return e.sFacetId===t.additionalData.facetId&&e.sExtensionPointNamePrefix==="SmartFormExtension"});if(a){t.extensionPointName=a.sExtensionPointName;t.extensionPointNamePrefix="SmartFormExtension";t.additionalData.type=t.additionalData.type||"SmartForm"}}function K(t){var e=t.annotations.Facet.annotation.Target&&t.annotations.Facet.annotation.Target.AnnotationPath&&t.annotations.Facet.annotation.Target.AnnotationPath.split("@")[1];e=e&&e.split("#")[0];switch(e){case"com.sap.vocabularies.UI.v1.FieldGroup":case"com.sap.vocabularies.UI.v1.Identification":t.additionalData.type="SmartForm";break;case"com.sap.vocabularies.UI.v1.LineItem":t.additionalData.type="SmartTable";break;case"com.sap.vocabularies.UI.v1.Chart":t.additionalData.type="SmartChart";break;case"com.sap.vocabularies.Communication.v1.Address":t.additionalData.type="Address";break;case"com.sap.vocabularies.Communication.v1.Contact":t.additionalData.type="Contact";break;default:}w(t);M(t)}function V(t){if(t.annotations.Facet.annotation.RecordType!=="com.sap.vocabularies.UI.v1.ReferenceFacet"){return false}switch(t.additionalData.type){case"SmartForm":if(t.extensionPointName){return true}if(!t.targetAnnotation||!t.temporaryData.content){return false}return t.temporaryData.content.find(function(t){return t.RecordType!=="com.sap.vocabularies.UI.v1.DataFieldForAction"&&t.RecordType!=="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"});case"SmartTable":return t.tableSettings;case"SmartChart":return t.chartSettings;default:return t.targetAnnotation}}function _(t){return t.additionalData.type==="SmartForm"}function W(t,a){if(!t){throw new l(f,"Identified an invalid value of 'logicalAction' i.e., '"+a.logicalAction+"' for a custom action in the manifest.")}return e({},t,{id:a.id&&n.getStableId({type:"ObjectPageAction",subType:"CommonAction",sAction:a.id}),text:a.text,enabled:a.applicablePath&&c.getBreakoutActionEnabledKey(a),importance:a.importance,callbackName:a.press,isStandardAction:false,ariaHasPopup:sap.ui.core.aria.HasPopup.None})}function z(t,e,n,i,o){var c={};var s="._templateEventHandlers.";var l=a.format(p.getContext(e+n+"/Action"));switch(t.RecordType){case"com.sap.vocabularies.UI.v1.DataFieldForAction":var d=[];d.push("'"+l+"'");d.push("'"+o+"'");var u=t.InvocationGrouping&&t.InvocationGrouping.EnumMember||"";d.push("'"+u+"'");s+="onCallAction("+d.join(", ")+")";c.sPressHandler=s;var b=i.annotatedActions&&i.annotatedActions[l.split("/")[1]];if(b){c.sDataFieldCommand=b.command}break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":s+="onDataFieldForIntentBasedNavigation";c.sPressHandler=s;c.oIntent={semanticObject:a.format(p.getContext(e+n+"/SemanticObject")),action:l};var f=Object.keys(i.outbounds||{}).find(function(e){var a=r.getOutboundNavigationIntent(y,e);return a.semanticObject===t.SemanticObject.String&&a.action===t.Action.String});if(f){c.sDataFieldCommand=i.outbounds[f].command}break;default:break}return c}function $(t,e){var a=[],n;(t.targetAnnotation||[]).forEach(function(i){switch(i.RecordType){case"com.sap.vocabularies.UI.v1.DataFieldForAction":n=r.getToolbarDataFieldForActionCommandDetails(i,e,undefined,p.getObject(t.metaModelPath));if(!d(n)){a.push(n)}break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":n=r.getToolbarDataFieldForIBNCommandDetails(i,e,y,undefined,p.getObject(t.metaModelPath));if(!d(n)){a.push(n)}break;default:break}});return a}function G(t,e){w(e);e.blocks.forEach(K);var i=u.getSideContentExtensionPoint(v,e.additionalData.facetId,r.getViewExtensions());if(i){e.sideContentSettings={id:n.getStableId({type:"ObjectPageSection",subType:"DynamicSideContent",sFacet:e.additionalData.facetId})}}e.actions=[];var o=r.getSettings();e.blocks.forEach(function(t){if(t.additionalData.type==="SmartForm"){var i=R(t.additionalData.facetId,"Section");Object.values(i||{}).forEach(function(t){var a={id:n.getStableId({type:"ObjectPageAction",subType:"CommonAction",sAction:t.id}),text:t.text,press:t.press};if(t.command){a.command=t.command}e.actions.push(a)})}if(t.additionalData.type==="SmartTable"&&t.tableSettings){var r=R(t.additionalData.facetId,"Section");if(r){t.tableSettings.extensionActions=[];Object.values(r).forEach(function(e){if(e.logicalAction){t.tableSettings.commandExecution[e.logicalAction]=W(t.tableSettings.commandExecution[e.logicalAction],e)}else{e.enabled=c.getBreakoutActionEnabledKey(e);t.tableSettings.extensionActions.push(e);if(e.command){t.tableSettings.commandExecution[e.id]={id:e.id,action:e.command,callbackName:e.press};e.press="cmd:"+e.command}}})}var s=$(t,o);s.forEach(function(e){t.tableSettings.commandExecution[e.id]=e})}if(!t.targetAnnotation||!t.temporaryData.content){return}var l=a.resolvePath(p.getContext(t.metaModelPath+"/Target"));var d=l+(t.targetAnnotation.Data?"/Data/":"/");t.temporaryData.content.forEach(function(a,i){if(!a||!a.Action||a.RecordType!=="com.sap.vocabularies.UI.v1.DataFieldForAction"&&a.RecordType!=="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){return}var r=n.getStableId({type:"ObjectPage",subType:"DataField",sRecordType:a.RecordType,sSemanticObject:a.SemanticObject&&(a.SemanticObject.String||a.SemanticObject.Path),sAction:a.Action&&(a.Action.String||a.Action.Path)});var c=n.getStableId({type:"ObjectPageAction",subType:"AnnotatedAction",sFacet:t.additionalData.facetId,sDataField:r});var s=z(a,d,i,o,c);e.actions.push({id:c,press:s.sPressHandler,semanticObject:s.oIntent&&s.oIntent.semanticObject,action:s.oIntent&&s.oIntent.action,metaModelPath:d+i,command:s.sDataFieldCommand,actionPress:s.sDataFieldCommand?"cmd:"+s.sDataFieldCommand:s.sPressHandler})})});e.blocks=e.blocks.filter(V);if(e.temporaryData.potentiallySeparateForms&&!e.blocks.every(_)){e.blocks=e.blocks.map(function(t){if(_(t)){return{additionalData:{type:t.additionalData.type,facetId:t.additionalData.facetId},metaModelPath:t.metaModelPath,controlProperties:{id:n.getStableId({type:"ObjectPageSection",subType:"SmartForm",sFacet:t.additionalData.facetId,sIsPartOfPreview:t.annotations.Facet.annotation["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool})},aggregations:{groups:[t]}}}else{return t}});e.moreBlocks=e.blocks.filter(function(t){if(t.additionalData.type==="SmartForm"){return t.aggregations.groups[0].annotations.Facet.annotation["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="false"}else{return t.annotations.Facet.annotation["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="false"}});e.blocks=e.blocks.filter(function(t){if(t.additionalData.type==="SmartForm"){return t.aggregations.groups[0].annotations.Facet.annotation["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="true"}else{return t.annotations.Facet.annotation["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="true"}})}else{var s={additionalData:{type:"SmartForm",facetId:e.additionalData.facetId},controlProperties:{id:n.getStableId({type:"ObjectPageSection",subType:"SmartForm",sFacet:e.additionalData.facetId,sIsPartOfPreview:"true"})},aggregations:{groups:e.blocks.filter(function(t){return _(t)&&t.annotations.Facet.annotation["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="true"})}};var l={additionalData:{type:"SmartForm",facetId:e.additionalData.facetId},controlProperties:{id:n.getStableId({type:"ObjectPageSection",subType:"SmartForm",sFacet:e.additionalData.facetId,sIsPartOfPreview:"false"})},aggregations:{groups:e.blocks.filter(function(t){return _(t)&&t.annotations.Facet.annotation["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="false"})}};e.moreBlocks=e.blocks.filter(function(t){return!_(t)&&t.annotations.Facet.annotation["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="false"});e.blocks=e.blocks.filter(function(t){return!_(t)&&t.annotations.Facet.annotation["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="true"});if(s.aggregations.groups.length>0){e.blocks.unshift(s)}if(l.aggregations.groups.length>0){e.moreBlocks.unshift(l)}}e.bShowTitle=N(t,e);e.additionalData.useViewLazyLoading=r.isRenderingWaitingForViewportEntered();q(t,e)}function q(t,e){if(!e.isEmbeddedSubSection){if(!e.annotations){var a=U();var n=a.find(function(t){return t.sFacetId===e.additionalData.facetId});if(n){var i=n.oExtensionDefinition&&n.oExtensionDefinition["sap.ui.generic.app"];if(i&&i.enableLazyLoading){e.loadingStrategy="lazyLoadingAfterHeader"}return}}if(t){if(t.loadingBehavior){var o=t.loadingBehavior;if(o.waitForViewportEnter){e.loadingStrategy=o.waitForHeaderData?"lazyLoadingAfterHeader":"lazyLoading";return}e.loadingStrategy=o.waitForHeaderData?"activateAfterHeaderDataReceived":"activateWithBindingChange";return}}e.loadingStrategy="lazyLoading"}}function J(){return true}function Q(t){w(t);t.subSections.forEach(G.bind(null,t));t.subSections=t.subSections.filter(J)}function X(){return true}function Y(){var t=p.getMetaContext("/"+v).getPath();var e=D(t+"/com.sap.vocabularies.UI.v1.Facets",false);var a=L(e);a.forEach(Q);return a.filter(X)}function Z(){var t=[];var e;var a=p.getODataEntitySet(v);var n=p.getODataEntityType(a.entityType);var i=Object.keys(n);var o=i.filter(function(t){return t.includes("com.sap.vocabularies.UI.v1.FieldGroup")||t.includes("com.sap.vocabularies.UI.v1.Identification")});for(var r=0;r<o.length;r++){var c=n[o[r]].Data||n[o[r]];for(var s=0;s<c.length;s++){e=c[s];if(et(n,e)){t.push(tt(e,n))}}}return t}function tt(t,e){if(t.Value&&t.Value.Path){var a=t.Value.Path;var n;if(a.indexOf("/")>-1){var i=a.split("/")[0];n=p.getODataAssociationEnd(e,i);e=p.getODataEntityType(n&&n.type)||e;return i}return}}function et(t,e){if(e.Value&&e.Value.Path){var a=e.Value.Path;var n;if(a.endsWith("$value")){var i=a.split("/");var o=i.length;if(o>1){for(var r=0;r<o-1;r++){var c=i[r];var n=p.getODataAssociationEnd(t,c);t=p.getODataEntityType(n&&n.type)}return t&&t.hasStream==="true"}}}return false}function at(){function t(t){var e=c.buildEmphasizedButtonExpression(t["com.sap.vocabularies.UI.v1.Identification"]);return{Delete:{action:"Delete",callbackName:"._templateEventHandlers.onDelete",id:n.getStableId({type:"ObjectPageAction",subType:"CommonAction",sAction:"delete"}),text:"{i18n>DELETE}",press:"cmd:Delete",ariaHasPopup:sap.ui.core.aria.HasPopup.Dialog,isStandardAction:true,determining:false},Edit:{action:"Edit",callbackName:"._templateEventHandlers.onEdit",id:n.getStableId({type:"ObjectPageAction",subType:"CommonAction",sAction:"edit"}),text:"{i18n>EDIT}",type:e,press:"cmd:Edit",isStandardAction:true,determining:false},Share:{action:"Share",callbackName:"._templateEventHandlers.onShareObjectPageActionButtonPress",isStandardAction:true,overrideForbidden:true,determining:false},NavigateForward:{action:"NavigateForward",callbackName:"._templateEventHandlers.onSwitchTabs(true)",isStandardAction:true,overrideForbidden:true,determining:false},NavigateBackward:{action:"NavigateBackward",callbackName:"._templateEventHandlers.onSwitchTabs(false)",isStandardAction:true,overrideForbidden:true,determining:false},Save:{action:"Save",callbackName:"._templateEventHandlers.onSave",id:n.getStableId({type:"ObjectPageAction",subType:"CommonAction",sAction:r.isDraftEnabled()?"activate":"save"}),text:"{= ${ui>/createMode} ? ${i18n>CREATE} : ${i18n>SAVE}}",type:e,press:"cmd:Save",visible:"{ui>/editable}",isStandardAction:true,determining:true}}}function a(t,a){if(!t||t.overrideForbidden){throw new l(f,"Identified an invalid value of 'logicalAction' i.e., '"+a.logicalAction+"' for a custom action in the manifest.")}return e({},t,{id:a.id&&n.getStableId({type:"ObjectPageAction",subType:a.logicalAction==="Save"?"CommonAction":"HeaderExtensionAction",sAction:a.id}),text:a.text,visible:a.applicablePath&&s.getActionControlBreakoutVisibility(a.applicablePath),importance:a.importance,callbackName:a.press,isStandardAction:false,ariaHasPopup:sap.ui.core.aria.HasPopup.None,type:sap.m.ButtonType.Default})}function i(t){var e=Object.create(null);var a=t.Action.String.split("/")[1];if(h.annotatedActions&&h.annotatedActions[a]){var n;if(!t.Determining||t.Determining.Bool==="false"){n="action::"+c.getStableIdPartFromDataField(t);e.callbackName=s.getCallAction(t,n)}else{n=c.getStableIdPartForDatafieldActionButton(t)+"::Determining";e.callbackName="._templateEventHandlers.onDeterminingDataFieldForAction"}e.id=n;e.action=h.annotatedActions[a].command;e.annotatedAction=true}return e}function o(t){if(t.Determining&&t.Determining.Bool==="true"){var e=Object.keys(h.outbounds||{}).find(function(e){var a=r.getOutboundNavigationIntent(y,e);return a.semanticObject===t.SemanticObject.String&&a.action===t.Action.String});if(e){return{id:c.getStableIdPartForDatafieldActionButton(t)+"::Determining",action:h.outbounds[e].command,callbackName:"._templateEventHandlers.onDeterminingDataFieldForIntentBasedNavigation",outboundAction:true}}}return Object.create(null)}var u=t(p.getODataEntityType(p.getODataEntitySet(v).entityType));var b=r.getControllerExtensions();var g=[],m=Object.create(null),S=Object.create(null),I=Object.create(null);Object.values(b&&b.Header&&b.Header.Actions||{}).forEach(function(t){if(t.logicalAction){u[t.logicalAction]=a(u[t.logicalAction],t)}else{t.id=n.getStableId({type:"ObjectPageAction",subType:t.determining?"CommonAction":"HeaderExtensionAction",sAction:t.id});g.push(t);if(t.command){m[t.id]={id:t.id,action:t.command,callbackName:t.press};t.press="cmd:"+t.command}}});var P=p.getODataEntityType(p.getODataEntitySet(v).entityType);var h=r.getSettings();(P["com.sap.vocabularies.UI.v1.Identification"]||[]).forEach(function(t){switch(t.RecordType){case"com.sap.vocabularies.UI.v1.DataFieldForAction":var e=i(t);if(!d(e)){S[e.id]=e}break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":var e=o(t);if(!d(e)){I[e.id]=e}break;default:break}});return{commandExecution:e(u,m,S,I),extensionActions:g}}return{streamEnabledAssociatedEntites:Z(),sections:Y(),breadCrumb:r.getBreadCrumbInfo(),isSelflinkRequired:true,isIndicatorRequired:true,isSemanticallyConnected:false,targetEntities:A,pageLevelActions:at()}}return{getTemplateSpecificParameters:p}});
//# sourceMappingURL=templateSpecificPreparationHelper.js.map