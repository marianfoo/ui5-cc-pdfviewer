sap.ui.define(["sap/ui/base/Object","sap/base/util/extend","sap/ui/model/Sorter","sap/ui/core/MessageType","sap/suite/ui/generic/template/lib/MessageUtils","sap/suite/ui/generic/template/genericUtilities/controlHelper"],function(r,e,t,n,o,a){"use strict";function i(r,e,i){var u=true;var s;var l;function g(){s=Object.create(null);l=Object.create(null)}function c(t,n){var i=s[t];if(i){n.some(function(r,e){if(r!==i.controlIds[e]){i=null;return true}return r===i.controlId})}if(!i){i={};var l=Object.create(null);var g=function(r,e,t){if(t){l[t.getId()]=e}};i.controlId=e.oCommonUtils.getPositionableControlId(n,true,g);var c=[];var v,f;for(var d=i.controlId;d;){c.push(d);var p=l[d];v=v||p&&a.isObjectPageSection(p)&&p;f=f||p&&a.isSmartTable(p)&&p;d=p&&p.getId()}c.reverse();i.pathToControlId=c;if(i.controlId){var h=r.byId(i.controlId);if(!v){f=null;v=a.isObjectPageSection(h)&&h}else{f=f||a.isSmartTable(h)&&h}}i.groupers=v?[v]:[];if(f){var I=e.oCommonUtils.getOwnerPresentationControl(f);var m=e.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(I);var C=e.oComponentUtils.getBindingPath();var b=m.getBindingPath();var P=C+"/"+b;i.groupers.push(f);i.getItemBindingPath=u?Function.prototype:function(){var r=o.getMessageById(t);if(!r){return null}var e=r.aFullTargets.find(function(r){return r.startsWith(P)});if(!e){return null}var n=e.substring(P.length);var a=n.split("/")[0];return P+a}}else{i.getItemBindingPath=Function.prototype}i.controlIds=n;s[t]=i}return i}function v(r){var e=r.getId();var t=l[e];if(!t){t=f(r);l[e]=t}return t}function f(r){var t={};var n=e.oCommonUtils.getOwnerPresentationControl(r);var o=e.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(n);var a=o.getCurrentContexts()||[];a.forEach(function(r,e){var n=r&&r.getMessages()||[];n.forEach(function(n){t[n.id]={context:r,index:e}})});return t}function d(r,t){if(!s){return""}var n=t&&c(r,t);var o=n?n.groupers:[];switch(o.length){case 0:return e.oCommonUtils.getText("GENERIC_MESSAGE_GROUP_NAME");case 1:return o[0].getTitle();default:var a=o[0].getTitle();var i=o[1];var u=i.getHeader();return e.oCommonUtils.getText("MESSAGE_GROUP_TABLE",[a,u])}}var p=new t("");function h(r){switch(r){case n.Error:return 1;case n.Warning:return 2;case n.Success:return 3;case n.Information:return 4;case n.None:return 5;default:return 6}}function I(r,e,t){if(!e){return t?1:0}if(!t){return-1}return a.sortChildControls(r,e,t)}p.fnCompare=function(r,e){var t=c(r.id,r.controlIds);var n=c(e.id,e.controlIds);var o=t.groupers.length===n.groupers.length&&t.groupers.every(function(r,e){return n.groupers[e]===r});if(o){var a=t.getItemBindingPath();var u=n.getItemBindingPath();if(a!==u){var s=t.groupers[1];var l=v(s);var g=l[r.id];var f=l[e.id];if(g&&f){return g.index-f.index}if(g||f){return 1-2*!f}return(""+a).localeCompare(""+u)}var d=h(r.type)-h(e.type);if(d||!(t.controlId||n.controlId)){return d}}if(!o&&(t.groupers.length===1||n.groupers.length===1)&&t.groupers[0]===n.groupers[0]){return t.groupers.length-n.groupers.length}var p=t.pathToControlId;var m=n.pathToControlId;var C=Math.max(p.length,m.length);var b=sap.ui.getCore();for(var P=0;P<C;P++){if(p[P]!==m[P]){if(P===0){return I(i,t.groupers[0],n.groupers[0])}return I(b.byId(p[P-1]),P<p.length&&b.byId(p[P]),P<m.length&&b.byId(m[P]))}}return 0};function m(){return p}function C(r,e,t,n){var o=c(r,e);var a=o.groupers[1];if(!a){return t}return t}return{beforeRebind:g,getMessageSorter:m,getGroupTitle:d,getSubtitle:C}}return r.extend("sap.suite.ui.generic.template.ObjectPage.controller.MessageSortingHandler",{constructor:function(r,t,n){e(this,i(r,t,n))}})});
//# sourceMappingURL=MessageSortingHandler.js.map