/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery","./library","sap/m/library","sap/ui/base/ManagedObject","sap/ui/core/Control","sap/ui/core/delegate/ItemNavigation","sap/m/ScrollContainer","sap/m/Button","sap/ui/core/delegate/ScrollEnablement","sap/ui/Device","sap/ui/core/ResizeHandler","./HeaderContainerRenderer"],function(jQuery,t,e,i,r,o,s,n,a,l,c,h){"use strict";var g=r.extend("sap.suite.ui.commons.HeaderContainer",{metadata:{deprecated:true,interfaces:["sap.m.ObjectHeaderContainer"],library:"sap.suite.ui.commons",properties:{scrollStep:{type:"int",group:"Misc",defaultValue:300},scrollTime:{type:"int",group:"Misc",defaultValue:500},showDividers:{type:"boolean",group:"Misc",defaultValue:true},view:{type:"sap.suite.ui.commons.HeaderContainerView",group:"Misc",defaultValue:"Horizontal"},backgroundDesign:{type:"sap.m.BackgroundDesign",group:"Misc",defaultValue:"Transparent"}},aggregations:{scrollContainer:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},items:{type:"sap.ui.core.Control",multiple:true,singularName:"item"},buttonPrev:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},buttonNext:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}}}});g.prototype.init=function(){this._iSelectedCell=0;this._bRtl=sap.ui.getCore().getConfiguration().getRTL();this._rb=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");this._oScrollCntr=new s(this.getId()+"-scrl-cntnr",{width:"100%",horizontal:!l.system.desktop,height:"100%"});this.setAggregation("scrollContainer",this._oScrollCntr);if(l.system.desktop){this._oArrowPrev=new n({id:this.getId()+"-scrl-prev-button",tooltip:this._rb.getText("HEADERCONTAINER_BUTTON_PREV_SECTION"),press:function(t){t.cancelBubble();this._scroll(-this.getScrollStep(),this.getScrollTime())}.bind(this)}).addStyleClass("sapSuiteHdrCntrBtn").addStyleClass("sapSuiteHdrCntrLeft");this.setAggregation("buttonPrev",this._oArrowPrev);this._oArrowNext=new n({id:this.getId()+"-scrl-next-button",tooltip:this._rb.getText("HEADERCONTAINER_BUTTON_NEXT_SECTION"),press:function(t){t.cancelBubble();this._scroll(this.getScrollStep(),this.getScrollTime())}.bind(this)}).addStyleClass("sapSuiteHdrCntrBtn").addStyleClass("sapSuiteHdrCntrRight");this.setAggregation("buttonNext",this._oArrowNext);this._oScrollCntr.addDelegate({onAfterRendering:function(){if(l.system.desktop){var t=this.getId()+"-scrl-cntnr-scroll"?window.document.getElementById(this.getId()+"-scrl-cntnr-scroll"):null;var e=jQuery(document.getElementById(this.getId()+"-scrl-cntnr-scroll"));var i=e.find(".sapSuiteHrdrCntrInner").attr("tabindex","0");if(!this._oItemNavigation){this._oItemNavigation=new o;this.addDelegate(this._oItemNavigation);this._oItemNavigation.attachEvent(o.Events.BorderReached,this._handleBorderReached,this);this._oItemNavigation.attachEvent(o.Events.AfterFocus,this._handleBorderReached,this)}this._oItemNavigation.setRootDomRef(t);this._oItemNavigation.setItemDomRefs(i);this._oItemNavigation.setTabIndex0();this._oItemNavigation.setCycling(false)}}.bind(this),onBeforeRendering:function(){if(l.system.desktop){this._oScrollCntr._oScroller=new a(this._oScrollCntr,this._oScrollCntr.getId()+"-scroll",{horizontal:true,vertical:true,zynga:false,preventDefault:false,nonTouchScrolling:true})}}.bind(this)})}};g.prototype._scroll=function(t,e){this.bScrollInProcess=true;setTimeout(function(){this.bScrollInProcess=false}.bind(this),e+300);if(this.getView()==="Horizontal"){this._hScroll(t,e)}else{this._vScroll(t,e)}};g.prototype._vScroll=function(t,e){var i=this.getId()+"-scrl-cntnr"?window.document.getElementById(this.getId()+"-scrl-cntnr"):null;var r=i.scrollTop;var o=r+t;this._oScrollCntr.scrollTo(0,o,e)};g.prototype._hScroll=function(t,e){var i=this.getId()+"-scrl-cntnr"?window.document.getElementById(this.getId()+"-scrl-cntnr"):null;var r;if(!this._bRtl){var o=i.scrollLeft;r=o+t;this._oScrollCntr.scrollTo(r,0,e)}else{r=jQuery(i).scrollRightRTL()+t;this._oScrollCntr.scrollTo(r>0?r:0,0,e)}};g.prototype._checkOverflow=function(){if(this.getView()==="Horizontal"){this._checkHOverflow()}else{this._checkVOverflow()}};g.prototype._checkVOverflow=function(){var t=this._oScrollCntr.getDomRef();var e=false;if(t){if(t.scrollHeight>t.clientHeight){e=true}}this._lastVScrolling=e;if(t){var i=t.scrollTop;var r=false;var o=false;var s=t.scrollHeight;var n=t.clientHeight;if(Math.abs(s-n)===1){s=n}if(i>0){r=true}if(s>n&&i+n<s){o=true}if(!r){this._oArrowPrev.$().hide()}else{this._oArrowPrev.$().show()}if(!o){this._oArrowNext.$().hide()}else{this._oArrowNext.$().show()}}};g.prototype._checkHOverflow=function(){var t=this._oScrollCntr.getDomRef();var e=this.$("scroll-area");var i=false;if(t){if(t.scrollWidth-5>t.clientWidth){i=true}}this._lastScrolling=i;if(t){var r=t.scrollLeft;var o=false;var s=false;var n=t.scrollWidth;var a=t.clientWidth;if(Math.abs(n-a)===1){n=a}if(this._bRtl){var c=jQuery(t).scrollLeftRTL();if(c>(l.browser.msie?1:0)){s=true}}else if(r>1){o=true}var h=function(){var t=parseFloat(e.css("padding-right"));return l.browser.msie?t+1:t};if(n-5>a){if(this._bRtl){if(jQuery(t).scrollRightRTL()>1){o=true}}else if(Math.abs(r+a-n)>h()){s=true}}var g=this._oArrowPrev.$().is(":visible");if(g&&!o){this._oArrowPrev.$().hide()}if(!g&&o){this._oArrowPrev.$().show()}var d=this._oArrowNext.$().is(":visible");if(d&&!s){this._oArrowNext.$().hide()}if(!d&&s){this._oArrowNext.$().show()}}};g.prototype._handleBorderReached=function(t){if(l.browser.msie&&this.bScrollInProcess){return}var e=t.getParameter("index");if(e===0){this._scroll(-this.getScrollStep(),this.getScrollTime())}else if(e===this.getItems().length-1){this._scroll(this.getScrollStep(),this.getScrollTime())}};g.prototype.addItem=function(t,e){this._oScrollCntr.addContent(t.addStyleClass("sapSuiteHrdrCntrInner"),e);return this};g.prototype.insertItem=function(t,e,i){this._oScrollCntr.insertContent(t.addStyleClass("sapSuiteHrdrCntrInner"),e,i);return this};g.prototype._callMethodInManagedObject=function(t,e){var r=Array.prototype.slice.call(arguments);if(e==="items"){r[1]="content";return this._oScrollCntr[t].apply(this._oScrollCntr,r.slice(1))}else{return i.prototype[t].apply(this,r.slice(1))}};g.prototype.onBeforeRendering=function(){if(l.system.desktop){sap.ui.getCore().attachIntervalTimer(this._checkOverflow,this);this._oArrowPrev.setIcon(this.getView()==="Horizontal"?"sap-icon://navigation-left-arrow":"sap-icon://navigation-up-arrow");this._oArrowNext.setIcon(this.getView()==="Horizontal"?"sap-icon://navigation-right-arrow":"sap-icon://navigation-down-arrow");this.$().off("click",this.handleSwipe)}};g.prototype.onAfterRendering=function(){jQuery(document.getElementById(this.getId()+"-scrl-next-button")).attr("tabindex","-1");jQuery(document.getElementById(this.getId()+"-scrl-prev-button")).attr("tabindex","-1");if(l.system.desktop){this.$().on("swipe",jQuery.proxy(this.handleSwipe,this))}};g.prototype.handleSwipe=function(t){t.preventDefault();t.stopPropagation();this._isDragEvent=true};g.prototype.exit=function(){if(this._oItemNavigation){this.removeDelegate(this._oItemNavigation);this._oItemNavigation.destroy()}if(this._sScrollResizeHandlerId){c.deregister(this._sScrollResizeHandlerId)}};g.prototype.onclick=function(t){if(this._isDragEvent){t.preventDefault();t.stopPropagation();this._isDragEvent=false}};g.prototype.setView=function(e){this.setProperty("view",e,true);if(e===t.HeaderContainerView.Horizontal&&!l.system.desktop){this._oScrollCntr.setHorizontal(true);this._oScrollCntr.setVertical(false)}else if(!l.system.desktop){this._oScrollCntr.setHorizontal(false);this._oScrollCntr.setVertical(true)}return this};g.prototype.validateAggregation=function(t,e,i){return this._callMethodInManagedObject("validateAggregation",t,e,i)};g.prototype.getAggregation=function(t,e,i){return this._callMethodInManagedObject("getAggregation",t,e,i)};g.prototype.setAggregation=function(t,e,i){this._callMethodInManagedObject("setAggregation",t,e,i);return this};g.prototype.indexOfAggregation=function(t,e){return this._callMethodInManagedObject("indexOfAggregation",t,e)};g.prototype.insertAggregation=function(t,e,i,r){this._callMethodInManagedObject("insertAggregation",t,e,i,r);return this};g.prototype.addAggregation=function(t,e,i){this._callMethodInManagedObject("addAggregation",t,e,i);return this};g.prototype.removeAggregation=function(t,e,i){return this._callMethodInManagedObject("removeAggregation",t,e,i)};g.prototype.removeAllAggregation=function(t,e){return this._callMethodInManagedObject("removeAllAggregation",t,e)};g.prototype.destroyAggregation=function(t,e){this._callMethodInManagedObject("destroyAggregation",t,e);return this};g.prototype._getParentCell=function(t){return jQuery(t).parents(".sapSuiteHrdrCntrInner").addBack(".sapSuiteHrdrCntrInner").get(0)};g.prototype.onsaptabnext=function(t){this._iSelectedCell=this._oItemNavigation.getFocusedIndex();var e=this.$().find(":focusable");var i=e.index(t.target);var r=e.eq(i+1).get(0);var o=this._getParentCell(t.target);var s;if(r){s=this._getParentCell(r)}if(o&&s&&o.id!==s.id||r&&r.id===this.getId()+"-after"){var n=e.last().get(0);if(n){this._bIgnoreFocusIn=true;n.focus()}}};g.prototype.onsaptabprevious=function(t){var e=this.$().find(":focusable");var i=e.index(t.target);var r=e.eq(i-1).get(0);var o=this._getParentCell(t.target);this._iSelectedCell=this._oItemNavigation.getFocusedIndex();var s;if(r){s=this._getParentCell(r)}if(!s||o&&o.id!==s.id){var n=this.$().attr("tabindex");this.$().attr("tabindex","0");this.$().focus();if(!n){this.$().removeAttr("tabindex")}else{this.$().attr("tabindex",n)}}};g.prototype.onfocusin=function(t){if(this._bIgnoreFocusIn){this._bIgnoreFocusIn=false;return}if(t.target.id===this.getId()+"-after"){this._restoreLastFocused()}};g.prototype._restoreLastFocused=function(){if(!this._oItemNavigation){return}var t=this._oItemNavigation.getItemDomRefs();var e=this._oItemNavigation.getFocusedIndex();var i=jQuery(t[e]);var r=i.control(0)||{};var o=r.getTabbables?r.getTabbables():i.find(":sapTabbable");o.eq(-1).add(i).eq(-1).focus()};return g});
//# sourceMappingURL=HeaderContainer.js.map