/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define("sap/suite/ui/commons/TimelineRenderManager",["sap/ui/thirdparty/jquery","./library","sap/m/Text","sap/ui/core/Icon","sap/m/ViewSettingsDialog","sap/ui/core/ResizeHandler","sap/ui/core/Item","sap/m/ToolbarSpacer","sap/m/SearchField","sap/m/OverflowToolbar","sap/m/Select","sap/m/RangeSlider","sap/m/Label","sap/m/Panel","sap/m/FlexBox","sap/m/OverflowToolbarButton","sap/m/MessageStrip","sap/m/ViewSettingsFilterItem","sap/m/ViewSettingsCustomItem","sap/m/OverflowToolbarLayoutData","sap/m/library","sap/m/MessageToast","sap/ui/core/InvisibleText","sap/m/SliderTooltip","sap/suite/ui/commons/TimelineRenderManagerTimestamp","sap/suite/ui/commons/util/StringSliderTooltip","sap/m/ResponsiveScale","sap/ui/core/library"],function(jQuery,e,t,i,s,r,n,o,a,l,m,p,c,g,u,f,h,d,_,S,T,C,b,I,v,y,U,D){"use strict";var x=D.CSSSize;var F=T.ButtonType;var L=T.OverflowToolbarPriority;var R=e.TimelineGroupType;var w=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var E=680;var M=Object.freeze({UP:"UP",DOWN:"DOWN",NONE:"NONE"});function P(e,t,i){e.removeClass(t).addClass(i)}function H(e,t){return parseInt(e.css(t).replace("px",""),10)}var j={extendTimeline:function(e){e.prototype._initControls=function(){this._setupMessageStrip();this._setupFilterDialog();this._setupHeaderToolbar();this._setupAccessibilityItems()};e.prototype._registerResizeListener=function(){var e=this.$().parent().get(0);if(e){this.oResizeListener=r.register(e,jQuery.proxy(this._performResizeChanges,this))}};e.prototype._deregisterResizeListener=function(){if(this.oResizeListener){r.deregister(this.oResizeListener)}};e.prototype._performUiChanges=function(e){this._deregisterResizeListener();if(!this.getDomRef()){return}if(this._isVertical()){this._performUiChangesV(e)}else{this._performUiChangesH()}this._setupScrollers();this._startItemNavigation();this._registerResizeListener()};e.prototype._performDoubleSidedChangesLi=function(e,t){var i=e.children().first(),s=this._isLeftAlignment()?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight";if(this._renderDblSided){if(e.hasClass("sapSuiteUiCommonsTimelineItem")){e.removeClass("sapSuiteUiCommonsTimelineItem").addClass(t?"sapSuiteUiCommonsTimelineItemOdd":"sapSuiteUiCommonsTimelineItemEven");if(!t){P(i,"sapSuiteUiCommonsTimelineItemWrapperVLeft","sapSuiteUiCommonsTimelineItemWrapperVRight")}else{P(i,"sapSuiteUiCommonsTimelineItemWrapperVRight","sapSuiteUiCommonsTimelineItemWrapperVLeft")}}}else{e.removeClass("sapSuiteUiCommonsTimelineItemOdd").removeClass("sapSuiteUiCommonsTimelineItemEven").addClass("sapSuiteUiCommonsTimelineItem");i.removeClass("sapSuiteUiCommonsTimelineItemWrapperVLeft").removeClass("sapSuiteUiCommonsTimelineItemWrapperVRight").addClass(s)}};e.prototype._performDoubleSidedChanges=function(){var e=this.$(),t=e.find(".sapSuiteUiCommonsTimelineItemUlWrapper").not(".sapSuiteUiCommonsTimelineShowMoreWrapper"),i=e.find(".sapSuiteUiCommonsTimelineScrollV .sapSuiteUiCommonsTimelineGroupHeader"),s;if(this._renderDblSided){this._$content.addClass("sapSuiteUiCommonsTimelineDblSided");i.addClass("sapSuiteUiCommonsTimelineGroupHeaderDblSided");i.addClass("sapSuiteUiCommonsTimelineItemWrapperVLeft").removeClass("sapSuiteUiCommonsTimelineItemWrapperVRight")}else{this._$content.removeClass("sapSuiteUiCommonsTimelineDblSided");i.removeClass("sapSuiteUiCommonsTimelineGroupHeaderDblSided sapSuiteUiCommonsTimelineItemWrapperVLeft");i.addClass(this._isLeftAlignment()?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight")}for(var r=0;r<t.length;r++){var n=jQuery(t[r]),o=n.find("> li").not(".sapSuiteUiCommonsTimelineGroupHeader");o.eq(1).css("margin-top",this._renderDblSided?"40px":"auto");for(var a=0;a<o.length;a++){s=jQuery(o[a]);this._performDoubleSidedChangesLi(s,a%2===0)}}e.find(".sapSuiteUiCommonsTimelineItemBarV").css("height","");e.find(".sapSuiteUiCommonsTimelineItem").css("margin-bottom","")};e.prototype._performUiChangesH=function(){var e=this.$(),t,i;var s=function(t){return e.width()-(t.position().left+t.outerWidth())};if(this.getEnableDoubleSided()&&this._isGrouped()){i=e.find(".sapSuiteUiCommonsTimelineHorizontalBottomLine ul");e.find("[firstgroupevenitem = true]:visible").each(function(e,r){var n=function(e){return e+"-"+(this._bRtlMode?"right":"left")}.bind(this),o=jQuery("#"+r.id+"-line"),a=this._bRtlMode?s(o):o.position().left,l=30,m=jQuery(r),p=H(i,n("padding")),c,g;if(e===0){c=a-l-p}else{t=m.prevAll(".sapSuiteUiCommonsTimelineItemLiWrapperV:visible:first");g=this._bRtlMode?s(t):t.position().left+H(t,n("margin"));c=a-l-(g+t.outerWidth())}m.css(n("margin"),c+"px")}.bind(this))}if(!this.getEnableScroll()){e.find(".sapSuiteUiCommonsTimelineContentsH").css("overflow-x","hidden")}this._calculateTextHeight()};e.prototype._performUiChangesV=function(e){var t=this.$(),i=t.outerWidth()+50;if(this.getEnableDoubleSided()){this._renderDblSided=i>=E;if(this._renderDblSided!==this._lastStateDblSided||e){this._performDoubleSidedChanges()}this._lastStateDblSided=this._renderDblSided}this._calculateTextHeight();this._calculateHeightV()};e.prototype._calculateHeightV=function(){var e=this.$(),t=this.$("headerBar").outerHeight()||0,i=this.$("filterMessage").outerHeight()||0,s=this.$("messageStrip").outerHeight()||0,r=s+i+t,n=function(e,t){var i,s,r,n,o,a,l,m=e.length,p=this.getShowIcons()?".sapSuiteUiCommonsTimelineItemBarIconWrapperV:visible":".sapSuiteUiCommonsTimelineItemNoIcon:visible",c=t.length>0?t.find(p+", .sapSuiteUiCommonsTimelineItemBarIconWrapperV:visible").eq(0):jQuery(),g=8;for(var u=0;u<m;u++){i=jQuery(e[u+1]);s=jQuery(e[u]);r=u<m-1?i.find(p):c;o=s.find(p);if(r.length>0&&o.length>0){a=r.offset().top;l=o.offset().top+o.height();n=s.find(".sapSuiteUiCommonsTimelineItemBarV");g=8;n.height(a-l-g)}}},o=function(e){var t,i,s,r,n,o=40,a=100,l=function(){var e=H(s,"margin-top")+s.position().top+s.height()-t.position().top;i.css("margin-bottom",e+o+"px")};for(var m=2;m<e.length;m++){t=jQuery(e[m]);i=jQuery(e[m-1]);s=jQuery(e[m-2]);r=this._bRtlMode?!t.hasClass("sapSuiteUiCommonsTimelineItemOdd"):t.hasClass("sapSuiteUiCommonsTimelineItemOdd");n=t.position().left;if(!r&&n<a||r&&n>a){l()}else{var p=t.position().top-i.position().top,c=H(s,"margin-bottom");if(p<o){s.css("margin-bottom",c+o-p+"px")}}}},a=function(){var t=5,i=e.position().top,s=e.parent().height(),n=H(this._$content,"padding-bottom"),o=H(this._$content,"padding-top"),a=s-i-r-o-n-t;this._$content.height(a)}.bind(this),l,m,p,c;if(this.getEnableScroll()){a()}if(this._renderDblSided){l=e.find(".sapSuiteUiCommonsTimelineItemUlWrapper");for(var g=0;g<l.length;g++){m=jQuery(l[g]);p=jQuery(l[g+1]);c=m.find(" > li:not(.sapSuiteUiCommonsTimelineGroupHeader):visible");c.css("margin-bottom","");o.call(this,c,m);n.call(this,c,p)}}};e.prototype._performResizeChanges=function(){this._performUiChanges()};e.prototype._calculateTextHeight=function(){var e=this.$(),t=this.getTextHeight(),i,s,r=function(t,i){e.find(".sapSuiteUiCommonsTimelineItemTextWrapper:visible").each(function(e,s){var r=jQuery(s),n=r.children().first(),o=n.get(0).getClientRects(),a=0,l=0,m,p=-1e5,c=0,g=w.getText("TIMELINE_TEXT_SHOW_MORE"),u=r.attr("expanded");u=u=="true";r.height("auto");r.css("-webkit-line-clamp","");if(o&&o.length>0){m=o[0].top;c=0;for(var f=0;f<o.length-1;f++){if(p!==o[f].bottom){p=o[f].bottom;c++}if(t>0&&o[f+1].bottom-m>t){l=c;a=o[f].bottom-m;break}if(i>0&&c===i){a=o[f].bottom-o[0].top;l=i;break}}}if(!u){if(a>0){r.height(a);r.css("-webkit-line-clamp",l.toString());r.next().show()}else if(!r.attr("expandable")){r.next().hide()}}else{for(var h=f;h<o.length-1;h++){if(p!==o[h].bottom){p=o[h].bottom;c++}}if(i>0&&c<=i){r.attr("expanded",false);r.next().children()[0].text=g;r.next().hide()}}})},n=function(e){r(0,parseInt(e,10))},o=function(e){r(e,0)},a=function(){var t=e.find(".sapSuiteUiCommonsTimelineItemTextWrapper");t.css("height","");t.css("-webkit-line-clamp","");e.css("height","100%");var i=this._$content.height(),s=H(this._$content,"padding-bottom"),r=this._$content.get(0).scrollHeight,n=r-i-s,o={height:0},a,l=20;e.find(".sapSuiteUiCommonsTimelineItemTextWrapper").each(function(e,t){var i=jQuery(t).height();if(i>o.height){o.height=i;o.item=jQuery(this)}});if(o.item){a=o.item.parent().find(".sapSuiteUiCommonsTimelineItemShowMore:hidden").height();return o.height-n-a-l}return 1};if(t){if(this._useAutomaticHeight()){o(a.call(this))}else if(jQuery.isNumeric(t)){n(t)}else{i=/([0-9]*\.?[0-9]+)(px)+/i;s=i.exec(t);if(s&&s.length>1){o(s[1])}else if(x.isValid(t)){e.find(".sapSuiteUiCommonsTimelineItemTextWrapper").height(t)}}}};e.prototype._fixScrollerPositionH=function(){var e=this.$(),t=e.find(".sapSuiteUiCommonsTimelineHorizontalMiddleLine"),i=e.find(".sapSuiteUiCommonsTimelineHorizontalScroller"),s,r=this._$content.position().top;if(t.get(0)){s=t.position().top;e.find(".sapSuiteUiCommonsTimelineScrollerIconWrapper").css("top",s-5+"px");i.css("top",r+"px");i.height(this._$content.outerHeight()-15)}};e.prototype._setupScrollers=function(){var e=this.$(),t=450,i="rgba(0, 0, 0, 0)",s,r,n,o,a,l,m,p,c,g,u,f,h,d=function(e){var t=i;e.parents().each(function(e,s){var r=jQuery(s).css("background-color"),n=jQuery(s).css("background-image");if(n!=="none"){t=i;return}if(r!==i&&r!=="transparent"){t=r}});return t};if(this._scrollingFadeout()){s=this._isVertical()?e.height():e.width();if(s<t){e.find(".sapSuiteUiCommonsTimelineVerticalScroller",".sapSuiteUiCommonsTimelineHorizontalScroller").hide();this._scrollersSet=false;return}if(!this._scrollersSet){r=d(this.$());if(r&&r!==i){n=r.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);if(n&&n.length>=4){o=parseInt(n[1],10);a=parseInt(n[2],10);l=parseInt(n[3],10);m="rgba("+o+","+a+","+l+", 0)";c="rgba("+o+","+a+","+l+", 0.7)";p="rgba("+o+","+a+","+l+", 1)";g=e.find(".sapSuiteUiCommonsTimelineHorizontalLeftScroller, .sapSuiteUiCommonsTimelineTopScroller ");u=e.find(".sapSuiteUiCommonsTimelineHorizontalRightScroller, .sapSuiteUiCommonsTimelineBottomScroller");f=this._isVertical()?"top":"left";h=this._isVertical()?"bottom":"right";g.css("background-image","linear-gradient(to "+f+", "+m+", "+p+")");u.css("background-image","linear-gradient(to "+h+", "+m+", "+p+")");g.css("background-image","-webkit-linear-gradient("+h+", "+m+", "+c+" 30%,"+p+")");u.css("background-image","-webkit-linear-gradient("+f+", "+m+", "+c+" 30%,"+p+")");this._scrollersSet=true;if(this.getContent().length>0){if(!this._isVertical()&&this._$content.get(0).scrollWidth>this._$content.outerWidth()||this._isVertical()&&this._$content.get(0).scrollHeight>this._$content.outerHeight()){u.show()}}}}else{e.find(".sapSuiteUiCommonsTimelineHorizontalScroller").hide()}}if(!this._isVertical()){this._fixScrollerPositionH()}}};e.prototype._setupScrollEvent=function(){var e=this.$(),t=e.find(".sapSuiteUiCommonsTimelineHorizontalLeftScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper, .sapSuiteUiCommonsTimelineTopScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper"),i=e.find(".sapSuiteUiCommonsTimelineHorizontalRightScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper, .sapSuiteUiCommonsTimelineBottomScroller .sapSuiteUiCommonsTimelineScrollerIconWrapper"),s=e.find(".sapSuiteUiCommonsTimelineHorizontalLeftScroller, .sapSuiteUiCommonsTimelineTopScroller"),r=e.find(".sapSuiteUiCommonsTimelineHorizontalRightScroller, .sapSuiteUiCommonsTimelineBottomScroller"),n=this._$content,o=this;if(o._lazyLoading()||o._scrollingFadeout()){n.on("scroll",function(e){var n=jQuery(e.currentTarget),a=n.get(0).scrollLeft,l=n.get(0).scrollTop,m=false,p=200,c=5,g=false,u,f,h,d,_;if(o._isVertical()){u=n.outerHeight();f=n.get(0).scrollHeight;g=l+u>f-p;m=l+u>=f-c}else{h=n.width();d=n.get(0).scrollWidth;g=a+h>d-p;m=a+h>=d-c-185}if(o._lazyLoading()&&o._scrollMoreEvent){if(g&&!o._isMaxed()){o._scrollMoreEvent=false;o._loadMore()}}if(o._scrollersSet){if(a>50||l>50){s.show()}else{s.hide();o._manualScrolling=false}if(m){r.hide()}else{r.show()}var S;if(o._isVertical()){S=n.get(0).scrollTop;_=S>o._lastScrollPosition.y?i:t;o._lastScrollPosition.y=S}else{S=n.get(0).scrollLeft;_=S>o._lastScrollPosition.x?i:t;o._lastScrollPosition.x=S}_.addClass("sapSuiteUiCommonsTimelineScrolling");clearTimeout(jQuery.data(this,"scrollTimer"));jQuery.data(this,"scrollTimer",setTimeout(function(){t.removeClass("sapSuiteUiCommonsTimelineScrolling");i.removeClass("sapSuiteUiCommonsTimelineScrolling")},350))}});this.$().find(".sapSuiteUiCommonsTimelineScrollerIconWrapper").on("mousedown",function(e){var t=90,i=jQuery(this).hasClass("sapSuiteUiCommonsTimelineScrollerIconWrapperLeft")||jQuery(this).hasClass("sapSuiteUiCommonsTimelineScrollerIconWrapperTop")?-t:t;o._manualScrolling=true;o._performScroll(i)});this.$().find(".sapSuiteUiCommonsTimelineScrollerIconWrapper").on("mouseup",function(){o._manualScrolling=false}).on("mouseout",function(){o._manualScrolling=false})}if(this.getEnableScroll()&&!o._isVertical()){this._$content.on("wheel",function(e){if(e.originalEvent.deltaX){return}var t=e.originalEvent.deltaY,i=30;if(t<i&&t>i*-1){t=t>0?i:i*-1}this.scrollLeft+=t*2});e.find(".sapSuiteUiCommonsTimelineHorizontalScroller, .sapSuiteUiCommonsTimelineVerticalScroller").on("wheel",function(e){var t=e.originalEvent.deltaY;if(o._isVertical()){o._$content.get(0).scrollTop+=t*2}else{o._$content.get(0).scrollLeft+=t*2}})}};e.prototype._setupMessageStrip=function(){var e=this;this._objects.register("messageStrip",function(){return new h(e.getId()+"-messageStrip",{close:function(){e.setCustomMessage("");e.fireCustomMessageClosed()},showCloseButton:true})});this._objects.register("filterMessageText",function(){return new t(e.getId()+"-filterMessageText",{})});this._objects.register("filterMessage",function(){var t=e._objects.getFilterMessageText(),s,r;r=new i(e.getId()+"filterMessageIcon",{src:"sap-icon://decline",press:[e._clearFilter,e]});r.setTooltip(w.getText("TIMELINE_CLEAR_ICN_TOOLTIP"));s=new l(e.getId()+"-filterMessage",{design:"Info",content:[t,new o,r]});s.addStyleClass("sapSuiteUiCommonsTimelineFilterInfoBar");s.setHeight("auto");return s})};e.prototype._setMessageBars=function(e){var t=this._getFilterMessage();if(t){e.addChild(this._objects.getFilterMessage());this._objects.getFilterMessageText().setText(t)}};e.prototype._setupRangeFilterPage=function(){var e=this;this._rangeFilterType=null;this._objects.register("timestampFilterPicker",function(){return new v(e.getId(),{dateChanged:function(t){var i=t.getSource(),s=i.getStartDate()||e._minDate,r=i.getEndDate()||e._maxDate;e._filterDialogRangePage.setFilterCount(+(s!==e._minDate||r!==e._maxDate))}},undefined,w,e._objects)});this._objects.register("timeFilterSelect",function(){var t=new m(e.getId()+"-timeFilterSelect",{ariaLabelledBy:e._objects.getRangeTypeLbl().getId(),change:function(t){e._rangeFilterType=t.getParameter("selectedItem").getProperty("key");e.toggleGroupTypeSelector(e._rangeFilterType);e._setRangeFilter();var i=e._objects.getFilterContent()._getDialog();var s=i.getBeginButton();s.setEnabled(true);if(e._objects.getTimeFilterSelect().getSelectedItem().getText()===w.getText("TIMELINE_CUSTOM_RANGE")){e._objects.getTimestampFilterPicker()._checkDatePickerStatus()}},items:[new n({text:w.getText("TIMELINE_YEAR"),key:R.Year}),new n({text:w.getText("TIMELINE_QUARTER"),key:R.Quarter}),new n({text:w.getText("TIMELINE_MONTH"),key:R.Month}),new n({text:w.getText("TIMELINE_DAY"),key:R.Day}),new n({text:w.getText("TIMELINE_CUSTOM_RANGE"),key:R.None})]});t.addStyleClass("sapSuiteUiCommonsTimelineRangeSelect");return t});this._objects.register("timeRangeSlider",function(){var t=function(t){if(typeof t==="string"){t=Number(t)}var i=e._fnAddDate(t);return e._formatGroupBy(i,e._rangeFilterType).title};var i=new U;i.getLabel=t;var s=new p(e.getId()+"-timeRangeSlider",{enableTickmarks:true,visible:false,showAdvancedTooltip:true,step:1,change:function(t){var i=s.getMin(),r=s.getMax(),n=s.getRange();e._filterDialogRangePage.setFilterCount(+(n[0]!==i||n[1]!==r))},customTooltips:[new y({mapFunction:t}),new y({mapFunction:t,fetchValue2:true})],scale:i});s.addStyleClass("sapSuiteUiCommonsTimelineRangeFilter");return s});this._objects.register("rangeTypeLbl",function(){return new c(e.getId()+"-rangeTypeLbl",{text:w.getText("TIMELINE_GROUP_BY_PERIOD")+":"})});this._objects.register("rangeTypePanel",function(){var t=new g(e.getId()+"-rangeTypePanel",{content:[e._objects.getRangeTypeLbl(),e._objects.getTimeFilterSelect()]});t.addStyleClass("sapSuiteUiCommonsTimelineRangeFilterPanel");t.addStyleClass("sapSuiteUiCommonsTimelineRangeFilterPanelShadowed");return t});this._objects.register("rangePanel",function(){return new u(e.getId()+"rangePanel",{direction:"Column",items:[e._objects.getRangeTypePanel(),e._objects.getTimeRangeSlider(),e._objects.getTimestampFilterPicker().getTimestampPanelRadio(),e._objects.getTimestampFilterPicker().getTimestampPanelPicker()]})})};e.prototype._setupFilterFirstPage=function(e){if(e){e.removeAllAggregation("filterItems");if(this.getShowItemFilter()){e.addAggregation("filterItems",new d({key:"items",text:this._getFilterTitle()}))}if(this.getShowTimeFilter()){this._filterDialogRangePage=new _({key:"range",text:w.getText("TIMELINE_RANGE_SELECTION"),customControl:[this._objects.getRangePanel()]});e.addAggregation("filterItems",this._filterDialogRangePage)}}};e.prototype._setupFilterDialog=function(){var e=this;this._setupRangeFilterPage();this._objects.register("filterContent",function(){var t,i,r=function(t){if(!e._filterState.data){e._setFilterList();t.removeAllItems();e._aFilterList.forEach(function(i){var s=jQuery.grep(e._currentFilterKeys,function(e){return i.key===e.key}).length>0;t.addItem(new d({key:i.key,text:i.text,selected:s}))})}e._filterState.data=true},n=function(){C.show(w.getText("TIMELINE_NO_LIMIT_DATA"))},o=function(){if(!e._filterState.range){a.setBusy(true);e._getTimeFilterData().then(function(){a.setBusy(false);if(!e._minDate||!e._maxDate||(!(e._minDate instanceof Date)||!(e._maxDate instanceof Date))){n();return}if(!e._rangeFilterType){e._rangeFilterType=e._calculateRangeTypeFilter()}if(!e._startDate&&!e._endDate){e._setRangeFilter()}else{var s=e._objects.getTimeRangeSlider(),r=e._fnDateDiff(e._rangeFilterType),o=s.getMin(),l=s.getMax();if(l-o!==r){e._setRangeFilter()}t=e._fnDateDiff(e._rangeFilterType,e._minDate,e._startDate);i=e._fnDateDiff(e._rangeFilterType,e._minDate,e._endDate);s.setRange([t,i])}e.toggleGroupTypeSelector(e._rangeFilterType);e._objects.getTimeFilterSelect().setSelectedKey(e._rangeFilterType)}).catch(function(){a.setBusy(false);n()});e._filterState.range=true}},a=new s(e.getId()+"-filterContent",{confirm:function(t){var i=t.getParameter("filterItems"),s,r,n,o,a;e._currentFilterKeys=i.map(function(e){return{key:e.getProperty("key"),text:e.getProperty("text")}});e._startDate=null;e._endDate=null;if(e._objects.getTimestampFilterPicker().getVisible()){var l=e._objects.getTimestampFilterPicker().getStartDate()||e._minDate,m=e._objects.getTimestampFilterPicker().getEndDate()||e._maxDate;if(l!==e._minDate||m!==e._maxDate){e._startDate=l;e._endDate=m;a=true}}else{s=e._objects.getTimeRangeSlider();o=s.getRange();r=s.getMin();n=s.getMax();if(o[0]!==r||o[1]!==n){e._startDate=e._fnAddDate(Math.min.apply(null,o),M.DOWN);e._endDate=e._fnAddDate(Math.max.apply(null,o),M.UP);a=true}}e._filterData(a)},resetFilters:function(t){var i=e._objects.getTimeRangeSlider();i.setValue(i.getMin());i.setValue2(i.getMax());e._filterDialogRangePage.setFilterCount(0);e._objects.getTimestampFilterPicker().clearDates()},filterDetailPageOpened:function(e){var t=e.getParameter("parentFilterItem").getProperty("key");if(t==="items"){r(e.getParameter("parentFilterItem"))}if(t==="range"){o()}}});e._setupFilterFirstPage(a);return a})};e.prototype._setupHeaderToolbar=function(){var e=this,t=function(t){e._objects.register(t.name,function(){var i=new f(e.getId()+"-"+t.name,{type:F.Transparent,icon:t.icon,tooltip:t.tooltip,press:t.fnPress});i.setLayoutData(new S({priority:t.priority}));return i})};t({name:"filterIcon",icon:"sap-icon://add-filter",tooltip:w.getText("TIMELINE_FILTER_BY"),fnPress:[e._openFilterDialog,e],priority:L.NeverOverflow,visible:e.getShowItemFilter()||e.getShowTimeFilter()});t({name:"sortIcon",icon:"sap-icon://arrow-bottom",tooltip:w.getText("TIMELINE_SORT"),fnPress:[e._sortClick,e],priority:L.High,visible:e.getSort()&&e.getShowSort()});var i=new o;this._objects.register("searchFieldLabel",function(){return new b(e.getId()+"-searchFieldLabel",{text:w.getText("TIMELINE_ACCESSIBILITY_SEARCH")})});this._objects.register("searchField",function(){var t=new a(e.getId()+"-searchField",{width:"14rem",ariaLabelledBy:e._objects.getSearchFieldLabel().getId(),search:function(t){e._search(t.getSource().getValue())},visible:e.getShowSearch()});t.setLayoutData(new S({priority:L.Low}));return t});this._objects.register("headerBar",function(){var t=[i,e._objects.getSearchFieldLabel(),e._objects.getSearchField(),e._objects.getSortIcon(),e._objects.getFilterIcon()];var s=new l(e.getId()+"-headerBar",{content:t,visible:e.getShowHeaderBar()});s.addStyleClass("sapSuiteUiCommonsTimelineHeaderBar");s.setParent(e);return s})};e.prototype._setupAccessibilityItems=function(){var e=this;this._objects.register("accessibilityTitle",function(){return new b(e.getId()+"-accessibilityTitle",{text:w.getText("TIMELINE_ACCESSIBILITY_TITLE")})})};e.prototype.toggleGroupTypeSelector=function(e){var t=e!==R.None;this._objects.getTimestampFilterPicker().setVisible(!t);this._objects.getTimeRangeSlider().setVisible(t)}}};return j},true);
//# sourceMappingURL=TimelineRenderManager.js.map