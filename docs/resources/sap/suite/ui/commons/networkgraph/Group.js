/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/suite/ui/commons/library","sap/ui/thirdparty/jquery","./ElementBase","sap/ui/core/IconPool","sap/m/CheckBox"],function(e,jQuery,t,o,i){"use strict";var s=e.networkgraph.ElementStatus,r=e.networkgraph.HeaderCheckboxState;var n={COLLAPSED_HEIGHT:32,COLLAPSED_WIDTH:160,ROUNDING:6,ICON_OFFSET:8,ICON_SIZE:15,HEADER_SIZE:32};var a="expand-all",u="collapse-all",p="horizontal-grip";var h=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var l=t.extend("sap.suite.ui.commons.networkgraph.Group",{metadata:{library:"sap.suite.ui.commons",properties:{headerCheckBoxState:{type:"sap.suite.ui.commons.networkgraph.HeaderCheckboxState",group:"Misc",defaultValue:r.Hidden},key:{type:"string",group:"Misc",defaultValue:null},collapsed:{type:"boolean",group:"Misc",defaultValue:false},icon:{type:"string",group:"Appearance",defaultValue:null},minWidth:{type:"float",defaultValue:undefined},parentGroupKey:{type:"string",group:"Misc",defaultValue:null}},events:{headerCheckBoxPress:{parameters:{checked:"boolean"}},collapseExpand:{},showDetail:{}},aggregations:{_checkBox:{type:"sap.m.CheckBox",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2,render:function(e,t){t._render({renderManager:e})}},onAfterRendering:function(){this._afterRenderingBase()}});l.prototype.aProcessRequiredProperties=["key","parentGroupKey"];l.BUTTONS={MENU:"menu",COLLAPSE:"collapse"};l.prototype.init=function(){this._iWidth=n.COLLAPSED_WIDTH;this._iHeight=n.COLLAPSED_HEIGHT;this._oActionButtons={};this._clearChildren();this._bIsHidden=false};l.prototype._afterRendering=function(){this._setupEvents();if(!this._isVisible()){this.$().hide()}if(this.$().find(".sapSuiteUiCommonsNetworkGraphHeaderCheckboxInner").length!==0){this.$().find(".sapSuiteUiCommonsNetworkGraphHeaderCheckboxInner").attr("aria-label",this.getTitle())}this._removeFromInvalidatedControls()};l.prototype._renderTopGroup=function(e){var t=this._getElementId(e.idSufix),o=this._iTopGroupIndex===0,i=e.renderManager;var s=this.getIcon(),r=this.getTitle();var n=this._iTopGroupIndex*50;if(this.getParent()._bIsRtl){o=!o;n=o?0:50}if(o){i.openStart("div").class("sapSuiteUiCommonsNetworkTopGroupDelimiter").openEnd().close("div")}this._renderHtmlElement("div",{top:0,left:n+"%",width:"50%",height:"32px"},{id:t,"data-sap-ui":t,class:"sapSuiteUiCommonsNetworkTopGroup "+(!o?"sapSuiteUiCommonsNetworkTopGroupRight":"")},i);i.openStart("div").class("sapSuiteUiCommonsNetworkTopGroupHeader").openEnd();if(s){this._renderHtmlIcon(s,null,null,null,null,i)}if(r){i.openStart("div").class("sapSuiteUiCommonsNetworkGroupHeaderTitle").openEnd().text(r).close("div")}i.close("div");i.close("div")};l.prototype._render=function(e){var o=this.getParent(),i=!this.getCollapsed()||this._isCollapsedSwimLane()?this._iHeight:n.HEADER_SIZE,s;e=e||{};if(this._iNestedLevel===0&&o._isTwoColumnsLayout()){this._renderTopGroup(e);return""}if(this._isIgnored()||!this.getVisible()){return""}if(this.getParent()._isLayered()){s=this._getElementId(e.idSufix);var r=this._convertToStyle({top:this.getY()+"px",left:this.getX()+"px",width:this._iWidth+"px",height:i+"px"},this._getStatusStyle({"border-color":t.ColorType.Border,"border-width":t.ColorType.BorderWidth,"border-style":t.ColorType.BorderStyle}),true);this._renderHtmlElement("div",{},{id:s,"data-sap-ui":s,class:this._getGroupClass(),style:r},e.renderManager);this._renderHeader(e);e.renderManager.close("div")}};l.prototype._renderHeader=function(e){var o=this.getIcon(),i=this.getTitle();var r="",n="",l="",d="";if(this.getStatus()&&this.getStatus()!==s.Standard){l=this._getStatusStyle({color:t.ColorType.Content},true);d=this._getStatusStyle({color:t.ColorType.Content},false);if(this._bIsSwimLane){r=this._getStatusStyle({"background-color":t.ColorType.Background},false)}else{n=this._getStatusStyle({"background-color":t.ColorType.Background,"border-color":t.ColorType.Background},false)}}e.renderManager.openStart("div");this.applyStyles(e.renderManager,this.getStyleObject(n));e.renderManager.class("sapSuiteUiCommonsNetworkGroupHeader").openEnd();if(this._bIsSwimLane&&(r||this._hasDefaultStatus())){e.renderManager.openStart("div").class("sapSuiteUiCommonsNetworkGroupHeaderStatus").openEnd();this.applyStyles(e.renderManager,this.getStyleObject(r));e.renderManager.close("div")}e.renderManager.openStart("div").class("sapSuiteUiCommonsNetworkGroupHeaderInner").class("sapSuiteUiCommonsNetworkGroupHeaderInnerText").openEnd();if(this._showHeaderCheckBox()){this._renderClonedControl(e,this._getHeaderCheckbox())}if(o){this._renderHtmlIcon(o,"sapSuiteUiCommonsNetworkGroupHeaderIcon",null,l,null,e.renderManager)}if(i){e.renderManager.openStart("div").class("sapSuiteUiCommonsNetworkGroupHeaderTitle");var c=sap.ui.getCore().getConfiguration().getLanguage();var f=["ja","zh_TW","zh_CN","ko"];if(this._isVerticalSwimLane()&&f.indexOf(c)>-1){d=d.length>0?d.concat(";text-orientation:sideways"):d.concat("text-orientation:sideways")}this.applyStyles(e.renderManager,this.getStyleObject(d));e.renderManager.openEnd();e.renderManager.text(i);e.renderManager.close("div")}e.renderManager.close("div");e.renderManager.openStart("div").class("sapSuiteUiCommonsNetworkGroupHeaderInner").class("sapSuiteUiCommonsNetworkGroupHeaderInnerIcons").openEnd();this._renderHtmlIcon(this.getCollapsed()?a:u,"sapSuiteUiCommonsNetworkGroupHeaderMenuIcon","collapse",l,h.getText("NETWORK_GRAPH_EXPAND_COLLAPSE"),e.renderManager);this._renderHtmlIcon(p,"sapSuiteUiCommonsNetworkGroupHeaderMenuIcon","menu",l,h.getText("NETWORK_GRAPH_GROUP_DETAILS"),e.renderManager);e.renderManager.close("div");e.renderManager.close("div")};l.prototype._getGroupClass=function(){return"sapSuiteUiCommonsNetworkGroup "+this._getStatusClass()+(this.getCollapsed()?"sapSuiteUiCommonsNetworkGroupCollapsed":"sapSuiteUiCommonsNetworkGroupExpanded")+(this._bIsSwimLane?" sapSuiteUiCommonsNetworkGroupSwimLane":" sapSuiteUiCommonsNetworkGroupClassic")+(this._isVerticalSwimLane()?" sapSuiteUiCommonsNetworkGroupVerticalSwimLane":"")+(this._isTopBottom()?" sapSuiteUiCommonsNetworkGroupTopBottom ":"")};l.prototype.getChildNodes=function(){this._checkForProcessData();return this.aChildren};l.prototype.getChildLines=function(){this._checkForProcessData();return this.aLines};l.prototype.getParentNodes=function(){this._checkForProcessData();return this.aParents};l.prototype.getParentLines=function(){this._checkForProcessData();return this.aParentLines};l.prototype.getNodes=function(){this._checkForProcessData();return this.aNodes};l.prototype.isHidden=function(){return this._bIsHidden};l.prototype.setHidden=function(e){this.$()[e?"hide":"show"]();this._bIsHidden=e};l.prototype.getHeaderCheckbox=function(){return this._getHeaderCheckbox()};l.prototype._getHeaderCheckbox=function(){var e=this.getAggregation("_checkBox"),t=this;if(!e){e=new i(this.getId()+"-checkbox",{select:function(o){var i=e.getSelected();t.fireHeaderCheckBoxPress({checked:i})}}).addStyleClass("sapSuiteUiCommonsNetworkGraphHeaderCheckboxInner");this.setAggregation("_checkBox",e,true)}return e};l.prototype._isCollapsedSwimLane=function(){return this._bIsSwimLane&&this.getCollapsed()};l.prototype._clearChildren=function(){this.aNodes=[];this.aLines=[];this.aChildren=[];this.aParentLines=[];this.aParents=[];this.aChildGroups=[]};l.prototype._hasVisibleNodes=function(e){var t=this.aNodes.some(function(e){return!e._bIsHidden});if(!t){for(var o=0;o<this.aChildGroups.length;o++){if(this.aChildGroups[o]._hasVisibleNodes()){return true}}}return t};l.prototype._hasNodes=function(){var e=this.aNodes.some(function(e){return e._useInLayout()});if(!e){e=this.aChildGroups.some(function(e){return e._hasNodes()})}return e};l.prototype._hideShow=function(e){this.$()[e?"hide":"show"]();this._bIsHidden=e;var t=this._oParentGroup;while(t){var o=t._hasVisibleNodes();if(o&&!e||!o&&e){t._hideShow(e)}else{break}t=t._oParentGroup}};l.prototype._setButtonFocus=function(e,t){var o=t?"addClass":"removeClass";e[o]("sapSuiteUiCommonsNetworkElementFocus")};l.prototype._setMenuButtonFocus=function(e){this._setButtonFocus(jQuery(this._oActionButtons.menu),e)};l.prototype._setCollapseButtonFocus=function(e){this._setButtonFocus(jQuery(this._oActionButtons.collapse),e)};l.prototype._setupEvents=function(){var e=this.$("menu"),o=this.$("header"),i=this.$("collapse"),s=this.$().find(".sapSuiteUiCommonsNetworkGroupHeaderMenuIcon");this._oActionButtons.menu=e[0];this._oActionButtons.collapse=i[0];i.off("click");e.off("click");o.off("click");s.off("mouseover");s.off("mouseout");e.on("click",function(e){var t=this.fireEvent("showDetail",{},true);if(t){this._openDetail()}if(this.getParent()){this.getParent().setFocus({item:this,button:l.BUTTONS.MENU})}this._setMenuButtonFocus(false)}.bind(this));i.on("click",function(e){this._collapse();if(this.getParent()){this.getParent().setFocus({item:this,button:l.BUTTONS.COLLAPSE})}}.bind(this));o.on("click",function(e){if(this.getParent()){this.getParent().setFocus({item:this})}this.firePress()}.bind(this));var r=function(e,t,o){if(!this._bIsSwimLane){e.css("background-color",this._getColor(t))}e.css("color",this._getColor(o))}.bind(this);s.on("mouseover",function(e){r(jQuery(e.currentTarget),t.ColorType.HoverBackground,t.ColorType.HoverContent)});s.on("mouseout",function(e){r(jQuery(e.currentTarget),t.ColorType.Background,t.ColorType.Content)})};l.prototype._collapse=function(){this.getParent()._selectElementAfterScroll=this;this.fireEvent("collapseExpand",{},true);this.setCollapsed(!this.getCollapsed())};l.prototype._openDetail=function(){var e=this.$("menu");this.getParent()._tooltip.openDetail({item:this,opener:e[0]})};l.prototype._isEmpty=function(){return this.aNodes.length===0};l.prototype._isIgnored=function(){if(!this._useInLayout()){return true}return!this._hasNodes()};l.prototype._isVisible=function(){var e=this._bIsSwimLane||this.aNodes.some(function(e){return!e.isHidden()});if(!e){e=this.aChildGroups.some(function(e){return e._isVisible()})}return e};l.prototype._useInLayout=function(){return!this._oCollapsedByParent};l.prototype._resetSize=function(){if(this.getCollapsed()){this._iHeight=n.COLLAPSED_HEIGHT}};l.prototype._getAccessibilityLabel=function(){return h.getText("NETWORK_GRAPH_GROUP")+" "+this.getTitle()};l.prototype._isTopBottom=function(){var e=this.getParent();return e&&e._isTopBottom()};l.prototype._isVerticalSwimLane=function(){if(this._bIsSwimLane){var e=this._isTopBottom();return e&&!this.getCollapsed()||!e&&this.getCollapsed()}return false};l.prototype._isCollapsed=function(){return this.getCollapsed()||!!this._oCollapsedByParent};t.prototype._showHeaderCheckBox=function(){return this.getHeaderCheckBoxState()!==r.Hidden};l.prototype._getBorderSize=function(){return 1};l.prototype._setFocus=function(e){this._setMenuButtonFocus(e)};l.prototype._isOnScreen=function(e,o,i,s){var r=this.getX(),n=this.getY();return t._isRectOnScreen(r,r+this._iWidth,n,n+this._iHeight,e,o,i,s)};l.prototype.getHeaderCheckBoxState=function(){if(this.getProperty("headerCheckBoxState")===r.Hidden){return r.Hidden}return this.getHeaderCheckbox().getSelected()?r.Checked:r.Unchecked};l.prototype.setHeaderCheckBoxState=function(e){this._setHeaderCheckBoxState(e);return this};l.prototype.setX=function(e){this.fX=e;return this};l.prototype.getX=function(){return this.fX};l.prototype.setY=function(e){this.fY=e;return this};l.prototype.getY=function(){return this.fY};l.prototype._setCollapsed=function(e,t){var o=this;var i=this.getParent(),s=[];var r=function(t){t.aChildGroups.forEach(function(e){r(e)});if(o!==t){if(!t._oCollapsedByParent||t._oCollapsedByParent===o){t._oCollapsedByParent=e?o:null}}};var n=function(t){if(e){this.getNodes().forEach(function(e){if(e.getSelected()){e.setSelected(false);s.push(e)}});this.getChildLines().forEach(function(e){if(e.getSelected()&&e._isInCollapsedGroup()){e.setSelected(false);s.push(e)}})}}.bind(this);if(e!==this.getCollapsed()||t){this.setProperty("collapsed",e,true);if(e){this.getNodes().forEach(function(e){if(e.getSelected()){e.setSelected(false);s.push(e)}});this.getChildLines().forEach(function(e){if(e.getSelected()&&e._isInCollapsedGroup()){e.setSelected(false);s.push(e)}})}this.aChildGroups.forEach(function(e){n(e)});r(this);if(i&&s.length>0){i.fireSelectionChange({items:s})}if(i&&i._bIsLayedOut){i.invalidate()}}};l.prototype.setCollapsed=function(e){this._setCollapsed(e,false);return this};l.prototype.setVisible=function(e){this.setProperty("visible",e);var t=this.getParent();if(t&&t._bIsLayedOut&&!this.getCollapsed()){this.aNodes.forEach(function(t){if(!e){t.$().hide()}else if(!t._bIsHidden){t.$().show()}})}return this};return l});
//# sourceMappingURL=Group.js.map