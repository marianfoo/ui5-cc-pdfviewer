/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/suite/ui/commons/library","sap/ui/thirdparty/jquery","sap/ui/core/Control","./SvgBase","./Node","./Line","./Group","./layout/LayeredLayout","./Tooltip","sap/ui/model/json/JSONModel","sap/m/SuggestionItem","./Utils","sap/m/Label","sap/m/OverflowToolbar","sap/m/OverflowToolbarButton","sap/m/SearchField","sap/m/ToolbarSpacer","sap/ui/core/CustomData","sap/ui/model/Filter","sap/m/OverflowToolbarLayoutData","./KeyboardNavigator","sap/ui/core/theming/Parameters","sap/base/Log","sap/ui/performance/Measurement","sap/base/util/uid","sap/base/security/encodeXML","./GraphRenderer","sap/m/ToggleButton","sap/ui/core/routing/HashChanger","sap/m/library","sap/m/Dialog","sap/suite/ui/commons/util/FullScreenUtil"],function(e,jQuery,t,i,s,o,r,n,a,h,l,u,g,c,p,f,d,_,m,y,L,v,T,b,N,S,C,E,I,A,w,O){"use strict";var F=A.ButtonType,R=e.networkgraph.Orientation,G=e.networkgraph.LayoutRenderType,x=e.networkgraph.RenderType;var U="nodes",$="lines",D="groups";var P=[.05,.1,.25,.33,.5,.67,.75,.8,.9,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],k=1,B=.4,H=1e5;var M={Group:"group",Node:"node",Line:"line",IsLastKey:"islast",TypeKey:"type"};var W=Object.freeze({Node:"Node",Line:"Line",Group:"Group"});var K=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var Z=0,Y=100;var z=l.extend("sap.suite.ui.commons.networkgraph.LimitedSuggestionItem",{render:function(e,t,i,s){if(Z++<Y){l.prototype.render.call(this,e,t,i,s)}}});var X=i.extend("sap.suite.ui.commons.networkgraph.Graph",{metadata:{library:"sap.suite.ui.commons",properties:{height:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"100%"},width:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"100%"},orientation:{type:"sap.suite.ui.commons.networkgraph.Orientation",group:"Behavior",defaultValue:R.LeftRight},enableZoom:{type:"boolean",group:"Behavior",defaultValue:true},enableWheelZoom:{type:"boolean",group:"Behavior",defaultValue:true},backgroundImage:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},backgroundColor:{type:"sap.suite.ui.commons.networkgraph.BackgroundColor",group:"Appearance",defaultValue:"White"},renderType:{type:"sap.suite.ui.commons.networkgraph.RenderType",group:"Appearance",defaultValue:x.Html},noData:{type:"boolean",group:"Behavior",defaultValue:false},noDataText:{type:"string",group:"Behavior",defaultValue:""}},aggregations:{lines:{type:"sap.suite.ui.commons.networkgraph.Line",multiple:true,singularName:"line"},nodes:{type:"sap.suite.ui.commons.networkgraph.Node",multiple:true,singularName:"node"},groups:{type:"sap.suite.ui.commons.networkgraph.Group",multiple:true,singularName:"group"},legend:{type:"sap.ui.core.Control",multiple:false},layoutAlgorithm:{type:"sap.suite.ui.commons.networkgraph.layout.LayoutAlgorithm",multiple:false},statuses:{type:"sap.suite.ui.commons.networkgraph.Status",multiple:true,singularName:"status"}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{graphReady:{},afterLayouting:{},beforeLayouting:{},zoomChanged:{},failure:{parameters:{type:"string",message:"string"}},selectionChange:{parameters:{items:{type:"sap.suite.ui.commons.networkgraph.ElementBase[]"}}},searchSuggest:{parameters:{term:{type:"string"}}},search:{parameters:{term:{type:"string"},key:{type:"string"}}}}}});X.FAILURE_TYPE={INCONSISTENT_MODEL:"Inconsistent model",LAYOUT_FAILURE:"Layout failure"};X.prototype.ZOOM_100=k;X.prototype.init=function(){this._fZoomLevel=1;this._mSelectedNodes={};this._mSelectedLines={};this._bIsLayedOut=false;this._bIsFullScreen=false;this._mNodes={};this._bNeedNodeProcessing=true;this._oFullScreenContainer=null;this._bRequiresDataProcessing=true;this._oPanning={};this._oLegendLabels={};this._iRunningLayouts=0;this._oLastLayout=null;this._bIsRtl=sap.ui.getCore().getConfiguration().getRTL();this._oFocus=null;this._tooltip=this._createTooltip();this._bIsInvalid=false;this._oStatuses={};this._aShadedNodes=[];this._createToolbar()};X.prototype.onBeforeRendering=function(){this._bIsRtl=sap.ui.getCore().getConfiguration().getRTL();this.setBusy(false);this.setBusyIndicatorDelay(0);this._iNodeMaxWidth=0;this.getNodes().forEach(function(e){e._resetDimensions();var t=e.getMaxWidth();if(t>this._iNodeMaxWidth){this._iNodeMaxWidth=t}}.bind(this));this.getLines().forEach(function(e){e._resetLayoutData()});if(!this.getNoData()){this.setDisableToolbarButtons(true);this._loadData()}else{this.setDisableToolbarButtons(false)}};X.prototype.onAfterRendering=function(){var e="",t=this.getNodes(),i=this._bIsRtl?"direction="+'"rtl"':"",s='<rect class="sapSuiteFlickerFreeRect" x="0" y="0"></rect>';this.$divnodes=this.$("divnodes");this.$divgroups=this.$("divgroups");this.$background=this.$("background");this.$tooltips=this.$("tooltiplayer");this.$scroller=this.$("scroller");this._$innerscroller=this.$("innerscroller");this.$legend=this.$("legend");if(this._oFullScreenContainer&&this._bIsFullScreen){this._oFullScreenContainer.$content=this.$();this.$().addClass("sapSuiteUiCommonsNetworkGraphFullScreen")}if(t.length===0||this._bIsInvalid||this.getNoData()){if(this._bIsInvalid){this.$scroller.html('<span class="sapSuiteNetworkGraphErrorText">'+K.getText("NETWORK_GRAPH_WRONGDATA")+"</span>")}if(this._oSuggestionItemsModel){this._oSuggestionItemsModel.setData("")}this.fireGraphReady();return}this.setBusy(true);t.forEach(function(e){e.bOutput=true});if(this._isDelayedLayouting()){if(!this._isUseNodeHtml()){t.forEach(function(t){t._setupWidthAndHeight();e+=t._render({sizeDetermination:true});e+="</g>"})}var o=function(){if(this._iNodeMaxWidth){this.$divnodes.css("width",this._iNodeMaxWidth+50+"px")}this._isUseNodeHtml()?this._createDivNodes():this._$innerscroller.append('<svg id="'+this.getId()+'-sizesvg"'+i+' class="sapSuiteUiCommonsNetworkGraphSvg">'+e+s+"</svg>");t.forEach(function(e){if(this._isUseNodeHtml()){e._setupDivDimensions()}else{e.calculateSizes();e._setupWidthAndHeight()}}.bind(this));this._preprocessData();sap.ui.getCore().detachThemeChanged(o)}.bind(this);if(!sap.ui.getCore().isThemeApplied()){sap.ui.getCore().attachThemeChanged(o)}else{o()}}};X.prototype.exit=function(){if(this._oFullScreenUtil){this._oFullScreenUtil.cleanUpFullScreen(this)}};X.prototype._beforeRender=function(){this.fireEvent("afterLayouting")};X.prototype._fireFailure=function(e,t){var i=t;if(typeof t==="object"&&t.text){i=t.text}var s="Graph failure: "+e+": "+i;if(e===X.FAILURE_TYPE.INCONSISTENT_MODEL){s+=" This may be due to the model size restriction. For its increase use model's 'setSizeLimit' method."}this.fireFailure([e.toString(),i]);T.error(s)};X.prototype.isFullScreen=function(){return this._bIsFullScreen};X.prototype.toggleFullScreen=function(){this._toggleFullScreen()};X.prototype.preventInvalidation=function(e){this._bPreventInvalidation=e};X.prototype.scrollToElement=function(e){this._scrollToElement(e)};X.prototype.setSearchSuggestionItems=function(e){var t=[];if(e){e.forEach(function(e){t.push({text:e.getText(),icon:e.getIcon(),key:e.getKey(),description:e.getDescription()})})}this._oSuggestionItemsModel.setData({items:t})};X.prototype.destroyAllElements=function(){this.destroyAggregation(U,false);this.destroyAggregation(D,false);this.destroyAggregation($,false)};X.prototype.deselect=function(e){var t=[],i=this.$(),s=function(e){Object.keys(e).forEach(function(i){t.push(e[i]);e[i].setSelected(false)},this)}.bind(this);i.find("."+this.HIGHLIGHT_CLASS).removeClass(this.HIGHLIGHT_CLASS);i.find("."+this.SELECT_CLASS).removeClass(this.SELECT_CLASS);i.find("."+this.VISIBLE_ACTIONS_BUTTONS_CLASS).removeClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS);s(this._mSelectedNodes);s(this._mSelectedLines);this._aShadedNodes.forEach(function(e){e._setNodeOpacity(false)});this._aShadedNodes=[];this.$(this.LINEBUTTONSID).hide();if(!e&&t.length){this.fireSelectionChange({items:t})}return t};X.prototype.getFocus=function(){return this._oFocus};X.prototype.getToolbar=function(){return this._toolbar};X.prototype.getNodeByKey=function(e){if(this._bRequiresDataProcessing){this._processData()}return this._mNodes[e]};X.prototype.setCustomLegendLabel=function(e){var t;if(e.isGroup===true){t=W.Group}else if(e.isLine===true){t=W.Line}else{t=e.isNode===false?W.Line:W.Node}if(e.status){this._oLegendLabels[t+e.status]=e.label;this._createLegend()}};X.prototype.updateLegend=function(){this._createLegend()};X.prototype.zoom=function(e){e=e||{};e.deltaY=e.zoomin!==false?1:-1;if(e.x&&e.y){e.point={x:e.x,y:e.y}}this._zoom(e)};X.prototype.getZoomLevelMilestones=function(){return P};X.prototype.getCurrentZoomLevel=function(){return this._fZoomLevel};X.prototype.setCurrentZoomLevel=function(e){this._fZoomLevel=e;this._zoomLabel.setText(this._getZoomText())};X.prototype.getCorrectMousePosition=function(e){var t=this.$svg.offset(),i=1,s=1;if(this._iWidth!==this.$svg.width()||this._iHeight!==this.$svg.height()){i=this._iWidth/this.$svg.width();s=this._iHeight/this.$svg.height()}return{x:parseInt((e.x-t.left)*i,10),y:parseInt((e.y-t.top)*s,10)}};X.prototype._createTooltip=function(){var e=new a(this.getId()+"-tooltip");this.addDependent(e);e.create(this);e.attachEvent("afterClose",function(){var e=this.getFocus();if(e){this.setFocus(e);if(e.button=="menu"){e.item._setMenuButtonFocus(true)}}}.bind(this));return e};X.prototype.defocus=function(){this.$().find("."+this.FOCUS_CLASS).removeClass(this.FOCUS_CLASS)};X.prototype.setFocus=function(e,t){if(!e&&!this._oFocus||e&&this._oFocus&&e.item===this._oFocus.item&&e.button===this._oFocus.button){if(t){this._updateAccessibility(e)}return}this.defocus();if(this.getFocusDomRef()){this.getFocusDomRef().focus()}if(e){if(e.button){if(e.item instanceof s||e.item instanceof o){e.item._setActionButtonFocus(e.button,true)}else if(e.item instanceof r){if(e.button===r.BUTTONS.MENU){e.item._setMenuButtonFocus(true)}else if(e.button===r.BUTTONS.COLLAPSE){e.item._setCollapseButtonFocus(true)}}}else if(e.item){e.item._setFocus(true);if(e.item instanceof r){e.button=r.BUTTONS.MENU}}}this._oFocus=e;this._ensureOnScreen(e?e.item:null);this._updateAccessibility(e)};X.prototype._updateAccessibility=function(e){var t=function(){this._setAccessibilityTitle(K.getText("NETWORK_GRAPH_ACCESSIBILITY_CONTENT"))}.bind(this),i=function(t){if(t==="Expand/Collapse"){if(e.item.getCollapsed()){return K.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+" "+t+" "+K.getText("NETWORK_GRAPH_EXPANDED")}else{return K.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+" "+t+" "+K.getText("NETWORK_GRAPH_COLLAPSED")}}return K.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+" "+t};if(this.getDomRef("wrapper")){this.getDomRef("wrapper").setAttribute("aria-live","assertive");this._setAriaLabelForWrapper()}if(e){if(e.button){if(e.item instanceof s){if(e.button.title==="Expand/Collapse"){this._setAccessibilityTitle(e.item._getActionButtonTitle(e.button)+" "+e.item._oExpandState)}else{this._setAccessibilityTitle(e.item._getActionButtonTitle(e.button))}}else if(e.item instanceof r){if(e.button===r.BUTTONS.MENU){this._setAccessibilityTitle(i(K.getText("NETWORK_GRAPH_GROUP_DETAIL")))}else if(e.button===r.BUTTONS.COLLAPSE){this._setAccessibilityTitle(i(K.getText("NETWORK_GRAPH_EXPAND_COLLAPSE")))}else{t()}}else{t()}}else if(e.item){this._setAccessibilityTitle(e.item._getAccessibilityLabel())}else{this._setAriaLabelForWrapper(K.getText("NETWORK_GRAPH_ACCESSIBILITY_CONTENT"));this._setAccessibilityTitle(" ")}}else{t()}};X.prototype._setAriaLabelForWrapper=function(e){e=e?e:" ";this.getDomRef("wrapper").setAttribute("aria-label",e)};X.prototype._processProperties=function(){if(this._bNeedNodeProcessing){this._mSelectedNodes={};this._mSelectedLines={};this.getNodes().forEach(function(e){if(e.getSelected()){this._mSelectedNodes[e.getKey()]=e}if(e.getCollapsed()){e.setCollapsed(true)}},this);this.getLines().forEach(function(e){if(e.getSelected()){this._mSelectedLines[e._getLineId()]=e}},this);this._bNeedNodeProcessing=false}};X.prototype._loadData=function(){if(this.getNodes().length>0){if(!this._processData()){return}if(!this._isDelayedLayouting()){setTimeout(this._preprocessData.bind(this),0)}}};X.prototype._preprocessData=function(){this._bIsLayedOut=false;this._bImageLoaded=false;this.fireBeforeLayouting();this._applyLayout().then(this._render.bind(this))};X.prototype._getAllElements=function(){return this.getNodes().concat(this.getGroups())};X.prototype._render=function(){this._beforeRender();this._iRunningLayouts--;if(this._iRunningLayouts>0){return}this._oLastLayout=null;this._createSearchSuggestItems();this._innerRender();this._createLegend();this._processProperties();if(this._fZoomLevel!==1){this.$svg[0].setAttribute("viewBox","0 0 "+this.$svg.width()+" "+this.$svg.height());this.$svg.width(this.$svg.width()*this._fZoomLevel);this.$svg.height(this.$svg.height()*this._fZoomLevel);this.$background.width(this.$svg.width()*this._fZoomLevel);this.$background.height(this.$svg.height()*this._fZoomLevel);if(this._isUseNodeHtml()){var e="scale("+this._fZoomLevel+")";this.$("divnodes").css("transform",e)}this.$("tooltiplayer").css("transform",e);this.$("divgroups").css("transform",e)}this._setLineClasses();if(this._selectElementAfterScroll){this._scrollToElement(this._selectElementAfterScroll);this._selectElementAfterScroll=null}if(this._oFocus&&this._oFocus.button===r.BUTTONS.COLLAPSE){this._oFocus.item._setCollapseButtonFocus(true)}this._bIsLayedOut=true;this._setupEvents();this._setupKeyboardNavigation();this.setFocus(this.getFocus());if(!this.getBackgroundImage()||this._bImageLoaded){this.setBusy(false);this.fireGraphReady()}if(!this._isSwimLane()&&!this._isTwoColumnsLayout()){this.$("innerscroller").addClass(" sapSuiteUiCommonsNetworkGraphInnerScrollerCenter ")}};X.prototype._createDivNodes=function(){var e=sap.ui.getCore().createRenderManager();this.getNodes().forEach(function(t){t._bMainRender=true;e.renderControl(t);t._bMainRender=false});e.flush(this.$divnodes[0]);e.destroy()};X.prototype._innerRender=function(e){var t=function(e){var t="";e.forEach(function(e){t+=e._render();e.bOutput=true});return t};var i=function(){this.$svg.find(".sapSuiteFlickerFreeRect").remove();this._bImageLoaded=true;if(this._bIsLayedOut){this.setBusy(false);this.fireGraphReady()}}.bind(this);var s=function(){var e=sap.ui.getCore().createRenderManager();this.getGroups().forEach(function(t){e.renderControl(t)});e.flush(this.$("divgroups")[0],false,true);e.destroy()}.bind(this);var o=20,r=50,n=function(){var e=0,t=0;var s=function(i,s){if(i>e){e=i}if(s>t){t=s}};this._iWidth=0;this._iHeight=0;this._getAllElements().forEach(function(e){if(!e._isIgnored()){s(e._iWidth+e.getX(),e._iHeight+e.getY())}},this);this.getLines().forEach(function(e){if(!e._isIgnored()){e.getCoordinates().forEach(function(e){s(e.getX(),e.getY())})}},this);if(this.getBackgroundImage()){var n=new Image;n.onload=function(){this._iWidth=Math.max(this._iWidth,n.width);this._iHeight=Math.max(this._iHeight,n.height);this.$svg.width(this._iWidth);this.$svg.height(this._iHeight);this.$background.width(this._iWidth);this.$background.height(this._iHeight);this.$svg.css("background-image","url("+this.getBackgroundImage()+")");this.$svg.css("background-size","cover");i()}.bind(this);n.onerror=function(){T.warning("Unable to load background image.");i()};n.src=this.getBackgroundImage()}this._iWidth=Math.round(e+(this._isTwoColumnsLayout()?0:r));this._iHeight=Math.round(t+o);if(this.getWidth()==="auto"){this.$().width(this._iWidth)}if(this.getHeight()==="auto"){this.$("wrapper").height(this._iHeight)}if(this._isTwoColumnsLayout()){var a=this._$innerscroller.width();if(this._iWidth<a){this._iWidth=a}}this.$svg.width(this._iWidth);this.$svg.height(this._iHeight);this.$background.width(this._iWidth);this.$background.height(this._iHeight);if(this._isUseNodeHtml()){this.$divnodes.width(this._iWidth);this.$divnodes.height(this._iHeight);this.$divnodes.css("opacity",1)}this.$divgroups.width(this._iWidth);this.$divgroups.height(this._iHeight);this.$tooltips.width(this._iWidth);this.$tooltips.height(this._iHeight)}.bind(this);var a=function(e){e.forEach(function(e){e.forEach(function(e){e._afterRendering()})})};var h=this.getNodes(),l=this.getLines();b.start(this.getId(),"Rendering of a network graph");if(!this._isUseNodeHtml()){this.$("sizesvg").remove()}s();this._$innerscroller.append(this._renderSvg(this._isUseNodeHtml()?[]:t(h),t(l)));this.$svg=this.$("networkGraphSvg");this.$background=this.$("background");n();if(this._isUseNodeHtml()){h.forEach(function(e){var t=e.$();if(e._isInCollapsedGroup()){t.hide()}t.css("top",e.getY()+"px");t.css("left",e.getX()+"px")})}a([this._isUseNodeHtml()?[]:h,l]);b.end(this.getId())};X.prototype._renderSvg=function(e,t){var i="",s="sapSuiteUiCommonsNetworkGraphSvg sapSuiteUiCommonsNetworkGraphNoSelect "+(this._fZoomLevel<B?" sapSuiteUiCommonsNetworkGraphZoomedOut ":"");var o=function(e,t,s){i+='<g id="'+this._getDomId(e)+'" class="'+(s||"")+'">';i+=t?t:"";i+="</g>"}.bind(this);i+='<svg id="'+this.getId()+'-networkGraphSvg"';if(this._bIsRtl){i+="direction="+'"rtl"'}i+=' class="'+s+" sapSuiteNetworkGraphSvgMargin ";if(!this._isUseNodeHtml()){i+="sapSuiteNetworkGraphSvgPosition"}i+='" preserveAspectRatio="none" ';i+=">";i+='<g id="'+this.getId()+'-svgbody">';o("lines",t,"sapSuiteUiCommonsNetworkLines");if(!this._isUseNodeHtml()){o("nodes",e,"sapSuiteUiCommonsNetworkNodes")}i+="</g>";if(this.getBackgroundImage()){i+='<rect class="sapSuiteFlickerFreeRect" x="0" y="0" height="100%" width="100%"></rect>'}i+="</svg>";if(this._isUseNodeHtml()){i+='<div id="'+this.getId()+'-background"></div>'}return i};X.prototype._isProperKey=function(e){return e||e==="0"};X.prototype._processData=function(){var e=this._isSwimLane();var t=function(){var t=0,i;this.mGroups={};i=this.getGroups().some(function(i){var s=i.getKey();i._iNestedLevel=0;if(!this._isProperKey(s)){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Group without a proper key [index: "+t+"] found.");return true}i._bIsSwimLane=e;i._resetSize();i._clearChildren();if(this.mGroups[s]){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Group with a duplicit key "+s+" found.");return true}this.mGroups[s]=i;t++;return false},this);return i||this.getGroups().some(function(e){if(e.getParentGroupKey()&&!this.mGroups[e.getParentGroupKey()]){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Group '"+e.getKey()+"' reffers to a nonexistent parent group '"+e.getParentGroupKey()+"'.");return true}return false},this)}.bind(this);var i=function(){var e=0;this._mNodes={};return this.getNodes().some(function(t){if(!this._isProperKey(t.getKey())){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Node without a proper ID [index: "+e+"] found.");return true}var i=t.getGroup(),s;t._oGroup=null;if(i){s=this.mGroups[i];if(s){t._oGroup=s;s.aNodes.push(t)}else{this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Node belonging to a nonexistent group with key "+i+" found.");return true}}this._isUseNodeHtml()?t._resetDimensions():t._setupWidthAndHeight();t._clearChildren();t._rendered=false;if(this._mNodes[t.getKey()]){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Node with a duplicit key "+t.getKey()+" found.");return true}this._mNodes[t.getKey()]=t;e++;return false},this)}.bind(this);var s=function(){return this.getLines().some(function(e,t){var i=this.getNodeByKey(e.getFrom()),s=this.getNodeByKey(e.getTo());if(!i){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Line going from a nonexistent node with key "+e.getFrom()+" found.");return true}if(!s){this._fireFailure(X.FAILURE_TYPE.INCONSISTENT_MODEL,"Line going to a nonexistent node with key "+e.getTo()+" found.");return true}e._rendered=false;e._initialized=false;if(i&&s){i.aChildren.push(s);i.aLines.push(e);s.aParents.push(i);s.aParentLines.push(e);e._oFrom=i;e._oTo=s;e._sKey="line_"+i.getKey()+"-"+s.getKey()+"["+t+"]"}if(i._oGroup){i._oGroup.aLines.push(e);i._oGroup.aChildren.push(s)}if(s._oGroup){s._oGroup.aParentLines.push(e);s._oGroup.aParents.push(i)}return false},this)}.bind(this);var o=function(){this.getGroups().forEach(function(e){var t=e.getParentGroupKey();if(t){var i=this.mGroups[t];if(i){e._oParentGroup=i;i.aChildGroups.push(e)}}}.bind(this));this.getGroups().forEach(function(e){var t=0,i=e._oParentGroup,s=false,o=e;while(i){if(i.getCollapsed()&&!s){e._oCollapsedByParent=i;s=true}o=i;i=i._oParentGroup;t++}e._iNestedLevel=t;e._oTopParentGroup=o})}.bind(this);this._bRequiresDataProcessing=false;if(t()||i()||s()){this._bIsInvalid=true;return false}o();this._oStatuses={};this.getStatuses().forEach(function(e){var t=e.getKey();if(t){this._oStatuses[t]=e}},this);this._bIsInvalid=false;return true};X.prototype._validateLayout=function(){var e,t,i,s="";e=this.getNodes().some(function(e){if(e._isIgnored()){return false}s="Missing coordinates: Node("+e.getKey()+")";return!(e._oGroup&&e._oGroup.getCollapsed()||isFinite(e.getX())&&isFinite(e.getY()))});if(e){this._fireFailure(X.FAILURE_TYPE.LAYOUT_FAILURE,s);return false}if(this._isLayered()){t=this.getGroups().some(function(e){if(e._isIgnored()){return false}s="Missing coordinates: Group("+e.getKey()+")";return!e._isEmpty()&&(!isFinite(e.getX())||!isFinite(e.getY()))});if(t){this._fireFailure(X.FAILURE_TYPE.LAYOUT_FAILURE,s);return false}}i=this.getLines().some(function(e){if(e._isIgnored()){return false}s="Missing coordinates: Line("+e.getKey()+")";return!e._validateLayout()});if(i){this._fireFailure(X.FAILURE_TYPE.LAYOUT_FAILURE,s);return false}return true};X.prototype._suggest=function(e){var t=function(e){e.addCustomData(new _({key:M.IsLastKey,value:"true",writeToDom:true}))};var i=function(e){var t=u.find(e.getCustomData(),function(e){return e.getKey()===M.IsLastKey});if(t){e.removeCustomData(t)}};var s=function(e){var t=u.find(e.getCustomData(),function(e){return e.getKey()===M.TypeKey});return t&&t.getValue()};var o=function(){var e=this._searchField.getSuggestionItems(),o,r,n;for(var a=0;a<e.length;a++){o=e[a];i(o);if(a<e.length-1){r=s(o);n=s(e[a+1]);if(r&&n){if(r===M.Node&&n===M.Line||r===M.Line&&n===M.Group){t(o)}}}}}.bind(this);var r=[],n=this.fireEvent("searchSuggest",{term:e},true);Z=0;if(n){if(e){r=[new m([new m("text",function(t){return(t.toLowerCase()||"").indexOf(e.toLowerCase())>-1}),new m("description",function(t){return(t.toLowerCase()||"").indexOf(e.toLowerCase())>-1})],false)]}this._searchField.getBinding("suggestionItems").filter(r);o()}this._searchField.suggest()};X.prototype._getElementSelectFunctionName=function(e){var t="";if(e instanceof s){t="_selectNode"}if(e instanceof o){t="_selectLine"}if(e instanceof r){t="_selectGroup"}return t};X.prototype._search=function(e,t){var i,s,o;s=this.fireEvent("search",{term:e,key:t},true);if(!s){return}if(e){o=u.find(this.getNodes(),function(i){return t?i.getKey()===t:i.getTitle()===e});if(!o){o=u.find(this.getLines(),function(i){if(i._isLoop()){return false}return t?i._getLineId()===t:i._createSuggestionHelpText()===e})}if(!o){o=u.find(this.getGroups(),function(i){return i.aNodes.length>0&&(t?i.getKey()===t:i.getTitle()===e)})}if(o){i=this._getElementSelectFunctionName(o);if(i){this[i]({element:o,scroll:true,alwaysSelect:true})}}}else{this.deselect(false);this.setFocus(null)}};X.prototype._createToolbar=function(){var e=this;this._toolbar=new c(this.getId()+"-toolbar",{content:[new d]}).addStyleClass("sapSuiteUiCommonsNetworkGraphToolbar");this.addDependent(this._toolbar);this._toolbar.ontouchstart=function(){this.setFocus(null);this.getDomRef("wrapper").setAttribute("aria-live","off");this._setAriaLabelForWrapper(K.getText("NETWORK_GRAPH_ACCESSIBILITY_LABEL"))}.bind(this);this._searchField=new f({layoutData:new y({priority:sap.m.OverflowToolbarPriority.NeverOverflow,shrinkable:true}),enableSuggestions:true,suggest:function(t){e._suggest(t.getParameter("suggestValue"))},search:function(t){var i=t.getParameter("query"),s=t.getParameter("suggestionItem"),o;if(s){o=s.getProperty("key")}e._search(i,o)}}).addStyleClass("sapSuiteUiCommonsNetworkGraphSearchField");this._toolbar.addContent(this._searchField);this._toolbar.addContent(new E({id:this.getId()+"-legendButton",type:F.Transparent,icon:"sap-icon://legend",tooltip:K.getText("NETWORK_GRAPH_LEGEND"),press:function(t){if(e.$legend.is(":visible")){e.$legend.hide()}else{e.$legend.show()}}}));if(this.getEnableZoom()){this._zoomLabel=new g({layoutData:new y({group:1,priority:sap.m.OverflowToolbarPriority.Disappear}),text:"100%"});this._zoomIn=new p({layoutData:new y({group:1}),type:F.Transparent,ariaDescribedBy:[this._zoomLabel],text:K.getText("CHARTCONTAINER_ZOOMIN"),icon:"sap-icon://zoom-in",tooltip:K.getText("CHARTCONTAINER_ZOOMIN"),press:function(t){e._zoom({deltaY:1})}});this._toolbar.addContent(this._zoomIn);this._toolbar.addContent(this._zoomLabel);this._zoomOut=new p({layoutData:new y({group:1}),type:F.Transparent,ariaDescribedBy:[this._zoomLabel],text:K.getText("CHARTCONTAINER_ZOOMOUT"),icon:"sap-icon://zoom-out",tooltip:K.getText("CHARTCONTAINER_ZOOMOUT"),press:function(t){e._zoom({deltaY:-1})}});this._toolbar.addContent(this._zoomOut)}this._toolbar.addContent(new p({type:F.Transparent,icon:"sap-icon://popup-window",tooltip:K.getText("NETWORK_GRAPH_ZOOMTOFIT"),text:K.getText("NETWORK_GRAPH_ZOOMTOFIT"),press:this._fitToScreen.bind(this)}));this._oFullScreenButton=new p({type:F.Transparent,text:K.getText("CALCULATION_BUILDER_ENTER_FULL_SCREEN_BUTTON"),icon:"sap-icon://full-screen",tooltip:K.getText("CALCULATION_BUILDER_ENTER_FULL_SCREEN_BUTTON"),press:this._toggleFullScreen.bind(this)});this._toolbar.addContent(this._oFullScreenButton)};X.prototype._fitToScreen=function(){var e=this.$scroller.height()/this._iHeight,t=this.$scroller.width()/this._iWidth,i=Math.min(e,t),s=P.slice(-1);for(var o=1;o<P.length;o++){if(i<P[o]){s=P[o-1];break}}this._zoom({zoomLevel:s})};X.prototype._getZoomText=function(){return Math.floor(this._fZoomLevel*100)+"%"};X.prototype._toggleFullScreen=function(){if(this._bIsFullScreen==false){this._sControlHeight=this.getHeight();this.setHeight("100%");this._sControlWidth=this.getWidth();this.setWidth("100%")}var e=function(e,t){this._oFullScreenButton.setIcon(e);this._oFullScreenButton.setText(t);this._oFullScreenButton.setTooltip(t)}.bind(this);if(this._bIsFullScreen){e("sap-icon://full-screen",K.getText("CALCULATION_BUILDER_ENTER_FULL_SCREEN_BUTTON"))}else{e("sap-icon://exit-full-screen",K.getText("CALCULATION_BUILDER_EXIT_FULL_SCREEN_BUTTON"))}this._bIsFullScreen=!this._bIsFullScreen;if(!this._oFullScreenUtil){this._oFullScreenUtil=O}this._oFullScreenUtil.toggleFullScreen(this,this._bIsFullScreen,this._oFullScreenButton,this._toggleFullScreen);if(this._bIsFullScreen==false){this.setHeight(this._sControlHeight);this.setWidth(this._sControlWidth)}};X.prototype._setupKeyboardNavigation=function(){var e=[],t=[[]],i,s;if(!this._isLayedOut()){return}this.getNodes().forEach(function(t){if(t.isHidden()||t._isIgnored()||!t.getVisible()){return}e.push({item:t,x:t.getX(),y:t.getY()})});this.getLines().forEach(function(t){if(t.isHidden()||t._isIgnored()||!t.getVisible()||t.getCoordinates().length<2){return}var i=t.getCoordinates()[0],s=i.getX(),o=i.getY();t.getCoordinates().forEach(function(e){if(s>e.getX()){s=e.getX()}if(o>e.getY()){o=e.getY()}});e.push({item:t,x:s,y:o})});this.getGroups().forEach(function(t){if(t.isHidden()||t._isEmpty()||!t.getVisible()){return}e.push({item:t,x:t.getX(),y:t.getY()})});e.sort(function(e,t){if(e.y<t.y){return-1}else if(e.y>t.y){return 1}else if(e.x<t.x){return-1}else if(e.x>t.x){return 1}else{return 0}});if(e.length>0){s=[e[0]];t=[s];i=e[0];e.forEach(function(e,o){if(o===0){return}if(e.y===i.y){s.push(e)}else{s=[e];t.push(s)}i=e})}t=this._normalizeGrid(t,e);if(!this._oKeyboardNavigator){this._oKeyboardNavigator=new L(this);this.addDelegate(this._oKeyboardNavigator)}this._oKeyboardNavigator.setItems(t);this._oKeyboardNavigator.setWrapperDom(this.getFocusDomRef())};X.prototype._normalizeGrid=function(e,t){if(t.length===0){return e}var i=t[0],s=i.x,o=i.x,r=1,n,a,h=[],l;t.forEach(function(e){if(e.x<s){s=e.x}if(e.x>o){o=e.x}});e.forEach(function(e){if(e.length>r){r=e.length}});n=Math.abs(o-s)/r;a=s;for(l=0;l<r;l++){a+=n;h.push(a)}return e.map(function(e){var t,i;if(e.length===r){t=e}else{t=[];i=0;while(i<r-e.length&&h[i]<e[0].x){i++;t.push(null)}e.forEach(function(e){t.push(e);i++});while(i<r){t.push(null);i++}}return t.map(function(e){return e?e.item:null})})};X.prototype.getFocusDomRef=function(){return this.getDomRef("wrapper")};X.prototype._setupEvents=function(){var e=5;var t=0,i={},s=this.$("ctrlalert"),o=this.$scroller;var r=function(e,t){return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2))};var n=function(e){if(e.touches&&e.touches.length===2){i={t1:e.touches[0],t2:e.touches[1],diff:r(e.touches[0],e.touches[1])}}};var a=function(s){if(s.touches&&s.touches.length===2){if(++t===e){var o=s.touches[0],n=s.touches[1],a=r(o,n);this._zoom({point:{x:(o.clientX+n.clientX)/2,y:(o.clientY+n.clientY)/2},deltaY:a-i.diff});t=0;i={t1:o,t2:n,diff:a}}s.preventDefault()}}.bind(this);o.on("mousemove",function(e){this._mouseMove(e.clientX,e.clientY)}.bind(this));var h=this._isSwimLane()?this.$svg:this.$divgroups;h.on("mousedown",function(e){this._mouseDown(e.clientX,e.clientY);e.preventDefault()}.bind(this));o.on("mouseleave",this._endDragging.bind(this));o.on("mouseup",this._mouseUp.bind(this));if(this.getEnableZoom()){o.on("wheel",function(e){if(this._wheel({x:e.originalEvent.clientX,y:e.originalEvent.clientY,deltaY:e.originalEvent.deltaY,div:s,ctrl:e.ctrlKey})){e.preventDefault()}}.bind(this))}o.on("touchstart",function(e){n(e)});o.on("touchmove",function(e){a(e)})};X.prototype._wheel=function(e){if(this.getEnableWheelZoom()||e.ctrl){e.div.css("opacity","0");this._zoom({point:{x:e.x,y:e.y},deltaY:-e.deltaY});this._zoomLabel.setText(this._getZoomText());return true}};X.prototype._endDragging=function(){this._oPanning.dragging=false;this.$scroller.removeClass("sapSuiteUiCommonsNetworkGraphPanning")};X.prototype._mouseMove=function(e,t){var i=this.$scroller[0];if(this._oPanning.dragging){if(!this.$scroller.hasClass("sapSuiteUiCommonsNetworkGraphPanning")){this.$scroller.addClass("sapSuiteUiCommonsNetworkGraphPanning")}i.scrollTop=i.scrollTop-(t-this._oPanning.lastY);i.scrollLeft=i.scrollLeft-(e-this._oPanning.lastX);this._oPanning.lastX=e;this._oPanning.lastY=t}};X.prototype._mouseDown=function(e,t){this.deselect(false);this.setFocus(null);this._oPanning.lastX=e;this._oPanning.lastY=t;this._oPanning.dragging=true;this._tooltip.instantClose()};X.prototype._mouseUp=function(){this._endDragging()};X.prototype._preventZoomToChangeLineWidth=function(){return this._isLayered()&&(this._fZoomLevel>=.5&&this._fZoomLevel<2)};X.prototype._setLineClasses=function(){var e=this.$(),t=this._preventZoomToChangeLineWidth()?"addClass":"removeClass",i=this._fZoomLevel<.5?"removeClass":"addClass";e[t]("sapSuiteUiCommonsNetworkGraphDefaultLineWidth");e[i]("sapSuiteUiCommonsNetworkGraphCrispEdges")};X.prototype._zoom=function(e){var t=this.$svg[0].getAttribute("viewBox"),i=e.deltaY<0?-1:1,s,o,r,n;var a=function(e){var t=0,i;P.forEach(function(s,o){var r=Math.abs(e-s);if(r<i||i===undefined){t=o;i=r}});return t};if(!e.point){e.point={x:this.$scroller.width()/2,y:this.$scroller.height()/2}}s=this.getCorrectMousePosition({x:e.point.x,y:e.point.y});if(e.zoomLevel||e.zoomLevel===0){this._fZoomLevel=e.zoomLevel}else{r=a(this._fZoomLevel);if(P.indexOf(this._fZoomLevel)<0){if(this._fZoomLevel>P[r]){r=i<0?r:r+i}else{r=i>0?r:r+i}}else{r+=i}if(r<0){r=0}else if(r>P.length-1){r=P.length-1}this._fZoomLevel=P[r]}if(this._fZoomLevel<0){this._fZoomLevel=0}if(!t){n="0 0 "+Math.round(this.$svg.width())+" "+Math.round(this.$svg.height());this.$svg[0].setAttribute("viewBox",n)}this.$svg.width(Math.round(this._iWidth*this._fZoomLevel));this.$svg.height(Math.round(this._iHeight*this._fZoomLevel));this.$background.width(Math.round(this._iWidth*this._fZoomLevel));this.$background.height(Math.round(this._iHeight*this._fZoomLevel));o=this.getCorrectMousePosition({x:e.point.x,y:e.point.y});this.$scroller[0].scrollLeft+=(s.x-o.x)*this._fZoomLevel;this.$scroller[0].scrollTop+=(s.y-o.y)*this._fZoomLevel;this._zoomLabel.setText(this._getZoomText());if(this._fZoomLevel<B){this.$svg.addClass("sapSuiteUiCommonsNetworkGraphZoomedOut")}else{this.$svg.removeClass("sapSuiteUiCommonsNetworkGraphZoomedOut")}if(this._isUseNodeHtml()){this.$("divnodes").css("transform","scale("+this._fZoomLevel+")")}this.$("divgroups").css("transform","scale("+this._fZoomLevel+")");this.$tooltips.css("transform","scale("+this._fZoomLevel+")");this._setLineClasses();this.fireEvent("zoomChanged")};X.prototype._createSearchSuggestItems=function(){var e=50;var t={items:[]},i=this.getNodes().sort(function(e,t){return e.getTitle().localeCompare(t.getTitle())}),s=this.getLines().sort(function(e,t){var i=e.getTitle(),s=t.getTitle();if(i===s){return e.getFromNode().getTitle().localeCompare(t.getFromNode().getTitle())}return i.localeCompare(s)}),o=this.getGroups().sort(function(e,t){return e.getTitle().localeCompare(t.getTitle())});this._oSuggestionItemsModel=new h;this._oSuggestionItemsModel.setSizeLimit(H);i.forEach(function(i){var s=u.trimText(i.getTitle(),e);t.items.push({text:s?s:i.getKey(),type:M.Node,icon:i.getIcon(),key:i.getKey(),description:"("+K.getText("NETWORK_GRAPH_NODE")+")"})});s.forEach(function(e){if(e._isLoop()){return}if(e.getTitle()||e.getFromNode().getTitle()||e.getToNode().getTitle()){t.items.push({text:e._createSuggestionHelpText(),type:M.Line,key:e._getLineId(),description:"("+K.getText("NETWORK_GRAPH_LINE")+")"})}});o.forEach(function(i){var s=u.trimText(i.getTitle(),e);if(i.aNodes.length>0){t.items.push({text:s?s:i.getKey(),key:i.getKey(),type:M.Group,description:"("+K.getText("NETWORK_GRAPH_GROUP")+")"})}});this._oSuggestionItemsModel.setData(t);this._searchField.setModel(this._oSuggestionItemsModel);this._searchField.bindAggregation("suggestionItems",{path:"/items",template:new z({text:"{text}",icon:"{icon}",key:"{key}",description:"{description}",customData:new _({key:"type",value:"{type}"})})})};X.prototype._scrollToElement=function(e){var t=e._oGroup&&e._oGroup.getCollapsed(),i,s,r,n,a,h;if(t){e=e._oGroup}if(e instanceof o){a=e.getSource();h=e.getTarget();r=Math.abs(h.getX()-a.getX());n=Math.abs(h.getY()-a.getY());i=Math.min(a.getX(),h.getX());s=Math.max(a.getY(),h.getY())}else{i=e.getX();s=e.getY();r=e._iWidth;n=e._iHeight}this.$scroller.get(0).scrollLeft=(i+(r?r:0)/2)*this._fZoomLevel-this.$scroller.width()/2;this.$scroller.get(0).scrollTop=(s+(n?n:0)/2)*this._fZoomLevel-this.$scroller.height()/2};X.prototype._ensureOnScreen=function(e){if(!e||!this.$scroller){return}var t,i,n,a=this.$scroller[0],h=a.scrollLeft/this._fZoomLevel,l=a.scrollTop/this._fZoomLevel,u=h+this.$scroller.width()/this._fZoomLevel,g=l+this.$scroller.height()/this._fZoomLevel;if(!e._isOnScreen(h,u,l,g)){if(e instanceof s){i=e.getX()+e._iWidth/2;n=e.getY()+e._iHeight/2}else if(e instanceof o){t=e._getArrowFragmentVector();i=(t.center.x+t.apex.x)/2;n=(t.center.y+t.apex.y)/2}else if(e instanceof r){i=e.getX();n=e.getY()}if(i<h||i>u){a.scrollLeft=i*this._fZoomLevel-this.$scroller.width()/2}if(n<l||n>g){a.scrollTop=n*this._fZoomLevel-this.$scroller.height()/2}}};X.prototype._createLegend=function(){var e=this.$("legend"),t="",i=this,s={},o={},r={};var n=function(e,t){var i=S(e.getStatus());if(i){if(t[i]){t[i].push(e)}else{t[i]=[e]}}};var a=function(e){return Object.keys(e).length>0};var h=function(e,i,s){var o=this._oStatuses[e],r=o&&o._getLegendColor(),n=r?"background-color:"+r:"";t+=this._renderControl("div",{status:e,elementtype:s,class:"sapSuiteUiCommonsNetworkGraphLegendLine"},false);t+=this._renderControl("div",{class:"sapSuiteUiCommonsNetworkGraphLegendColorLine "+this._getStatusClass(e),style:n});t+=this._renderControl("label",{class:"sapSuiteUiCommonsNetworkGraphLegendLineLabel"},false);t+=S(this._oLegendLabels[s+e]?this._oLegendLabels[s+e]:i);t+="</label>";t+="</div>"}.bind(this);var l=function(e,i,s,o,r){e.forEach(function(e){n(e,i)});if(a(i)){t+='<div class="'+s+'"><label class="sapSuiteUiCommonsNetworkGraphLegendTitle">'+S(K.getText(o))+"</label></div>";var l=Object.keys(i).reduce(function(e,t){var i;if(this._oLegendLabels[r+t]){i=this._oLegendLabels[r+t]}else{var s=this._oStatuses[t];i=s?s.getTitle()||t:K.getText("NETWORK_GRAPH_"+t.toUpperCase())}e[t]=i;return e}.bind(this),{});Object.keys(i).sort(function(e,t){return(l[e]||"").localeCompare(l[t])}).forEach(function(e){h(e,l[e],r)})}}.bind(this);if(this.getLegend()){return}if(!e[0]){return}l(this.getNodes(),s,"sapSuiteUiCommonsNetworkGraphLegendTitleNode","NETWORK_GRAPH_NODES",W.Node);l(this.getLines(),o,"sapSuiteUiCommonsNetworkGraphLegendTitleLine","NETWORK_GRAPH_LINES",W.Line);l(this.getGroups(),r,"sapSuiteUiCommonsNetworkGraphLegendTitleLine","NETWORK_GRAPH_GROUPS",W.Group);e.html(t);if(sap.ui.getCore().byId(this.getId()+"-legendButton").getPressed()){this.getDomRef("legend").style.display="block"}this.$().find(".sapSuiteUiCommonsNetworkGraphLegendLine").on("click",function(e){var t=jQuery(this).attr("status"),r=jQuery(this).attr("elementtype"),n;if(r===W.Node){n=s}if(r===W.Line){n=o}if(!e.ctrlKey){i.deselect(false);i.setFocus(null)}if(r!==W.Group&&n[t]){n[t].forEach(function(e){e.setSelected(true)})}})};X.prototype._selectElement=function(e){var t=e.element&&!e.element.getSelected(),i=[];var s=function(t){e.element.setSelected(t);if(e.setFocus!==false){this.setFocus({item:e.element})}}.bind(this);this.$("svg").find("."+this.VISIBLE_ACTIONS_BUTTONS_CLASS).removeClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS);if(!e.preventDeselect){i=this.deselect(true);if(e.setFocus){this.setFocus(null)}if(t||e.alwaysSelect){s(true)}}else{s(t)}if(!e.element._hasFocus()&&e.forceFocus){this.setFocus({item:e.element})}if(!i.some(function(t){return t===e.element})){i.push(e.element)}this.fireSelectionChange({items:i})};X.prototype._selectLine=function(e){var t=e.element.getFromNode(),i=e.element.getToNode(),s=t._isInCollapsedGroup()&&t._oGroup===i._oGroup?i._oGroup:null;if(e.scroll){this._scrollToElement(s||e.element)}if(!s){this._selectElement(e)}};X.prototype._selectNode=function(e){var t=e.element._isInCollapsedGroup()?e.element._oGroup:null;if(e.scroll){this._scrollToElement(t||e.element)}if(!t){this._selectElement(e);if(e.renderActionButtons!==false){e.element.showActionButtons(true)}}};X.prototype._selectGroup=function(e){if(e.scroll){this._scrollToElement(e.element)}this.setFocus({item:e.element})};X.prototype._applyLayout=function(){var e;this._iRunningLayouts++;e=this._getLayoutAlgorithm().layout().catch(function(e){this._fireFailure(X.FAILURE_TYPE.LAYOUT_FAILURE,e);return Promise.reject()}.bind(this)).then(function(){return new Promise(function(t,i){if(e.isTerminated()){t();return}if(this._validateLayout()){t()}else{i()}}.bind(this))}.bind(this));if(this._oLastLayout&&this._iRunningLayouts>1){this._oLastLayout.terminate()}this._oLastLayout=e;return e};X.prototype._setAccessibilityTitle=function(e){var t,i=this.$("accessibility");if(e===null){t=K.getText("NETWORK_GRAPH_ACCESSIBILITY_CONTENT")}else if(typeof e==="string"){t=e}else{t=e._getAccessibilityLabel()}if(i){i.html(S(t))}};X.prototype._isTopBottom=function(){return this.getOrientation()===R.TopBottom||this.getOrientation()===R.BottomTop};X.prototype._getLayoutAlgorithm=function(){return this.getLayoutAlgorithm()||this._getDefalutLayout()};X.prototype._isUseNodeHtml=function(){return this.getRenderType()===x.Html};X.prototype._getDefalutLayout=function(){if(!this._oDefalutLayout){this._oDefaultLayout=new n;this._oDefaultLayout.setParent(this,null,true)}return this._oDefaultLayout};X.prototype._isLayered=function(){var e=this._getLayoutAlgorithm().getLayoutRenderType();return e===G.SwimLanes||e===G.LayeredWithGroups||e===G.TwoColumns};X.prototype._isSwimLane=function(){return this._getLayoutAlgorithm().getLayoutRenderType()===G.SwimLanes};X.prototype._isTwoColumnsLayout=function(){return this._getLayoutAlgorithm().getLayoutRenderType()===G.TwoColumns};X.prototype._isDelayedLayouting=function(){if(this._isUseNodeHtml()){return true}return this.getNodes().some(function(e){var t=e.hasListeners("computeSizes");return t||e._useAutomaticSize()||e.getTitleLineSize()!==1||e._displayDescription()})};X.prototype._isLayedOut=function(){return this._bIsLayedOut};X.prototype.setEnableZoom=function(e){if(this._toolbar){this._zoomLabel.setVisible(e);this._zoomIn.setVisible(e);this._zoomOut.setVisible(e)}this.setProperty("enableZoom",e);return this};X.prototype.setDisableToolbarButtons=function(e){this._toolbar.setEnabled(e);return this};X.prototype.destroyAggregation=function(e,i){this._bRequiresDataProcessing=true;t.prototype.destroyAggregation.call(this,e,i)};X.prototype.insertAggregation=function(e,i,s,o){this._bRequiresDataProcessing=true;t.prototype.insertAggregation.call(this,e,i,s,o)};X.prototype.removeAggregation=function(e,i,s){this._bRequiresDataProcessing=true;t.prototype.removeAggregation.call(this,e,i,s)};X.prototype.addAggregation=function(e,i,s){this._bRequiresDataProcessing=true;t.prototype.addAggregation.call(this,e,i,s)};X.prototype.removeAllAggregation=function(e,i){this._bRequiresDataProcessing=true;t.prototype.removeAllAggregation.call(this,e,i)};X.prototype.updateAggregation=function(e){this._bNeedNodeProcessing=true;t.prototype.updateAggregation.call(this,e)};X.prototype.invalidate=function(){if(this._bPreventInvalidation!==true){t.prototype.invalidate.call(this)}};return X});
//# sourceMappingURL=Graph.js.map