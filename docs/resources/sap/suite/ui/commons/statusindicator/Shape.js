/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery","../library","sap/ui/core/Control","sap/suite/ui/commons/util/HtmlElement","sap/suite/ui/commons/statusindicator/util/ThemingUtil","sap/base/Log"],function(jQuery,t,i,e,n,r){"use strict";var o=t.statusindicator.FillingType;var l=t.statusindicator.FillingDirectionType;var a=t.statusindicator.VerticalAlignmentType;var s=t.statusindicator.HorizontalAlignmentType;var u=i.extend("sap.suite.ui.commons.statusindicator.Shape",{metadata:{abstract:true,library:"sap.suite.ui.commons",properties:{fullAnimationDuration:{type:"int",defaultValue:0},fillColor:{type:"sap.m.ValueCSSColor",defaultValue:"Neutral"},animationOnStartup:{type:"boolean",defaultValue:false},animationOnChange:{type:"boolean",defaultValue:true},animationOnStartupDelay:{type:"int",defaultValue:0},fillingDirection:{type:"sap.suite.ui.commons.statusindicator.FillingDirectionType",defaultValue:l.Up},fillingType:{type:"sap.suite.ui.commons.statusindicator.FillingType",defaultValue:o.Linear},fillingAngle:{type:"int",defaultValue:undefined},verticalAlignment:{type:"sap.suite.ui.commons.statusindicator.VerticalAlignmentType",defaultValue:a.Middle},horizontalAlignment:{type:"sap.suite.ui.commons.statusindicator.HorizontalAlignmentType",defaultValue:s.Middle}}},renderer:null});u.prototype.GRADIENT_ID="gradient";u.prototype.STOP_ID="stop";u.prototype.getDisplayedValue=function(){r.fatal("Must be overridden!")};u.prototype._setInitialValue=function(t){r.fatal("Must be overridden!")};u.prototype._updateDom=function(t,i){r.fatal("Must be overridden!")};u.prototype.init=function(){if(i.prototype.init){i.prototype.init.apply(this,arguments)}this._oAnimationPropertiesResolver=null};u.prototype.onBeforeRendering=function(){if(i.prototype.onBeforeRendering){i.prototype.onBeforeRendering.apply(this,arguments)}this._clearBoundingBox()};u.prototype._getCssFillColor=function(){return n.resolveColor(this.getFillColor())};u.prototype._resolveFillColor=function(){return this._oAnimationPropertiesResolver.getColor(this,this.getDisplayedValue())};u.prototype._injectAnimationPropertiesResolver=function(t){this._oAnimationPropertiesResolver=t};u.prototype.getDisplayedFillColor=function(t){return this._oAnimationPropertiesResolver.getColor(this,t)};u.prototype.getFullAnimationDuration=function(){return 250};u.prototype._buildPreserveAspectRatioAttribute=function(){var t="x";switch(this.getHorizontalAlignment()){case s.Left:t+="Min";break;case s.Middle:t+="Mid";break;case s.Right:t+="Max";break}t+="Y";switch(this.getVerticalAlignment()){case a.Top:t+="Min";break;case a.Middle:t+="Mid";break;case a.Bottom:t+="Max";break}t+=" meet";return t};u.prototype._getGradientElement=function(t){var i=new e(this.getFillingType()===o.Linear?"linearGradient":"radialGradient");i.setId(this._buildIdString(this.getId(),this.GRADIENT_ID));if(this.getFillingType()===o.Linear){var n=this.computeLinearFillingAngle();i.setAttribute("x1",n===90?1:0);i.setAttribute("y1",n===0?1:0);i.setAttribute("x2",n===270?1:0);i.setAttribute("y2",n===180?1:0)}var r=this._getDisplayedGradientOffset(t);var l=new e(this.STOP_ID);l.setAttribute("offset",r);l.setAttribute("stop-color","white");i.addChild(l);var a=new e(this.STOP_ID);a.setAttribute("offset",r);a.setAttribute("stop-color","transparent");i.addChild(a);return i};u.prototype.getPolygonElement=function(t){var i=new e("polygon");i.setId(this._buildIdString(this.getId(),"polygon"));i.setAttribute("fill","white");return i};u.prototype.computeLinearFillingAngle=function(){if(this.getFillingAngle()!==undefined){return this._getNormalizedFillingAngle()}switch(this.getFillingDirection()){case l.Up:return 0;case l.Down:return 180;case l.Left:return 90;case l.Right:return 270;default:r.error("Unknown FillingDirection '"+this.getFillingDirection()+"'");return 0}};u.prototype._useGradientForAnimation=function(){var t=this._getNormalizedFillingAngle();var i=this.getFillingType();return i===o.Radial||i===o.Linear&&(t===undefined||[0,90,180,270].indexOf(t)>-1)};u.prototype._getPolygonPoints=function(t){var i;switch(this.getFillingType()){case o.Linear:i=this._getPolygonPointsForLinearFilling(t);break;case o.Circular:i=this._getPolygonPointsForCircularFilling(t);break;default:r.error("Unknown FillingType '"+this.getFillingType()+"' given.");i=this._getPolygonPointsForLinearFilling(t)}i=i.map(function(t){t.x=Number(t.x.toFixed(3));t.y=Number(t.y.toFixed(3));return t});return i};u.prototype._getPolygonPointsForLinearFilling=function(t){var i=180-this._getNormalizedFillingAngle();var e=Math.tan(i*Math.PI/180);var n=this._getBoundingPoints();var r=n.start;var o=n.end;var l=r.y-e*r.x;var a=o.y-e*o.x;var s=l+(a-l)/100*t;var u=r.x;var g=u*e+s;var p=r.y;var d=(p-s)/e;var h=[r,{x:u,y:g},{x:d,y:p}];return h};u.prototype._getPolygonPointsForCircularFilling=function(t){var i=this,e=3.6*t,n=this._getBoundingBox(),r=[];var o,a,s;var u=g(n.x+n.width/2,n.y);var p=g(n.x+n.width/2,n.y+n.height/2);function d(t){var e=Object.assign({},t);if(i.getFillingDirection()===l.CounterClockwise){var n=t.x-p.x;e.x=p.x-n}return e}function h(t,i,e){var n=Math.tan((i-t)*Math.PI/180);return n*e/2}r.push(u);if(0<e&&e<45){o=h(e,0,n.height);s=g(u.x-o,u.y);r.push(d(s))}if(45<=e){r.push(d(g(n.x+n.width,n.y)))}if(45<e&&e<135){a=h(e,90,n.width);s=g(n.x+n.width,n.y+n.height/2-a);r.push(d(s))}if(135<=e){r.push(d(g(n.x+n.width,n.y+n.height)))}if(135<e&&e<225){o=h(e,180,n.height);s=g(n.x+n.width/2+o,n.y+n.height);r.push(d(s))}if(225<=e){r.push(d(g(n.x,n.y+n.height)))}if(225<e&&e<315){a=h(e,270,n.width);s=g(n.x,n.y+n.height/2+a);r.push(d(s))}if(315<=e){r.push(d(g(n.x,n.y)))}if(315<e&&e<=360){o=h(e,360,n.height);s=g(n.x+n.width/2-o,n.y);r.push(d(s))}r.push(p);return r};u.prototype._isFillingAngleInFirstQuadrant=function(){var t=this._getNormalizedFillingAngle();return 0<t&&t<90};u.prototype._isFillingAngleInSecondQuadrant=function(){var t=this._getNormalizedFillingAngle();return 90<t&&t<180};u.prototype._isFillingAngleInThirdQuadrant=function(){var t=this._getNormalizedFillingAngle();return 180<t&&t<270};u.prototype._isFillingAngleInForthQuadrant=function(){var t=this._getNormalizedFillingAngle();return 270<t&&t<360};u.prototype._getBoundingPoints=function(){var t=this._getBoundingBox();var i=t.x+t.width;var e=t.y+t.height;var n=t.x;var o=t.y;if(this._isFillingAngleInFirstQuadrant()){}else if(this._isFillingAngleInSecondQuadrant()){i=t.x+t.width;e=t.y;n=t.x;o=t.y+t.height}else if(this._isFillingAngleInThirdQuadrant()){i=t.x;e=t.y;n=t.x+t.width;o=t.y+t.height}else if(this._isFillingAngleInForthQuadrant()){i=t.x;e=t.y+t.height;n=t.x+t.width;o=t.y}else{r.error("Invalid call of _getBoundingPoints. FillingAngle '"+this.getFillingAngle()+"' is not in any quadrant")}return{start:g(i,e),end:g(n,o)}};u.prototype._getBoundingBox=function(){if(!this._oBoundingBox){this._oBoundingBox=this.$()[0].getBBox()}return this._oBoundingBox};u.prototype._clearBoundingBox=function(){this._oBoundingBox=null};u.prototype._getNormalizedFillingAngle=function(){if(this.getFillingAngle()===undefined){return this.getFillingAngle()}var t=this.getFillingAngle()%360;if(t<0){t+=360}return t};u.prototype.isFillable=function(){return this.getFillingType()!==o.None};u.prototype._getDisplayedGradientOffset=function(t){if(this.isFillable()){var i=t/100;return i}else{return 1}};u.prototype._getMaskElement=function(t){var i=new e("mask");i.setId(t);if(this._useGradientForAnimation()){var n=this._getSimpleShapeElement(this._buildIdString(this.getId(),"mask-shape"));n.setAttribute("stroke-width",0);n.setAttribute("stroke","white");n.setAttribute("fill",this._buildSvgUrlString(this.getId(),this.GRADIENT_ID));i.addChild(n)}else{i.addChild(this.getPolygonElement(this._iDisplayedValue))}return i};u.prototype._buildSvgUrlString=function(){return"url(#"+this._buildIdString.apply(this,arguments)+")"};u.prototype._buildIdString=function(){var t=jQuery.makeArray(arguments).join("-");return t};function g(t,i){return{x:t,y:i}}return u});
//# sourceMappingURL=Shape.js.map