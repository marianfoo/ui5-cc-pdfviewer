// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["jquery.sap.global","sap/suite/ui/commons/UnifiedThingInspector","sap/ui/core/format/NumberFormat","sap/viz/ui5/data/FlattenedDataset","sap/ui/core/Locale","sap/ui/model/type/DateTime","sap/ui/model/type/Time","sap/ui/model/type/Date","sap/ui/model/type/Float","sap/ui/model/type/Integer","sap/ui/model/json/JSONModel","sap/ui/core/Control","sap/m/Image","sap/m/Link","sap/m/Text","sap/ui/core/library","sap/ui/layout/VerticalLayout","sap/m/Label","sap/ui/layout/form/SimpleForm","sap/suite/ui/commons/UnifiedThingGroup","sap/ui/ux3/ThingGroup","sap/ui/core/HTML","sap/m/Column","sap/m/ColumnListItem","sap/m/library","sap/m/Table","sap/m/Page","sap/m/VBox","sap/m/Input","sap/m/List","sap/m/StandardListItem","sap/ui/model/FilterOperator","sap/m/DateTimeInput","sap/ui/model/Filter","sap/m/ViewSettingsItem","sap/m/ViewSettingsCustomItem","sap/ui/core/CustomData","sap/m/ViewSettingsDialog","sap/ui/model/Sorter","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/Button","sap/viz/ui5/Area","sap/viz/ui5/Bar","sap/viz/ui5/Bubble","sap/viz/ui5/Column","sap/viz/ui5/StackedColumn","sap/viz/ui5/StackedColumn100","sap/viz/ui5/Donut","sap/viz/ui5/Heatmap","sap/viz/ui5/HorizontalArea","sap/viz/ui5/Line","sap/viz/ui5/Pie","sap/viz/ui5/Scatter","sap/viz/ui5/Treemap","sap/viz/ui5/types/Title","sap/suite/ui/commons/KpiTile","sap/ui/model/odata/ODataModel","sap/suite/ui/commons/FacetOverview","sap/suite/ui/commons/library","sap/ui/layout/Grid","sap/ui/vbm/VBI","sap/ui/layout/HorizontalLayout","sap/ui/core/Icon","sap/m/Carousel","sap/ui/core/IconPool","sap/ushell/resources","sap/ushell/ui/footerbar/AddBookmarkButton","sap/suite/ui/commons/LinkActionSheet","sap/ushell/services/AppConfiguration","sap/m/ActionSheet","sap/ushell/ui/footerbar/JamDiscussButton","sap/ushell/ui/footerbar/JamShareButton"],function(e,t,a,n,i,s,r,o,l,c,f,p,d,u,g,m,h,y,T,b,v,S,P,C,I,w,x,E,U,A,O,F,V,L,D,N,k,B,M,_,H,R,j,Q,G,z,W,K,$,J,X,q,Y,Z,ee,te,ae,ne,ie,se,re,oe,le,ce,fe,pe,de,ue,ge,me,he,ye,Te){"use strict";var be=I.URLHelper;var ve=I.PlacementType;var Se=se.FacetOverviewHeight;var Pe=I.DateTimeInputType;var Ce=I.ListMode;var Ie=I.ListSeparators;var we=I.BackgroundDesign;var xe=I.ListType;var Ee=m.TextAlign;var Ue={},Ae=[],Oe={},Fe={},Ve="displayFactSheet",Le,De;Le=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();if(sap.ui.getCore().getConfiguration().getLanguage()==="ZH"){Le=new i("zh_CN")}function Ne(e){return e<0}function ke(e){var t=Number(e).toFixed(0);if(Ne(e)){t=Number(t)*-1}return t}function Be(e,t){var n,i,s,r;if(!e){return""}i=new RegExp(a.oDefaultFloatFormat.groupingSeparator,"g");if(t>=0){t=parseInt(t,10);r=a.getFloatInstance({minFractionDigits:t,maxFractionDigits:t},Le)}else{r=a.getFloatInstance({minFractionDigits:0,maxFractionDigits:99},Le)}n=r.format(e);s=n.replace(/[\D]/g,"");if(s&&s.length>6){e=e.replace(i,"");if(ke(e)<1e3){return a.getIntegerInstance().format(e)}r=a.getFloatInstance({minFractionDigits:1,maxFractionDigits:1,style:"short"},Le);return r.format(e)}return n}function Me(){var t="",a,n,i,s,r,o,l,c,f,p,d;r=this.getElementBinding().sPath.split("/")[1];o=this.getModel();l=this.mBindingInfos.value.parameters;c=this.mBindingInfos.value.parts;for(a=0;a<l.length;a+=1){t=t+l[a].string}for(n=0;n<c.length;n+=1){i=c[n].path;p="{"+i+"}";s=o.oData[r][i];t=t.replace(p,s)}f=Ze(t);if(e.isNumeric(f)){d=this.mBindingInfos.value.parts.filter(function(e){return e.path===i});f=Be(f,d[0].type.oFormatOptions.maxFractionDigits);this.setDoubleFontSize(true)}this.setValue(f);this.getElementBinding().detachChange(Me)}var _e=function(){var e="";if(De.getName()&&De.getDescription()){e=De.getName()+", "+De.getDescription()}else if(De.getName()&&!De.getDescription()){e=De.getName()}else if(!De.getName()&&De.getDescription()){e=De.getDescription()}return e};var He=function(e){var t,a,n;t=e.slice(1).split("/");a="/";for(n=0;n<t.length;n+=1){if(t[n].indexOf("(")>0&&t[n].indexOf("sid(")<0){break}else{a+=t[n]+"/"}}return a};var Re=function(e,t){var a,n,i,s;n=e.slice(t.sServiceUrl.length+1);if(n.indexOf("/")>=0){i=n.split("/");s=i[i.length];a=i[i.length-1];if(a.indexOf("(")>=0){a=a.slice(a.indexOf("("))}a=this.getNavEntitySet(a,s,t.getMetadata())}else if(n.indexOf("(")>=0){a=n.slice(0,n.indexOf("("))}else if(n.indexOf("?")>=0){a=n.slice(0,n.indexOf("?"))}else{a=n}return a};var je=function(e,t){var a,n="",i,s;a=e.slice(t.sServiceUrl.length+1);if(a.indexOf("(")>=0){n=a.slice(a.indexOf("(")+1,a.indexOf(")"));if(n.indexOf("=")<=0){i=t.getServiceMetadata();s=ze(Re(e,t),i);n=Qe(s,i)+"="+n}}return n};var Qe=function(e,t){var a,n,i;for(a=t.dataServices.schema.length-1;a>=0;a-=1){i=t.dataServices.schema[a];if(i.namespace===e.slice(0,e.lastIndexOf("."))){for(n=0;n<i.entityType.length;n+=1){if(i.entityType[n].name===e.slice(e.lastIndexOf(".")+1)){return i.entityType[n].key.propertyRef[0].name}}}}};var Ge=function(e,t){var a,n,i,s;for(a=t.dataServices.schema.length-1;a>=0;a-=1){i=t.dataServices.schema[a];if(i.entityContainer){s=i.entityContainer[0].entitySet;for(n=s.length-1;n>=0;n-=1){if(s[n].entityType===e){return s[n].name}}}}};var ze=function(e,t,a){var n,i,s,r,o;for(n=t.dataServices.schema.length-1;n>=0;n-=1){s=t.dataServices.schema[n];if(s.entityContainer){r=s.entityContainer[0].entitySet;for(i=r.length-1;i>=0;i-=1){if(r[i].name===e){if(a){o=r[i].entityType.slice(s.namespace.length+1)}else{o=r[i].entityType}return o}}}}};var We=function(e,t,a){var n,i,s,r,o,l,c;r=e.split(".");for(n=a.dataServices.schema.length-1;n>=0;n-=1){o=a.dataServices.schema[n];l=r[0];if(r.length>2){for(s=1;s<r.length-1;s+=1){l+="."+r[s]}}if(o.namespace===l){for(i=0;i<o.entityType.length;i+=1){if(o.entityType[i].name===r[r.length-1]){if(o.entityType[i].navigationProperty){for(s=0;s<o.entityType[i].navigationProperty.length;s+=1){if(o.entityType[i].navigationProperty[s].name===t){c=o.entityType[i].navigationProperty[s];return{name:c.relationship,toRole:c.toRole}}}}}}}}};var Ke=function(e,t,a){var n,i,s,r,o,l,c,f;n=ze(e,a);if(t.charAt(0)==="@"){if(Ue.termDefinitions&&Ue.termDefinitions[t]){i=Ue.termDefinitions[t];if(i.indexOf("Collection")>=0){i=i.slice(i.indexOf("(")+1,i.indexOf(")"))}return Ge(i,a)}}else{s=We(n,t,a);if(s){for(r=a.dataServices.schema.length-1;r>=0;r-=1){o=a.dataServices.schema[r];if(o.entityContainer&&o.entityContainer[0].associationSet){for(l=o.entityContainer[0].associationSet.length-1;l>=0;l-=1){c=o.entityContainer[0].associationSet[l];if(c.association===s.name){for(f=0;f<c.end.length;f+=1){if(c.end[f].role===s.toRole){return c.end[f].entitySet}}}}}}}}};var $e=function(e,t,a){var n,i,s,r,o,l,c,f,p;r=ze(e,a);f=r.split(".")[r.split(".").length-1];o=We(r,t,a);if(o){for(n=a.dataServices.schema.length-1;n>=0;n-=1){l=a.dataServices.schema[n];for(i=0;i<l.entityType.length&&!p;i+=1){if(l.entityType[i].name===f){for(s=0;s<l.entityType[i].navigationProperty.length;s+=1){if(l.entityType[i].navigationProperty[s].name===t){p=l.entityType[i].navigationProperty[s].toRole;break}}}}for(i=l.association.length-1;i>=0;i-=1){c=l.association[i];if(l.namespace+"."+c.name===o.name){for(s=0;s<c.end.length;s+=1){if(c.end[s].role===p){return c.end[s].multiplicity}}}}}}else{jQuery.sap.log.error('"'+t+"\" wasn't found in the metadata document. Check whether the corresponding search connector is active.");return 0}};var Je=function(e,t){var a,n,i,s;a={};if(Ue.expand){if(Ue.expand[ze(e,t)]){n=Ue.expand[ze(e,t)];i=[];for(s in n){if(n.hasOwnProperty(s)){i.push(n[s])}}a.expand=i.join(", ")}}return a};var Xe=function(e,t,a){var n,i,s,r,o,l;for(n=a.dataServices.schema.length-1;n>=0;n-=1){i=a.dataServices.schema[n];for(s=0;s<i.entityType.length;s+=1){if(i.entityType[s].name===t.split(".")[t.split(".").length-1]){for(r=0;r<i.entityType[s].navigationProperty.length;r+=1){if(i.entityType[s].navigationProperty[r].name===e){for(o=0;o<i.association.length;o+=1){for(l=i.association[o].end.length-1;l>=0;l-=1){if(i.association[o].end[l].role===i.entityType[s].navigationProperty[r].toRole){return i.association[o].end[l].type}}}}}}}}};var qe=function(e,t){var a={},n;a.parts=[];a.parameters=[];for(n=e.length-1;n>=0;n-=1){if(e[n].Type==="Path"){if(e[n].EdmType){switch(e[n].EdmType){case"Edm.DateTimeOffset":case"Edm.DateTime":a.parts.push({path:e[n].Value,type:new s({UTC:true})});break;case"Edm.Time":a.parts.push({path:e[n].Value+"/ms",type:new r({source:{pattern:"timestamp"},UTC:true})});break;case"Edm.Date":a.parts.push({path:e[n].Value,type:new o({UTC:true})});break;case"Edm.Decimal":case"Edm.Double":case"Edm.Single":a.parts.push({path:e[n].Value,type:new l});break;case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":a.parts.push({path:e[n].Value,type:new c});break;default:a.parts.push({path:e[n].Value});break}}else{a.parts.push({path:e[n].Value})}}else if(e[n].Type==="String"){a.parameters.unshift({string:e[n].Value})}}a.formatter=function(){var a="",n,i,s,r,o="",l=false,c=0,f=0;if(arguments&&arguments.length>=1){n=arguments.length-1;s="";r=0;if(e&&e[0]&&e[0].Type==="String"&&e[0].Value.substr(0,1)==="#"){l=true}for(i=0;i<e.length;i+=1){if(e[i].Type==="Path"){s=arguments[n];if(!s||s.length===0){if(a.length>r){if(a.indexOf("(")>r){a=a.substr(0,r)}else{a=a.substr(0,r);s=a}}}else{if(l){s=encodeURIComponent(s)}a+=s;c+=1}n-=1;r=a.length}else{r=a.length;o=e[i].Value;if(o.indexOf("(")!==-1){f+=1}if(s&&s.length>0||o.indexOf("(")!==-1||o&&o.substr(0,1)==="#"){a+=e[i].Value}else{o=""}}}if(t){a=t(a)}a=a.trim();if(c===1&&f>0&&a.substr(0,1)==="("&&a.substr(-1)===")"){a=a.substr(1,a.length-2)}return a.trim()}};return a};var Ye=function(e,t){var a;for(a in e){if(e.hasOwnProperty(a)){if(a==="__metadata"){continue}else if(a===t){return e[a]}else if(typeof e[a]==="object"){return Ye(e[a],t)}}}};var Ze=function(e){var t,a,n,i={},s;t=e.lastIndexOf("/");a=e.slice(0,t);n=e.slice(t+1);if(!Fe[e]){i=new f;i.loadData(a,null,false);Fe[e]=i.getData()}else{i=Fe[e]}if(Fe[e]&&Fe[e].d){if(!Fe[e].d[n]){s=Ye(Fe[e].d,n)}else{s=Fe[e].d[n]}}return s};var et=function(e,t,a,n){var i,s,r,o,l,c,f,m;i=new p;s=at(e.Value,e.EdmType,t);if(e.Value&&e.Value["com.sap.vocabularies.UI.v1.IsImageURL"]){i=new d({height:"50px"});if(s.BindingInfo){i.bindProperty("src",s.BindingInfo)}else{i.setProperty("src",s.String)}}else{if(e.UrlRef||e.Url||e.Target&&e.Target.Path){i=new u({wrapping:true})}else{i=new g;if(e.EdmType==="Edm.Decimal"||e.EdmType==="Edm.Double"||e.EdmType==="Edm.Single"||e.EdmType==="Edm.Int16"||e.EdmType==="Edm.Int32"||e.EdmType==="Edm.Int64"){i.setTextAlign(Ee.End)}}i.addStyleClass("sapFactsheetUtiDataField");if(s.BindingInfo){i.bindProperty("text",s.BindingInfo)}else{i.setProperty("text",s.String)}}if(e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithNavigation"&&a){r=e.Target.Path;if(Ue[t][r.slice(1)]){if(r.charAt(0)==="@"){if(r.indexOf("/")<0){o=Ue[t][r.slice(1)].UrlRef}else{o=Ue[t][r.slice(1,r.indexOf("/"))].UrlRef}i.bindProperty("href",nt(o))}}i.attachPress(function(e){return false})}if(e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){if(e.Url.String){i.setHref(e.Url.String)}else{i.bindProperty("href",nt(e.Url));l=new g({wrapping:true});if(s.BindingInfo){l.bindProperty("text",jQuery.extend({},s.BindingInfo))}else{l.setProperty("text",s.String)}i.setVisible(false);c=new h;c.addContent(i);c.addContent(l);if(!Ae[Ae.indexOf(n)].Links){Ae[Ae.indexOf(n)].Links=[]}if(e.Url.Apply){f=e.Url.Apply.Parameters[0].Value.slice(e.Url.Apply.Parameters[0].Value.indexOf("#")+1,e.Url.Apply.Parameters[0].Value.indexOf("-"));m=e.Url.Apply.Parameters[0].Value.slice(e.Url.Apply.Parameters[0].Value.indexOf("#")+1,e.Url.Apply.Parameters[0].Value.indexOf("?"))}Ae[Ae.indexOf(n)].Links.push({sSemanticObject:f,sIntend:m,oVL:c})}}if(c){return c}return i};var tt=function(e,t,a,n){var i,s="",r="",o,l,c,f;i=new y(t);i.addStyleClass("sapFactsheetUtiLabel");if(n){s=":"}if(e.Label){if(e.Label.String){i.setText(e.Label.String.trim()+s);i.setTooltip(e.Label.String.trim())}else if(e.Label.Path){i.bindProperty("text",e.Label.Path);i.bindProperty("tooltip",e.Label.Path)}}else if(e.Value){if(e.Value.Path&&a){o=a[e.Value.Path];for(l in o){if(o.hasOwnProperty(l)){if(l==="http://www.sap.com/Protocols/SAPData"){if(o[l].label){r=o[l].label;break}}}}}else if(e.Value.Apply&&e.Value.Apply.Name==="odata.concat"){for(c in e.Value.Apply.Parameters){if(e.Value.Apply.Parameters.hasOwnProperty(c)){f=e.Value.Apply.Parameters[c];if(f.Type==="Path"){o=a[f.Value];for(l in o){if(o.hasOwnProperty(l)){if(l==="http://www.sap.com/Protocols/SAPData"){if(o[l].label){r=o[l].label;break}}}}break}}}}i.setText(r+s);i.setTooltip(r)}return i};var at=function(t,a,n){var i={},f=[],p=[],d=[],u,g,m,h,y,T,b,v,S,P,C,I;var w=function(e,t,a){var n,i={};n=Ue.propertyAnnotations[e];if(n&&n[t]&&n[t][a]){if(n[t][a].Path){i.Type="Path";i.Value=n[t][a].Path}else{i.Type="String";i.Value=n[t][a].String}}return i};if(!t){return false}if(t.Apply){if(t.Apply.Name==="odata.concat"){if(n&&Ue.propertyAnnotations&&Ue.propertyAnnotations[n]){h=t.Apply.Parameters;for(g=0;g<h.length;g+=1){f.push(h[g]);if(h[g].Type==="Path"){m=w(n,h[g].Value,"Org.OData.Measures.V1.ISOCurrency");if(!e.isEmptyObject(m)){f.push({Type:"String",Value:" "});f.push({Type:m.Type,Value:m.Value})}m=w(n,h[g].Value,"Org.OData.Measures.V1.Unit");if(!e.isEmptyObject(m)){f.push({Type:"String",Value:" "});f.push({Type:m.Type,Value:m.Value})}}}i.BindingInfo=qe(f)}else{i.BindingInfo=qe(t.Apply.Parameters)}}}else if(t.Path){if(t.Path.charAt(0)==="@"){y=Ue[n][t.Path.slice(1,t.Path.indexOf("/"))].UrlRef;T=t.Path.slice(t.Path.indexOf("/")+1);if(y&&y.Apply){b=y.Apply.Parameters;switch(y.Apply.Name){case"odata.concat":p=b;p.push({Type:"String",Value:"/"+T});break;case"odata.fillUriTemplate":v=b[0].Value.split("{");for(u in v){if(v.hasOwnProperty(u)){if(v[u].indexOf("}")<0){p.push({Type:"String",Value:v[u]})}else{S=v[u].split("}");for(g=1;g<b.length;g+=1){if(b[g].Name===S[0]){P=b[g].Value;if(P.Path){p.push({Type:"Path",Value:P.Path})}else if(P.Apply&&P.Apply.Name&&P.Apply.Name.toLowerCase()==="odata.uriencode"){C=P.Apply.Parameters[0];p.push({Type:C.Type,Value:encodeURIComponent(C.Value)});p.push({Type:"String",Value:"{"+encodeURIComponent(C.Value)+"}"})}}}p.push({Type:"String",Value:S[1]})}}}p.push({Type:"String",Value:"/"+T});i.fnChange=Me;break;default:break}i.BindingInfo=qe(p,Ze)}else if(y&&y.Path){p.push({Type:"Path",Value:y.Path},{Type:"String",Value:"/"+T});i.BindingInfo=qe(p,Ze)}else if(y&&y.String){i.String=Ze(y.String+"/"+T)}}else{i.BindingInfo={};switch(a){case"Edm.DateTimeOffset":case"Edm.DateTime":i.BindingInfo={path:t.Path,type:new s({UTC:true})};break;case"Edm.Time":i.BindingInfo={path:t.Path+"/ms",type:new r({source:{pattern:"timestamp"},UTC:true})};break;case"Edm.Date":i.BindingInfo={path:t.Path,type:new o({UTC:true})};break;case"Edm.Decimal":case"Edm.Double":case"Edm.Single":case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":if(a==="Edm.Decimal"||a==="Edm.Double"||a==="Edm.Single"){I=new l}else if(a==="Edm.Int16"||a==="Edm.Int32"||a==="Edm.Int64"){I=new c}if(Ue.propertyAnnotations){d.push({Type:"Path",Value:t.Path,EdmType:a},{Type:"String",Value:" "});m=w(n,t.Path,"Org.OData.Measures.V1.ISOCurrency");if(!e.isEmptyObject(m)){d.push({Type:m.Type,Value:m.Value})}m=w(n,t.Path,"Org.OData.Measures.V1.Unit");if(!e.isEmptyObject(m)){d.push({Type:m.Type,Value:m.Value})}i.BindingInfo=qe(d)}else{i.BindingInfo={path:t.Path,type:I}}break;default:i.BindingInfo={path:t.Path};break}}}else if(t.String){i.String=t.String}return i};var nt=function(e){var t=[],a,n,i,s,r={},o,l,c;if(e&&e.Apply){a=e.Apply.Parameters;switch(e.Apply.Name){case"odata.fillUriTemplate":a[0].Value=a[0].Value.trim();n=a[0].Value.split("{");for(i=0;i<n.length;i+=1){if(n[i].indexOf("}")<0){t.push({Value:n[i],Type:"String"})}else{s=n[i].split("}");r={};r.Value=s[0];r.Type="Path";for(i=1;i<a.length;i+=1){if(a[i].Name===r.Value){o=a[i].Value;if(o.Path){r.Value=o.Path}else if(o.Apply&&o.Apply.Name&&o.Apply.Name.toLowerCase()==="odata.uriencode"){r.Value=o.Apply.Parameters[0].Value}break}}t.push(r);t.push({Value:s[1],Type:"String"})}}l=sap.ushell.Container.getService("NavTargetResolution").getCurrentResolution();if(l&&l.url){c=jQuery.sap.getUriParameters(l.url).get("sap-system");if(c){t.push({Type:"String",Value:"&sap-system="+c})}}break;default:break}}return qe(t)};var it=function(e){var t=Ee.Begin;if(e.EdmType==="Edm.Decimal"||e.EdmType==="Edm.Double"||e.EdmType==="Edm.Single"||e.EdmType==="Edm.Int16"||e.EdmType==="Edm.Int32"||e.EdmType==="Edm.Int64"){t=Ee.End}return t};var st=function(e,t,a,n,i,s){var r,o=0,l=0,c=0,f=0,d,u,g,m,h,y;if(!i){i=e.getServiceMetadata()}if(!a){a=[]}d=ze(t,i);y=new T({labelMinWidth:150,maxContainerCols:2});u=Ue.propertyExtensions?Ue.propertyExtensions[d]:[];if(n&&n.High){l=n.High}if(n&&n.Medium){c=n.Medium}if(n&&n.Low){f=n.Low}for(r=0;r<a.length;r+=1){g=dt(a[r]);if(n&&g==="High"){if(l){l-=1}else{continue}}else if(n&&g==="Medium"){if(c){c-=1}else{continue}}else if(n&&g==="Low"){if(f){f-=1}else{continue}}if(n&&n.Total&&o>=n.Total){break}o+=1;m=(new p).setModel(e);h=tt(a[r],{textAlign:Ee.End},u,false);h.addStyleClass("sapFactsheetUtiFormPadding");m=et(a[r],d,i,s);m.addStyleClass("sapFactsheetUtiFormPadding");if(m.setTextAlign){m.setTextAlign(Ee.Begin)}y.addContent(h);y.addContent(m)}y.addStyleClass("sapFactsheetUtiFormLayout");return y};var rt=function(e,t,a,n,i){var s="",r=[],o,l,c,f,p,d,u,g,m,y,T,S,P,C,I;l=e.getServiceMetadata();switch(a.RecordType){case"com.sap.vocabularies.UI.v1.ReferenceFacet":c=new b;if(a.Label&&a.Label.String){c.setTitle(a.Label.String)}f=a.Target.AnnotationPath;p=f.substring(f.lastIndexOf("@")+1);f=f.substring(0,f.lastIndexOf("@")-1);if(f){s=$e(t,f,l)}d=p.split("#");switch(d[0]){case"com.sap.vocabularies.UI.v1.LineItem":case"com.sap.vocabularies.UI.v1.Chart":case"com.sap.vocabularies.UI.v1.Badge":case"com.sap.vocabularies.UI.v1.Identification":if(f){u=Ke(t,f,l);P=ze(u,l)}else{P=ze(t,l)}if(d[0]==="com.sap.vocabularies.UI.v1.Chart"){p="com.sap.vocabularies.UI.v1.LineItem"}C=Ue[P][p];if(Ue.propertyExtensions){I=Ue.propertyExtensions[P]}if(s==="*"&&d[0]!=="com.sap.vocabularies.UI.v1.Identification"){g=lt(e,C,P,l,n+"/"+f,a,I,i);c.setContent(g)}if(d[0]==="com.sap.vocabularies.UI.v1.Identification"){m=Ue[P]["com.sap.vocabularies.UI.v1.Identification"];y=new h({width:"100%"}).setModel(e);if(f){y.addContent(st(e,u,m,null,null,i)).addStyleClass("sapFactsheetUtiPanel");y.bindElement(n+"/"+f)}else{y.addContent(st(e,t,m,null,null,i).addStyleClass("sapFactsheetUtiPanel"))}c.setContent(y)}break;case"com.sap.vocabularies.UI.v1.StatusInfo":if(f){u=Ke(t,f,l);T=Ue[ze(u,l)]["com.sap.vocabularies.UI.v1.StatusInfo"];c.setContent(st(e,u,T,null,null,i).addStyleClass("sapFactsheetUtiPanel").bindElement(n+"/"+f))}else{T=Ue[ze(t,l)]["com.sap.vocabularies.UI.v1.StatusInfo"];c.setContent(st(e,t,T,null,null,i).addStyleClass("sapFactsheetUtiPanel"))}break;case"com.sap.vocabularies.UI.v1.FieldGroup":S=Ue[ze(t,l)][p];if(S){if(!c.getTitle()||c.getTitle()===""){if(S.Label){if(S.Label.String){c.setTitle(S.Label.String)}else if(S.Label.Path){c.bindProperty("title",S.Label.Path)}}}if(f){u=Ke(t,f,l);c.setContent(st(e,u,S.Data,null,null,i).addStyleClass("sapFactsheetUtiPanel").bindElement(n+"/"+f))}else{c.setContent(st(e,t,S.Data,null,null,i).addStyleClass("sapFactsheetUtiPanel"))}}break;default:break}return c;case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":c=new v({title:a.Label.String});c.setContent(ot(a));return c;case"com.sap.vocabularies.UI.v1.CollectionFacet":for(o=0;o<a.Facets.length;o+=1){r.push(rt(e,t,a.Facets[o],n,i))}return r;default:break}};var ot=function(e){var t,a,n;switch(e.UrlContentType.String){case"image/png":case"image/jpeg":case"image/gif":t=new d({width:"100%"});if(e.Url.String){t.setSrc(e.Url.String)}return t;default:a=new S;if(e.Url.String){a.setContent("<iframe src = '"+e.Url.String+"' width='100%' height='250px' frameborder='0'></iframe>")}else if(e.Url.Path){a.bindProperty("content",{path:e.Url.Path,formatter:function(){n="<iframe src = '"+e.Url.Path+"' width='100%' height='250px' frameborder='0'></iframe>";return n}})}return a}};var lt=function(e,t,a,n,i,r,o,l){var c=[],f=[],d=[],u=[],m=[],h=[],T=false,v,S,I,j,Q,G,z,W,K,$,J,X,q,Y,Z,ee,te,ae,ne,ie,se;ne=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");if(!n){n=e.getServiceMetadata()}I=Ue.propertyExtensions?Ue.propertyExtensions[a]:[];j=6;if(jQuery.device.is.tablet&&jQuery.device.is.landscape){j=5}else if(jQuery.device.is.tablet&&jQuery.device.is.portrait){j=4}else if(jQuery.device.is.phone&&jQuery.device.is.landscape){j=3}else if(jQuery.device.is.phone&&jQuery.device.is.portrait){j=2}Q=0;G=0;for(v=0;v<t.length;v+=1){z=dt(t[v]);if(z==="High"){Q+=1}}if(j>Q){G=j-Q}else if(j<Q){Q=j}u.push(new P({visible:false}));d.push((new g).bindText("__metadata/uri"));for(v=0;v<t.length;v+=1){se="";$=new p;z=dt(t[v]);$=et(t[v],a,n,l);W=tt(t[v],null,I);if(t[v].Value.Path){ee=t[v].Value.Path;if(o&&o[ee]&&o[ee]["http://www.sap.com/Protocols/SAPData"]&&o[ee]["http://www.sap.com/Protocols/SAPData"].sortable){W.data("IsSortable",o[ee]["http://www.sap.com/Protocols/SAPData"].sortable);if(o[ee]["http://www.sap.com/Protocols/SAPData"].sortable==="true"){T=true}}else{W.data("IsSortable","true");T=true}if(o&&o[ee]&&o[ee]["http://www.sap.com/Protocols/SAPData"]&&o[ee]["http://www.sap.com/Protocols/SAPData"].filterable){W.data("IsFilterable",o[ee]["http://www.sap.com/Protocols/SAPData"].filterable);if(o[ee]["http://www.sap.com/Protocols/SAPData"].filterable==="true"){T=true}}else{W.data("IsFilterable","true");T=true}}else{ie=true;for(S=0;S<t[v].Value.Apply.Parameters.length;S+=1){if(t[v].Value.Apply.Parameters[S].Type==="Path"){ee=t[v].Value.Apply.Parameters[S].Value;if(o[ee]&&o[ee]["http://www.sap.com/Protocols/SAPData"]&&o[ee]["http://www.sap.com/Protocols/SAPData"].sortable){if(o[ee]["http://www.sap.com/Protocols/SAPData"].sortable==="false"){ie=false;se="";break}}if(se){se+=";"}se+=ee}}ee=se;if(ie===false){W.data("IsSortable","false")}else{W.data("IsSortable","true");T=true}W.data("IsFilterable","false")}if(t[v].EdmType){W.data("EdmType",t[v].EdmType)}W.data("ColumnName",ee);c.push(W);f.push($);if(z==="High"){if(Q>0){K=true;Q-=1}else{K=false}}else if(z==="Medium"){if(G>0){K=true;G-=1}else{K=false}}else{K=false}u.push(new P({header:W,hAlign:it(t[v]),visible:K}));d.push($)}J=new C({type:xe.Navigation,unread:false,cells:d});if(r){X=r.Label.String}J.attachPress({aColumns:t,aLabels:c,aControls:f,sTitle:X},function(e,a){var n,i,s,r,o,p,d;i=e.getSource().getCells()[0].getText().substr(e.getSource().getCells()[0].getText().lastIndexOf("/"));s=new w({backgroundDesign:we.Transparent,showSeparators:Ie.None,columns:[new P({hAlign:Ee.End}),new P]});s.addStyleClass("sapFactsheetUtiPanel");s.addStyleClass("sapFactsheetUtiTilePadding");s.addStyleClass("sapFactsheetUtiTableNoTopBorder");s.bindElement(i);for(n=0;n<t.length;n+=1){r=c[n].clone();r.setText(r.getText()+":");d=f[n].clone();r.setLabelFor(d);s.addItem(new C({cells:[r,d]}))}o=new b({content:s,title:X,description:_e()});p=new x({title:De.getTitle(),showNavButton:true,content:[o]});De.navigateToPage(p,true);De.attachAfterNavigate(s,function(e){if(e.getParameters().getParameters().toId.indexOf("__page")>=0){var t;t=s.getItems();if(t.length>0&&Ae.indexOf(l)>=0){Ae[Ae.indexOf(l)].bLoaded=true;Ae[Ae.indexOf(l)].bProcessed=false;Ae[Ae.indexOf(l)].bIsTable=true;Ae[Ae.indexOf(l)].oTableItems=t;ht(Ae.indexOf(l))}}})});q=new w({growing:true,columns:u});q.setModel(e);q.bindItems({path:i,template:J});var re=new E({items:[new U({placeholder:ne.getText("USHELL_FACTSHEET_ENTER_YOUR_FILTER"),change:function(e){var t,a,n,i,s;t=e.getSource().getParent().getParent().getId();a=sap.ui.getCore().byId(t.substr(0,t.indexOf("-")));n=a.getFilterItems();for(s=0;s<n.length;s+=1){if(n[s]instanceof N&&n[s].getKey()===this.oParent.data("ColumnName")){i=n[s];break}}if(i){if(e.getParameter("newValue")===undefined||e.getParameter("newValue")===""){i.setSelected(false);i.setFilterCount(0)}else{i.setSelected(true);i.setFilterCount(1)}}}}).addStyleClass("sapFactsheetUtiFilterInput")]});var oe=new E({items:[new A({mode:Ce.SingleSelectLeft,includeItemInSelection:true,items:[new O({title:ne.getText("USHELL_FACTSHEET_GREATER_THEN")}).data("FilterOperator",F.GT),new O({title:ne.getText("USHELL_FACTSHEET_EQUALS")}).data("FilterOperator",F.EQ),new O({title:ne.getText("USHELL_FACTSHEET_LESS_THEN")}).data("FilterOperator",F.LT)]}),new U({placeholder:ne.getText("USHELL_FACTSHEET_ENTER_YOUR_FILTER"),change:function(e){var t,a,n,i,s;t=e.getSource().getParent().getParent().getId();a=sap.ui.getCore().byId(t.substr(0,t.indexOf("-")));n=a.getFilterItems();for(s=0;s<n.length;s+=1){if(n[s]instanceof N&&n[s].getKey()===this.oParent.data("ColumnName")){i=n[s];break}}if(i){if(e.getParameter("newValue")===undefined||e.getParameter("newValue")===""){i.setSelected(false);i.setFilterCount(0)}else{i.setSelected(true);i.setFilterCount(1)}}}}).addStyleClass("sapFactsheetUtiFilterInput")]});new E({items:[new A({mode:Ce.SingleSelectLeft,includeItemInSelection:true,items:[new O({title:ne.getText("USHELL_FACTSHEET_AFTER")}).data("FilterOperator",F.GT),new O({title:ne.getText("USHELL_FACTSHEET_AT")}).data("FilterOperator",F.EQ),new O({title:ne.getText("USHELL_FACTSHEET_BEFORE")}).data("FilterOperator",F.LT)]}),new V({type:Pe.Date,valueFormat:new s({pattern:"yyyy/MM/dd HH:mm:ss UTC+00:00"}).getOutputPattern(),placeholder:ne.getText("USHELL_FACTSHEET_ENTER_YOUR_FILTER"),change:function(e){var t,a,n,i,s;t=e.getSource().getParent().getParent().getId();a=sap.ui.getCore().byId(t.substr(0,t.indexOf("-")));n=a.getFilterItems();for(s=0;s<n.length;s+=1){if(n[s]instanceof N&&n[s].getKey()===this.oParent.data("ColumnName")){i=n[s];break}}if(e.getParameter("newValue")===undefined||e.getParameter("newValue")===""){i.setSelected(false);i.setFilterCount(0)}else{i.setSelected(true);i.setFilterCount(1)}}}).addStyleClass("sapFactsheetUtiFilterInput")]});var le=function(e){var t=[],a=e.getItems(),n,i,s;if(a[0].getParent().data("EdmType")==="Edm.String"&&a[0].getValue()){t.push(new L(a[0].getParent().data("ColumnName"),F.Contains,a[0].getValue()))}else if(a[0].getParent().data("EdmType")==="Edm.Decimal"&&a[1].getValue()){for(n=0;n<a[0].getItems().length;n+=1){if(a[0].getItems()[n].getSelected()===true){i=a[0].getItems()[n].data("FilterOperator");break}}s=a[1].getValue();for(n=s.length-1;n>0;n-=1){if(s[n]===","){s=s.replace(s[n],".");break}}t.push(new L(a[1].getParent().data("ColumnName"),i,s))}else if(a[0].getParent().data("EdmType")==="Edm.Date"&&a[1].getValue()){for(n=0;n<a[0].getItems().length;n+=1){if(a[0].getItems()[n].getSelected()===true){i=a[0].getItems()[n].data("FilterOperator");break}}t.push(new L(a[1].getParent().data("ColumnName"),i,a[1].getValue()))}else{t.push(new L(a[0].getParent().data("ColumnName"),F.EQ,a[0].getValue()))}return t};var ce=function(e){var t=e.getSource(),a=t.getFilterItems(),n,i,s;for(n=0;n<a.length;n+=1){if(a[n]&&a[n]instanceof N){a[n].setSelected(false);a[n].setFilterCount(0);s=a[n].getCustomControl().getItems();for(i=0;i<s.length;i+=1){if(s[i]instanceof U||s[i]instanceof V){s[i].setValue("")}if(s[i]instanceof A&&s[i].getSelectedItem()!==null){s[i].removeSelections()}}}}};var fe=ce;for(v=0;v<u.length;v+=1){if(u[v+1]){W=c[v].clone();if(W.getText()&&W.data("IsSortable")==="true"&&u[v+1].getVisible()){Y=new D({text:W.getText(),key:W.data("ColumnName")});if(v===0){Y.setSelected(true)}Y.Sort=W.Sort;m.push(Y)}if(W.getText()&&W.data("IsFilterable")==="true"){if(W.data("EdmType")==="Edm.String"){ae=re.clone().data("ColumnName",W.data("ColumnName")).data("EdmType",W.data("EdmType"))}else if(W.data("EdmType")==="Edm.Decimal"){ae=oe.clone().data("ColumnName",W.data("ColumnName")).data("EdmType",W.data("EdmType"))}if(W.data("EdmType")==="Edm.String"||W.data("EdmType")==="Edm.Decimal"){te=new N({key:W.data("ColumnName"),text:W.getText(),customControl:ae,customData:new k({key:"callback",value:le})});h.push(te)}}}}Z=new B({sortItems:m,filterItems:h,cancel:fe,resetFilters:ce,confirm:function(e){var t=[],a=[],n=[],i=[],s,r,o,l,c,f,p;o=e.getParameters();l=q.getBinding("items");if(o.sortItem){c=o.sortItem.getKey();f=o.sortDescending;if(c.indexOf(";")>0){a=c.split(";");for(s=0;s<a.length;s+=1){t.push(new M(a[s],f))}}else if(c){t.push(new M(c,f))}l.sort(t)}r=o;for(s=0;s<r.filterItems.length;s+=1){if(r.filterItems[s]instanceof N){p=r.filterItems[s].getCustomData()[0].getValue();n=p.apply(this,[r.filterItems[s].getCustomControl()]);if(n){if(!Array.isArray(n)){n=[n]}i=i.concat(n)}}else if(r.filterItems[s]instanceof D){n=r.filterItems[s].getCustomData()[0].getValue();if(n){if(!Array.isArray(n)){n=[n]}i=i.concat(n)}}}l.filter(i)}});if(T===true&&(m.length>0||h.length>0)){q.setHeaderToolbar(new _({content:[new y,new H,new R({icon:"sap-icon://drop-down-list",press:function(){Z.open()},tooltip:sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("P13NDIALOG_VIEW_SETTINGS")})]}))}q.setNoDataText(sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("PULL2REFRESH_LOADING_LONG"));var pe=function(e){return function(t){var a=this.getItems();if(a.length===0){this.setNoDataText(ne.getText("FACETOVERVIEW_NO_CONTENT_TEXT"))}else{this.setNoDataText(sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("PULL2REFRESH_LOADING_LONG"))}if(a.length>0&&Ae.indexOf(e)>=0){Ae[Ae.indexOf(e)].bLoaded=true;Ae[Ae.indexOf(e)].bProcessed=false;Ae[Ae.indexOf(e)].bIsTable=true;Ae[Ae.indexOf(e)].oTableItems=a}ht(Ae.indexOf(e))}}(l);q.attachUpdateFinished(pe);return q};var ct=function(e,t,a,n){var i;switch(e){case"com.sap.vocabularies.UI.v1.ChartType/Area":i=new j({});break;case"com.sap.vocabularies.UI.v1.ChartType/Bar":i=new Q({});break;case"com.sap.vocabularies.UI.v1.ChartType/Bubble":i=new G({});break;case"com.sap.vocabularies.UI.v1.ChartType/Column":i=new z({});break;case"com.sap.vocabularies.UI.v1.ChartType/ColumnStacked":i=new W({});break;case"com.sap.vocabularies.UI.v1.ChartType/ColumnStacked100":i=new K({});break;case"com.sap.vocabularies.UI.v1.ChartType/Donut":i=new $({});break;case"com.sap.vocabularies.UI.v1.ChartType/HeatMap":i=new J({});break;case"com.sap.vocabularies.UI.v1.ChartType/HorizontalArea":i=new X({});break;case"com.sap.vocabularies.UI.v1.ChartType/Line":i=new q({});break;case"com.sap.vocabularies.UI.v1.ChartType/Pie":i=new Y({});break;case"com.sap.vocabularies.UI.v1.ChartType/Scatter":i=new Z({});break;case"com.sap.vocabularies.UI.v1.ChartType/TreeMap":i=new ee({});break;case"com.sap.vocabularies.UI.v1.ChartType/AreaStacked":case"com.sap.vocabularies.UI.v1.ChartType/AreaStacked100":case"com.sap.vocabularies.UI.v1.ChartType/BarStacked":case"com.sap.vocabularies.UI.v1.ChartType/BarStacked100":case"com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked":case"com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked100":case"com.sap.vocabularies.UI.v1.ChartType/Radar":case"com.sap.vocabularies.UI.v1.ChartType/Waterfall":break}if(i){if(t&&t.String){i.setTitle(new te({visible:true,text:t.String}))}if(a&&a.String){i.setTooltip(a.String)}i.setWidth("100%");i.setHeight("17rem");i.setDataset(n)}else{i=new g({})}return i};var ft=function(e){var t;e=e||1;if(jQuery.device.is.phone){t=7*e+"rem"}else{t=11*e-1+"rem"}return t};var pt=function(e){var t=0,a=0,n=0,i,s;for(i=0;i<e.length;i+=1){s=dt(e[i]);if(s){switch(s){case"High":t+=1;break;case"Medium":a+=1;break;case"Low":n+=1;break}}}return{High:t,Medium:a,Low:n}};var dt=function(e){var t="";if(e.Importance){t=e.Importance.EnumMember}else if(e["com.sap.vocabularies.UI.v1.Importance"]){t=e["com.sap.vocabularies.UI.v1.Importance"].EnumMember}return t.substr(t.indexOf("/")+1)};var ut=function(t,a,n,i){var s=false,r,o,l,c;r=new ae({doubleFontSize:false});if(a.ValueFormat){o=a.ValueFormat.NumberOfFractionalDigits.Int}if(a.Title&&a.Title.String){r.setDescription(a.Title.String)}else if(a.Title&&a.Title.Path){r.bindProperty("description",{path:a.Title.Path})}if(a.Value&&a.Value.String){r.setValue(a.Value.String)}else if(a.Value&&a.Value.Path){l=at(a.Value,a.Value.EdmType,n);if(l.fnChange){r.setModel(t);r.bindElement(i);r.getElementBinding().attachChange(l.fnChange,r)}if(l.String){if(e.isNumeric(l.String)){s=true;r.setValue(Be(l.String,o))}else{r.setValue(l.String)}}else if(l.BindingInfo){c=l.BindingInfo;if(c.parts&&c.parts.length===2){r.bindProperty("valueUnit",c.parts[0]);c.parts[1].type=undefined;c.parts[1].formatter=function(){return function(e){return Be(e,o)}}(o);r.bindProperty("value",c.parts[1])}else if(c.parts&&c.parts.length===1){c.parts[0].type=undefined;c.parts[0].formatter=function(){return function(e){return Be(e,o)}}(o);r.bindProperty("value",c)}else{r.bindProperty("value",c)}}}if(a.Value.EdmType==="Edm.Decimal"||a.Value.EdmType==="Edm.Double"||a.Value.EdmType==="Edm.Single"||a.Value.EdmType==="Edm.Int16"||a.Value.EdmType==="Edm.Int32"||a.Value.EdmType==="Edm.Int64"||s===true){r.setDoubleFontSize(true)}return r};var gt=function(e){var t=[],a=[],n,i,s;var r=function(e){if(o(e)===false){if(Array.isArray(e)){for(i=0;i<e.length;i+=1){o(e[i])}}else if(typeof e==="object"){for(s in e){if(e.hasOwnProperty(s)){if(e[s].constructor!==String){r(e[s])}}}}}};var o=function(e){if(e.RecordType&&e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){if(e.Url&&e.Url.Apply){n=e.Url.Apply.Parameters[0].Value.slice(e.Url.Apply.Parameters[0].Value.indexOf("#")+1,e.Url.Apply.Parameters[0].Value.indexOf("-"));if(t.indexOf(n)<0){t.push(n)}return true}}else{return false}};for(s in Ue){if(Ue.hasOwnProperty(s)){if(s.indexOf(e.dataServices.schema[0].namespace)>=0){r(Ue[s])}}}for(i=0;i<t.length;i+=1){if(!Oe.hasOwnProperty(t[i])){a.push(t[i])}}return a};var mt=function(e){var t,a,n,i;if(e.length>0){a=new f;n="/sap/opu/odata/UI2/INTEROP/SemanticObjects?$expand=Links&$format=json";i="&$filter=id%20eq%20%27";for(t=0;t<e.length;t+=1){if(i.length>22){i+="%20or%20id%20eq%20%27"+e[t]+"%27"}else{i+=e[t]+"%27"}}n+=n+i;a.loadData(n);a.attachRequestCompleted(function(){var e=[],t,a,n;if(this.getData().d&&this.getData().d.results){n=this.getData().d.results;for(t=0;t<n.length;t+=1){Oe[n[t].id]="";e=n[t].Links.results;for(a=0;a<e.length;a+=1){Oe[e[a].id.slice(0,e[a].id.indexOf("~"))]=""}}}Oe.InteropCompleted=true;ht()})}else{Oe.InteropCompleted=true}};var ht=function(e){var t,a,n,i,s,r,o;if(Oe.InteropCompleted===true){for(t=0;t<Ae.length;t+=1){if(Ae[t].bLoaded&&!Ae[t].bProcessed&&Ae[t].Links){o=Ae[t].Links;for(a=0;a<o.length;a+=1){if(Oe.hasOwnProperty(o[a].sIntend)===true){if(Ae[t].bIsTable===true){if(Ae[t].oTableItems){s=Ae[t].oTableItems;for(n=0;n<s.length;n+=1){r=s[n].getCells();for(i=0;i<r.length;i+=1){if(r[i]instanceof h&&r[i].getContent()[0].getBindingInfo("href").parts===o[a].oVL.getContent()[0].getBindingInfo("href").parts&&r[i].getContent()[1].getBindingInfo("text").parts===o[a].oVL.getContent()[1].getBindingInfo("text").parts){r[i].getContent()[0].setVisible(true);r[i].getContent()[1].setVisible(false)}}}}}else{o[a].oVL.getContent()[0].setVisible(true);o[a].oVL.getContent()[1].setVisible(false)}}else if(Ae[t].bIsTable===false){o[a].oVL.getContent()[1].setText(o[a].oVL.getContent()[0].getText())}Ae[t].bProcessed=true}}}}if(e>=0){if(Ae[e].bLoaded&&!Ae[e].bProcessed&&Ae[e].Links){o=Ae[e].Links;for(a=0;a<o.length;a+=1){if(Ae[e].bIsTable===false){o[a].oVL.getContent()[1].setText(o[a].oVL.getContent()[0].getText())}}}}};var yt=function(t,a,i){var s={},r=[],o=0,l=0,c=0,p,m,T,v,x,E,U,A,O,F,V,L,N,k,j,Q,G,z,W,K,$,J,X,q,Y,Z,ee,te,ae,se,Pe,Ce,Ie,we,xe,Fe,Le,De,Ne,ke,Be,Me,Qe,Ge,We,qe,Ye;T=He(t);z=a.substring(0,a.substring(0,a.lastIndexOf("/")).lastIndexOf("/"));W=a.substring(a.substring(0,a.lastIndexOf("/")).lastIndexOf("/"));if(window.location.search.indexOf("cbn_keep_anno_case%3Dtrue")===-1){W=W.toLowerCase()}v=new ne(T,{annotationURI:z+W,loadAnnotationsJoined:true,loadMetadataAsync:false,json:true});v.setCountSupported(false);i.setModel(v);x=Re(t,v);E="/"+t.slice(T.length);U=v.getServiceMetadata();Ue=v.getServiceAnnotations();A=ze(x,U);O=Ue[A]["com.sap.vocabularies.UI.v1.HeaderInfo"];F=Ue[A]["com.sap.vocabularies.UI.v1.Facets"];i.bindElement(E,Je(x,U));K=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");Oe.InteropCompleted=false;mt(gt(U));i.addStyleClass("sapFactsheetUtiThingType"+x.replace(/\s/g,""));if(O.TypeName.String){i.setTitle(O.TypeName.String)}else if(O.TypeName.Path){i.bindProperty("title",{path:O.TypeName.Path})}if(O.ImageUrl&&O.ImageUrl.String){i.setIcon(O.ImageUrl.String)}else if(O.ImageUrl&&O.ImageUrl.Path){i.bindProperty("icon",{path:O.ImageUrl.Path})}else if(O.TypeImageUrl&&O.TypeImageUrl.String){i.setIcon(O.TypeImageUrl.String)}else if(O.TypeImageUrl&&O.TypeImageUrl.Path){i.bindProperty("icon",{path:O.TypeImageUrl.Path})}if(O.Title.Value.String){i.setName(O.Title.Value.String)}else{i.bindProperty("name",at(O.Title.Value,O.Title.EdmType,A).BindingInfo)}if(O.Description&&O.Description.Value){if(O.Description.Value.String){i.setDescription(O.Description.Value.String)}else{i.bindProperty("description",at(O.Description.Value,O.Description.EdmType,A).BindingInfo)}}for(Ge in Ue[A]){if(Ue[A].hasOwnProperty(Ge)){if(Ge.search("com.sap.vocabularies.UI.v1.DataPoint")!==-1){We=Ue[A][Ge];if(We){i.addKpi(ut(v,We,A,E));c+=1}}if(c>=3){break}}}for(p=0;p<F.length;p+=1){if(F[p]["com.sap.vocabularies.UI.v1.IsSummary"]){k=F[p];break}}if(k){$=15;for(m=0;m<k.Facets.length;m+=1){J=k.Facets[m].Target.AnnotationPath.substring(k.Facets[m].Target.AnnotationPath.lastIndexOf("@")+1);V=k.Facets[m].Target.AnnotationPath;V=V.substring(0,V.lastIndexOf("@")-1);k.Facets[m].NavPath=V;X=Ke(x,V,U);k.Facets[m].NavEntitySet=X;if(X){q=X}else{q=x}k.Facets[m].EntitySet=q;Y=ze(X,U);if(Y){Z=Y}else{Z=A}k.Facets[m].EntityType=Z;ee=[];if(Ue[Z][J].length){ee=Ue[Z][J]}else if(Ue[Z][J].Data.length){ee=Ue[Z][J].Data}k.Facets[m].Content=ee;for(p=0;p<ee.length;p+=1){te=dt(ee[p]);if(te==="High"){o+=1}else if(te==="Medium"){l+=1}}}if(o>=$){o=$;l=0}else if(o+l>$){l=$-o;if(l<0){l=0}}if(jQuery.device.is.phone){l=0}se=$-o-l;De=new ie({title:K.getText("UNIFIEDTHINGINSPECTOR_GENERAL_INFORMATION_HEADER_TEXT")});Ae=[];Ae.push(De);Ae[0].bLoaded=false;Ae[0].bProcessed=false;Ae[0].bIsTable=false;Pe=[];Ie=l+o;for(m=0;m<k.Facets.length;m+=1){we=st(v,k.Facets[m].EntitySet,k.Facets[m].Content,{High:o,Medium:l,Low:0},null,De).addStyleClass("sapFactsheetUtiTilePadding");if(m>0){we.addStyleClass("sapFactsheetUtiPaddingTop")}if(k.Facets[m].NavPath){we.bindElement(E+"/"+k.Facets[m].NavPath)}Ce=pt(k.Facets[m].Content);o-=Ce.High;l-=Ce.Medium;if(Ce.High>0&&o+Ce.High>0||Ce.Medium>0&&l+Ce.Medium>0){Pe.push(we);if(m>0){if(se>0){se-=1}else if(l>0){l-=1}else if(o>0){o-=1}}}if(o<1&&l<1){break}}if(o<0){o=0}if(l<0){l=0}s=new h({content:Pe,width:"100%"});xe=ft();Le=1;if(Ie>3&&Ie<=9){xe=ft(2);Le=2}else if(Ie>9){xe=ft(3);Le=3}De.setContent(s);De.setRowSpan(Le);if(jQuery.device.is.phone){De.setHeightType(Se.Auto)}else{De.setHeight(xe)}De.addStyleClass("sapFactsheetUtiGeneralInformationOverviewFacet");De.attachPress({facets:k},function(e,t){var a,n,s,r,o;i.removeAllFacetContent();s=new b;s.setDescription(_e());s.setTitle(K.getText("UNIFIEDTHINGINSPECTOR_GENERAL_INFORMATION_HEADER_TEXT"));s.addStyleClass("sapFactsheetUtiGeneralInformationUtg");if(t.facets.Facets.length>1){a="L6 M12 S12"}else{a="L12 M12 S12"}Ae[0].Links=[];r=new h({width:"100%"});for(p=0;p<t.facets.Facets.length;p+=1){if(p%2===0){n=new re({hSpacing:1,vSpacing:1,defaultSpan:a})}o=rt(v,x,t.facets.Facets[p],E,this);o.addStyleClass("sapFactsheetUtiGeneralInformationUtgContent");if(p===0&&t.facets.Facets.length>1&&o.getTitle().trim()===""){o.setTitle(K.getText("UNIFIEDTHINGINSPECTOR_GENERAL_INFORMATION_HEADER_TEXT"))}n.addContent(o);if(p%2!==0){r.addContent(n)}}Ae[0].bLoaded=true;Ae[0].bProcessed=false;Ae[0].bIsTable=false;ht(0);if(p%2!==0){r.addContent(n)}s.setContent(r);i.addFacetContent(s);i.navigateToDetail()});i.addFacet(De)}var Ze=function(t){return function(a){var n,s,r,o,l,c,p,d,u,g,m,y,T,S,P;if(t.cardinality==="*"&&a.results&&a.results.length&&a.results.length!==0||t.cardinality==="1"&&a){c=new f;if(t.cardinality==="*"){if(a.results&&a.results.length){c.setData(a)}}else{c.setData({result:a});p="/result"}s=new ne("/sap/opu/odata/sap/VBI_APPL_DEF_SRV",false);r=Ue[t.navigationType]["com.sap.vocabularies.UI.v1.GeoLocation"];u=Ue[t.navigationType]["com.sap.vocabularies.UI.v1.HeaderInfo"];g=Ue[t.navigationType]["com.sap.vocabularies.UI.v1.Identification"];if(r.Longitude&&r.Latitude){l={Data:{Set:{N:[{name:"Spots",E:[]}]}}};if(t.cardinality==="1"){if(r.Longitude.Path&&r.Latitude.Path){o=a[r.Longitude.Path]+";"+a[r.Latitude.Path]+";0"}l.Data.Set.N[0].E.push({A:o,I:"pin_blue.png"})}else{for(n=0;n<a.results.length;n+=1){if(r.Longitude.Path&&r.Latitude.Path){o=a.results[n][r.Longitude.Path]+";"+a.results[n][r.Latitude.Path]+";0"}l.Data.Set.N[0].E.push({A:o,I:"pin_blue.png"})}if(a.results.length!==0){o=a.results[0][r.Longitude.Path]+";"+a.results[0][r.Latitude.Path]+";0"}}}P=parseInt(a.__count,10);if(Number(P)){t.facet.setQuantity(P)}var C=function(t){var a,n,i,s,r;a=e.parseJSON(t.getParameters().data);if(a.Action.name==="DETAIL_REQUEST"&&a.Action.instance){n=a.Action.instance;if(c.oData.results){p="/results/"+n.split(".")[1]}S=u.TypeName.String.substring(0,17);s=parseFloat(ft(.7))*16;r=parseFloat(ft(1.5))*16;i={SAPVB:{version:"2.0","xmlns:VB":"VB",Windows:{Remove:{name:"Detail1"},Set:{name:"Detail1",Window:{id:"Detail1",type:"callout",refParent:"Main",refScene:"",offsetX:"16",offsetY:"-27",modal:"false",width:r,height:s,caption:S,"pos.bind":n+".GeoPosition"}}},Scenes:{Set:{name:"Details",Scene:{id:"Details",navControlVisible:"false"}}}}};this.load(i)}};var I=function(e){var a,n,i,s;if(!m){m=et(u.Title,t.navigationType,U,t.facet);m.setModel(c);m.bindElement(p);y=et(u.Description,t.navigationType,U,t.facet);y.setModel(c);y.bindElement(p);for(a in r.Address){if(a==="label"){d=et({Value:r.Address[a]},t.navigationType,U,t.facet);d.setModel(c);d.bindElement(p);break}}s=7;if(jQuery.device.is.tablet&&jQuery.device.is.landscape){s=4}else if(jQuery.device.is.tablet&&jQuery.device.is.portrait){s=5}else if(jQuery.device.is.phone&&jQuery.device.is.landscape){s=2}else if(jQuery.device.is.phone&&jQuery.device.is.portrait){s=3}T=new h({width:"100%"}).setModel(v);if(t.navigationPath){i=Ke(t.entitySet,t.navigationPath,U);T.addContent(st(v,i,g,{High:s},null,t.facet));T.setModel(c).bindElement(p)}else{T.addContent(st(v,t.entitySet,g,{High:s},null,t.facet)).setModel(c).bindElement(p)}}else{m.bindElement(p);if(y){y.bindElement(p)}if(d){d.bindElement(p)}if(T){T.bindElement(p)}}n=parseFloat(ft(1.5))*16*.95+"px";if(m){m.placeAt(e.getParameter("contentarea").id);m.addStyleClass("sapFactsheetUtiGeoPopupHead");if(jQuery.device.is.phone){m.addStyleClass("sapFactsheetUtiGeoPopupHeadFontPhone")}m.setWidth(n)}if(y){y.placeAt(e.getParameter("contentarea").id);y.addStyleClass("sapFactsheetUtiGeoPopupDescr");if(jQuery.device.is.phone){y.addStyleClass("sapFactsheetUtiGeoPopupDescrFontPhone")}y.setWidth(n)}if(d){d.placeAt(e.getParameter("contentarea").id);d.addStyleClass("sapFactsheetUtiGeoPopupText");d.setWidth(n)}if(T&&T.getContent()[0]&&T.getContent()[0].getContent&&T.getContent()[0].getContent().length>0){T.placeAt(e.getParameter("contentarea").id);T.addStyleClass("sapFactsheetUtiGeoPopupText");T.setWidth(n)}if(Ae.indexOf(t.facet)>=0){Ae[Ae.indexOf(t.facet)].bLoaded=true;Ae[Ae.indexOf(t.facet)].bProcessed=false;Ae[Ae.indexOf(t.facet)].bIsTable=false}ht(Ae.indexOf(t.facet))};var w=function(t){if(m){m.destroy();m=undefined}if(y){y.destroy();y=undefined}if(d){d.destroy();d=undefined}if(T){T.destroy();T=undefined}e(t.getParameter("contentarea").id).empty()};var x=function(t){return function(a){var n,s,f,p,d;p=a.ProjectJSON;p=p.indexOf("{")?p.substr(p.indexOf("{")):p;n=e.parseJSON(p);n.SAPVB.Scenes.Set.SceneGeo.initialStartPosition=o;n.SAPVB.Scenes.Set.SceneGeo.initialZoom=12;n.SAPVB.Actions.Set.Action.push({id:"200",name:"TAP_ON_MAP",refEvent:"Click",refScene:"MainScene",refVO:"Map"});if(l){n.SAPVB.Data=l.Data}for(d=0;d<n.SAPVB.Scenes.Set.SceneGeo.VO.length;d+=1){if(n.SAPVB.Scenes.Set.SceneGeo.VO[d].datasource==="Spots"){if(n.SAPVB.Scenes.Set.SceneGeo.VO[d].scale&&n.SAPVB.Scenes.Set.SceneGeo.VO[d].scale.split(";").length!==3){n.SAPVB.Scenes.Set.SceneGeo.VO[d].scale="1.0;1.0;1.0";break}}}t.facet.getContent().attachSubmit(function(){if(jQuery.device.is.tablet||jQuery.device.is.phone){t.facet.firePress()}});t.facet.getContent().load(n);t.facet.attachPress("",function(){var a=[],o=[],l,p;if(!s){s=new oe({width:"100%",height:"100%",plugin:false,config:null});s.addStyleClass("sapFactsheetUtiGeoPopup")}n.SAPVB.Scenes.Set.SceneGeo.NavigationDisablement.move="false";n.SAPVB.Scenes.Set.SceneGeo.NavigationDisablement.zoom="false";n.SAPVB.Scenes.Set.SceneGeo.NavigationDisablement.pitch="false";n.SAPVB.Scenes.Set.SceneGeo.NavigationDisablement.yaw="false";n.SAPVB.Scenes.Set.SceneGeo.SuppressedNavControlVisibility="false";s.load(n);if(t.cardinality==="*"){for(l=0;l<c.oData.results.length;l+=1){a.push(c.oData.results[l][r.Longitude.Path]);o.push(c.oData.results[l][r.Latitude.Path])}}s.attachSubmit(C);s.attachOpenWindow(I);s.attachCloseWindow(w);f=new b({content:s,title:t.facetContent.Label.String,description:_e()});i.removeAllFacetContent();i.addFacetContent(f);i.navigateToDetail();i.attachAfterNavigate(a,function(t){if(t.getParameters().getParameters().toId.indexOf("-detail-page")!==-1){if(jQuery.device.is.phone){p="300px"}else{p=Math.floor(e("#"+t.getParameters().getParameters().toId+"-cont").height()-128)+"px"}s.setHeight(p);if(a.length>1){s.zoomToGeoPosition(a,o)}}})})}};var E=function(e){return function(){i.removeFacet(e)}};s.read("VBIApplicationSet('ZFACTSHEETS')","","",false,x(t),E(t.facet))}else{t.facet.setQuantity(undefined);t.facet.addStyleClass("sapFactsheetUtiEmptyTile");t.facet.setHeightType(jQuery.device.is.phone?Se.Auto:Se.S);t.facet.setContent(undefined);t.facet.setTitle(undefined)}}};var nt=function(e){return function(t){var a="",s,r,o,l,c,p,u,m,y,T,b,P,C,I,w,x,E,A,O,F,V,L,D,N,k,B,M,_,H,R,j;o=new f;if(e.facetContent.Target&&e.facetContent.Target.AnnotationPath&&e.facetContent.Target.AnnotationPath.split("#")[1]&&Ue[e.navigationType]["com.sap.vocabularies.UI.v1.Badge#"+e.facetContent.Target.AnnotationPath.split("#")[1]]){l=Ue[e.navigationType]["com.sap.vocabularies.UI.v1.Badge#"+e.facetContent.Target.AnnotationPath.split("#")[1]]}else{l=Ue[e.navigationType]["com.sap.vocabularies.UI.v1.Badge"]}if(e.cardinality==="*"){if(t.results&&t.results.length){B=e.facetContent.Target.AnnotationPath;qe=B.substring(B.lastIndexOf("@")+1);if(qe==="com.sap.vocabularies.UI.v1.Chart"){M=Ue[e.navigationType]["com.sap.vocabularies.UI.v1.Chart"];_=Ue.propertyExtensions[e.navigationType];H=[];for(s=0;s<M.Dimensions.length;s+=1){H.push({axis:1,name:_[M.Dimensions[s].PropertyPath]["http://www.sap.com/Protocols/SAPData"].label,value:"{"+M.Dimensions[s].PropertyPath+"}"})}R=[];for(s=0;s<M.Measures.length;s+=1){R.push({name:_[M.Measures[s].PropertyPath]["http://www.sap.com/Protocols/SAPData"].label,value:"{"+M.Measures[s].PropertyPath+"}"})}j=new n({dimensions:H,measures:R,data:{path:"/results"}});y=ct(M.ChartType.EnumMember,M.Title,M.Description,j);y.setModel(o);e.facet.setHeightType(jQuery.device.is.phone?Se.Auto:Se.XL)}else{y=new h({width:"100%"}).addStyleClass("sapFactsheetUtiVLayoutPadding");for(s=0;s<t.results.length;s+=1){u=(new le).addStyleClass("sapFactsheetUtiHLayoutPadding");c=et(l.Title,e.navigationType,U,e.facet);if(c.setWrapping){c.setWrapping(false)}sap.ui.getCore().byId(i.getId()+"-master-page").addDelegate({onAfterShow:function(e){return function(){var t,a;t=e.getParent().getDomRef().clientWidth;a=t;if(e.getContent()[0]){a-=e.getContent()[0].getDomRef().clientWidth;if(t<e.getContent()[0].getDomRef().clientWidth){e.getContent()[0].getDomRef().setAttribute("style","width:"+t+"px");return}}if(e.getContent()[1]){a-=e.getContent()[1].getDomRef().clientWidth}if(a<10){a=0}if(e.getContent()[2]){e.getContent()[2].getDomRef().setAttribute("style","width:"+a+"px")}}}(u)});o=new f;o.setData({result:t.results[s]});c.setModel(o);c.bindElement("/result");m=false;if(t.results[s][l.Title.Value.Path]){m=true}if(l.Title.Value.Apply){for(r=0;r<l.Title.Value.Apply.Parameters.length;r+=1){if(l.Title.Value.Apply.Parameters[r].Type==="Path"){if(t.results[s][l.Title.Value.Apply.Parameters[r].Value]){m=true;break}}}}a="";if(m){u.addContent(c);if(l.MainInfo&&(l.MainInfo.EdmType&&l.MainInfo.EdmType==="Edm.Decimal"||l.MainInfo.Value&&l.MainInfo.Value.Apply&&l.MainInfo.Value.Apply.Parameters[0]&&l.MainInfo.Value.Apply.Parameters[0].EdmType&&l.MainInfo.Value.Apply.Parameters[0].EdmType==="Edm.Decimal")){a="comma"}else if(l.MainInfo&&l.MainInfo.Value.Path&&t.results[s][l.MainInfo.Value.Path]){a="dash"}else if(l.MainInfo&&l.MainInfo.Value.Apply){for(r=0;r<l.MainInfo.Value.Apply.Parameters.length;r+=1){if(l.MainInfo.Value.Apply.Parameters[r].Type==="Path"){if(t.results[s][l.MainInfo.Value.Apply.Parameters[r].Value]){a="dash";break}}}}if(a==="dash"){u.addContent(new S({content:'<span class="sapFactsheetUtiSeparatorPadding sapMText"> &ndash; </span>'}))}if(a==="comma"){u.addContent(new g({text:", "}).addStyleClass("sapFactsheetUtiSeparatorPaddingForDecimal"))}}if(l.MainInfo){p=et(l.MainInfo,e.navigationType,U,e.facet);if(p.setWrapping){p.setWrapping(false)}p.setModel(o);p.bindElement("/result");u.addContent(p)}y.addContent(u)}}T=parseInt(t.__count,10);if(Number(T)){e.facet.setQuantity(T)}e.facet.setContent(y);e.facet.attachPress({facet:e.facetContent},function(t,a){var n;i.removeAllFacetContent();Ae[Ae.indexOf(e.facet)].Links=[];n=rt(v,e.entitySet,a.facet,e.bindingPath,this);n.setDescription(_e());i.addFacetContent(n);if(Ae.indexOf(e.facet)>=0){Ae[Ae.indexOf(e.facet)].bLoaded=false;Ae[Ae.indexOf(e.facet)].bProcessed=false;Ae[Ae.indexOf(e.facet)].bIsTable=true}ht(Ae.indexOf(e.facet));i.navigateToDetail()})}else{e.facet.setQuantity(0);e.facet.addStyleClass("sapFactsheetUtiEmptyTile");e.facet.setHeightType(jQuery.device.is.phone?Se.Auto:Se.S)}if(Ae.indexOf(e.facet)>=0){Ae[Ae.indexOf(e.facet)].bLoaded=true;Ae[Ae.indexOf(e.facet)].bProcessed=false;Ae[Ae.indexOf(e.facet)].bIsTable=false}ht(Ae.indexOf(e.facet))}else{o.setData({result:t});for(N in t){if(t.hasOwnProperty(N)){if(N!=="__metadata"){if(typeof t[N]==="string"&&t[N]){if(parseInt(t[N],10)!==0){k=true;break}}else if(typeof t[N]==="number"&&parseInt(t[N],10)!==0){k=true;break}}}}if(k){b=new h;P=Ue.propertyExtensions?Ue.propertyExtensions[e.navigationType]:[];C=(new le).addStyleClass("sapFactsheetUtiHLayoutLabelValue");I=tt(l.Title,{},P,true).addStyleClass("sapFactsheetUtiLabelMargin");c=et(l.Title,e.navigationType,U,e.facet);c.setModel(o);c.bindElement("/result");C.addContent(I);C.addContent(c);b.addContent(C);if(l.MainInfo){w=(new le).addStyleClass("sapFactsheetUtiHLayoutLabelValue");x=tt(l.MainInfo,{},P,true).addStyleClass("sapFactsheetUtiLabelMargin");p=et(l.MainInfo,e.navigationType,U,e.facet);p.setModel(o);p.bindElement("/result");w.addContent(x);w.addContent(p);b.addContent(w)}if(l.SecondaryInfo){E=(new le).addStyleClass("sapFactsheetUtiHLayoutLabelValue");A=tt(l.SecondaryInfo,{},P,true).addStyleClass("sapFactsheetUtiLabelMargin");O=et(l.SecondaryInfo,e.navigationType,U,e.facet);O.setModel(o);O.bindElement("/result");E.addContent(A);E.addContent(O);b.addContent(E)}if(l.TypeImageUrl||l.ImageUrl){if(l.ImageUrl){F=l.ImageUrl}else{F=l.TypeImageUrl}V=new le;L="64px";if(jQuery.device.is.phone){L="48px"}if(F.String&&F.String.substr(0,11)==="sap-icon://"){D=new ce({size:L,width:L})}else{D=new d({width:L})}D.addStyleClass("sapFactsheetUtiRelIcon");if(F&&F.String){D.setSrc(F.String)}else if(F&&F.Path){D.bindProperty("src",F.Path)}V.addContent(D);V.addContent(b);e.facet.setContent(V)}else{e.facet.setContent(b)}e.facet.attachPress({facet:e.facetContent},function(t,a){var n;i.removeAllFacetContent();Ae[Ae.indexOf(e.facet)].Links=[];n=rt(v,e.entitySet,a.facet,e.bindingPath,this);n.setDescription(_e());i.addFacetContent(n);if(Ae.indexOf(e.facet)>=0){Ae[Ae.indexOf(e.facet)].bLoaded=true;Ae[Ae.indexOf(e.facet)].bProcessed=false;Ae[Ae.indexOf(e.facet)].bIsTable=false}ht(Ae.indexOf(e.facet));i.navigateToDetail()})}else{e.facet.addStyleClass("sapFactsheetUtiEmptyTile");e.facet.setHeightType(jQuery.device.is.phone?Se.Auto:Se.S)}if(Ae.indexOf(e.facet)>=0){Ae[Ae.indexOf(e.facet)].bLoaded=true;Ae[Ae.indexOf(e.facet)].bProcessed=false;Ae[Ae.indexOf(e.facet)].bIsTable=false}ht(Ae.indexOf(e.facet))}}};var it=function(e){return function(){i.removeFacet(e.facet)}};var ot=function(e){return function(t){var a,n,s,r,o;n=Ue[e.navigationType]["com.sap.vocabularies.UI.v1.MediaResource"];if(e.cardinality==="*"){if(t.results&&t.results.length){a=(new le).addStyleClass("sapFactsheetUtiPictureViewerOverview");for(s=0;s<t.results.length;s+=1){a.addContent(new d({src:t.results[s][n.Thumbnail.Url.Path],height:"85px"}));if(s===3){break}}r=parseInt(t.__count,10);if(Number(r)){e.facet.setQuantity(r)}e.facet.setContent(a);e.facet.attachPress({facet:e.facetContent,data:t},function(e,t){var a,r,l;i.removeAllFacetContent();o=new b;if(t.facet.Label&&t.facet.Label.String){o.setTitle(t.facet.Label.String)}o.setDescription(_e());if(jQuery.device.is.phone){r="350px"}else{r="550px"}a=new fe({height:r});for(s=0;s<t.data.results.length;s+=1){l=new d({src:t.data.results[s][n.Url.Path]});if(jQuery.device.is.phone){l.addStyleClass("sapFactsheetUtiCarouselMaxImageHeightPhone")}else{l.addStyleClass("sapFactsheetUtiCarouselMaxImageHeight")}a.addPage(l)}o.setContent(a);i.addFacetContent(o);i.navigateToDetail()})}else{e.facet.setQuantity(0);e.facet.addStyleClass("sapFactsheetUtiEmptyTile");e.facet.setHeightType(jQuery.device.is.phone?Se.Auto:Se.S)}}}};var lt=function(e,t){var a=[],n={},i,s,r,o,l,c,f,p,d,u;var g=function(e,t){var a,n="";if(e){if(e.Path){return t[e.Path]}else if(e.String){return e.String}else if(e.Apply.Name==="odata.concat"){for(a=0;a<e.Apply.Parameters.length;a+=1){if(e.Apply.Parameters[a].Type==="Path"){n=n+t[e.Apply.Parameters[a].Value]}else if(e.Apply.Parameters[a].Type==="String"){n=n+e.Apply.Parameters[a].Value}}return n}}};n.iCount=0;n.aContacts=[];for(i=0;i<e.__batchResponses.length;i+=1){if(!e.__batchResponses[i].data){continue}a=e.__batchResponses[i].data.results;if(!a){a=[];a.push(e.__batchResponses[i].data)}if(a.length>0){o=Ue[a[0].__metadata.type]["com.sap.vocabularies.Communication.v1.Contact"];if(o){for(s=0;s<a.length;s+=1){l=c=f="";if(o.tel){for(r=0;r<o.tel.length;r+=1){if(o.tel[r].type&&o.tel[r].type.EnumMember){p=g(o.tel[r].uri,a[s]);switch(o.tel[r].type.EnumMember){case"com.sap.vocabularies.Communication.v1.PhoneType/voice":l=p?p.replace("tel:",""):"";l=l?l.replace(";ext=",""):"";break;case"com.sap.vocabularies.Communication.v1.PhoneType/cell":c=p?p.replace("tel:",""):"";c=c?c.replace(";ext=",""):"";break;case"com.sap.vocabularies.Communication.v1.PhoneType/fax":f=p?p.replace("tel:",""):"";f=f?f.replace(";ext=",""):"";break}}}}u=o.email&&o.email.address?o.email.address:"";d=g(o.photo,a[s]);n.iCount+=1;n.aContacts.push({fn:g(o.fn,a[s]),title:g(o.title,a[s]),org:g(o.org,a[s]),phone:l,mobile:c,fax:f,photo:d,email:g(u,a[s]),sEntity:a[0].__metadata.type,bExistsPhoto:!!d,bUseIcon:!d,sOrder:n.iCount})}}}}if(t){n.aContacts.sort(function(e,a){return e[t]>a[t]?1:-1})}return n};var yt=function(){return function(e){var t,a,n,s,r,o,l,c;a=lt(e,"sOrder");n=new re({defaultSpan:"L6 M6 S12",hSpacing:0,vSpacing:0}).addStyleClass("sapFactsheetUtiContactsGrid");for(t=0;t<a.aContacts.length&&t<4;t+=1){o=new h;if(a.aContacts[t].photo){l=new d({height:"55px",src:a.aContacts[t].photo})}else{l=new ce({size:"50px",src:pe.getIconURI("person-placeholder")}).addStyleClass("sapFactsheetUtiRelIcon")}o.addContent(l);o.addStyleClass("sapFactsheetUtiContactsImage");r=new h({content:[new g({text:a.aContacts[t].fn}).addStyleClass("sapFactsheetUtiTextName"),new g({text:a.aContacts[t].title}).addStyleClass("sapFactsheetUtiTextValue")]});s=new le({content:[o,r]}).addStyleClass("sapFactsheetUtiContactsBox");n.addContent(s)}De=sap.ui.getCore().byId(i.data("contactFacetId"));De.setQuantity(a.iCount);if(t>0){De.setContent(n);if(t<=2){c=Se.M}else{c=Se.L}De.attachPress(function(){var e,t=[],a;v.clearBatch();for(e=0;e<Ue[A]["com.sap.vocabularies.UI.v1.Contacts"].length;e+=1){V=Ue[A]["com.sap.vocabularies.UI.v1.Contacts"][e].AnnotationPath;V=V.substring(0,V.lastIndexOf("@")-1);if(V!==""){a=E+"/"+V}else{a=E}t.push(v.createBatchOperation(a,"GET"))}v.addBatchReadOperations(t);v.submitBatch(function(e){var t,a,n,s,r,o,l;l=jQuery.sap.resources({url:jQuery.sap.getModulePath("sap.ushell.components.container.")+"/resources/resources.properties",language:sap.ui.getCore().getConfiguration().getLanguage()});t=lt(e,"sEntity");a=new f;a.setData(t);n=new C({type:I.Inactive,unread:false,cells:[new h({content:[new d({src:"{photo}",width:"74px",visible:"{bExistsPhoto}"}),new ce({size:"76px",src:pe.getIconURI("person-placeholder"),visible:"{bUseIcon}"}).addStyleClass("sapFactsheetUtiRelIcon")]}),new h({content:[new g({text:"{fn}"}).addStyleClass("sapFactsheetUtiContactsName"),new y({text:"{title}"}),new y({text:"{org}"})]}),new u({text:"{phone}",href:"tel:{phone}"}),new u({text:"{mobile}",href:"tel:{mobile}"}),new u({text:"{fax}",href:"tel:{fax}"}),new u({text:"{email}",href:"mailto:{email}"})]});s=new w({threshold:2,inset:false,showUnread:true,scrollToLoad:true,columns:[new P({hAlign:Ee.Center,width:"12%",header:new g({text:""})}),new P({hAlign:Ee.Begin,header:new g({text:l.getText("USHELL_FACTSHEET_NAME")})}),new P({hAlign:Ee.Begin,width:"12%",header:new g({text:l.getText("USHELL_FACTSHEET_PHONE")}),minScreenWidth:"Tablet",demandPopin:true}),new P({hAlign:Ee.Begin,width:"12%",header:new g({text:de.i18n.getText("mobile")}),minScreenWidth:"Tablet",demandPopin:true}),new P({hAlign:Ee.Begin,width:"12%",header:new g({text:de.i18n.getText("fax")}),minScreenWidth:"Tablet",demandPopin:true}),new P({hAlign:Ee.Begin,width:"26%",header:new g({text:l.getText("USHELL_FACTSHEET_EMAIL")}),minScreenWidth:"Tablet",demandPopin:true})],items:{path:"/aContacts",template:n}});r=new B({sortItems:[new D({key:"fn",text:l.getText("USHELL_FACTSHEET_NAME")}),new D({key:"phone",text:l.getText("USHELL_FACTSHEET_PHONE")}),new D({key:"mobile",text:de.i18n.getText("mobile")}),new D({key:"fax",text:de.i18n.getText("fax")}),new D({key:"email",text:l.getText("USHELL_FACTSHEET_EMAIL")})],confirm:function(e){var t,a,n=[];t=e.getParameters();a=s.getBinding("items");if(t.sortItem){n.push(new M(t.sortItem.getKey(),t.sortDescending));a.sort(n)}}});s.setHeaderToolbar(new _({content:[new y,new H,new R({icon:"sap-icon://drop-down-list",press:function(){r.open()}})]}));s.setModel(a);o=new b({title:De.getTitle(),description:_e(),content:s});i.removeAllFacetContent();i.addFacetContent(o);i.navigateToDetail()})})}else{c=Se.S;De.addStyleClass("sapFactsheetUtiEmptyTile");De.setQuantity(0)}De.setHeightType(jQuery.device.is.phone?Se.Auto:c)}};for(p=0;p<F.length;p+=1){if(F[p]["com.sap.vocabularies.UI.v1.Map"]){V=F[p].Target.AnnotationPath;V=V.substring(0,V.lastIndexOf("@")-1);Be="1";ke=A;if(V){ke=Xe(V,A,U);Be=$e(x,V,U)}Ye="100%";if(jQuery.device.is.phone){Ye="150px"}Ne=new oe({width:"100%",height:Ye,plugin:false,config:null});De=new ie({title:F[p].Label.String.trim(),heightType:jQuery.device.is.phone?Se.Auto:Se.L,content:Ne});Ae.push(De);Ae[Ae.length-1].bLoaded=false;Ae[Ae.length-1].bProcessed=false;Ae[Ae.length-1].bIsTable=false;L={cardinality:Be,navigationPath:V,facet:De,facetContent:F[p],navigationType:ke,metadata:U,bindingPath:E,entitySet:x};if(Be==="*"){Me=["$inlinecount=allpages","$top=1000"]}else{Me=[]}v.read(E+"/"+V,"",Me,true,Ze(L));i.addFacet(De)}else if(F[p].Target){V=F[p].Target.AnnotationPath;V=V.substring(0,V.lastIndexOf("@")-1);qe=F[p].Target.AnnotationPath.substring(F[p].Target.AnnotationPath.lastIndexOf("@")+1);if(V){ke=Xe(V,A,U);De=new ie({title:F[p].Label.String.trim(),heightType:jQuery.device.is.phone?Se.Auto:Se.M});Be=$e(x,V,U);if(Be!==0){L={cardinality:Be,navigationPath:V,facet:De,facetContent:F[p],navigationType:ke,metadata:U,bindingPath:E,entitySet:x};if(F[p]["com.sap.vocabularies.UI.v1.Gallery"]){if(Be==="*"){Me=["$inlinecount=allpages"]}else{Me=[]}v.read(E+"/"+V,"",Me,true,ot(L))}else{Ae.push(De);Ae[Ae.length-1].bLoaded=false;Ae[Ae.length-1].bProcessed=false;Ae[Ae.length-1].bIsTable=false;if(Be==="*"){Me=["$inlinecount=allpages","$top=3"]}else{Me=[]}v.read(E+"/"+V,"",Me,true,nt(L),it(L))}i.addFacet(De)}}else if(qe==="com.sap.vocabularies.UI.v1.Contacts"){De=new ie({title:F[p].Label.String.trim(),heightType:jQuery.device.is.phone?Se.Auto:Se.M});i.data("contactFacetId",De.sId);L={facet:De};v.clearBatch();for(m=0;m<Ue[A][qe].length;m+=1){V=Ue[A][qe][m].AnnotationPath;V=V.substring(0,V.lastIndexOf("@")-1);if(V!==""){Be=$e(x,V,U);if(Be==="*"){ae=E+"/"+V+"?$top=4&$inlinecount=allpages"}else{ae=E+"/"+V}}else{ae=E}r.push(v.createBatchOperation(ae,"GET"))}v.addBatchReadOperations(r);v.submitBatch(yt(L));i.addFacet(De)}}}Fe=new ue;var Tt=function(){var e={},a,n,s,r,o,l,c,f,p,d,m,h,y,T;Fe.setAppData({title:i.getTitle(),subtitle:i.getName()+" - "+i.getDescription()});Fe.setEnabled(true);h=sap.ushell.Container.getService("URLParsing");y=h.getShellHash(window.location.href);T=h.parseShellHash(y);p=T.semanticObject;Q=new ge({showCancelButton:true,placement:ve.Top});N=je(t,v);o=N.split(",");for(a=0;a<o.length;a+=1){o[a]=o[a].replace("='","=","g");if(o[a].lastIndexOf("'")===o[a].length-1){o[a]=o[a].slice(0,-1)}}for(l in Ue[A]){if(Ue[A].hasOwnProperty(l)){if(l.indexOf("com.sap.vocabularies.Common.v1.SecondaryKey")===0){c=Ue[A][l];for(a=0;a<c.length;a+=1){f=this.getBoundContext().getProperty(c[a].PropertyPath);if(f){o.push(c[a].PropertyPath+"="+f)}}}}}for(a=0;a<o.length;a+=1){s=o[a].substr(0,o[a].indexOf("="));r=o[a].substr(o[a].indexOf("=")+1,o[a].length);e[decodeURIComponent(s)]=decodeURIComponent(r)}j=sap.ushell.Container.getService("CrossApplicationNavigation").getSemanticObjectLinks(p,e);j.done(function(e){var t,a,n;for(t=0;t<e.length;t+=1){n=e[t].intent;if(n.indexOf(Ve)<0&&n.indexOf("-analyzeKPIDetails~")<0&&n.indexOf("-analyzeSBKPIDetails~")<0&&n.indexOf("-NavigateToMaintainCusProj~")<0&&n.indexOf("CostCenter-manageCostCenter~")<0&&n.indexOf("AccountingDocument-analyzeDocumentJournal~")<0&&n.indexOf("AccountingDocument-analyzeGLLineItem~")<0&&n.indexOf("ControllingDocument-analyzeCostCenters~")<0&&n.indexOf("ControllingDocument-analyzeInternalOrders~")<0&&n.indexOf("ControllingDocument-analyzeMarketSegment~")<0&&n.indexOf("ControllingDocument-analyzeProfitCentersActuals~")<0&&n.indexOf("ControllingDocument-analyzeProfitLoss~")<0&&n.indexOf("ControllingDocument-analyzeProjectsActuals~")<0&&n.indexOf("PurchaseOrder-create~")<0){a=sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal({target:{shellHash:n}});Q.addItem(new u({text:e[t].text,href:a}));i.setTransactionsVisible(true)}}});i.attachTransactionsButtonPress(function(e){Q.openBy(e.getParameter("caller"))});this.detachChange(Tt);me.setWindowTitle(i.getTitle().trim()+": "+i.getName().trim()+" ("+i.getDescription().trim()+")");i.setActionsVisible(true);Qe=new R({text:K.getText("UNIFIEDTHINGINSPECTOR_FOOTER_BUTTON_EMAIL_LINK"),icon:"sap-icon://email",press:function(){be.triggerEmail("",i.getName(),window.location.href)}});G=new he({placement:ve.Top});d=t.substr(0,t.lastIndexOf("/")+1);for(n in v.oData){if(v.oData.hasOwnProperty(n)){d=d+n;m=n.substring(n.indexOf("(")+1,n.indexOf(")"));break}}G.addButton(new ye({jamData:{businessObject:{appContext:"CB",odataServicePath:t.substr(0,t.lastIndexOf("/")+1),collection:x,key:m,name:i.getTitle(),ui_url:window.location.href}}}));G.addButton(new Te({jamData:{object:{id:window.location.href,display:new g({text:i.getTitle()}),share:""},externalObject:{appContext:"CB",odataServicePath:t.substr(0,t.lastIndexOf("/")+1),collection:x,key:m,name:i.getTitle()}}}));G.addButton(Fe);G.addButton(Qe);i.attachActionsButtonPress(function(e){G.openBy(e.getParameter("caller"))});Ae[0].bLoaded=true;Ae[0].bProcessed=false;ht(0)};i.getElementBinding().attachChange(Tt);i.attachBackAction(function(){history.back()});i.addDelegate({onAfterRendering:function(){i._adjustFacetLayout()}});return i};return function(e,a){try{De=yt(e,a,new t({configurationVisible:false}))}catch(e){throw e}return De}},true);
//# sourceMappingURL=ThingInspector.js.map