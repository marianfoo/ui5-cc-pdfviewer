// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/Device"],function(e){"use strict";var t={};t.initialized=[];t.parse=function(t,n){var a={},i={},r={},o={},s={},l="",d,f,p,u,c,h,g,N,m,x,y,A,T,b,v,P,S,O,R,V,D,E,C,w,U,I,L,X,_,z,F,j,k,M,H,Q,G,Y;if(e.browser.internet_explorer){a={setNameSpace:function(e){e.setProperty("SelectionNamespaces",'xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" xmlns:d="http://docs.oasis-open.org/odata/ns/edm"');e.setProperty("SelectionLanguage","XPath");return e},selectNodes:function(e,t,n){return n.selectNodes(t)},nextNode:function(e){return e.nextNode()},getNodeText:function(e){return e.text}}}else{a={setNameSpace:function(e){return e},nsResolver:function(e){var t={edmx:"http://docs.oasis-open.org/odata/ns/edmx",d:"http://docs.oasis-open.org/odata/ns/edm"};return t[e]||null},selectNodes:function(e,t,n){var a=e.evaluate(t,n,this.nsResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);a.length=a.snapshotLength;return a},nextNode:function(e,t){return e.snapshotItem(t)},getNodeText:function(e){return e.textContent}}}var q=function(t){var n;if(e.browser.internet_explorer){n=new ActiveXObject("Microsoft.XMLHTTP");n.open("GET",t,false);n.send(null);return n.responseXML}n=jQuery.sap.sjax({url:t,dataType:"xml"});if(n.success){return n.data}};var B=function(e){var t={},n={},a={},i=false,r,o,s,l,d={},f,p={},u={},c=false,h,g,N,m,x,y,A,T,b;for(r=e.dataServices.schema.length-1;r>=0;r-=1){t=e.dataServices.schema[r];if(t.entityType){o=t.namespace;s=t.entityType;l=t.complexType;for(f in s){if(s.hasOwnProperty(f)){d=s[f];u={};if(d.hasStream&&d.hasStream==="true"){continue}p={};for(N in d.property){h=d.property[N];if(h.type.substring(0,o.length)===o){for(g in l){if(l[g].name===h.type.substring(o.length+1)){for(N in l[g].property){m=l[g].property[N];p[l[g].name+"/"+m.name]=m.type}}}}else{x=h.name;y=h.type;for(T in h.extensions){A=h.extensions[T];if(A.name==="display-format"&&A.value==="Date"){y="Edm.Date"}else{c=true;if(!u[x]){u[x]={}}if(A.namespace&&!u[x][A.namespace]){u[x][A.namespace]={}}u[x][A.namespace][A.name]=A.value}}p[x]=y}}if(!n[o+"."+d.name]){n[o+"."+d.name]={}}n[o+"."+d.name]=p;if(c){if(!a[o+"."+d.name]){i=true}a[o+"."+d.name]={};a[o+"."+d.name]=u}}}}}if(i){b={types:n,extensions:a}}else{b={types:n}}return b};var J=function(e,t,n,a){var i,r,o="";for(i in e){if(e.hasOwnProperty(i)){if(e[i]){r=e[i];if(r.Value&&r.Value.Path){o=K(r.Value.Path,t,n,a);if(o){e[i].EdmType=o}continue}if(r.Path){o=K(r.Path,t,n,a);if(o){e[i].EdmType=o}continue}if(r.Facets){e[i].Facets=J(r.Facets,t,n,a);continue}if(r.Data){e[i].Data=J(r.Data,t,n,a);continue}if(i==="Data"){e.Data=J(r,t,n,a);continue}if(r.Value&&r.Value.Apply){e[i].Value.Apply.Parameters=J(r.Value.Apply.Parameters,t,n,a);continue}if(r.Value&&r.Type&&r.Type==="Path"){o=K(r.Value,t,n,a);if(o){e[i].EdmType=o}}}}}return e};var K=function(e,t,n,a){var i;if(e.charAt(0)==="@"&&e.indexOf(a.Alias)===1){e=e.slice(a.Alias.length+2)}if(e.indexOf("/")>=0){if(t[e.slice(0,e.indexOf("/"))]){n=e.slice(0,e.indexOf("/"));e=e.slice(e.indexOf("/")+1)}}for(i in t[n]){if(t[n].hasOwnProperty(i)){if(e===i){return t[n][i]}}}};var W=function(e){var t="",n="",a,i={};for(a=0;a<e.attributes.length;a+=1){if(e.attributes[a].name!=="Property"&&e.attributes[a].name!=="Term"){t=e.attributes[a].name;n=e.attributes[a].value}}if(t.length>0){i[t]=ae(n)}return i};var Z=function(e,t){var n={},i,r,o,s,l,d;if(t.hasChildNodes()){i=a.selectNodes(e,"./d:String",t);if(i.length>0){r=a.nextNode(i,0);n.String=a.getNodeText(r)}else{o=a.selectNodes(e,"./d:Path",t);if(o.length>0){s=a.nextNode(o,0);n.Path=a.getNodeText(s)}else{l=a.selectNodes(e,"./d:Apply",t);if(l.length>0){d=a.nextNode(l,0);n.Apply=te(e,d)}}}}return n};var $=function(e,t,n){var i={},r,o,s,l,d,f,p,u,c={},h,g,N,m,x;if(t.hasChildNodes()){r=a.selectNodes(e,"./d:Record | ./d:Collection/d:Record | ./d:Collection/d:If/d:Record",t);if(r.length){o=0;for(s=0;s<r.length;s+=1){l=a.nextNode(r,s);d=ee(e,l,n);if(l.getAttribute("Type")){d.RecordType=ae(l.getAttribute("Type"))}if(o===0){if(l.nextElementSibling||l.parentNode.nodeName==="Collection"||l.parentNode.nodeName==="If"){i=[];i.push(d)}else{i=d}}else{i.push(d)}o+=1}}else{f=a.selectNodes(e,"./d:UrlRef",t);if(f.length>0){for(s=0;s<f.length;s+=1){p=a.nextNode(f,s);i.UrlRef=Z(e,p)}}else{f=a.selectNodes(e,"./d:Url",t);if(f.length>0){for(s=0;s<f.length;s+=1){p=a.nextNode(f,s);i.Url=Z(e,p)}}else{x=a.selectNodes(e,"./d:Collection/d:AnnotationPath | ./d:Collection/d:PropertyPath",t);if(x.length>0){i=[];for(s=0;s<x.length;s+=1){u=a.nextNode(x,s);c={};c[u.nodeName]=a.getNodeText(u);i.push(c)}}else{i=W(t);h=a.selectNodes(e,"./d:Annotation",t);g={};for(N=0;N<h.length;N+=1){g=a.nextNode(h,N);if(g.hasChildNodes()===false){m=ae(g.getAttribute("Term"));i[m]=W(g)}}}}}}}else{i=W(t)}return i};var ee=function(e,t,n){var i={},r={},o,s,l,d,f,p,u,c,h,g;o=a.selectNodes(e,"./d:Annotation",t);for(s=0;s<o.length;s+=1){r=a.nextNode(o,s);if(r.hasChildNodes()===false){l=ae(r.getAttribute("Term"));i[l]=W(r)}}d=a.selectNodes(e,"./d:PropertyValue",t);if(d.length>0){for(f=0;f<d.length;f+=1){p=a.nextNode(d,f);u=p.getAttribute("Property");i[u]=$(e,p,n);c=a.selectNodes(e,"./d:Apply",p);h=null;for(g=0;g<c.length;g+=1){h=a.nextNode(c,g);if(h){i[u]={};i[u].Apply=te(e,h)}}}}else{i=$(e,t,n)}return i};var te=function(e,t){var n={},i,r=null,o=[],s;i=a.selectNodes(e,"./d:*",t);for(s=0;s<i.length;s+=1){r=a.nextNode(i,s);switch(r.nodeName){case"Apply":o.push({Type:"Apply",Value:te(e,r)});break;case"LabeledElement":o.push({Name:r.getAttribute("Name"),Value:Z(e,r)});break;default:o.push({Type:r.nodeName,Value:a.getNodeText(r)});break}}n.Name=t.getAttribute("Function");n.Parameters=o;return n};var ne=function(e,n){var a,i,r,o,s,l;for(i=t.dataServices.schema.length-1;i>=0;i-=1){a=t.dataServices.schema[i];if(a.entityType){r=a.namespace+".";o=a.entityType;for(l=o.length-1;l>=0;l-=1){if(r+o[l].name===e&&o[l].navigationProperty){for(s=0;s<o[l].navigationProperty.length;s+=1){if(o[l].navigationProperty[s].name===n){return true}}}}}}return false};var ae=function(e){for(c in i){if(i.hasOwnProperty(c)){if(e.indexOf(c+".")>=0){e=e.replace(c+".",i[c]+".");return e}}}return e};if(this.initialized[n]){return this.initialized[n]}p=q(n);p=a.setNameSpace(p);u=a.selectNodes(p,"//d:Schema",p);for(d=0;d<u.length;d+=1){h=a.nextNode(u,d);r.Alias=h.getAttribute("Alias");r.Namespace=h.getAttribute("Namespace")}N=a.selectNodes(p,"//edmx:Reference",p);for(d=0;d<N.length;d+=1){g=a.nextNode(N,d);x=a.selectNodes(p,"./edmx:Include",g);if(x&&x.length>0){m=a.nextNode(x,0);if(m.getAttribute("Alias")){i[m.getAttribute("Alias")]=m.getAttribute("Namespace")}else{i[m.getAttribute("Namespace")]=m.getAttribute("Namespace")}}A=a.selectNodes(p,"./edmx:IncludeAnnotations",g);if(A.length>0){for(f=0;f<A.length;f+=1){y=a.nextNode(A,f);if(y.getAttribute("TargetNamespace")){l=y.getAttribute("TargetNamespace");if(!o[l]){o[l]={}}o[l][y.getAttribute("TermNamespace")]=g.getAttribute("Uri")}else{o[y.getAttribute("TermNamespace")]=g.getAttribute("Uri")}}}}if(o){s.annotationReferences=o}s.aliasDefinitions=i;b=a.selectNodes(p,"//d:Term",p);if(b.length>0){v={};for(P=0;P<b.length;P+=1){T=a.nextNode(b,P);S=ae(T.getAttribute("Type"));v["@"+r.Alias+"."+T.getAttribute("Name")]=S}s.termDefinitions=v}O=B(t);if(O.extensions){s.propertyExtensions=O.extensions}V=a.selectNodes(p,"//d:Annotations ",p);for(P=0;P<V.length;P+=1){R=a.nextNode(V,P);if(R.hasChildNodes()===false){continue}D=R.getAttribute("Target");E=D.split(".")[0];if(E&&i[E]){D=D.replace(new RegExp(E,""),i[E])}C=D;w=null;if(D.indexOf("/")>0){C=D.split("/")[0];w=D.replace(C+"/","")}if(!s[C]){s[C]={}}if(w){if(!s.propertyAnnotations){s.propertyAnnotations={}}if(!s.propertyAnnotations[C]){s.propertyAnnotations[C]={}}s.propertyAnnotations[C][w]={};U=a.selectNodes(p,"./d:Annotation",R);for(I=0;I<U.length;I+=1){L=a.nextNode(U,I);if(L.hasChildNodes()===false){X=ae(L.getAttribute("Term"));s.propertyAnnotations[C][w][X]=W(L)}}}else{_=C.replace(i[E],E);U=a.selectNodes(p,"./d:Annotation",R);for(z=0;z<U.length;z+=1){L=a.nextNode(U,z);F=L.getAttribute("Qualifier");j=ae(L.getAttribute("Term"));if(F){j+="#"+F}k=$(p,L,_);k=J(k,O.types,C,r);s[C][j]=k}H=a.selectNodes(p,"//d:Annotations[contains(@Target, '"+_+"')]//d:PropertyValue[contains(@Path, '/')]//@Path",p);for(d=0;d<H.length;d+=1){M=a.nextNode(H,d);G=M.value;if(s.propertyAnnotations){if(s.propertyAnnotations[C]){if(s.propertyAnnotations[C][G]){continue}}}Q=G.split("/");if(ne(C,Q[0],t)){if(!s.expand){s.expand={}}if(!s.expand[C]){s.expand[C]={}}s.expand[C][Q[0]]=Q[0]}}Y=a.selectNodes(p,"//d:Annotations[contains(@Target, '"+_+"')]//d:Path[contains(., '/')]",p);for(d=0;d<Y.length;d+=1){M=a.nextNode(Y,d);G=a.getNodeText(M);if(s.propertyAnnotations[C]){if(s.propertyAnnotations[C][G]){continue}}if(!s.expand){s.expand={}}if(!s.expand[C]){s.expand[C]={}}Q=G.split("/");if(ne(C,Q[0],t)){if(!s.expand){s.expand={}}if(!s.expand[C]){s.expand[C]={}}s.expand[C][Q[0]]=Q[0]}}}this.initialized[n]=s}return s};return t},true);
//# sourceMappingURL=Mapping.js.map