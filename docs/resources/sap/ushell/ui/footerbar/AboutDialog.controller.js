// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/ushell/services/AppConfiguration","sap/ushell/Config","sap/ushell/resources","sap/base/Log","sap/base/util/isEmptyObject","sap/ui/Device"],function(e,t,o,n,i,r,s,a,l){"use strict";return e.extend("sap.ushell.ui.footerbar.AboutDialog.controller",{onBeforeOpen:function(){this._setupAboutDialogModel()},onClose:function(){this._getDialog().close()},onAfterClose:function(){this._getDialog().destroy()},_getDialog:function(){if(!this.oAboutDialog){this.oAboutDialog=t.byId("aboutDialogFragment","aboutDialog")}return this.oAboutDialog},_setupAboutDialogModel:function(){this._setupAppInfoModel().catch(function(e){s.error("Failed to setup application info model.",e)});var e=this._getDialog(),t=this._getSystemInformation(),n=this._getUserEnvironmentInformation(),i=new o(t),r=new o(n);e.setModel(i,"SysInfo");e.setModel(r,"UserEnvInfo")},_setupAppInfoModel:function(){var e=["appId","appVersion","appSupportInfo","technicalAppComponentId","appFrameworkId","appFrameworkVersion"],t=this._getDialog();return new Promise(function(i,r){sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(t){var o=t.getCurrentApplication();return Promise.all([o.getInfo(e),this._getContentProviderLabel(o)])}.bind(this)).then(function(r){var s=n.getMetadata(),a=r[0]||{},l=r[1];e=e.concat(["appTitle","contentProviderLabel"]);a.appTitle=s.title;a.contentProviderLabel=l;var u=this._buildApplicationInformationObject(e,a);t.setModel(new o(u),"AppInfo");i()}.bind(this)).catch(function(e){r(e)})}.bind(this))},_buildApplicationInformationObject:function(e,t){var o={},n;for(var i=0;i<e.length;i++){n=e[i];if(t[n]){o[n]={label:r.i18n.getText(n),text:t[n]}}}return o},_getSystemInformation:function(){var e=sap.ushell.Container.getLogonSystem(),t=e.getProductName(),o=e.getProductVersion(),n=e.getSystemName(),i=e.getSystemRole(),s=e.getTenantRole(),a={};if(t){a.productName={label:r.i18n.getText("productName"),text:t}}if(o){a.productVersion={label:r.i18n.getText("productVersionFld"),text:o}}if(n){a.systemName={label:r.i18n.getText("systemName"),text:n}}if(i){a.systemRole={label:r.i18n.getText("systemRole"),text:i}}if(s){a.tenantRole={label:r.i18n.getText("tenantRole"),text:s}}return a},_getUserEnvironmentInformation:function(){var e={};e.userAgentFld={label:r.i18n.getText("userAgentFld"),text:navigator.userAgent};var t=this._getDeviceType(),o=this._isTouchSupported(),n=sap.ushell.Container.getUser(),i=n.getTheme(),s=n.getContentDensity()==="cozy";if(t){e.deviceType={label:r.i18n.getText("deviceType"),text:t}}e.touchSupported={label:r.i18n.getText("touchSupported"),text:o?r.i18n.getText("yes"):r.i18n.getText("no")};e.activeTheme={label:r.i18n.getText("activeTheme"),text:i};e.optimizedForTouch={label:r.i18n.getText("AppearanceContentDensityLabel"),text:s?r.i18n.getText("yes"):r.i18n.getText("no")};return e},_getContentProviderLabel:function(e){if(i.last("/core/contentProviders/providerInfo/show")){return e.getSystemContext().then(function(e){return e.label})}return Promise.resolve(undefined)},_getDeviceType:function(){var e;if(l.system.combi){e=r.i18n.getText("configuration.form_factor_combi")}else if(l.system.desktop){e=r.i18n.getText("configuration.form_factor_desktop")}else if(l.system.tablet){e=r.i18n.getText("configuration.form_factor_tablet")}else if(l.system.phone){e=r.i18n.getText("configuration.form_factor_phone")}return e},_isTouchSupported:function(){return l.support.touch&&(l.system.tablet||l.system.phone||l.system.combi)},calculateNumberOfColumns:function(e){if(!this.isFormVisible(e)){return 1}return Object.keys(e).length>1?2:1},isFormVisible:function(e){return!!e&&!a(e)}})});
//# sourceMappingURL=AboutDialog.controller.js.map