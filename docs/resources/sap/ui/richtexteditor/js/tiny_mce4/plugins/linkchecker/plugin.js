/* Tiny link checker plugin
 *
 * Copyright 2010-2020 Tiny Technologies Inc.  All rights reserved.
 *
 * Version: 2.1.0-97
 */

!function(p){"use strict";var n,t,e,r,o,u,d=function(n){var t=n,e=function(){return t};return{get:e,set:function(n){t=n},clone:function(){return d(e())}}},i=function(n){return parseInt(n,10)},c=function(n,t){var e=n-t;return 0===e?0:0<e?1:-1},a=function(n,t,e){return{major:n,minor:t,patch:e}},f=function(n){var t=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(n);return t?a(i(t[1]),i(t[2]),i(t[3])):a(0,0,0)},m=function(n,t){return!!n&&-1===function(n,t){var e=c(n.major,t.major);if(0!==e)return e;var r=c(n.minor,t.minor);if(0!==r)return r;var o=c(n.patch,t.patch);return 0!==o?o:0}(f([(e=n).majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join(".")),f(t));var e},l=function(r,o){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=r.console;e&&o in e&&e[o].apply(e,arguments)}},h={log:l(window,"log"),error:l(window,"error"),warn:l(window,"warm")},s=function(){},v=function(e,r){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e(r.apply(null,n))}},g=function(n){return function(){return n}},y=function(n){return n},w=g(!1),k=g(!0),T=function(n){return n.getParam("linkchecker_service_url",void 0,"string")},b=function(t,e){var r,n;return(n=function(){var n=arguments;clearTimeout(r),r=setTimeout(function(){t.apply(this,n)},e)}).stop=function(){clearTimeout(r)},n},x=function(){return O},O=(n=function(n){return n.isNone()},r={fold:function(n,t){return n()},is:w,isSome:w,isNone:k,getOr:e=function(n){return n},getOrThunk:t=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:g(null),getOrUndefined:g(void 0),or:e,orThunk:t,map:x,each:s,bind:x,exists:w,forall:k,filter:x,equals:n,equals_:n,toArray:function(){return[]},toString:g("none()")},Object.freeze&&Object.freeze(r),r),_=function(e){var n=g(e),t=function(){return o},r=function(n){return n(e)},o={fold:function(n,t){return t(e)},is:function(n){return e===n},isSome:k,isNone:w,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:t,orThunk:t,map:function(n){return _(n(e))},each:function(n){n(e)},bind:r,exists:r,forall:r,filter:function(n){return n(e)?o:O},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(n){return n.is(e)},equals_:function(n,t){return n.fold(w,function(n){return t(e,n)})}};return o},E={some:_,none:x,from:function(n){return null==n?O:_(n)}},j=function(t){return function(n){return function(n){if(null===n)return"null";var t=typeof n;return"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t}(n)===t}},A=j("object"),R=j("array"),S=j("boolean"),F=j("function"),C=Array.prototype.slice,D=Array.prototype.indexOf,I=Array.prototype.push,P=function(n,t){return e=n,r=t,-1<D.call(e,r);var e,r},N=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var u=n[o];r[o]=t(u,o)}return r},L=function(n,t){for(var e=0,r=n.length;e<r;e++){t(n[e],e)}},M=function(n,t,e){return L(n,function(n){e=t(e,n)}),e},U=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!R(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);I.apply(t,n[e])}return t},B=(F(Array.from)&&Array.from,Object.keys),q=Object.hasOwnProperty,J=function(n,t){for(var e=B(n),r=0,o=e.length;r<o;r++){var u=e[r];t(n[u],u)}},V=function(n,e){return H(n,function(n,t){return{k:t,v:e(n,t)}})},H=function(n,r){var o={};return J(n,function(n,t){var e=r(n,t);o[e.k]=e.v}),o},z=function(n,e){var r=[];return J(n,function(n,t){r.push(e(n,t))}),r},W=function(n,t){return $(n,t)?E.from(n[t]):E.none()},$=function(n,t){return q.call(n,t)},Y=function(i){if(!R(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],e={};return L(i,function(n,r){var t=B(n);if(1!==t.length)throw new Error("one and only one name per case");var o=t[0],u=n[o];if(void 0!==e[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!R(u))throw new Error("case arguments must be an array");c.push(o),e[o]=function(){var n=arguments.length;if(n!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+n);for(var e=new Array(n),t=0;t<e.length;t++)e[t]=arguments[t];return{fold:function(){if(arguments.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+arguments.length);return arguments[r].apply(null,e)},match:function(n){var t=B(n);if(c.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+t.join(","));if(!function(n,t){for(var e=0,r=n.length;e<r;++e)if(!0!==t(n[e],e))return!1;return!0}(c,function(n){return P(t,n)}))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,e)},log:function(n){p.console.log(n,{constructors:c,constructor:o,params:e})}}}}),e},K=Y([{invalid:["invalidUrl"]},{unknown:["unknownUrl"]},{valid:["validUrl"]}]),X=function(n,t,e,r){return n.fold(t,e,r)},G=function(n){return n&&/^https?:\/\//.test(n)},Q=function(n){return 0===n.indexOf("mailto:")||"#"===n.charAt(0)},Z=tinymce.DOM,nn=tinymce.util.Tools,tn="data-mce-linkchecker-status",en="data-mce-linkchecker-focus",rn=function(n){var t=Z.select('a[href]:not([href=""])',n);return nn.map(t,function(n){return Z.getAttrib(n,"href")})},on=function(n,t){Z.setAttrib(n,tn,t),an(n)&&Z.setAttrib(n,"aria-invalid",!0)},un=function(t,n){return nn.map(n,function(n){return{url:t(Z.getAttrib(n,"href")),elm:n}})},cn=function(n,t){return nn.grep(n,function(n){return n.url===t})},an=function(n){return"invalid"===Z.getAttrib(n,tn)},fn=function(n,t){return Z.setAttrib(n,en,t?"true":null)},ln=function(t){return function(n){nn.each(n,function(n){return n.attr(t,null)})}},sn=function(c){return function(n){var t,e,r,o=n.trim(),u=!1===G(t=o)&&/^\w+:/.test(t)?o:c.documentBaseURI.toAbsolute(o),i=(0===u.indexOf("//")?location.protocol+u:u).replace(/ /g,"%20");return e=i,(r=document.createElement("a")).href=e,G(e)?r.href:e}},pn=function(n){return function(){n.execCommand("mceLink")}},dn=function(n,t){return function(){!function(n){if(!tinymce.Env.ie||10<tinymce.Env.ie){var t=document.createElement("a");t.target="_blank",t.href=n,t.rel="noreferrer noopener";var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,!0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}else{var r=window.open("","_blank");if(r){r.opener=null;var o=r.document;o.open(),o.write('<meta http-equiv="refresh" content="0; url='+tinymce.DOM.encode(n)+'">'),o.close()}}}(sn(n)(tinymce.DOM.getAttrib(t,"href")))}},mn=function(n,t){return function(){n.undoManager.transact(function(){tinymce.DOM.remove(t,!0)})}},hn=function(n,t){return function(){n.add(t.href),on(t,"ignored")}},vn=tinymce.DOM,gn=function(n,t,e){var r,o,u,i,c,a,f,l=new tinymce.ui.Factory.create("menu",{items:[(r=n,r.plugins.link?{text:"Link",icon:"link",onclick:pn(r)}:null),{text:"Open link",icon:"newtab",onclick:dn(n,t)},{text:"Remove link",icon:"unlink",onclick:mn(n,t)},{text:"-"},{text:"Ignore",onclick:hn(e,t)}],context:"contextmenu",onhide:function(){l.remove(),fn(t,!1)}});l.renderTo(document.body),o=n,u=l,i=t,c=vn.getPos(o.getContentAreaContainer()),a=o.dom.getPos(i),"BODY"===(f=o.dom.getRoot()).nodeName?(a.x-=f.ownerDocument.documentElement.scrollLeft||f.scrollLeft,a.y-=f.ownerDocument.documentElement.scrollTop||f.scrollTop):(a.x-=f.scrollLeft,a.y-=f.scrollTop),c.x+=a.x,c.y+=a.y,u.moveTo(c.x,c.y+i.offsetHeight+1),fn(t,!0)},yn=function(n,t){var e,r;n.on("contextmenu",(e=n,r=t,function(n){var t=e.dom.getParent(n.target,"a[href]");an(t)&&(n.preventDefault(),n.stopImmediatePropagation(),gn(e,t,r))}),!0)},wn=function(n,t,e){return[{text:"Ignore",onAction:hn(e,t)}]},kn=function(n,t,e){var r,o=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var u=n[r];t(u,r)&&e.push(u)}return e}(n.getParam("contextmenu","").split(" "),function(n){return""!==n});if(0!==o.length&&-1===o.indexOf("link")){var u=[{text:"Remove link",icon:"unlink",onAction:mn(n,e)},{text:"Open link",icon:"new-tab",onAction:dn(n,e)},{type:"separator"}];return(r=n,r.plugins.link?[{text:"Link...",icon:"link",onAction:pn(r)}]:[]).concat(u).concat(wn(0,e,t))}return wn(0,e,t)},Tn=tinymce.util.Tools,bn=function(n,t){return Tn.grep(n,function(n){return!1===t.has(n)})},xn=function(t){return function(n){return G(n)===t}},On=function(n,t,o,e,u){var r=Tn.grep(Tn.map(rn(u),o),xn(!0));n.checkMany(bn(r,t)).get(function(n){n.fold(e.logError,function(n){return t=u,e=n,r=un(o,Z.select("a[href]",t)),void nn.each(e,function(n,t){nn.each(cn(r,t),function(t){X(n.result,function(n){on(t.elm,"invalid")},function(n){on(t.elm,"unknown")},function(n){on(t.elm,"valid")})})});var t,e,r})})},_n=function(n,t,e,r,o){var u,i,c,a,f=Tn.grep(Tn.map(rn(o),e),xn(!1)),l=bn((u=f,Tn.grep(u,function(n){return!1===Q(n)})),t);i=o,c=l,a=un(e,Z.select("a[href]",i)),nn.each(c,function(n){nn.each(cn(a,n),function(n){on(n.elm,"unknown")})})},En=function(n,t,e,r,o){var u=o.getBody();On(n,t,e,r,u),_n(0,t,e,0,u)},jn=function(n,t,e,r,o,u,i){var c,a,f,l,s=b(En,500);(c=n.serializer).addTempAttr(tn),c.addTempAttr(en),c.addAttributeFilter(tn,ln(tn)),c.addAttributeFilter(en,ln(tn)),n.dom.loadCSS((a=u,n.getParam("linkchecker_content_css")||a+"/content.min.css")),n.on("change setContent undo redo",function(){s(r,t,e,o,n,i)}),En(r,t,e,o,n),i?(l=t,(f=n).ui.registry.addContextMenu("linkchecker",{update:function(n){var t=f.dom.getParent(n,"a[href]");return an(t)?kn(f,l,t):[]}})):yn(n,t)},An=function(n,t){return function(){return{status:n,message:t}}},Rn=An("invalid","URL does not seem to be valid"),Sn=An("none",""),Fn=An("valid","The URL seems to be valid"),Cn=function(n,r,t){var e,o=b((e=t,function(n,t){e.checkOne(n).get(function(n){n.fold(function(){t({status:"none",message:""})},function(n){X(n.result,function(n){t(Rn())},function(n){t(Sn())},function(n){t(Fn())})})})}),500);return function(n,t){var e=r(n.url);0===n.url.length||!G(e)&&Q(e)?t(Fn()):G(e)?o(e,t):t(Sn())}},Dn=function(n,t){return $(e=n,r=t)?E.from(e[r]):E.none();var e,r},In=function(n,t){var e={};return e[n]=t,e},Pn=function(e){return{is:function(n){return e===n},isValue:k,isError:w,getOr:g(e),getOrThunk:g(e),getOrDie:g(e),or:function(n){return Pn(e)},orThunk:function(n){return Pn(e)},fold:function(n,t){return t(e)},map:function(n){return Pn(n(e))},mapError:function(n){return Pn(e)},each:function(n){n(e)},bind:function(n){return n(e)},exists:function(n){return n(e)},forall:function(n){return n(e)},toOption:function(){return E.some(e)}}},Nn=function(e){return{is:w,isValue:w,isError:k,getOr:y,getOrThunk:function(n){return n()},getOrDie:function(){return n=String(e),function(){throw new Error(n)}();var n},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,t){return n(e)},map:function(n){return Nn(e)},mapError:function(n){return Nn(n(e))},each:s,bind:function(n){return Nn(e)},exists:w,forall:k,toOption:E.none}},Ln={value:Pn,error:Nn,fromOption:function(n,t){return n.fold(function(){return Nn(t)},Pn)}},Mn=(Y([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),Object.prototype.hasOwnProperty),Un=function(i){return function(){for(var n=new Array(arguments.length),t=0;t<n.length;t++)n[t]=arguments[t];if(0===n.length)throw new Error("Can't merge zero objects");for(var e={},r=0;r<n.length;r++){var o=n[r];for(var u in o)Mn.call(o,u)&&(e[u]=i(e[u],o[u]))}return e}},Bn=Un(function(n,t){return A(n)&&A(t)?Bn(n,t):t}),qn=Un(function(n,t){return t}),Jn=function(n,t){return e=t,r={},L(n,function(n){var t=n[e];r[t]=n}),r;var e,r};(u=o||(o={}))[u.Error=0]="Error",u[u.Value=1]="Value";var Vn,Hn,zn,Wn=function(n,t,e){return n.stype===o.Error?t(n.serror):e(n.svalue)},$n=function(n){return{stype:o.Value,svalue:n}},Yn=function(n){return{stype:o.Error,serror:n}},Kn=function(n){return Wn(n,Ln.error,Ln.value)},Xn=$n,Gn=function(n){var t=[],e=[];return L(n,function(n){Wn(n,function(n){return e.push(n)},function(n){return t.push(n)})}),{values:t,errors:e}},Qn=Yn,Zn=function(n,t){return n.stype===o.Value?t(n.svalue):n},nt=function(n,t){return n.stype===o.Error?t(n.serror):n},tt=function(n,t){return n.stype===o.Value?{stype:o.Value,svalue:t(n.svalue)}:n},et=function(n,t){return n.stype===o.Error?{stype:o.Error,serror:t(n.serror)}:n},rt=Y([{setOf:["validator","valueType"]},{arrOf:["valueType"]},{objOf:["fields"]},{itemOf:["validator"]},{choiceOf:["key","branches"]},{thunk:["description"]},{func:["args","outputSchema"]}]),ot=Y([{field:["name","presence","type"]},{state:["name"]}]),ut=function(n){return A(n)&&100<B(n).length?" removed due to size":JSON.stringify(n,null,2)},it=function(n,t){return Qn([{path:n,getErrorInfo:t}])},ct=Y([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),at=ct.strict,ft=(ct.asOption,ct.defaultedThunk,ct.asDefaultedOptionThunk,ct.mergeWithThunk,function(n){return v(Qn,U)(n)}),lt=function(n,t){var e,r,o=Gn(n);return 0<o.errors.length?ft(o.errors):(e=o.values,r=t,0<e.length?Xn(Bn(r,qn.apply(void 0,e))):Xn(r))},st=function(n){var t=Gn(n);return 0<t.errors.length?ft(t.errors):Xn(t.values)},pt=Y([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),dt=function(e,r,o){return Dn(r,o).fold(function(){return n=o,t=r,it(e,function(){return'Could not find valid *strict* value for "'+n+'" in '+ut(t)});var n,t},Xn)},mt=function(n,t,e){var r=Dn(n,t).fold(function(){return e(n)},y);return Xn(r)},ht=function(c,a,n,f){return n.fold(function(o,e,n,r){var u=function(n){var t=r.extract(c.concat([o]),f,n);return tt(t,function(n){return In(e,f(n))})},i=function(n){return n.fold(function(){var n=In(e,f(E.none()));return Xn(n)},function(n){var t=r.extract(c.concat([o]),f,n);return tt(t,function(n){return In(e,f(E.some(n)))})})};return n.fold(function(){return Zn(dt(c,a,o),u)},function(n){return Zn(mt(a,o,n),u)},function(){return Zn(Xn(Dn(a,o)),i)},function(n){return Zn((e=n,r=Dn(t=a,o).map(function(n){return!0===n?e(t):n}),Xn(r)),i);var t,e,r},function(n){var t=n(a),e=tt(mt(a,o,g({})),function(n){return Bn(t,n)});return Zn(e,u)})},function(n,t){var e=t(a);return Xn(In(n,f(e)))})},vt=function(c){return{extract:function(n,t,e){return r=n,o=e,u=t,i=N(c,function(n){return ht(r,o,n,u)}),lt(i,{});var r,o,u,i},toString:function(){return"obj{\n"+N(c,function(n){return n.fold(function(n,t,e,r){return n+" -> "+r.toString()},function(n,t){return"state("+n+")"})}).join("\n")+"}"},toDsl:function(){return rt.objOf(N(c,function(n){return n.fold(function(n,t,e,r){return ot.field(n,e,r)},function(n,t){return ot.state(n)})}))}}},gt=g((Vn=Xn,{extract:function(e,n,t){return nt(Vn(t,n),function(n){return t=n,it(e,function(){return t});var t})},toString:function(){return"val"},toDsl:function(){return rt.itemOf(Vn)}})),yt=v(function(o){return{extract:function(e,r,n){var t=N(n,function(n,t){return o.extract(e.concat(["["+t+"]"]),r,n)});return st(t)},toString:function(){return"array("+o.toString()+")"},toDsl:function(){return rt.arrOf(o)}}},vt),wt=(pt.state,pt.field),kt=function(n,t,e){return Kn((r=n,o=y,u=e,i=t.extract([r],o,u),et(i,function(n){return{input:u,errors:n}})));var r,o,u,i},Tt=function(n,t,e){return kt(n,t,e).fold(function(n){throw new Error(bt(n))},y)},bt=function(n){return"Errors: \n"+(t=n.errors,e=10<t.length?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t,N(e,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))+"\n\nInput object: "+ut(n.input);var t,e},xt=function(){return(new Date).getTime()};(zn=Hn||(Hn={})).JSON="json",zn.Blob="blob",zn.Text="text",zn.FormData="formdata",zn.MultipartFormData="multipart/form-data";var Ot,_t,Et,jt=function(){return(jt=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)},At={},Rt={exports:At};_t=At,Et=Rt,Ot=void 0,function(n){"object"==typeof _t&&void 0!==Et?Et.exports=n():"function"==typeof Ot&&Ot.amd?Ot([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function u(i,c,a){function f(t,n){if(!c[t]){if(!i[t]){var e=!1;if(!n&&e)return e(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=c[t]={exports:{}};i[t][0].call(o.exports,function(n){return f(i[t][1][n]||n)},o,o.exports,u,i,c,a)}return c[t].exports}for(var l=!1,n=0;n<a.length;n++)f(a[n]);return f}({1:[function(n,t,e){var r,o,u=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(n){try{return r.call(null,t,0)}catch(n){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(n){r=i}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var f,l=[],s=!1,p=-1;function d(){s&&f&&(s=!1,f.length?l=f.concat(l):p=-1,l.length&&m())}function m(){if(!s){var n=a(d);s=!0;for(var t=l.length;t;){for(f=l,l=[];++p<t;)f&&f[p].run();p=-1,t=l.length}f=null,s=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(n){try{return o.call(null,t)}catch(n){return o.call(this,t)}}}(n)}}function h(n,t){this.fun=n,this.array=t}function v(){}u.nextTick=function(n){var t=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];l.push(new h(n,t)),1!==l.length||s||a(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=v,u.addListener=v,u.once=v,u.off=v,u.removeListener=v,u.removeAllListeners=v,u.emit=v,u.prependListener=v,u.prependOnceListener=v,u.listeners=function(n){return[]},u.binding=function(n){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(n){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],2:[function(n,s,t){(function(e){!function(n){var t=setTimeout;function r(){}function u(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(n,this)}function o(e,r){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,u._immediateFn(function(){var n=1===e._state?r.onFulfilled:r.onRejected;if(null!==n){var t;try{t=n(e._value)}catch(n){return void c(r.promise,n)}i(r.promise,t)}else(1===e._state?i:c)(r.promise,e._value)})):e._deferreds.push(r)}function i(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof u)return t._state=3,t._value=n,void a(t);if("function"==typeof e)return void l((r=e,o=n,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=n,a(t)}catch(n){c(t,n)}var r,o}function c(n,t){n._state=2,n._value=t,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&u._immediateFn(function(){n._handled||u._unhandledRejectionFn(n._value)});for(var t=0,e=n._deferreds.length;t<e;t++)o(n,n._deferreds[t]);n._deferreds=null}function f(n,t,e){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.promise=e}function l(n,t){var e=!1;try{n(function(n){e||(e=!0,i(t,n))},function(n){e||(e=!0,c(t,n))})}catch(n){if(e)return;e=!0,c(t,n)}}u.prototype.catch=function(n){return this.then(null,n)},u.prototype.then=function(n,t){var e=new this.constructor(r);return o(this,new f(n,t,e)),e},u.all=function(n){var c=Array.prototype.slice.call(n);return new u(function(r,o){if(0===c.length)return r([]);var u=c.length;function i(t,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if("function"==typeof e)return void e.call(n,function(n){i(t,n)},o)}c[t]=n,0==--u&&r(c)}catch(n){o(n)}}for(var n=0;n<c.length;n++)i(n,c[n])})},u.resolve=function(t){return t&&"object"==typeof t&&t.constructor===u?t:new u(function(n){n(t)})},u.reject=function(e){return new u(function(n,t){t(e)})},u.race=function(o){return new u(function(n,t){for(var e=0,r=o.length;e<r;e++)o[e].then(n,t)})},u._immediateFn="function"==typeof e?function(n){e(n)}:function(n){t(n,0)},u._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},u._setImmediateFn=function(n){u._immediateFn=n},u._setUnhandledRejectionFn=function(n){u._unhandledRejectionFn=n},void 0!==s&&s.exports?s.exports=u:n.Promise||(n.Promise=u)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,f){(function(n,t){var r=a("process/browser.js").nextTick,e=Function.prototype.apply,o=Array.prototype.slice,u={},i=0;function c(n,t){this._id=n,this._clearFn=t}f.setTimeout=function(){return new c(e.call(setTimeout,window,arguments),clearTimeout)},f.setInterval=function(){return new c(e.call(setInterval,window,arguments),clearInterval)},f.clearTimeout=f.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},f.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},f.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},f._unrefActive=f.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;0<=t&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},t))},f.setImmediate="function"==typeof n?n:function(n){var t=i++,e=!(arguments.length<2)&&o.call(arguments,1);return u[t]=!0,r(function(){u[t]&&(e?n.apply(null,e):n.call(null),f.clearImmediate(t))}),t},f.clearImmediate="function"==typeof t?t:function(n){delete u[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var St,Ft,Ct,Dt,It,Pt=Rt.exports.boltExport,Nt=function(n){var e=E.none(),t=[],r=function(n){o()?i(n):t.push(n)},o=function(){return e.isSome()},u=function(n){L(n,i)},i=function(t){e.each(function(n){p.setTimeout(function(){t(n)},0)})};return n(function(n){e=E.some(n),u(t),t=[]}),{get:r,map:function(e){return Nt(function(t){r(function(n){t(e(n))})})},isReady:o}},Lt={nu:Nt,pure:function(t){return Nt(function(n){n(t)})}},Mt=function(n){p.setTimeout(function(){throw n},0)},Ut=function(e){var n=function(n){e().then(n,Mt)};return{map:function(n){return Ut(function(){return e().then(n)})},bind:function(t){return Ut(function(){return e().then(function(n){return t(n).toPromise()})})},anonBind:function(n){return Ut(function(){return e().then(function(){return n.toPromise()})})},toLazy:function(){return Lt.nu(n)},toCached:function(){var n=null;return Ut(function(){return null===n&&(n=e()),n})},toPromise:e,get:n}},Bt=function(n){return Ut(function(){return new Pt(n)})},qt=function(n){return Ut(function(){return Pt.resolve(n)})},Jt=function(u){return jt(jt({},u),{toCached:function(){return Jt(u.toCached())},bindFuture:function(t){return Jt(u.bind(function(n){return n.fold(function(n){return qt(Ln.error(n))},function(n){return t(n)})}))},bindResult:function(t){return Jt(u.map(function(n){return n.bind(t)}))},mapResult:function(t){return Jt(u.map(function(n){return n.map(t)}))},mapError:function(t){return Jt(u.map(function(n){return n.mapError(t)}))},foldResult:function(t,e){return u.map(function(n){return n.fold(t,e)})},withTimeout:function(n,o){return Jt(Bt(function(t){var e=!1,r=p.setTimeout(function(){e=!0,t(Ln.error(o()))},n);u.get(function(n){e||(p.clearTimeout(r),t(n))})}))}})},Vt=function(n){return Jt(Bt(n))},Ht=function(n){return Jt(qt(Ln.value(n)))},zt={nu:Vt,wrap:Jt,pure:Ht,value:Ht,error:function(n){return Jt(qt(Ln.error(n)))},fromResult:function(n){return Jt(qt(n))},fromFuture:function(n){return Jt(n.map(Ln.value))},fromPromise:function(n){return Vt(function(t){n.then(function(n){t(Ln.value(n))},function(n){t(Ln.error(n))})})}},Wt=(void 0!==p.window?p.window:Function("return this;")(),function(n){try{var t=JSON.parse(n);return Ln.value(t)}catch(n){return Ln.error("Response was not JSON.")}}),$t=function(t){return Bt(function(e){var n=new p.FileReader;n.onload=function(n){var t=n.target?n.target.result:new p.Blob([]);e(t)},n.readAsText(t)})},Yt=function(n){return qt(n.response)},Kt=function(n,t){switch(n){case Hn.JSON:return Wt(t.response).fold(function(){return Yt(t)},qt);case Hn.Blob:return e=t,E.from(e.response).map($t).getOr(qt("no response content"));case Hn.Text:default:return Yt(t)}var e},Xt=function(n){var t,e=(t=n.body,E.from(t).bind(function(n){switch(n.type){case Hn.JSON:return E.some("application/json");case Hn.FormData:return E.some("application/x-www-form-urlencoded; charset=UTF-8");case Hn.MultipartFormData:return E.none();case Hn.Text:default:return E.some("text/plain")}})),r=!0===n.credentials?E.some(!0):E.none(),o=function(n){switch(n){case Hn.Blob:return"application/octet-stream";case Hn.JSON:return"application/json, text/javascript";case Hn.Text:return"text/plain";default:return""}}(n.responseType)+", */*; q=0.01",u=void 0!==n.headers?n.headers:{};return{contentType:e,responseType:function(n){switch(n){case Hn.JSON:return E.none();case Hn.Blob:return E.some("blob");case Hn.Text:return E.some("text");default:return E.none()}}(n.responseType),credentials:r,accept:o,headers:u,progress:F(n.progress)?E.some(n.progress):E.none()}},Gt=function(n){var e=new p.FormData;return J(n,function(n,t){e.append(t,n)}),e},Qt=function(a){return zt.nu(function(o){var u,i=new p.XMLHttpRequest;i.open(a.method,(u=a.url,E.from(a.query).map(function(n){var t,e=z(n,function(n,t){return encodeURIComponent(t)+"="+encodeURIComponent(n)}),r=(t="?",-1!==u.indexOf(t)?"&":"?");return 0<e.length?u+r+e.join("&"):u}).getOr(u)),!0);var e,n,t=Xt(a);e=i,(n=t).contentType.each(function(n){return e.setRequestHeader("Content-Type",n)}),e.setRequestHeader("Accept",n.accept),n.credentials.each(function(n){return e.withCredentials=n}),n.responseType.each(function(n){return e.responseType=n}),n.progress.each(function(t){return e.upload.addEventListener("progress",function(n){return t(n.loaded,n.total)})}),J(n.headers,function(n,t){return e.setRequestHeader(t,n)});var r,c=function(){var t,n,e;(t=a.url,n=a.responseType,e=i,Kt(n,e).map(function(n){return{message:0===e.status?"Unknown HTTP error (possible cross-domain request)":"Could not load url "+t+": "+e.statusText,status:e.status,responseText:n}})).get(function(n){return o(Ln.error(n))})};i.onerror=c,i.onload=function(){var n,t,e,r;0===i.status&&(n=a.url,t=n,r=0,""!=(e="file:")&&(t.length<e.length||t.substr(r,r+e.length)!==e))?c():i.status<100||400<=i.status?c():function(n,t){var e=function(){return zt.pure(t.response)},r=function(n){return zt.error({message:n,status:t.status,responseText:t.responseText})};switch(n){case Hn.JSON:return Wt(t.response).fold(r,zt.pure);case Hn.Blob:case Hn.Text:return e();default:return r("unknown data type")}}(a.responseType,i).get(o)},(r=a.body,E.from(r).map(function(n){return n.type===Hn.JSON?JSON.stringify(n.data):n.type===Hn.FormData?Gt(n.data):n.type===Hn.MultipartFormData?Gt(n.data):n})).fold(function(){return i.send()},function(n){i.send(n)})})},Zt=function(){return n="",{type:Hn.Text,data:n};var n},ne=function(n,t){var e=-1===n.indexOf("?")?"?":"&";return t?n+e+"apiKey="+encodeURIComponent(t):n},te=function(n){return W(n,"tiny-api-key").orThunk(function(){return W(n,"tinymce-api-key")}).orThunk(function(){return W(n,"textbox-api-key")}).getOrUndefined()},ee=function(n){return n.fold(function(n){var t=n.responseText,e=A(t)?t:n.message;return Ln.error(e)},Ln.value)},re=function(i,c){var a=te(c);return{execute:function(n){var o,t,e=V(n,function(n){return S(n)?String(n):n}),r=ne((o=e,i.replace(/\$\{([^{}]*)\}/g,function(n,t){var e,r=o[t];return"string"==(e=typeof r)||"number"===e?r.toString():n})),a),u=(t={url:r,responseType:Hn.JSON,credentials:!0,headers:c},Qt(jt(jt({},t),{method:"get",body:Zt()}))).map(ee);return zt.wrap(u)}}},oe=function(o,u){var i=te(u);return{execute:function(n){var t,e,r=(t={url:ne(o,i),body:(e=n,{type:Hn.JSON,data:e}),responseType:Hn.JSON,credentials:!0,headers:u},Qt(jt(jt({},t),{method:"post"}))).map(ee);return zt.wrap(r)}}},ue=function(t,o,n,u,e){return!0===e?{known:{},unknown:n}:M(n,function(e,n){var r=u(n);return t(o,r).fold(function(){return{known:e.known,unknown:e.unknown.concat([n])}},function(n){var t=In(r,n);return{known:jt(jt({},e.known),t),unknown:e.unknown}})},{known:{},unknown:[]})},ie=function(n,t,e,r,o,u){var i,c,a,f,l,s=ue(t.get,o,e,r,u);return 0===s.unknown.length?zt.value(s.known):(i=n,c=t,a=s.known,f=s.unknown,l=o,i(f,u).mapResult(function(n){return J(n,function(n,t){c.set(t,n,l)}),jt(jt({},a),n)}))},ce=[(Dt="url",wt(Dt,Dt,at(),gt())),(St="fresh",Ft=!1,wt(St,St,(Ct=Ft,ct.defaultedThunk(g(Ct))),gt()))],ae=vt(ce),fe=vt([wt("urls","urls",at(),(It=ce,yt(It)))]),le=function(n,t,e){var a=function(n,e){void 0===e&&(e=36e5);var t,r,o={},u=function(n,t,e){o[n]={result:t,timestamp:e}},i=function(n,t){return n-t<e};return A(n)&&(t=n,r=xt(),J(t,function(n,t){i(r,n.timestamp)&&u(t,n.result,n.timestamp)})),{set:u,get:function(t,n){return E.from(o[n]).filter(function(n){return i(t,n.timestamp)}).map(function(n){return n.result})},dump:function(){return o}}}(e),f=re(n+"/1/check?url=${url}&fresh=${fresh}",t),r=oe(n+"/1/check",t),l=function(n){return{url:n.url,result:(t=n.url,e=n.result,"VALID"===e?K.valid(t):"INVALID"===e?K.invalid(t):K.unknown(t))};var t,e};return{checkOne:function(o,n){void 0===n&&(n=!1);var t,e,r,u,i,c=xt();return(t=function(n,t){var e={url:encodeURIComponent(o),fresh:t},r=Tt("ephox.link.service.one.ajax.service.get",ae,e);return f.execute(r)},e=a,r=o,u=c,(!0===(i=n)?E.none():e.get(u,r)).fold(function(){return t(r,i).mapResult(function(n){return e.set(r,n,u),n})},function(n){return zt.pure(n)})).mapResult(l)},checkMany:function(n,t){void 0===t&&(t=!1);var e=xt();return ie(function(n,t){var e=Tt("ephox.link.service.many.ajax.service.post",fe,{urls:n});return r.execute(e).mapResult(function(n){return Jn(n.results,"url")})},a,n,function(n){return n.url},e,t).mapResult(function(n){return V(n,l)})},dumpCache:a.dump}},se=function(n,t,e){var u,i=(u=t,M(n,function(n,t){var e,r=jt(jt({},u({url:t})),{origUrl:t}),o=r.url;return jt(jt({},n),((e={})[o]=$(n,o)?n[o].concat([r]):[r],e))},{}));return e(N(z(i,function(n){return n}),function(n){return n[0]})).mapResult(function(n){return r=i,o={},J(n,function(t,n){var e=r[n];L(e,function(n){o[n.origUrl]=t})}),o;var r,o})},pe=function(t){var n,e,r,o,u=(n=T(t),o=(r=t).getParam("api_key"),e=o||r.getParam("linkchecker_api_key"),le(n,e?{"tinymce-api-key":e}:{})),i=function(n){return t.getParam("linkchecker_preprocess",y,"function")(n)};return{checkOne:function(n){var t=i({url:n});return u.checkOne(t.url)},checkMany:function(n){return se(n,i,function(n){return u.checkMany(n)})}}},de=function(){var l,s=function(){void 0!==l&&(l.parentNode.removeChild(l),l=void 0)};return{add:function(n,t){s();var e,r,o=me(n,t);e="This link seems to be invalid.",(r=document.createElement("div")).className="mce-widget mce-tooltip mce-tooltip-s",r.setAttribute("role","presentation"),r.innerHTML='<div class="mce-tooltip-arrow"></div><div style="white-space:pre;" class="mce-tooltip-inner">'+e+"</div>",l=r,document.body.appendChild(l);var u=l.getBoundingClientRect(),i=n.getBody().getBoundingClientRect(),c=o.top-u.height/2,a=o.center-u.width/2;a<=0?(l.className="mce-widget mce-tooltip mce-tooltip-sw",a=o.center):o.center+u.width/2-20>i.width&&(l.className="mce-widget mce-tooltip mce-tooltip-se",a=o.center-u.width);var f="position:absolute;top:"+c+"px;left:"+a+"px;";l.setAttribute("style",f)},remove:s}},me=function(n,t){var e=t.getBoundingClientRect(),r=n.inline?{top:0,left:0}:n.getContentAreaContainer().getBoundingClientRect(),o=n.dom.getViewPort();return{top:e.top+r.top+o.y-e.height,center:e.left+r.left+o.x+e.width/2}},he=function(a){var f=de();a.on("mouseover mouseout",function(n){var t,e,r,o,u,i=n.target,c="mouseover"===n.type;t=f,r=i,o=c,u=(e=a).dom.getParent(r,"a[href]"),an(u)&&!0===o?t.add(e,u):t.remove()}),a.on("remove",function(){f.remove()})},ve=function(r,o){if(m(tinymce,"4.4.3"))return h.error('The "linkchecker" plugin requires at least 4.4.3 version of TinyMCE.'),function(){};var t,u,i,c=!m(tinymce,"5.0.0"),n=d(0),a=pe(r),f=(t={},{add:function(n){t[n]=!0},has:function(n){return n in t}}),l=sn(r),s=(u=r,i=n,{logError:function(n){var t,e,r="string"==typeof(t=n)?{message:t}:t;e=r,u.fire("LinkCheckerError",e),i.set(i.get()+1),i.get()<5&&!u.removed&&p.console.error("Link checker error: "+r.message)}});return r.on("SkinLoaded",function(){var n,t,e;T(r)?(jn(r,f,l,a,s,o,c),t=l,e=a,"filepicker_validator_handler"in(n=r).settings==0&&(n.settings.filepicker_validator_handler=Cn(0,t,e))):s.logError("You need to specify the linkchecker_service_url setting")}),c||he(r),{}};tinymce.PluginManager.add("linkchecker",ve)}(window);