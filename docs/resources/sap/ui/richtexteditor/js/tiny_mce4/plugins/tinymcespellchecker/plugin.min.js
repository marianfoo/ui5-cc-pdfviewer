/* Ephox Spell Checker Pro
 *
 * Copyright 2010-2016 Ephox Corporation.  All rights reserved.
 *
 * Version: 2.0.1-158
 */

!function(_){"use strict";var t=function(n){return parseInt(n,10)},u=function(n,e){var t=n-e;return 0===t?0:0<t?1:-1},r=function(n,e,t){return{major:n,minor:e,patch:t}},h=function(n){var e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(n);return e?r(t(e[1]),t(e[2]),t(e[3])):r(0,0,0)},v=function(n,e){var t=u(n.major,e.major);if(0!==t)return t;var r=u(n.minor,e.minor);if(0!==r)return r;var o=u(n.patch,e.patch);return 0!==o?o:0},y=function(n){return h([(e=n).majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join("."));var e},S=function(n,e){return!!n&&-1===v(y(n),h(e))},n=function(e){return function(n){return function(n){if(null===n)return"null";var e=typeof n;return"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(n)===e}},i=n("string"),c=n("object"),a=n("array"),o=n("boolean"),f=n("function"),s=n("number"),w=function(){},g=function(t,r){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(r.apply(null,n))}},b=function(n){return function(){return n}},x=function(n){return n};function l(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}var e,d,p,m,k=function(n){return n()},T=b(!1),O=b(!0),E=function(){return C},C=(e=function(n){return n.isNone()},m={fold:function(n,e){return n()},is:T,isSome:T,isNone:O,getOr:p=function(n){return n},getOrThunk:d=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:b(null),getOrUndefined:b(void 0),or:p,orThunk:d,map:E,each:w,bind:E,exists:T,forall:O,filter:E,equals:e,equals_:e,toArray:function(){return[]},toString:b("none()")},Object.freeze&&Object.freeze(m),m),I=function(t){var n=b(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:O,isNone:T,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return I(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:C},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(T,function(n){return e(t,n)})}};return o},N={some:I,none:E,from:function(n){return null==n?C:I(n)}},A=Array.prototype.slice,D=Array.prototype.indexOf,R=Array.prototype.push,L=function(n,e){return D.call(n,e)},M=function(n,e){return-1<L(n,e)},j=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return!0}return!1},P=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r},B=function(n,e){for(var t=0,r=n.length;t<r;t++){e(n[t],t)}},F=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t},z=function(n,e,t){return B(n,function(n){t=e(t,n)}),t},W=function(n,e){for(var t=0,r=n.length;t<r;t++){var o=n[t];if(e(o,t))return N.some(o)}return N.none()},q=function(n,e){for(var t=0,r=n.length;t<r;t++){if(e(n[t],t))return N.some(t)}return N.none()},U=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!a(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);R.apply(e,n[t])}return e},V=function(n,e){return U(P(n,e))},H=function(n,e){for(var t=0,r=n.length;t<r;++t){if(!0!==e(n[t],t))return!1}return!0},J=function(n){var e=A.call(n,0);return e.reverse(),e},K=function(n){return[n]},Y=(f(Array.from)&&Array.from,Object.keys),X=Object.hasOwnProperty,$=function(n,e){for(var t=Y(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}},G=function(n,t){return Q(n,function(n,e){return{k:e,v:t(n,e)}})},Q=function(n,r){var o={};return $(n,function(n,e){var t=r(n,e);o[t.k]=t.v}),o},Z=function(n,t){var r=[];return $(n,function(n,e){r.push(t(n,e))}),r},nn=function(n){return Z(n,function(n){return n})},en=function(n,e){return tn(n,e)?N.from(n[e]):N.none()},tn=function(n,e){return X.call(n,e)},rn=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:b(n)}},on={fromHtml:function(n,e){var t=(e||_.document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw _.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return rn(t.childNodes[0])},fromTag:function(n,e){var t=(e||_.document).createElement(n);return rn(t)},fromText:function(n,e){var t=(e||_.document).createTextNode(n);return rn(t)},fromDom:rn,fromPoint:function(n,e,t){var r=n.dom();return N.from(r.elementFromPoint(e,t)).map(rn)}},un=(_.Node.ATTRIBUTE_NODE,_.Node.CDATA_SECTION_NODE,_.Node.COMMENT_NODE),cn=_.Node.DOCUMENT_NODE,an=(_.Node.DOCUMENT_TYPE_NODE,_.Node.DOCUMENT_FRAGMENT_NODE,_.Node.ELEMENT_NODE),fn=_.Node.TEXT_NODE,sn=(_.Node.PROCESSING_INSTRUCTION_NODE,_.Node.ENTITY_REFERENCE_NODE,_.Node.ENTITY_NODE,_.Node.NOTATION_NODE,void 0!==_.window?_.window:Function("return this;")()),ln=function(n,e){return function(n,e){for(var t=null!=e?e:sn,r=0;r<n.length&&null!=t;++r)t=t[n[r]];return t}(n.split("."),e)},gn=function(n,e){var t=ln(n,e);if(null==t)throw new Error(n+" not available on this browser");return t},dn=function(n){var e,t=ln("ownerDocument.defaultView",n);return(e=t,gn("HTMLElement",e)).prototype.isPrototypeOf(n)},pn=function(n){return n.dom().nodeName.toLowerCase()},mn=function(n){return n.dom().nodeType},hn=function(e){return function(n){return mn(n)===e}},vn=function(n){return mn(n)===un||"#comment"===pn(n)},yn=hn(an),wn=hn(fn),bn=function(n,e,t){if(!(i(t)||o(t)||s(t)))throw _.console.error("Invalid call to Attr.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},xn=function(n,e,t){bn(n.dom(),e,t)},kn=function(n,e){var t=n.dom().getAttribute(e);return null===t?void 0:t},Tn=function(n,e){n.dom().removeAttribute(e)};var On=function(n,e,t){return 0!=(n.compareDocumentPosition(e)&t)},En=function(n,e){return On(n,e,_.Node.DOCUMENT_POSITION_CONTAINED_BY)},_n=function(){return(_n=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)},Sn=function(n){var e=n,t=function(){return e};return{get:t,set:function(n){e=n},clone:function(){return Sn(t())}}},Cn=function(){return In(0,0)},In=function(n,e){return{major:n,minor:e}},Nn={nu:In,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?Cn():function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}}(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return In(r(1),r(2))}(n,t)},unknown:Cn},An="Firefox",Dn=function(n,e){return function(){return e===n}},Rn=function(n){var e=n.current;return{current:e,version:n.version,isEdge:Dn("Edge",e),isChrome:Dn("Chrome",e),isIE:Dn("IE",e),isOpera:Dn("Opera",e),isFirefox:Dn(An,e),isSafari:Dn("Safari",e)}},Ln={unknown:function(){return Rn({current:void 0,version:Nn.unknown()})},nu:Rn,edge:b("Edge"),chrome:b("Chrome"),ie:b("IE"),opera:b("Opera"),firefox:b(An),safari:b("Safari")},Mn="Windows",jn="Android",Pn="Solaris",Bn="FreeBSD",Fn="ChromeOS",zn=function(n,e){return function(){return e===n}},Wn=function(n){var e=n.current;return{current:e,version:n.version,isWindows:zn(Mn,e),isiOS:zn("iOS",e),isAndroid:zn(jn,e),isOSX:zn("OSX",e),isLinux:zn("Linux",e),isSolaris:zn(Pn,e),isFreeBSD:zn(Bn,e),isChromeOS:zn(Fn,e)}},qn={unknown:function(){return Wn({current:void 0,version:Nn.unknown()})},nu:Wn,windows:b(Mn),ios:b("iOS"),android:b(jn),linux:b("Linux"),osx:b("OSX"),solaris:b(Pn),freebsd:b(Bn),chromeos:b(Fn)},Un=function(n,e){var t=String(e).toLowerCase();return W(n,function(n){return n.search(t)})},Vn=function(n,t){return Un(n,t).map(function(n){var e=Nn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Hn=function(n,t){return Un(n,t).map(function(n){var e=Nn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Jn=function(n,e,t){return""===e||!(n.length<e.length)&&n.substr(t,t+e.length)===e},Kn=function(n,e){return-1!==n.indexOf(e)},Yn=function(n,e){return Jn(n,e,n.length-e.length)},Xn=function(n){return n.replace(/^\s+|\s+$/g,"")},$n=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Gn=function(e){return function(n){return Kn(n,e)}},Qn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return Kn(n,"edge/")&&Kn(n,"chrome")&&Kn(n,"safari")&&Kn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,$n],search:function(n){return Kn(n,"chrome")&&!Kn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return Kn(n,"msie")||Kn(n,"trident")}},{name:"Opera",versionRegexes:[$n,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Gn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Gn("firefox")},{name:"Safari",versionRegexes:[$n,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(Kn(n,"safari")||Kn(n,"mobile/"))&&Kn(n,"applewebkit")}}],Zn=[{name:"Windows",search:Gn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return Kn(n,"iphone")||Kn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Gn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Gn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Gn("linux"),versionRegexes:[]},{name:"Solaris",search:Gn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Gn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Gn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ne={browsers:b(Qn),oses:b(Zn)},ee=Sn(function(n,e){var t,r,o,u,i,c,a,f,s,l,g,d,p=ne.browsers(),m=ne.oses(),h=Vn(p,n).fold(Ln.unknown,Ln.nu),v=Hn(m,n).fold(qn.unknown,qn.nu);return{browser:h,os:v,deviceType:(r=h,o=n,u=e,i=(t=v).isiOS()&&!0===/ipad/i.test(o),c=t.isiOS()&&!i,a=t.isiOS()||t.isAndroid(),f=a||u("(pointer:coarse)"),s=i||!c&&a&&u("(min-device-width:768px)"),l=c||a&&!s,g=r.isSafari()&&t.isiOS()&&!1===/safari/i.test(o),d=!l&&!s&&!g,{isiPad:b(i),isiPhone:b(c),isTablet:b(s),isPhone:b(l),isTouch:b(f),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:b(g),isDesktop:b(d)})}}(_.navigator.userAgent,function(n){return _.window.matchMedia(n).matches})),te=function(){return ee.get()},re=an,oe=cn,ue=function(n,e){var t=n.dom();if(t.nodeType!==re)return!1;var r=t;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},ie=function(n,e){var t,r=void 0===e?_.document:e.dom();return(t=r).nodeType!==re&&t.nodeType!==oe||0===t.childElementCount?[]:P(r.querySelectorAll(n),on.fromDom)},ce=function(n,e){return n.dom()===e.dom()},ae=(te().browser.isIE(),ue),fe=function(n){var e=wn(n)?n.dom().parentNode:n.dom();return null!=e&&e.ownerDocument.body.contains(e)},se=function(n,e,t){for(var r=n.dom(),o=f(t)?t:b(!1);r.parentNode;){r=r.parentNode;var u=on.fromDom(r);if(e(u))return N.some(u);if(o(u))break}return N.none()},le=function(n,e,t){return se(n,function(n){return ue(n,e)},t)},ge=function(n,e,t){return r=le,i=t,ue(o=n,u=e)?N.some(o):f(i)&&i(o)?N.none():r(o,u,i);var r,o,u,i},de={ar:"Arabic",ca:"Catalan",zh:"Chinese",zh_cn:"Chinese (Simplified)",zh_tw:"Chinese (Traditional)",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",en_au:"English (Australia)",en_ca:"English (Canada)",en_gb:"English (United Kingdom)",en_us:"English (United States)",fa:"Farsi",fi:"Finnish",fr:"French",fr_ca:"French (Canada)",de:"German",el:"Greek",he:"Hebrew",hu:"Hungarian",it:"Italian",ja:"Japanese",kk:"Kazakh",ko:"Korean",nb:"Norwegian",no:"Norwegian",pl:"Polish",pt:"Portuguese",pt_br:"Portuguese (Brazil)",pt_pt:"Portuguese (Portugal)",ro:"Romanian",ru:"Russian",sk:"Slovak",sl:"Slovenian",es:"Spanish",es_419:"Spanish (Latin America)",es_es:"Spanish (Spain)",sv:"Swedish",tt:"Tatar",th:"Thai",tr:"Turkish",uk:"Ukrainian"},pe=["en_us","en_gb","da","nl","fi","fr","de","it","nb","pt","pt_pt","es","sv"],me=[{value:"no.language",text:"Off"}],he=function(n){return n.getParam("spellchecker_dialog",!1,"boolean")},ve={useDialog:he,getLanguage:function(n){return n.getParam("spellchecker_language","en_us","string")},setLanguage:function(n,e){n.settings.spellchecker_language=e},getLanguages:function(n){var e,t=!he(n),r=n.getParam("spellchecker_languages",pe),o=[];return i(r)?(e=r.split(","),o=P(e,function(n){var e=n.split("=");return{value:e[1],text:e[0]}})):a(r)&&(o=P(r,function(n){return{value:n,text:tn(de,n)?de[n]:n.toUpperCase()}})),t?me.concat(o):o},getWhitelist:function(n){return n.getParam("spellchecker_whitelist",[],"array")},getApiKey:function(n){return n.getParam("api_key")||n.getParam("spellchecker_api_key")},getHandler:function(n){return n.getParam("spellchecker_handler")},getRpcUrl:function(n){return n.getParam("spellchecker_rpc_url","","string")},isActive:function(n){return n.getParam("spellchecker_active",!0,"boolean")},getSelectContentLanguages:function(n){return n.getParam("spellchecker_select_languages","en,es,fr,de,pt,zh")}},ye=function(n){return void 0!==n.style&&f(n.style.getPropertyValue)},we=function(n,e,t){!function(n,e,t){if(!i(t))throw _.console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);ye(n)&&n.style.setProperty(e,t)}(n.dom(),e,t)},be=function(n,e){var t=n.dom(),r=_.window.getComputedStyle(t).getPropertyValue(e),o=""!==r||fe(n)?r:xe(t,e);return null===o?void 0:o},xe=function(n,e){return ye(n)?n.style.getPropertyValue(e):""},ke=function(n,e){var t=n.dom(),r=xe(t,e);return N.from(r).filter(function(n){return 0<n.length})},Te=function(n,e){var t,r,o,u,i=n.dom();r=e,ye(t=i)&&t.style.removeProperty(r),o="style",(u=n.dom())&&u.hasAttribute&&u.hasAttribute(o)&&""===Xn(kn(n,"style"))&&Tn(n,"style")},Oe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var r={};return B(e,function(n,e){r[n]=b(t[e])}),r}},Ee=function(n){return n.slice(0).sort()},_e=function(n,e){throw new Error("All required keys ("+Ee(n).join(", ")+") were not specified. Specified keys were: "+Ee(e).join(", ")+".")},Se=function(n){throw new Error("Unsupported keys for object: "+Ee(n).join(", "))},Ce=function(e,n){if(!a(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");B(n,function(n){if(!i(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")})},Ie=function(n){var t=Ee(n);W(t,function(n,e){return e<t.length-1&&n===t[e+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})},Ne=function(n){return on.fromDom(n.dom().ownerDocument)},Ae=function(n){return N.from(n.dom().parentNode).map(on.fromDom)},De=function(n,e){for(var t=f(e)?e:T,r=n.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=on.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o},Re=function(n){return N.from(n.dom().previousSibling).map(on.fromDom)},Le=function(n){return N.from(n.dom().nextSibling).map(on.fromDom)},Me=function(n){return P(n.dom().childNodes,on.fromDom)},je=function(n,e){var t=n.dom().childNodes;return N.from(t[e]).map(on.fromDom)},Pe=function(n){return n.dom().childNodes.length},Be=(Oe("element","offset"),function(e,t){Ae(e).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})}),Fe=function(n,e){Le(n).fold(function(){Ae(n).each(function(n){We(n,e)})},function(n){Be(n,e)})},ze=function(e,t){je(e,0).fold(function(){We(e,t)},function(n){e.dom().insertBefore(t.dom(),n.dom())})},We=function(n,e){n.dom().appendChild(e.dom())},qe=function(n,e){Be(n,e),We(e,n)},Ue=function(e,n){B(n,function(n){Be(e,n)})},Ve=function(r,o){B(o,function(n,e){var t=0===e?r:o[e-1];Fe(t,n)})},He=function(e,n){B(n,function(n){We(e,n)})},Je=function(n,e){var t=[];return B(Me(n),function(n){e(n)&&(t=t.concat([n])),t=t.concat(Je(n,e))}),t},Ke=function(n){var e=n.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},Ye=function(n){var e=Me(n);0<e.length&&Ue(n,e),Ke(n)},Xe=function(n,e){return ie(e,n)};var $e,Ge,Qe,Ze=($e=wn,Ge="text",{get:function(n){if(!$e(n))throw new Error("Can only get "+Ge+" value of a "+Ge+" node");return Qe(n).getOr("")},getOption:Qe=function(n){return $e(n)?N.from(n.dom().nodeValue):N.none()},set:function(n,e){if(!$e(n))throw new Error("Can only set raw "+Ge+" value of a "+Ge+" node");n.dom().nodeValue=e}}),nt=function(n){return Ze.get(n)},et=function(n,e){Ze.set(n,e)},tt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function rt(){return{up:b({selector:le,closest:ge,predicate:se,all:De}),down:b({selector:Xe,predicate:Je}),styles:b({get:be,getRaw:ke,set:we,remove:Te}),attrs:b({get:kn,set:xn,remove:Tn,copyTo:function(n,e){var t,r,o=z(n.dom().attributes,function(n,e){return n[e.name]=e.value,n},{});t=o,r=e.dom(),$(t,function(n,e){bn(r,e,n)})}}),insert:b({before:Be,after:Fe,afterAll:Ve,append:We,appendAll:He,prepend:ze,wrap:qe}),remove:b({unwrap:Ye,remove:Ke}),create:b({nu:on.fromTag,clone:function(n){return on.fromDom(n.dom().cloneNode(!1))},text:on.fromText}),query:b({comparePosition:function(n,e){return n.dom().compareDocumentPosition(e.dom())},prevSibling:Re,nextSibling:Le}),property:b({children:Me,name:pn,parent:Ae,document:function(n){return n.dom().ownerDocument},isText:wn,isComment:vn,isElement:yn,getText:nt,setText:et,isBoundary:function(n){return!!yn(n)&&("body"===pn(n)||M(tt,pn(n)))},isEmptyTag:function(n){return!!yn(n)&&M(["br","img","hr","input"],pn(n))},isNonEditable:function(n){return yn(n)&&"false"===kn(n,"contenteditable")}}),eq:ce,is:ae}}var ot=Oe("element","offset"),ut=(Oe("element","deltaOffset"),Oe("element","start","finish")),it=(Oe("begin","end"),Oe("element","text"),function(n,e){if(n.property().isText(e))return ot(e,n.property().getText(e).length);var t=n.property().children(e);return 0<t.length?it(n,t[t.length-1]):ot(e,t.length)}),ct=function(n,e,t){var r=n.property().children(e);return 0<r.length&&t<r.length?ct(n,r[t],0):0<r.length&&n.property().isElement(e)&&r.length===t?it(n,r[r.length-1]):ot(e,t)},at=ct,ft=rt(),st=function(n,e){return at(ft,n,e)},lt=function(n){var r=Oe.apply(null,n),o=[];return{bind:function(n){if(void 0===n)throw new Error("Event bind error: undefined handler");o.push(n)},unbind:function(e){o=F(o,function(n){return n!==e})},trigger:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=r.apply(null,n);B(o,function(n){n(t)})}}},gt={create:function(n){return{registry:G(n,function(n){return{bind:n.bind,unbind:n.unbind}}),trigger:G(n,function(n){return n.trigger})}}},dt=function(){return n=function(n){n.unbind()},e=Sn(N.none()),t=function(){e.get().each(n)},{clear:function(){t(),e.set(N.none())},isSet:function(){return e.get().isSome()},set:function(n){t(),e.set(N.some(n))}};var n,e,t},pt=function(t,r){var o=null;return{cancel:function(){null!==o&&(_.clearTimeout(o),o=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==o&&_.clearTimeout(o),o=_.setTimeout(function(){t.apply(null,n),o=null},r)}}},mt=function(n){var e,t,r,o,u,i,c,a=on.fromDom(n.target),f=function(){n.stopPropagation()},s=function(){n.preventDefault()},l=g(s,f);return e=a,t=n.clientX,r=n.clientY,o=f,u=s,i=l,c=n,{target:b(e),x:b(t),y:b(r),stop:o,prevent:u,kill:i,raw:b(c)}},ht=function(n,e,t,r,o){var u,i,c=(u=t,i=r,function(n){u(n)&&i(mt(n))});return n.dom().addEventListener(e,c,o),{unbind:l(vt,n,e,c,o)}},vt=function(n,e,t,r){n.dom().removeEventListener(e,t,r)},yt=b(!0),wt=function(n,e,t){return ht(n,e,yt,t,!1)},bt=function(i){if(!a(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],t={};return B(i,function(n,r){var e=Y(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],u=n[o];if(void 0!==t[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!a(u))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){var n=arguments.length;if(n!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+n);for(var t=new Array(n),e=0;e<t.length;e++)t[e]=arguments[e];return{fold:function(){if(arguments.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+arguments.length);return arguments[r].apply(null,t)},match:function(n){var e=Y(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!H(c,function(n){return M(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,t)},log:function(n){_.console.log(n,{constructors:c,constructor:o,params:t})}}}}),t},xt=bt([{aboveView:["item"]},{inView:["item"]},{belowView:["item"]}]),kt=_n(_n({},xt),{cata:function(n,e,t,r){return n.fold(e,t,r)}});function Tt(i,n){var t=dt(),e=gt.create({onChange:lt([])}),r=pt(function(){e.trigger.onChange()},1e3);!i.inline&&n&&(i.on("init",function(){var n=Kn(i.settings.plugins,"autoresize")?_.document:i.getDoc(),e=on.fromDom(n);t.set(wt(e,"scroll",function(n){r.throttle()})),r.throttle()}),i.on("remove",t.clear));var c=function(n,e){return Kn(i.settings.plugins,"autoresize")?n.top+e.top:n.top},a=function(n,e){return Kn(i.settings.plugins,"autoresize")?n.bottom+e.top:n.bottom};return{sections:function(){return function(){var n=i.getBody();if(!n)return[];var e=Kn(i.settings.plugins,"autoresize")?_.window:i.getWin(),o=(i.inline?i.getBody():i.getContentAreaContainer()).getBoundingClientRect(),u=e.innerHeight,t=on.fromDom(n),r=Me(t);return q(r,function(n){if(!yn(n))return!1;var e=n.dom().getBoundingClientRect(),t=c(e,o),r=a(e,o);return t<u&&0<r}).map(function(e){var n=q(r.slice(e+1),function(n){if(!yn(n))return!1;var e=n.dom().getBoundingClientRect(),t=c(e,o),r=a(e,o);return!(t<u&&0<r)}).map(function(n){return e+1+n}).getOr(r.length);return r.slice(e,n)}).getOr([t])}()},viewport:function(){return{assess:function(n){if(!yn(n))return kt.inView(n);var e,t,r=i.getWin(),o=r?r.innerHeight:0,u=n.dom().getBoundingClientRect();return t=o,((e=u).bottom<0?kt.aboveView:e.top>t?kt.belowView:kt.inView)(n)}}},events:e.registry}}var Ot={fireSpellcheckStart:function(n){return n.fire("SpellcheckStart")},fireSpellcheckEnd:function(n){return n.fire("SpellcheckEnd")},fireIgnore:function(n,e){return n.fire("SpellcheckerIgnore",{word:e})},fireIgnoreAll:function(n,e){return n.fire("SpellcheckerIgnoreAll",{word:e})},fireError:function(n,e){return n.fire("SpellcheckError",e)}},Et=function(n,e,t,r){var o,u,i,c,a,f=(u=e,i=t,c=r,(a=Ne(o=n).dom().createRange()).setStart(o.dom(),u),a.setEnd(i.dom(),c),a),s=ce(n,t)&&e===r;return f.collapsed&&!s},_t=bt([{single:["element"]},{range:["start","soffset","finish","foffset"]}]),St={cata:function(n,e,t){return n.fold(e,t)},single:_t.single,range:function(n,e,t,r){var o=Et(t,r,n,e),u=o?ot(n,e):ot(t,r),i=o?ot(t,r):ot(n,e);return _t.range(u.element(),u.offset(),i.element(),i.offset())}},Ct=function(n,e){var t=kn(n,e);return void 0===t||""===t?[]:t.split(" ")},It=function(n){return void 0!==n.dom().classList},Nt=function(n,e){return o=e,u=Ct(t=n,r="class").concat([o]),xn(t,r,u.join(" ")),!0;var t,r,o,u},At=function(n,e){return o=e,0<(u=F(Ct(t=n,r="class"),function(n){return n!==o})).length?xn(t,r,u.join(" ")):Tn(t,r),!1;var t,r,o,u},Dt=function(n,e){It(n)?n.dom().classList.add(e):Nt(n,e)},Rt=function(n){0===(It(n)?n.dom().classList:Ct(n,"class")).length&&Tn(n,"class")},Lt=function(n,e){It(n)?n.dom().classList.remove(e):At(n,e);Rt(n)},Mt="\ufeff",jt=bt([{before:["element"]},{after:["element"]},{rest:["element"]},{last:["element"]},{invalid:["element","offset"]}]),Pt=(jt.before,jt.after,jt.rest,jt.last,jt.invalid,function(n,e){return q(n,function(n){return n.start()===e})}),Bt=function(n,e,t){var r,o,u=t(n,e);return r=u,o=n.start(),P(r,function(n){return _n(_n({},n),{start:b(n.start()+o),finish:b(n.finish()+o)})})},Ft=function(n,t,e){return void 0===e&&(e=0),z(n,function(e,n){return t(n,e.len).fold(b(e),function(n){return{len:n.finish(),list:e.list.concat([n])}})},{len:e,list:[]}).list},zt=function(n,e,t){return 0===e.length?n:V(n,function(r){var n=V(e,function(n){return(t=n)>=(e=r).start()&&t<=e.finish()?[n-r.start()]:[];var e,t});return 0<n.length?Bt(r,n,t):[r]})},Wt=function(o,n,u){var e=Pt(o,n),i=Pt(o,u);return e.bind(function(n){var e,t,r=i.getOr((t=u,(e=o)[e.length-1]&&e[e.length-1].finish()===t?e.length+1:-1));return-1<r?N.some(o.slice(n,r)):N.none()}).getOr([])},qt=function(r,n){if(0===n.length)return[r];var e=z(n,function(n,e){if(0===e)return n;var t=r.substring(n.prev,e);return{prev:e,values:n.values.concat([t])}},{prev:0,values:[]}),t=n[n.length-1];return t<r.length?e.values.concat(r.substring(t)):e.values},Ut=bt([{none:[]},{start:["element"]},{middle:["before","after"]},{end:["element"]}]),Vt=(Ut.none,Ut.start,Ut.middle,Ut.end,bt([{include:["item"]},{excludeWith:["item"]},{excludeWithout:["item"]}])),Ht={include:Vt.include,excludeWith:Vt.excludeWith,excludeWithout:Vt.excludeWithout,cata:function(n,e,t,r){return n.fold(e,t,r)}},Jt=function(n,t){var r=[],o=[];return B(n,function(n){var e=t(n);Ht.cata(e,function(){o.push(n)},function(){0<o.length&&r.push(o),r.push([n]),o=[]},function(){0<o.length&&r.push(o),o=[]})}),0<o.length&&r.push(o),r},Kt=bt([{boundary:["item","universe"]},{empty:["item","universe"]},{text:["item","universe"]},{nonEditable:["item","universe"]}]),Yt=T,Xt=O,$t=b(0),Gt=b(1),Qt=function(n){return _n(_n({},n),{isBoundary:function(){return n.fold(Xt,Yt,Yt,Yt)},toText:function(){return n.fold(N.none,N.none,function(n){return N.some(n)},N.none)},is:function(t){return n.fold(Yt,Yt,function(n,e){return e.eq(n,t)},Yt)},len:function(){return n.fold($t,Gt,function(n,e){return e.property().getText(n).length},Gt)}})},Zt={text:g(Qt,Kt.text),boundary:g(Qt,Kt.boundary),empty:g(Qt,Kt.empty),nonEditable:g(Qt,Kt.empty),cata:function(n,e,t,r,o){return n.fold(e,t,r,o)}},nr=b([]),er=function(e,n,t){if(e.property().isText(n))return[Zt.text(n,e)];if(e.property().isEmptyTag(n))return[Zt.empty(n,e)];if(e.property().isNonEditable(n))return[];if(e.property().isElement(n)){var r=e.property().children(n),o=e.property().isBoundary(n)?[Zt.boundary(n,e)]:[],u=void 0!==t&&t(n)?[]:V(r,function(n){return er(e,n,t)});return o.concat(u).concat(o)}return[]},tr=er,rr=function(e,n,t){var r=V(n,function(n){return tr(e,n,t)}),o=Jt(r,function(n){return n.match({boundary:function(){return Ht.excludeWithout(n)},empty:function(){return Ht.excludeWith(n)},text:function(){return Ht.include(n)},nonEditable:function(){return Ht.excludeWithout(n)}})});return F(o,function(n){return 0<n.length})},or=(Oe("before","after"),function(e,t){return{element:b(t),wrap:function(n){e.insert().append(t,n)}}}),ur=function(t,n,r){if(0===n.length)return n;var e=F(n,function(n){return t.property().isText(n)&&0<t.property().getText(n).length});return P(e,function(n){var e=r();return t.insert().before(n,e.element()),e.wrap(n),e.element()})},ir=rt(),cr={assess:kt.inView},ar={anything:b(cr)},fr=function(e,n){return e.up().closest(n,"[lang]",b(!1)).map(function(n){return e.attrs().get(n,"lang")})},sr=function(e){var t=[],n=[],r=[],o=e,u=function(n){n.each(function(n){t.push(n)})},i=function(n){n.each(function(n){t=t.slice(0,t.length-1)})},c=function(){0<r.length&&n.push({lang:b(o),details:b(r)})},a=function(n){c(),r=[],o=n},f=function(n){return n.or(N.from(t[t.length-1])).getOr(e)};return{openInline:function(n,e){var t=f(n);t!==o&&a(t),u(n)},closeInline:function(n,e){i(n)},addDetail:function(n){var e=f(N.none());e!==o&&a(e),r.push(n)},addEmpty:function(n){var e=f(N.none());a(e)},openBoundary:function(n,e){u(n);var t=f(n);a(t)},closeBoundary:function(n,e){i(n);var t=f(n);a(t)},done:function(){return c(),n.slice(0)}}},lr=fr,gr=function(r){return function(n,e){var t=fr(n,e);return!r.equals(t)}},dr=function(r,o){return function(n,e){var t=fr(n,e).getOr(r);return o!==t}},pr=Oe("item","mode"),mr=function(n,e,t,r){return void 0===r&&(r=hr),n.property().parent(e).map(function(n){return pr(n,r)})},hr=function(n,e,t,r){return void 0===r&&(r=vr),t.sibling(n,e).map(function(n){return pr(n,r)})},vr=function(n,e,t,r){void 0===r&&(r=vr);var o=n.property().children(e);return t.first(o).map(function(n){return pr(n,r)})},yr=[{current:mr,next:hr,fallback:N.none()},{current:hr,next:vr,fallback:N.some(mr)},{current:vr,next:vr,fallback:N.some(hr)}],wr=function(e,t,r,o,n){return void 0===n&&(n=yr),W(n,function(n){return n.current===r}).bind(function(n){return n.current(e,t,o,n.next).orThunk(function(){return n.fallback.bind(function(n){return wr(e,t,n,o)})})})},br={left:function(){return{sibling:function(n,e){return n.query().prevSibling(e)},first:function(n){return 0<n.length?N.some(n[n.length-1]):N.none()}}},right:function(){return{sibling:function(n,e){return n.query().nextSibling(e)},first:function(n){return 0<n.length?N.some(n[0]):N.none()}}}},xr=function(e,n,t,r,o,u){return wr(e,n,r,o).bind(function(n){return u(n.item())?N.none():t(n.item())?N.some(n.item()):xr(e,n.item(),t,n.mode(),o,u)})},kr=function(n,e,t,r){return xr(n,e,t,hr,br.right(),r)},Tr=kr,Or=function(){return{left:br.left,right:br.right}},Er=wr,_r=Oe("item","start","finish","text"),Sr=Oe("items","abort"),Cr=function(n,e){var t=n.property().getText(e);return _r(e,0,t.length,t)},Ir=function(n,e,t){return Sr([],!0)},Nr=function(n,e,t){return Sr([],!1)},Ar=function(n,t,e){var r=n.property().getText(t);return e(r).fold(function(){return Sr([_r(t,0,r.length,r)],!1)},function(n){var e=n[0]===n[1]?[]:[_r(t,n[0],n[1],r.substring(n[0],n[1]))];return Sr(e,!0)})},Dr=Cr,Rr=function(n,e){return n.property().isText(e)?Cr(n,e):_r(e,0,0,"")},Lr=function(n,e,t,r){return(n.property().isBoundary(e)?Ir:n.property().isEmptyTag(e)?Ir:r(n,e)?Ir:n.property().isText(e)?Ar:Nr)(n,e,t)},Mr=b("[^\\w'\\-\\u0100-\\u017F\\u00C0-\\u00FF\ufeff\\u2018\\u2019]"),jr=b("[\\w'\\-\\u0100-\\u017F\\u00C0-\\u00FF\ufeff\\u2018\\u2019]"),Pr=function(n,e,t,r){return{term:function(){return new RegExp(n,r.getOr("g"))},prefix:e,suffix:t}},Br=function(n){return Pr(n,b(0),b(0),N.none())},Fr=function(n){return n.replace(/[-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},zr=function(n){var e,t,r=Fr(n);return e=r,t="((?:^'?)|(?:"+Mr()+"+'?))"+e+"((?:'?$)|(?:'?"+Mr()+"+))",Pr(t,function(n){return 1<n.length?n[1].length:0},function(n){return 2<n.length?n[2].length:0},N.none())},Wr=Pr,qr=Br,Ur=Mr,Vr=jr,Hr=function(n,e){for(var t=e.term(),r=[],o=t.exec(n);o;){var u=o.index+e.prefix(o),i=o[0].length-e.prefix(o)-e.suffix(o);r.push({start:b(u),finish:b(u+i)}),t.lastIndex=u+i,o=t.exec(n)}return r},Jr=Hr,Kr=function(t,n){var e,r,o=V(n,function(e){var n=Hr(t,e.pattern());return P(n,function(n){return _n(_n({},e),n)})});return e=o,(r=Array.prototype.slice.call(e,0)).sort(function(n,e){return n.start()<e.start()?-1:e.start()<n.start()?1:0}),r},Yr=new RegExp(Ur()+"+","g"),Xr=b(0),$r=function(n){var e=Jr(n,Wr(Ur(),Xr,Xr,N.none()));return N.from(e[e.length-1]).map(function(n){return n.start()})},Gr=function(n){var e=n.search(Yr);return-1<e?N.some(e):N.none()},Qr={firstWord:function(e){return Gr(e).map(function(n){return e.substring(0,n+1)})},lastWord:function(e){return $r(e).map(function(n){return e.substring(n)})},leftBreak:$r,rightBreak:Gr,hasBreak:function(n){return Gr(n).isSome()}},Zr=Or(),no=Zr.left(),eo=Zr.right(),to={left:{sibling:no.sibling,first:no.first,slicer:function(e){return Qr.leftBreak(e).map(function(n){return[n+1,e.length]})}},right:{sibling:eo.sibling,first:eo.first,slicer:function(n){return Qr.rightBreak(n).map(function(n){return[0,n]})}}},ro=function(r,n,e,o,u){var t=Er(r,n,e,o).map(function(n){var e=Lr(r,n.item(),o.slicer,u),t=e.abort()?[]:ro(r,n.item(),n.mode(),o,u);return e.items().concat(t)}).getOr([]);return F(t,function(n){return 0<n.text().trim().length})},oo=function(n,e,t){return ro(n,e,hr,to.left,t)},uo=function(n,e,t){return ro(n,e,hr,to.right,t)},io=function(n,e){return!n.property().isText(e)&&0===n.down().predicate(e,n.property().isText).length},co=function(n,e,t,r){var o=oo(n,e,r),u=uo(n,t,r),i=0<o.length?o[o.length-1]:Rr(n,e),c=0<u.length?u[u.length-1]:Rr(n,t),a=0===o.length&&0===u.length;return{left:b(i),right:b(c),isEmpty:b(a)}},ao={byBoundary:function(n,e){var t=b(!1),r=co(n,e,e,t),o=r.isEmpty()&&io(n,e);return{left:r.left,right:r.right,isEmpty:b(o)}},getEdges:co,byLanguage:function(n,e){var t=lr(n,e),r=gr(t),o=oo(n,e,r),u=uo(n,e,r),i=n.property().isText(e)?[Dr(n,e)]:[],c=J(o).concat(i).concat(u);return{all:b(c),left:b(o),middle:b(i),right:b(u),lang:b(t)}}},fo=Oe("left","right"),so=Oe("first","second","splits"),lo=function(n,e,t){var r=n.property().children(e);return q(r,l(n.eq,t)).map(function(n){return{before:b(r.slice(0,n)),after:b(r.slice(n+1))}})},go=function(r,o,n,e){var t,u,i=o(r,n);return t=function(n,e){var t=o(r,e);return po(r,n,t)},u=i,function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t],t)}(e,function(n){u=t(u,n)}),u},po=function(e,n,t){return n.bind(function(n){return t.filter(l(e.eq,n))})},mo=function(n,e){return l(n.eq,e)},ho=function(e,n,t,r){void 0===r&&(r=T);var o=[n].concat(e.up().all(n)),u=[t].concat(e.up().all(t)),i=function(e){return q(e,r).fold(function(){return e},function(n){return e.slice(0,n+1)})},c=i(o),a=i(u),f=W(c,function(n){return j(a,mo(e,n))});return{firstpath:b(c),secondpath:b(a),shared:b(f)}},vo={sharedOne:function(n,e,t){return 0<t.length?go(n,e,(r=t)[0],r.slice(1)):N.none();var r},subset:function(e,n,t){var r=ho(e,n,t);return r.shared().bind(function(n){return function(o,u,n,e){var i=o.property().children(u);if(o.eq(u,n[0]))return N.some([n[0]]);if(o.eq(u,e[0]))return N.some([e[0]]);var t=function(n){var e=J(n),t=q(e,mo(o,u)).getOr(-1),r=t<e.length-1?e[t+1]:e[t];return q(i,mo(o,r))},r=t(n),c=t(e);return r.bind(function(r){return c.map(function(n){var e=Math.min(r,n),t=Math.max(r,n);return i.slice(e,t+1)})})}(e,n,r.firstpath(),r.secondpath())})},ancestors:ho,breakToLeft:function(t,r,o){return lo(t,r,o).map(function(n){var e=t.create().clone(r);return t.insert().appendAll(e,n.before().concat([o])),t.insert().appendAll(r,n.after()),t.insert().before(r,e),fo(e,r)})},breakToRight:function(t,r,n){return lo(t,r,n).map(function(n){var e=t.create().clone(r);return t.insert().appendAll(e,n.after()),t.insert().after(r,e),fo(r,e)})},breakPath:function(u,n,i,c){var a=function(n,e,o){var t=so(n,N.none(),o);return i(n)?so(n,e,o):u.property().parent(n).bind(function(r){return c(u,r,n).map(function(n){var e=[{first:n.left,second:n.right}],t=i(r)?r:n.left();return a(t,N.some(n.right()),o.concat(e))})}).getOr(t)};return a(n,N.none(),[])}},yo=Oe("word","left","right"),wo=["'","‘","’"],bo=V(wo,function(e){return P(["twas"],function(n){return e+n})}),xo=function(n){return M(wo,n)},ko=function(n){var e,t,r=n.word();return 2<=r.length&&xo(r.charAt(r.length-1))&&!xo(r.charAt(r.length-2))?(t=(e=n).word(),yo(t.substring(0,t.length-1),e.left(),N.some(t.charAt(t.length-1)))):n},To=function(n){var e,t,r=n.word(),o=j(bo,function(n){return-1<r.indexOf(n)})?2:1,u=r.substring(0,o);return H(u,xo)&&!xo(r.charAt(o))?(t=(e=n).word(),yo(t.substring(1),N.some(t.charAt(0)),e.right())):n},Oo=function(n){var e=ko(n);return To(e)},Eo=Oo,_o=function(c){var n=qr(Vr()+"+"),e=Jr(c,n),a=c.length;return P(e,function(n){var e=n.start(),t=n.finish(),r=c.substring(e,t),o=0<e?N.some(c.charAt(e-1)):N.none(),u=t<a?N.some(c.charAt(t)):N.none(),i=yo(r,o,u);return Eo(i)})},So=function(o,u){var i=o.concat(u);if(0===i.length)throw new Error("You must specify at least one required or optional field.");return Ce("required",o),Ce("optional",u),Ie(i),function(e){var t=Y(e);H(o,function(n){return M(t,n)})||_e(o,t);var n=F(t,function(n){return!M(i,n)});0<n.length&&Se(n);var r={};return B(o,function(n){r[n]=b(e[n])}),B(u,function(n){r[n]=b(Object.prototype.hasOwnProperty.call(e,n)?N.some(e[n]):N.none())}),r}}(["elements","lang","words"],[]),Co=function(n,e){var t=P(e,function(n){var e=n.details(),t=n.lang(),r=P(e,function(n){return n.text()}).join(""),o=P(e,function(n){return n.item()}),u=_o(r);return So({lang:t,words:u,elements:o})});return{zones:b(t)}},Io="trampoline.stop",No={stop:b(Io),run:function(n){for(var e=n();e!==Io;)e=e()}},Ao=bt([{inline:["item","mode","lang"]},{text:["item","mode"]},{empty:["item","mode"]},{boundary:["item","mode","lang"]},{concluded:["item","mode"]}]),Do=function(n,e,t,r){var o=n.property().isElement(e)?N.from(n.attrs().get(e,"lang")):N.none();return n.property().isText(e)?Ao.text(e,t):r(e,t)?Ao.concluded(e,t):n.property().isBoundary(e)?Ao.boundary(e,t,o):n.property().isEmptyTag(e)?Ao.empty(e,t):Ao.inline(e,t,o)},Ro=function(o,n,u,i,c,a){return function(){return n.fold(function(n,e,t){return(e===vr?i.openInline:i.closeInline)(t,n),Lo(o,n,e,u,i,c,a)},function(n,e){var t=c(o,n);return i.addDetail(t),u(n,e)?No.stop():Lo(o,n,e,u,i,c,a)},function(n,e){return i.addEmpty(n),Lo(o,n,e,u,i,c,a)},function(e,t,r){var n=a.assess(e);return kt.cata(n,function(n){return t!==mr?Lo(o,e,hr,u,i,c,a):No.stop()},function(n){return(t===vr?i.openBoundary:i.closeBoundary)(r,e),Lo(o,e,t,u,i,c,a)},function(n){return No.stop()})},function(n,e){return No.stop()})}},Lo=function(n,e,t,r,o,u,i){var c,a,f,s,l=(s=r,Er(c=n,a=e,f=t,Or().right()).fold(function(){return Ao.concluded(a,f)},function(n){return Do(c,n.item(),n.mode(),s)}));return Ro(n,l,r,o,u,i)},Mo=function(t,n,r,e,o,u){var i=function(n,e){return t.eq(n,r)&&(e!==vr||t.property().isText(n)||0===t.property().children(n).length)},c=sr(e),a=Do(t,n,vr,i);return No.run(Ro(t,a,i,c,o,u)),c.done()},jo=function(f,n,e,s,l,g){var t=vo.subset(f,n,e).bind(function(n){if(0===n.length)return N.none();var t,r,o,u,i,c,e=n[0],a=n[n.length-1];return r=e,o=a,u=s,i=l,c=g,((t=f).eq(r,o)?N.some(r):t.property().parent(r)).map(function(n){var e=lr(t,n).getOr(u);return Mo(t,r,o,e,i,c)})}).getOr([]);return Co(f,t)},Po=function(t,r){return function(n,e){return n.eq(e,t.item())?t:n.eq(e,r.item())?r:Dr(n,e)}},Bo=function(){return{zones:b([])}},Fo={fromRange:function(n,e,t,r,o){var u=ao.getEdges(n,e,t,b(!1)),i=Po(u.left(),u.right());return jo(n,u.left().item(),u.right().item(),r,i,o)},transformEdges:Po,fromBounded:function(n,e,t,r,o){return jo(n,e,t,r,Dr,o)},fromBoundedWith:jo,fromInline:function(n,e,t,r){var o=ao.byBoundary(n,e),u=Po(o.left(),o.right());return o.isEmpty()?Bo():jo(n,o.left().item(),o.right().item(),t,u,r)},empty:Bo},zo=function(n,e,t,r,o,u){var i,c,a=Fo.fromBoundedWith(n,e,t,r,u,ar.anything()).zones();return 1===a.length?(i=a[0],c=o,i.lang()===c?N.some(i):N.none()):N.none()},Wo=function(n,e,t,r,o){return zo(n,e,t,r,o,Dr)},qo=function(n,e,t,r){var o=n.property().isText(e)?n.property().getText(e).length:n.property().children(e).length,u=at(n,e,0),i=at(n,e,o);return Wo(n,u.element(),i.element(),t,r)},Uo=Wo,Vo=function(n,e,t,r){var o=dr(t,r),u=ao.getEdges(n,e,e,o),i=Fo.transformEdges(u.left(),u.right());return u.isEmpty()?qo(n,e,t,r):zo(n,u.left().item(),u.right().item(),t,r,i)},Ho=function(){return N.none()},Jo=function(n,e,t,r){return n.property().isBoundary(e)?Uo(n,e,e,t,r):n.property().isEmptyTag(e)?Ho():Vo(n,e,t,r)},Ko=Jo,Yo=rt(),Xo=function(n,e,t){return Ko(Yo,n,e,t)},$o=function(n){return V(n,function(n){return Je(n,wn)})},Go=$o,Qo=function(n){var e=$o(n);return P(e,function(n){return wn(n)?nt(n):""}).join("")},Zo=function(n,e,t){return N.from(n[0]).bind(function(n){return Xo(n,e,t).bind(function(n){var e=n.words();return 1===e.length?N.some(e[0]).map(function(n){return n.word()}):N.none()})})},nu=function(n){return V(n,Me)},eu=function(t,r){var o=nu(t),u=Go(t);return N.from(t[0]).bind(function(n){Ue(n,o);var e=N.from(u[0]);return e.each(function(n){et(n,r)}),B(u.slice(1),function(n){et(n,"")}),B(t,Ke),e})};Oe("component","index");var tu=function(t){return{is:function(n){return t===n},isValue:O,isError:T,getOr:b(t),getOrThunk:b(t),getOrDie:b(t),or:function(n){return tu(t)},orThunk:function(n){return tu(t)},fold:function(n,e){return e(t)},map:function(n){return tu(n(t))},mapError:function(n){return tu(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return N.some(t)}}},ru=function(t){return{is:T,isValue:T,isError:O,getOr:x,getOrThunk:function(n){return n()},getOrDie:function(){return n=String(t),function(){throw new Error(n)}();var n},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return ru(t)},mapError:function(n){return ru(n(t))},each:w,bind:function(n){return ru(t)},exists:T,forall:O,toOption:N.none}},ou={value:tu,error:ru,fromOption:function(n,e){return n.fold(function(){return ru(e)},tu)}},uu=function(n){return n.replace(/\./g,"-")},iu=function(n,e){return n+"-"+e},cu=function(n){var t=uu(n);return{resolve:function(n){var e=n.split(" ");return P(e,function(n){return iu(t,n)}).join(" ")}}};cu("ephox.flour").resolve;var au={resolve:cu("data.mce").resolve},fu=au.resolve("annotation"),su=au.resolve("highlight-id"),lu=function(n){return N.from(kn(n,su))},gu={nonIgnoredMarker:function(n,e,t){return ge(n,"."+e+":not(."+t+")")},allNonIgnoredMarkers:function(n,e,t){return P(n.dom.select("."+e+":not(."+t+")"),on.fromDom)},marker:function(n,e){return ge(n,"."+e)},id:lu,set:function(n,e){xn(n,su,e),Dt(n,e)},sameId:function(t){return lu(t).fold(b([t]),function(n){var e=Ne(t);return Xe(e,"."+n)})},all:function(t){var n;return(n=t,N.from(kn(n,fu))).fold(b([t]),function(n){var e=Ne(t);return Xe(e,"span["+fu+"="+n+"]")})},otherCurrents:function(n,e){var t=Ne(n);return Xe(t,"."+e)},label:b(fu)},du={resolve:cu("mce").resolve},pu=au.resolve("lingo"),mu=du.resolve("spellchecker-annotation"),hu=du.resolve("spellchecker-word"),vu=du.resolve("spellchecker-ignore"),yu=du.resolve("spellchecker-current"),wu=function(n,e){return N.from(kn(n,e))},bu={nu:function(){var e,n=on.fromTag("span");return e=n,B([mu,hu],function(n){Dt(e,n)}),xn(n,"aria-invalid","spelling"),or(ir,n)},set:function(n,e,t){xn(n,"data-mce-bogus",1),xn(n,gu.label(),t),xn(n,pu,e)},setCurrent:function(n){Dt(n,yu)},unSetCurrent:function(n){Lt(n,yu)},label:b(mu),wordLabel:b(hu),ignoreLabel:b(vu),currentLabel:b(yu),detail:function(r){return gu.id(r).bind(function(t){return wu(r,gu.label()).bind(function(e){return wu(r,pu).map(function(n){return{id:b(t),word:b(e),lang:b(n),element:b(r)}})})})}},xu=function(n){return{fold:n}},ku=function(t){return xu(function(n,e){return e(t)})},Tu=function(t){return xu(function(n,e){return n(t)})},Ou=du.resolve("wrap-disabled"),Eu=function(n){var e=gu.sameId(n);B(e,function(n){Lt(n,Ou)})},_u=0,Su=function(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++_u+String(e)},Cu=Oe("id","match","current"),Iu=Oe("word","pattern"),Nu=function(o,n,e){var t=V(e,function(n){return[n.start(),n.finish()]}),u=zt(n,t,function(n,e){return function(o,n,e){var t=o.property().getText(n),r=F(qt(t,e),function(n){return 0<n.length});if(r.length<=1)return[ut(n,0,t.length)];o.property().setText(n,r[0]);var u=Ft(r.slice(1),function(n,e){var t=o.create().text(n),r=ut(t,e,e+n.length);return N.some(r)},r[0].length),i=P(u,function(n){return n.element()});return o.insert().afterAll(n,i),[ut(n,0,r[0].length)].concat(u)}(o,n.element(),e)});return P(e,function(n){var e=Wt(u,n.start(),n.finish()),t=P(e,function(n){return n.element()}),r=P(t,o.property().getText).join("");return{elements:function(){return t},word:n.word,exact:function(){return r}}})},Au=function(i,n,c,e){var t=rr(i,n,e);return V(t,function(n){var r,e=V(n,function(n){return n.fold(nr,nr,function(n){return[n]},nr)}),t=P(e,i.property().getText).join(""),o=Kr(t,c),u=(r=i,Ft(e,function(n,e){var t=e+r.property().getText(n).length;return N.from(ut(n,e,t))}));return Nu(i,u,o)})},Du=function(n,e,t,r){var o=P(t,function(n){var e=zr(n);return Iu(n,e)});return Au(n,e,o,r)},Ru=rt(),Lu=function(n,e,t){return Du(Ru,n,e,t)},Mu=function(n,u){return P(n,function(n){return t=u,r=V((e=n).elements(),function(n){return gu.marker(n,t).fold(b([]),function(n){return[n]})}),o=Su("mce-cram"),Cu(o,e,N.from(r[0]));var e,t,r,o})},ju=Oe("id","elements","word","lang"),Pu=function(n){return{fold:n}},Bu=function(t){return Pu(function(n,e){e(t)})},Fu=function(t){return Pu(function(n,e){n(t)})},zu=function(n,e,t,r){var o=Qo(n),u=Zo(n,t,r);return o===e&&u.is(e)},Wu=function(n,e,t,r,o){var u,i,c,a,f,s,l,g=(u=n.elements(),i=e,c={},B(u,function(n){gu.marker(n,i.label()).filter(fe).each(function(u){i.detail(u).each(function(n){var e=n.id(),t=n.word(),r=n.lang(),o=gu.sameId(u);0<o.length&&(c[e]=ju(e,o,t,r))})})}),c),d=(a=g,f=o,s=n.lang(),l=nn(a),P(l,function(n){return n.lang()===s&&zu(n.elements(),n.word(),f,n.lang())?Bu(n):Fu(n)}));B(d,function(n){var e=function(e){return function(n){B(n.elements(),e)}};n.fold(e(r),e(t))})},qu=function(n){return gu.nonIgnoredMarker(n,bu.label(),bu.ignoreLabel())},Uu={label:bu.label,highlight:function(c,a,n,e){Wu(a,bu,Eu,Ye,c.lang());var t=Lu(a.elements(),n,e),r=Mu(t,bu.label());return V(r,function(i){return i.current().fold(function(){var n=i.match(),e=n.word();if(c.ignore(n))return[];var t,r,o=F(n.elements(),function(n){return wn(n)?Ae(n).fold(function(){return!1},function(n){return"false"!==n.dom().contentEditable}):dn(n.dom())?"false"!==n.dom().contentEditable:n.dom().isContentEditable}),u=(t=o,r=bu.nu,ur(ir,t,r)||[]);return B(u,function(n){gu.set(n,i.id()),bu.set(n,a.lang(),e)}),0<u.length?[ku(u)]:[]},function(n){return[Tu(n)]})})},marker:qu,allMarkers:function(n){return gu.allNonIgnoredMarkers(n,bu.label(),bu.ignoreLabel())},substitute:function(n,e){var t=qu(n).fold(b([]),gu.sameId);return eu(t,e)},ignore:function(n){var e=qu(n).fold(b([]),gu.sameId);B(e,function(n){Lt(n,bu.wordLabel()),Dt(n,bu.ignoreLabel())})},ignoreAll:function(n){var e=qu(n).fold(b([]),gu.all);B(e,Ye)},detail:function(n){return bu.detail(n)},setCurrent:function(n){var e=gu.otherCurrents(n,bu.currentLabel());B(e,bu.unSetCurrent),bu.setCurrent(n)}},Vu=Uu.label(),Hu={isWrap:function(n){return t=Vu,It(e=n)&&e.dom().classList.contains(t);var e,t}},Ju=Oe("area","f");var Ku=function(n,e,t,r){return n.property().isBoundary(e)?Fo.fromBounded(n,e,e,t,r):n.property().isEmptyTag(e)?Yu():Fo.fromInline(n,e,t,r)},Yu=Fo.empty,Xu={single:Ku,range:function(n,e,t,r,o,u,i){var c=at(n,e,t),a=at(n,r,o);return n.eq(c.element(),a.element())?Ku(n,c.element(),u,i):Fo.fromRange(n,c.element(),a.element(),u,i)},empty:Yu},$u=rt(),Gu={single:function(n,e,t){return Xu.single($u,n,e,t)},range:function(n,e,t,r,o,u){return Xu.range($u,n,e,t,r,o,u)},empty:function(){return Xu.empty()}};function Qu(n,o){var t,r,u,i=Sn(n),e=(r=!(t=[]),u=function(){r=!0,N.from(t.shift()).fold(function(){r=!1},function(n){n.f()(n.area(),u)})},{enqueue:function(n,e){t.push(Ju(n,e)),r||u()},destroy:function(){t=[]}}),c=function(n,e,t,r){e(n,St.cata(t,function(n){return fe(n)?Gu.single(n,i.get(),o):Gu.empty()},function(n,e,t,r){return fe(n)&&fe(t)?Gu.range(n,e,t,r,i.get(),o):Gu.empty()}),i.get(),r)};return{run:function(n,e,t,r){void 0===r&&(r=x),c(n,e,t,r)},setLang:i.set,schedule:function(t,r,n,o){e.enqueue(n,function(n,e){void 0!==o&&o()?e():c(t,r,n,e)})},destroy:function(){e.destroy()}}}var Zu,ni,ei,ti=function(n,e){return n.fold(function(){return!1},function(n){return!n.ignore()&&(n.suggestions().isSome()||!e)})},ri={update:function(e,t,r){var n=Y(r);B(n,function(n){e.add(t,n,r[n])})},getInCache:function(t,r,n,o){return F(n,function(n){var e=t.get(r,n.word());return ti(e,o)})},getInCacheString:function(t,r,n,o){return F(n,function(n){var e=t.get(r,n);return ti(e,o)})}},oi={highlight:function(n,e,t,r){var o={operation:n,internal:n,ignore:b(!1),lang:b(r)},u=P(t,function(n){return n.word()}),i=F(u,function(n,e){return(t=u,r=n,o=L(t,r),-1===o?N.none():N.some(o)).filter(function(n){return n===e}).isSome();var t,r,o});n(function(){Uu.highlight(o,e,i,b(!1))})}},ui=function(n){var e=new RegExp(Mt,"g"),t=new RegExp("[‘’]","g");return n.replace(e,"").replace(t,"'")},ii={},ci={exports:ii};ni=ii,ei=ci,Zu=void 0,function(n){"object"==typeof ni&&void 0!==ei?ei.exports=n():"function"==typeof Zu&&Zu.amd?Zu([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function u(i,c,a){function f(e,n){if(!c[e]){if(!i[e]){var t=!1;if(!n&&t)return t(e,!0);if(s)return s(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var o=c[e]={exports:{}};i[e][0].call(o.exports,function(n){return f(i[e][1][n]||n)},o,o.exports,u,i,c,a)}return c[e].exports}for(var s=!1,n=0;n<a.length;n++)f(a[n]);return f}({1:[function(n,e,t){var r,o,u=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(n){try{return r.call(null,e,0)}catch(n){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(n){r=i}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var f,s=[],l=!1,g=-1;function d(){l&&f&&(l=!1,f.length?s=f.concat(s):g=-1,s.length&&p())}function p(){if(!l){var n=a(d);l=!0;for(var e=s.length;e;){for(f=s,s=[];++g<e;)f&&f[g].run();g=-1,e=s.length}f=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(n){try{return o.call(null,e)}catch(n){return o.call(this,e)}}}(n)}}function m(n,e){this.fun=n,this.array=e}function h(){}u.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];s.push(new m(n,e)),1!==s.length||l||a(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=h,u.addListener=h,u.once=h,u.off=h,u.removeListener=h,u.removeAllListeners=h,u.emit=h,u.prependListener=h,u.prependOnceListener=h,u.listeners=function(n){return[]},u.binding=function(n){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(n){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],2:[function(n,l,e){(function(t){!function(n){var e=setTimeout;function r(){}function u(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(n,this)}function o(t,r){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn(function(){var n=1===t._state?r.onFulfilled:r.onRejected;if(null!==n){var e;try{e=n(t._value)}catch(n){return void c(r.promise,n)}i(r.promise,e)}else(1===t._state?i:c)(r.promise,t._value)})):t._deferreds.push(r)}function i(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if(n instanceof u)return e._state=3,e._value=n,void a(e);if("function"==typeof t)return void s((r=t,o=n,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=n,a(e)}catch(n){c(e,n)}var r,o}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&u._immediateFn(function(){n._handled||u._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)o(n,n._deferreds[e]);n._deferreds=null}function f(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function s(n,e){var t=!1;try{n(function(n){t||(t=!0,i(e,n))},function(n){t||(t=!0,c(e,n))})}catch(n){if(t)return;t=!0,c(e,n)}}u.prototype.catch=function(n){return this.then(null,n)},u.prototype.then=function(n,e){var t=new this.constructor(r);return o(this,new f(n,e,t)),t},u.all=function(n){var c=Array.prototype.slice.call(n);return new u(function(r,o){if(0===c.length)return r([]);var u=c.length;function i(e,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void t.call(n,function(n){i(e,n)},o)}c[e]=n,0==--u&&r(c)}catch(n){o(n)}}for(var n=0;n<c.length;n++)i(n,c[n])})},u.resolve=function(e){return e&&"object"==typeof e&&e.constructor===u?e:new u(function(n){n(e)})},u.reject=function(t){return new u(function(n,e){e(t)})},u.race=function(o){return new u(function(n,e){for(var t=0,r=o.length;t<r;t++)o[t].then(n,e)})},u._immediateFn="function"==typeof t?function(n){t(n)}:function(n){e(n,0)},u._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},u._setImmediateFn=function(n){u._immediateFn=n},u._setUnhandledRejectionFn=function(n){u._unhandledRejectionFn=n},void 0!==l&&l.exports?l.exports=u:n.Promise||(n.Promise=u)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,f){(function(n,e){var r=a("process/browser.js").nextTick,t=Function.prototype.apply,o=Array.prototype.slice,u={},i=0;function c(n,e){this._id=n,this._clearFn=e}f.setTimeout=function(){return new c(t.call(setTimeout,window,arguments),clearTimeout)},f.setInterval=function(){return new c(t.call(setInterval,window,arguments),clearInterval)},f.clearTimeout=f.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},f.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},f.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},f._unrefActive=f.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},f.setImmediate="function"==typeof n?n:function(n){var e=i++,t=!(arguments.length<2)&&o.call(arguments,1);return u[e]=!0,r(function(){u[e]&&(t?n.apply(null,t):n.call(null),f.clearImmediate(e))}),e},f.clearImmediate="function"==typeof e?e:function(n){delete u[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,t){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});var ai=ci.exports.boltExport,fi=function(n){var t=N.none(),e=[],r=function(n){o()?i(n):e.push(n)},o=function(){return t.isSome()},u=function(n){B(n,i)},i=function(e){t.each(function(n){_.setTimeout(function(){e(n)},0)})};return n(function(n){t=N.some(n),u(e),e=[]}),{get:r,map:function(t){return fi(function(e){r(function(n){e(t(n))})})},isReady:o}},si={nu:fi,pure:function(e){return fi(function(n){n(e)})}},li=function(n){_.setTimeout(function(){throw n},0)},gi=function(t){var n=function(n){t().then(n,li)};return{map:function(n){return gi(function(){return t().then(n)})},bind:function(e){return gi(function(){return t().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return gi(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return si.nu(n)},toCached:function(){var n=null;return gi(function(){return null===n&&(n=t()),n})},toPromise:t,get:n}},di={nu:function(n){return gi(function(){return new ai(n)})},pure:function(n){return gi(function(){return ai.resolve(n)})}},pi=function(i,n){return n(function(r){var o=[],u=0;0===i.length?r([]):B(i,function(n,e){var t;n.get((t=e,function(n){o[t]=n,++u>=i.length&&r(o)}))})})},mi=function(n){return pi(n,di.nu)},hi=(bt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n){var e=[],t=[];return B(n,function(n){n.fold(function(n){e.push(n)},function(n){t.push(n)})}),{errors:e,values:t}}),vi=function(n){return ou.error(new Error(n))},yi=function(n,e){return F(n,function(n){return!M(e,n)})},wi=function(u,t,r){return di.nu(function(o){var n=P(u.words(),function(n){return ui(n.word())}),e=yi(n,r);t(e,u.lang()).get(function(n){return n.fold(function(n){var e=vi(n);o(e)},function(n){var e,t,r=(e=u,t=n,ou.value({spelling:b(t),zone:b(e)}));o(r)})})})},bi=function(e,o,t,u){return di.nu(function(r){var n=yi(e,u);t.correctionMany(n,o).get(function(n){return n.fold(function(n){var e=vi(n);r(e)},function(n){var e,t;r((e=o,t=n,ou.value({spelling:b(t),lang:b(e)})))})})})},xi=function(n){var e,t,r;return function(n,e){if(0===n.length)return[];for(var t=e(n[0]),r=[],o=[],u=0,i=n.length;u<i;u++){var c=n[u],a=e(c);a!==t&&(r.push(o),o=[]),t=a,o.push(c)}return 0!==o.length&&r.push(o),r}((e=n,t=function(n,e){return n.detail.lang()<e.detail.lang()?-1:e.detail.lang()<n.detail.lang()?1:0},(r=A.call(e,0)).sort(t),r),function(n){return n.detail.lang()})},ki={scan:function(u,e,n,t,i){var r=function(n){var e=n.zone();ri.update(u,e.lang(),n.spelling());var t=Y(n.spelling()),r=ri.getInCacheString(u,e.lang(),t,i),o=F(e.words(),function(n){var e=ui(n.word());return M(r,e)});return{zone:b(e),words:b(o)}},o=P(n,function(n){return wi(n,e,t)});return mi(o).map(function(n){var e=V(n,function(n){return n.fold(b([]),K)});return P(e,r)})},fetch:function(e,t,n,r){var o=function(n){ri.update(e,n.lang(),n.spelling())},u=xi(n),i=P(u,function(n){var e=P(n,function(n){return n.detail.word()});return bi(e,n[0].detail.lang(),t,r)});return mi(i).map(function(n){return B(n,function(n){n.each(o)}),hi(n)})}},Ti=!0;function Oi(u,i,c,a){var f=function(e,n,t){B(n,function(n){oi.highlight(e,n.zone(),n.words(),t)})};return{local:function(n,e,t,r){var o=e.zones(),u=P(o,function(n){var e=ri.getInCache(i,n.lang(),n.words(),Ti);return{zone:b(n),words:b(e),lang:n.lang}});f(n,u,t),r()},remote:function(e,n,t,r){var o=n.zones();ki.scan(i,c.correctionMany,o,a,Ti).get(function(n){u.removed||(f(e,n,t),r())})},check:function(e,n,t,r){var o=n.zones();ki.scan(i,c.check,o,a,!Ti).get(function(n){u.removed||(f(e,n,t),r())})},fetch:function(n){return ki.fetch(i,c,n,a)}}}var Ei,_i,Si=Object.prototype.hasOwnProperty,Ci=function(i){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var t={},r=0;r<n.length;r++){var o=n[r];for(var u in o)Si.call(o,u)&&(t[u]=i(t[u],o[u]))}return t}},Ii=Ci(function(n,e){return c(n)&&c(e)?Ii(n,e):e}),Ni=Ci(function(n,e){return e}),Ai=function(){return{zh_hk:"zh_tw",iw:"he",no:"nb",nn:"nb",en:"en",ar:"ar",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",es:"es",fa:"fa",fi:"fi",fr:"fr",he:"he",hr:"hr",hu:"hu",it:"it",ja:"ja",kk:"kk",ko:"ko",nl:"nl",nb:"nb",pl:"pl",pt:"pt",pt_pt:"pt_pt",ro:"ro",ru:"ru",sl:"sl",sk:"sk",sv:"sv",th:"th",tr:"tr",uk:"uk",zh:"zh",zh_tw:"zh_tw"}},Di=function(n){var e=n.toLowerCase().replace("-","_"),t=e.indexOf(";"),r=-1<t?e.substring(0,t):e,o=Xn(r),u=o.indexOf("_"),i=-1<u?o.substring(0,u):o;return{full:o,languageCode:i}},Ri=function(n,r){var e=n.split(","),t=P(e,function(n){return e=r,t=Di(n),e[t.full]||e[t.languageCode]||"";var e,t});return W(t,function(n){return""!==n})},Li={extract:Di,determine:function(n){return Ri(n,{zh_hk:"zh_tw",iw:"he",no:"nb",nn:"nb",en:"en",ar:"ar",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",es:"es",fa:"fa",fi:"fi",fr:"fr",he:"he",hr:"hr",hu:"hu",it:"it",ja:"ja",kk:"kk",ko:"ko",nl:"nl",nb:"nb",pl:"pl",pt:"pt",pt_pt:"pt_pt",ro:"ro",ru:"ru",sl:"sl",sk:"sk",sv:"sv",th:"th",tr:"tr",uk:"uk",zh:"zh",zh_tw:"zh_tw"})},determineFrom:Ri,localeList:Ai},Mi="no.language",ji={en_au:"en_gb",en_bz:"en_gb",en_ca:"en_gb",en_gb:"en_gb",en_ie:"en_gb",en_in:"en_gb",en_jm:"en_gb",en_my:"en_gb",en_nz:"en_gb",en_ph:"en_gb",en_sg:"en_gb",en_tt:"en_gb",en_za:"en_gb",en_zw:"en_gb",en_us:"en_us",en:"en_us"},Pi=["da","de","en","en_au","en_br","en_gb","en_uk","en_us","es","fi","fr","it","nb","nl","pt","pt_pt","sv"],Bi={determine:function(n){return n===Mi?N.some(n):(e=n,t=Ni(Li.localeList(),ji),Li.determineFrom(e,t).filter(function(n){return M(Pi,n)}));var e,t},isOn:function(n){return n!==Mi},offKey:b(Mi)};(_i=Ei||(Ei={}))[_i.Error=0]="Error",_i[_i.Value=1]="Value";var Fi,zi,Wi=function(n,e,t){return n.stype===Ei.Error?e(n.serror):t(n.svalue)},qi=function(n){return{stype:Ei.Value,svalue:n}},Ui=function(n){return{stype:Ei.Error,serror:n}},Vi=function(n){return Wi(n,ou.error,ou.value)},Hi=qi,Ji=function(n){var e=[],t=[];return B(n,function(n){Wi(n,function(n){return t.push(n)},function(n){return e.push(n)})}),{values:e,errors:t}},Ki=Ui,Yi=function(n,e){return n.stype===Ei.Value?e(n.svalue):n},Xi=function(n,e){return n.stype===Ei.Error?e(n.serror):n},$i=function(n,e){return n.stype===Ei.Value?{stype:Ei.Value,svalue:e(n.svalue)}:n},Gi=function(n,e){return n.stype===Ei.Error?{stype:Ei.Error,serror:e(n.serror)}:n},Qi=function(n){return c(n)&&100<Y(n).length?" removed due to size":JSON.stringify(n,null,2)},Zi=function(n,e){return Ki([{path:n,getErrorInfo:e}])},nc=bt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),ec=nc.strict,tc=(nc.asOption,nc.defaultedThunk,nc.asDefaultedOptionThunk,nc.mergeWithThunk,function(n,e){var t;return(t={})[n]=e,t}),rc=function(n){return g(Ki,U)(n)},oc=function(n,e){var t,r,o=Ji(n);return 0<o.errors.length?rc(o.errors):(t=o.values,r=e,0<t.length?Hi(Ii(r,Ni.apply(void 0,t))):Hi(r))},uc=function(n){var e=Ji(n);return 0<e.errors.length?rc(e.errors):Hi(e.values)},ic=bt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),cc=function(t,r,o){return en(r,o).fold(function(){return n=o,e=r,Zi(t,function(){return'Could not find valid *strict* value for "'+n+'" in '+Qi(e)});var n,e},Hi)},ac=function(n,e,t){var r=en(n,e).fold(function(){return t(n)},x);return Hi(r)},fc=function(c,a,n,f){return n.fold(function(o,t,n,r){var u=function(n){var e=r.extract(c.concat([o]),f,n);return $i(e,function(n){return tc(t,f(n))})},i=function(n){return n.fold(function(){var n=tc(t,f(N.none()));return Hi(n)},function(n){var e=r.extract(c.concat([o]),f,n);return $i(e,function(n){return tc(t,f(N.some(n)))})})};return n.fold(function(){return Yi(cc(c,a,o),u)},function(n){return Yi(ac(a,o,n),u)},function(){return Yi(Hi(en(a,o)),i)},function(n){return Yi((t=n,r=en(e=a,o).map(function(n){return!0===n?t(e):n}),Hi(r)),i);var e,t,r},function(n){var e=n(a),t=$i(ac(a,o,b({})),function(n){return Ii(e,n)});return Yi(t,u)})},function(n,e){var t=e(a);return Hi(tc(n,f(t)))})},sc=function(r){return{extract:function(t,n,e){return Xi(r(e,n),function(n){return e=n,Zi(t,function(){return e});var e})},toString:function(){return"val"}}},lc=function(c){return{extract:function(n,e,t){return r=n,o=t,u=e,i=P(c,function(n){return fc(r,o,n,u)}),oc(i,{});var r,o,u,i},toString:function(){return"obj{\n"+P(c,function(n){return n.fold(function(n,e,t,r){return n+" -> "+r.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"}}},gc=b(sc(Hi)),dc=g(function(o){return{extract:function(t,r,n){var e=P(n,function(n,e){return o.extract(t.concat(["["+e+"]"]),r,n)});return uc(e)},toString:function(){return"array("+o.toString()+")"}}},lc),pc=(ic.state,ic.field),mc=function(n,e,t){return Vi((r=n,o=x,u=t,i=e.extract([r],o,u),Gi(i,function(n){return{input:u,errors:n}})));var r,o,u,i},hc=function(n,e,t){return mc(n,e,t).fold(function(n){throw new Error(vc(n))},x)},vc=function(n){return"Errors: \n"+(e=n.errors,t=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e,P(t,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})).join("\n")+"\n\nInput object: "+Qi(n.input);var e,t},yc=function(u){return _n(_n({},u),{toCached:function(){return yc(u.toCached())},bindFuture:function(e){return yc(u.bind(function(n){return n.fold(function(n){return di.pure(ou.error(n))},function(n){return e(n)})}))},bindResult:function(e){return yc(u.map(function(n){return n.bind(e)}))},mapResult:function(e){return yc(u.map(function(n){return n.map(e)}))},mapError:function(e){return yc(u.map(function(n){return n.mapError(e)}))},foldResult:function(e,t){return u.map(function(n){return n.fold(e,t)})},withTimeout:function(n,o){return yc(di.nu(function(e){var t=!1,r=_.setTimeout(function(){t=!0,e(ou.error(o()))},n);u.get(function(n){t||(_.clearTimeout(r),e(n))})}))}})},wc=function(n){return yc(di.nu(n))},bc=function(n){return yc(di.pure(ou.value(n)))},xc={nu:wc,wrap:yc,pure:bc,value:bc,error:function(n){return yc(di.pure(ou.error(n)))},fromResult:function(n){return yc(di.pure(n))},fromFuture:function(n){return yc(n.map(ou.value))},fromPromise:function(n){return wc(function(e){n.then(function(n){e(ou.value(n))},function(n){e(ou.error(n))})})}},kc=function(){return(new Date).getTime()},Tc=function(n,t){void 0===t&&(t=36e5);var e,r,o={},u=function(n,e,t){o[n]={result:e,timestamp:t}},i=function(n,e){return n-e<t};return c(n)&&(e=n,r=kc(),$(e,function(n,e){i(r,n.timestamp)&&u(e,n.result,n.timestamp)})),{set:u,get:function(e,n){return N.from(o[n]).filter(function(n){return i(e,n.timestamp)}).map(function(n){return n.result})},dump:function(){return o}}};(zi=Fi||(Fi={})).JSON="json",zi.Blob="blob",zi.Text="text",zi.FormData="formdata",zi.MultipartFormData="multipart/form-data";var Oc,Ec,_c,Sc,Cc=function(n){try{var e=JSON.parse(n);return ou.value(e)}catch(n){return ou.error("Response was not JSON.")}},Ic=function(e){return di.nu(function(t){var n=new _.FileReader;n.onload=function(n){var e=n.target?n.target.result:new _.Blob([]);t(e)},n.readAsText(e)})},Nc=function(n){return di.pure(n.response)},Ac=function(n,e){switch(n){case Fi.JSON:return Cc(e.response).fold(function(){return Nc(e)},di.pure);case Fi.Blob:return t=e,N.from(t.response).map(Ic).getOr(di.pure("no response content"));case Fi.Text:default:return Nc(e)}var t},Dc=function(n){var e,t=(e=n.body,N.from(e).bind(function(n){switch(n.type){case Fi.JSON:return N.some("application/json");case Fi.FormData:return N.some("application/x-www-form-urlencoded; charset=UTF-8");case Fi.MultipartFormData:return N.none();case Fi.Text:default:return N.some("text/plain")}})),r=!0===n.credentials?N.some(!0):N.none(),o=function(n){switch(n){case Fi.Blob:return"application/octet-stream";case Fi.JSON:return"application/json, text/javascript";case Fi.Text:return"text/plain";default:return""}}(n.responseType)+", */*; q=0.01",u=void 0!==n.headers?n.headers:{};return{contentType:t,responseType:function(n){switch(n){case Fi.JSON:return N.none();case Fi.Blob:return N.some("blob");case Fi.Text:return N.some("text");default:return N.none()}}(n.responseType),credentials:r,accept:o,headers:u,progress:f(n.progress)?N.some(n.progress):N.none()}},Rc=function(n){var t=new _.FormData;return $(n,function(n,e){t.append(e,n)}),t},Lc=function(a){return xc.nu(function(r){var o,u=new _.XMLHttpRequest;u.open(a.method,(o=a.url,N.from(a.query).map(function(n){var e=Z(n,function(n,e){return encodeURIComponent(e)+"="+encodeURIComponent(n)}),t=Kn(o,"?")?"&":"?";return 0<e.length?o+t+e.join("&"):o}).getOr(o)),!0);var t,n,e=Dc(a);t=u,(n=e).contentType.each(function(n){return t.setRequestHeader("Content-Type",n)}),t.setRequestHeader("Accept",n.accept),n.credentials.each(function(n){return t.withCredentials=n}),n.responseType.each(function(n){return t.responseType=n}),n.progress.each(function(e){return t.upload.addEventListener("progress",function(n){return e(n.loaded,n.total)})}),$(n.headers,function(n,e){return t.setRequestHeader(e,n)});var i,c=function(){var e,n,t;(e=a.url,n=a.responseType,t=u,Ac(n,t).map(function(n){return{message:0===t.status?"Unknown HTTP error (possible cross-domain request)":"Could not load url "+e+": "+t.statusText,status:t.status,responseText:n}})).get(function(n){return r(ou.error(n))})};u.onerror=c,u.onload=function(){var n;0!==u.status||(n=a.url,Jn(n,"file:",0))?u.status<100||400<=u.status?c():function(n,e){var t=function(){return xc.pure(e.response)},r=function(n){return xc.error({message:n,status:e.status,responseText:e.responseText})};switch(n){case Fi.JSON:return Cc(e.response).fold(r,xc.pure);case Fi.Blob:case Fi.Text:return t();default:return r("unknown data type")}}(a.responseType,u).get(r):c()},(i=a.body,N.from(i).map(function(n){return n.type===Fi.JSON?JSON.stringify(n.data):n.type===Fi.FormData?Rc(n.data):n.type===Fi.MultipartFormData?Rc(n.data):n})).fold(function(){return u.send()},function(n){u.send(n)})})},Mc=function(n){return n.fold(function(n){var e=n.responseText,t=c(e)?e:n.message;return ou.error(t)},ou.value)},jc=function(c,a){var n,f=en(n=a,"tiny-api-key").orThunk(function(){return en(n,"tinymce-api-key")}).orThunk(function(){return en(n,"textbox-api-key")}).getOrUndefined();return{execute:function(n){var e,t,r,o,u,i=(e={url:(r=c,o=f,u=-1===r.indexOf("?")?"?":"&",o?r+u+"apiKey="+encodeURIComponent(o):r),body:(t=n,{type:Fi.JSON,data:t}),responseType:Fi.JSON,credentials:!0,headers:a},Lc(_n(_n({},e),{method:"post"}))).map(Mc);return xc.wrap(i)}}},Pc=function(e,o,n,u,t){return!0===t?{known:{},unknown:n}:z(n,function(t,n){var r=u(n);return e(o,r).fold(function(){return{known:t.known,unknown:t.unknown.concat([n])}},function(n){var e=tc(r,n);return{known:_n(_n({},t.known),e),unknown:t.unknown}})},{known:{},unknown:[]})},Bc=function(n,e,t,r,o,u){var i,c,a,f,s,l=Pc(e.get,o,t,r,u);return 0===l.unknown.length?xc.value(l.known):(i=n,c=e,a=l.known,f=l.unknown,s=o,i(f,u).mapResult(function(n){return $(n,function(n,e){c.set(e,n,s)}),_n(_n({},a),n)}))},Fc=function(n){return pc(n,n,ec(),gc())},zc=function(n,e){return pc(n,n,(t=e,nc.defaultedThunk(b(t))),gc());var t},Wc="iframely",qc="oembed",Uc="fallback",Vc="wikipedia",Hc=function(n){return"["+n.join(", ")+"]"},Jc=[Wc,qc,Uc],Kc=function(e,n,t){return j(n,function(n){return M(e,n)})?ou.error("Embed response source: "+Hc(e)+" contains more than one of "+Hc(Jc)):ou.value(t)},Yc=(lc([Fc("url"),Fc("maxWidth"),zc("fresh",!1)]),lc([Fc("status_code"),Fc("sub_code"),Fc("msg")]),lc([Fc("html"),(Oc="rels",Ec=[pc("source","source",ec(),(_c=function(n){return a(n)?M(e=n,Wc)?Kc(e,[qc,Uc,Vc],Wc):M(e,qc)?Kc(e,[Wc,Uc,Vc],qc):M(e,Uc)?Kc(e,[Wc,qc,Vc],Uc):M(e,Vc)?Kc(e,[Wc,qc,Uc],Vc):ou.error("Embed response source: "+Hc(e)+" did not contain any of: "+Hc(Jc)):ou.error("Sources was not an array: "+n);var e},sc(function(n){return _c(n).fold(Ki,Hi)})))],pc(Oc,Oc,ec(),lc(Ec)))]),[Fc("url"),zc("fresh",!1)]),Xc=(lc([pc("urls","urls",ec(),(Sc=Yc,dc(Sc)))]),bt([{invalid:["invalidUrl"]},{unknown:["unknownUrl"]},{valid:["validUrl"]}]),lc([Fc("language"),Fc("words")])),$c=function(t,o,r,n,e){var u=P(function(n,e){for(var t=[],r=0;r<n.length;r+=e){var o=A.call(n,r,r+e);t.push(o)}return t}(n,e),function(n){var e=hc("ephox.spelling.service.many.ajax.service.get",Xc,{language:r,words:n});return t.execute(e)});return xc.wrap(mi(u).map(function(n){var e=hi(n);if(0<e.values.length){var t=P(e.values,o),r=z(t,Ni,{});return ou.value(r)}return 0<e.errors.length?ou.error("Failures communicating with the spelling server: "+e.errors.join(", ")):ou.error("Unknown error")}))},Gc=function(r,o,u,n,i,e){var c=function(n){return n.spell};return Bc(function(n,e){var t=hc("ephox.spelling.service.many.ajax.service.get",Xc,{language:u,words:n});return r.execute(t).mapResult(c)},o,n,x,i,void 0!==e&&e).mapResult(function(e){B(n,function(n){tn(e,n)||o.set(n,Zc,i)});var r={};return $(e,function(e,t){o.get(i,t).each(function(n){n!==Zc&&(r[t]=e)})}),r})},Qc=function(n){void 0===n&&(n={});var t={};return $(n,function(n,e){t[e]=Tc(n)}),t},Zc=Su("good-spelling"),na=function(n,e){return en(n,e).getOrThunk(function(){return Tc()})},ea=function(n,e,t,r){var d=Qc(r),p=Qc({}),m=jc(n,t),o=jc(e,t);return{checkMany:function(n,e){var t,r,o,u,i,c,a,f=(t={},B(e,function(n){t[n]={}}),Y(t)),s=kc(),l=na(p,n),g=na(d,n);return p[n]=l,d[n]=g,r=m,o=g,u=n,a=function(n){return n.check},Bc(function(n,e){return $c(r,a,u,n,1e3)},l,f,x,i=s,void 0!==c&&c).mapResult(function(n){var t=[],r={};return $(n,function(n,e){n?o.set(e,Zc,i):r[e]=t}),r})},correctOne:function(n,e){var t=kc(),r=na(d,n);return d[n]=r,Gc(o,r,n,[e],t)},correctMany:function(n,e){var t=kc(),r=na(d,n);return d[n]=r,Gc(o,r,n,e,t)},dumpCache:function(){return G(d,function(n){return n.dump()})}}},ta={consoleMessage:function(n){if(f((t=n).message)&&f(t.status)&&f(t.responseText)){var e=n.responseText();return n.message()+". Response code "+n.status()+(0===e.length?".":". Error details: "+e)}return n;var t}},ra={get:function(n){var e=ve.getApiKey(n);return null===e?{}:{"tiny-api-key":e}}},oa={spelling:b("1")},ua=function(n,e){var t,r;return(Yn(t=n,r="/")?t:t+r)+e},ia={corsQuery:function(n){return ua(n,"version")},spelling:function(n){return ua(n,oa.spelling())+"/"}};function ca(e){var r=e.gaol,t=e.editor,n=e.language,o=ve.getHandler(t),u=o||function(n,o,u,i){var e=ia.spelling(o),t=ea(e+"correct",e+"correction",ra.get(n)),c=gt.create({failed:lt(["resource"])}),a=si.nu(function(n){t.checkMany(u,["startup"]).get(n)});a.get(function(n){n.fold(function(n){_.console.error("Unable to communicate with the spelling service:",ta.consoleMessage(n)),c.trigger.failed(o)},w)});var r=function(t,r){return di.nu(function(e){a.get(function(n){n.fold(function(){return e(n)},function(){r(i?t:u).get(function(n){e(n),n.fold(function(n){_.console.error("Error response from the spelling service:",ta.consoleMessage(n)),c.trigger.failed(o)},w)})})})})};return{check:function(e,n){return r(n,function(n){return t.checkMany(n,e)})},correction:function(e,n){return r(n,function(n){return t.correctOne(n,e)})},correctionMany:function(e,n){return r(n,function(n){return t.correctMany(n,e)})},events:c.registry,state:function(){return t.dumpCache()}}}(t,e.url,n,e.multilingual),i=gt.create({failed:lt(["resource"])});u.events.failed.bind(function(n){i.trigger.failed(n.resource())});var c=Qu(n,e.viewable.viewport()),a=Oi(t,e.cache,u,ve.getWhitelist(t)),f=function(){return!Bi.isOn(r.spelling().get())},s=function(){var n,e;n="mce-spellchecker-word",e=t.dom.select("span."+n),B(e,function(n){!function(n){var e=n.parentNode,t=n.childNodes;if(e){for(;0<t.length;)e.insertBefore(t[0],n);e.removeChild(n)}}(n)})};return e.editor.on("remove",function(){c.destroy()}),{run:function(n,e){var t=r.spelling().get();Bi.isOn(t)&&(c.setLang(t),c.run(n,a.local,e),c.schedule(n,a.remote,e,f))},fetch:a.fetch,check:function(n,e,t){c.setLang(r.nonOffSpelling()),c.run(n,a.check,e,t)},refresh:function(){var n=r.spelling().get();Bi.isOn(n)&&e.asYouType||s()},clear:s,state:u.state,events:i.registry}}var aa=function(){var n=!1;return{isBlocked:function(){return n},block:function(){n=!0},unblock:function(){n=!1}}},fa=function(n,e){return{control:n,instance:e}},sa={tap:function(t){var r=aa();return fa(r,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];r.isBlocked()||t.apply(null,n)})}},la=function(n,e,t,r){var o=ce(n,t)&&e===r;return{startContainer:b(n),startOffset:b(e),endContainer:b(t),endOffset:b(r),collapsed:b(o)}},ga={isSpace:function(n){return 32===(n.which||n.keyCode)},isEnter:function(n){return 13===(n.which||n.keyCode)}};function da(r){var o=gt.create({lookup:lt(["element"])}),e=function(){var n,e;n=function(n){o.trigger.lookup(n.startContainer())},e=r.selection.getRng(),n(la(on.fromDom(e.startContainer),e.startOffset,on.fromDom(e.endContainer),e.endOffset))},n=function(n){ga.isSpace(n)&&e()};return r.on("keyup",n),r.on("remove",function(){r.off("keyup",n)}),r.on("init",function(){var t=on.fromDom(r.getBody()),n=function(n){if(!n.selectionChange){var e=on.fromDom(n.element);ce(t,e)||(o.trigger.lookup(t),t=e)}};r.on("nodechange",n),r.on("remove",function(){r.off("nodechange",n)})}),{events:o.registry}}var pa=te().browser.isFirefox(),ma=function(n){return n.filter(function(n){return"img"===pn(n)})},ha=function(n){return wn(n)&&0===nt(n).length},va=function(u){var n,i=ma(je(u.startContainer(),u.startOffset()));return(n=u,ma(Le(n.startContainer()))).orThunk(function(){return i}).bind(function(o){return(n=u,ma(Re(n.endContainer()))).bind(function(n){var e=ce(o,n),t=u.startContainer().dom().length===u.startOffset(),r=0===u.endOffset();return e&&(t||i.isSome())&&r?N.some(o):N.none()});var n})},ya=function(n){return n.filter(function(n){return!n.collapsed()}).bind(function(n){return function(n){var e=n.startContainer();if(!ce(e,n.endContainer()))return N.none();if("img"===pn(e))return N.some(e);var t=Math.min(n.startOffset(),n.endOffset()),r=Math.max(n.startOffset(),n.endOffset()),o=ma(je(e,t));return r===t||r===t+1?o:pa&&r===t+2?o.filter(function(n){return Le(n).filter(ha).isSome()}):N.none()}(n).orThunk(function(){return va(n)})})},wa=Oe("image"),ba={detect:function(n){return ya(n).map(wa)}},xa=function(r,o,u){if(0===o.length)throw new Error("You must specify at least one required field.");return Ce("required",o),Ie(o),function(e){var t=Y(e);H(o,function(n){return M(t,n)})||_e(o,t),r(o,t);var n=F(o,function(n){return!u.validate(e[n],n)});return 0<n.length&&function(n,e){throw new Error("All values need to be of type: "+e+". Keys ("+Ee(n).join(", ")+") were not.")}(n,u.label),e}},ka=function(e,n){var t=F(n,function(n){return!M(e,n)});0<t.length&&Se(t)},Ta=Oe("ch","offset"),Oa=function(n,e){return Ta(n.charAt(e),e)},Ea=function(n,e){for(var t=e.getOr(n.length)-1;0<=t;t--)if(n.charAt(t)!==Mt)return N.some(Oa(n,t));return N.none()},_a=function(n,e){for(var t=e.getOr(0)+1;t<n.length;t++)if(n.charAt(t)!==Mt)return N.some(Oa(n,t));return N.none()},Sa=function(n,e){e.lastIndex=-1;var t=J(n).join(""),r=t.match(e);return null!=r&&void 0!==r.index&&0<=r.index?N.some(t.length-1-r.index):N.none()},Ca=function(n,e){e.lastIndex=-1;var t=n.match(e);return null!=t&&void 0!==t.index&&0<=t.index?N.some(t.index):N.none()},Ia=function(n,e){return M(["br","img","hr","input"],n.property().name(e))},Na=Ia,Aa=Or().left(),Da=Or().right(),Ra=bt([{abort:[]},{kontinue:[]},{finish:["info"]}]),La=bt([{aborted:[]},{edge:["element"]},{success:["info"]}]),Ma=function(n,e){return Na(n,e)||n.property().isBoundary(e)},ja=function(t,n,r,e,o,u,i){var c=function(){return i.fold(La.aborted,La.edge)},a=function(e){return Er(t,n,r,u).fold(c,function(n){return ja(t,n.item(),n.mode(),N.none(),o,u,e)})};if(Ma(t,n))return c();if(t.property().isText(n)){var f=t.property().getText(n);return o(t,Ra,n,f,e).fold(c,function(){return a(N.some(n))},La.success)}return a(i)},Pa=function(e,n,t,r){var o,u,i,c,a=at(e,n,t);return e.property().isText(n)?N.none():(o=e,u=a.element(),i=e.property().isText,c=r,xr(o,u,i,hr,br.left(),c)).map(function(n){return ot(n,e.property().getText(n).length)})},Ba=function(o,u,i){var c=function(n){return Ma(o,n)};return Pa(o,u,i,c).orThunk(function(){return t=c,r=at(n=o,e=u,i),n.property().isText(e)?N.none():kr(n,r.element(),n.property().isText,t).map(function(n){return ot(n,0)});var n,e,t,r}).getOr(ot(u,i))},Fa=function(n,e,t,r){var o=Ba(n,e,t);return ja(n,o.element(),hr,N.some(o.offset()),r,Aa,N.none())},za=function(n,e,t,r){var o=Ba(n,e,t);return ja(n,o.element(),hr,N.some(o.offset()),r,Da,N.none())},Wa=xa(ka,["regex","attempt"],{validate:f,label:"function"}),qa=Fa,Ua=za,Va=function(e,n,t){var r=b(!1);if(!e.property().isText(n))return N.none();var o=e.property().getText(n);return t<=o.length?N.some(ot(n,t)):Tr(e,n,e.property().isText,r).bind(function(n){return Va(e,n,t-o.length)})},Ha={previousChar:Ea,nextChar:_a,repeatLeft:qa,repeatRight:Ua,expandLeft:function(n,e,t,r){var i=Wa(r);return qa(n,e,t,function(n,e,t,r,o){var u=o.getOr(r.length);return Sa(r.substring(0,u),i.regex()).fold(function(){return e.kontinue()},function(n){return i.attempt(e,t,r,n)})})},expandRight:function(n,e,t,r){var i=Wa(r);return Ua(n,e,t,function(n,e,t,r,o){var u=o.getOr(0);return Ca(r.substring(u),i.regex()).fold(function(){return e.kontinue()},function(n){return i.attempt(e,t,r,u+n)})})},scanRight:Va},Ja=rt(),Ka=function(n,e){return Ha.scanRight(Ja,n,e)},Ya=function(n,e){var t=ot(n,e);return wn(n)?Ka(n,e).getOr(t):t},Xa={handle:function(n){var e=Ya(n.startContainer(),n.startOffset()),t=Ya(n.endContainer(),n.endOffset());return la(e.element(),e.offset(),t.element(),t.offset())}},$a=te().browser,Ga=function(n){return Et(n.endContainer(),n.endOffset(),n.startContainer(),n.startOffset())},Qa=function(n){return wn(n)||"br"===pn(n)};function Za(c){var a=function(){var n=c.selection.getRng(),e=on.fromDom(n.startContainer),t=on.fromDom(n.endContainer);return la(e,n.startOffset,t,n.endOffset)},u=function(n,e){var t,r,o=n(),u=Xa.handle(e),i=a();return(!ce(i.startContainer(),u.startContainer())||!ce(i.endContainer(),u.endContainer())||i.startOffset()!==u.startOffset()||i.endOffset()!==u.endOffset())&&(t=u,(r=c.dom.createRng()).setStart(t.startContainer().dom(),t.startOffset()),r.setEnd(t.endContainer().dom(),t.endOffset()),c.selection.setRng(r)),o},i=function(n,e){var t,r,o;return Qa(e.startContainer())&&Qa(e.endContainer())||ba.detect(N.some(e)).isSome()?u(n,e):(t=n,r=c.selection.getBookmark(),o=t(),c.selection.moveToBookmark(r),o)};return{transaction:function(n){var e=a(),t=st(e.endContainer(),e.endOffset()),r=st(e.startContainer(),e.startOffset()),o=e.collapsed()||!$a.isIE()||Ga(e),u=o&&!$a.isFirefox()?la(r.element(),r.offset(),t.element(),t.offset()):e;return(o?i:k)(n,u)}}}function nf(o,t,r,n,e){var u,i,c,a,f,s,l=Tt(o,e),g=ca({editor:o,gaol:n,viewable:l,cache:r,url:t,language:n.spelling().get(),multilingual:!0,asYouType:e}),d=(u=o,i=g,c=e,a=sa.tap(function(n){var e=n.element();if(c){var t=St.single(e);s(t)}}),f=Za(u),s=function(n){i.run(f.transaction,n)},c&&da(u).events.lookup.bind(function(n){a.instance(n)}),{scan:s,check:function(n,e){i.check(f.transaction,n,e)},lock:function(n){var e=a.control.isBlocked();a.control.block(),n(),e||a.control.unblock()}}),p=gt.create({analytics:lt(["message"])});g.events.failed.bind(function(n){var e=o.translate(["The spelling service was not found: ({0})",t]);Ot.fireError(o,{message:e}),_.console.error(e)}),o.on("init",function(){var n=o.getBody(),e=on.fromDom(n);xn(e,"spellcheck",!1),g.refresh()}),o.on("remove",function(){var n=o.getBody(),e=on.fromDom(n);Tn(e,"spellcheck"),r.destroy()});var m=function(n,e,t,r){var o=Hu.isWrap(n)?st(n,e):ot(n,e),u=Hu.isWrap(t)?st(t,r):ot(t,r);return St.range(o.element(),o.offset(),u.element(),u.offset())},h=function(n){var e=n[0],t=n[n.length-1],r=Pe(t);return m(e,0,t,r)},v=function(){var n=l.sections();if(0<n.length){var e=h(n);d.scan(e)}};l.events.onChange.bind(v);var y=g.clear;return{events:function(){return p.registry},scanView:v,scanRange:function(n,e,t,r){(0,d.scan)(m(n,e,t,r))},fetch:g.fetch,checkDocument:function(n){var e=on.fromDom(o.getBody()),t=Me(e);if(0<t.length){var r=h(t);d.check(r,n)}},lock:function(n){return d.lock(n)},clear:y}}var ef=function(n){return"img"===pn(n)?1:(e=n,Ze.getOption(e)).fold(function(){return Me(n).length},function(n){return n.length});var e},tf=function(n,t){return Uu.marker(n).bind(Uu.detail).map(function(n){var e=t.suggestions(n.lang(),n.word());return{detail:n,suggestions:e}})},rf=function(t,n,e){t.undoManager.transact(function(){Uu.substitute(n,e).each(function(n){var e=ef(n);t.selection.setCursorLocation(n.dom(),e),t.focus()})})},of=tf,uf=function(n,e,t){n.undoManager.transact(function(){Uu.ignore(e)}),Ot.fireIgnore(n,t)},cf=function(n,e,t,r,o){o.ignore(r,t),Uu.ignoreAll(e),Ot.fireIgnoreAll(n,t)},af=function(n,e,t,r,o){var u=4<r.length?o.getSubstituteItemsOverMax(n,r,4):o.getSubstituteItems(n,r),i=[o.getSeparator(),o.getIgnoreItem(n,t),o.getIgnoreAllItem(n,t,e)];return u.concat(i)},ff=function(n,e,t){void 0===t&&(t=100);var r,o=n.length>t?t:n.length,u=n.slice(0,o),i=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e}(P(u,function(n){return tf(n,e)}));return r={},B(i,function(n){r[n.detail.word()]=n}),nn(r)},sf=function(n){var e,t=Uu.allMarkers(n);return(e=t,0===e.length?N.none():N.some(e[0])).bind(Uu.detail)},lf=function(n){return Uu.allMarkers(n)},gf=function(t,e,u,i,r){var o=function(n){var e=Bi.isOn(n);(e?u.scanView:u.clear)(),(e?Ot.fireSpellcheckStart:Ot.fireSpellcheckEnd)(t)},c=function(e,n,t,r){var o=function(){r<3?c(e,n,t,r+1):n()};u.fetch(e).get(function(n){0<n.values.length?tf(e[0].detail.element(),i).fold(function(){o()},function(n){n.suggestions.fold(function(){o()},function(n){t(n)})}):o()})};return{changeLanguage:function(n){e.spelling().setAndCache(t,n),r&&o(n)},toggleLanguage:function(){var n=Bi.isOn(e.spelling().get())?Bi.offKey():e.nonOffSpelling();e.spelling().setAndCache(t,n),o(n)},getWordsAsync:function(n){u.checkDocument(n)},getWordsSuggestionsAsync:c}},df=function(r,o){var a=function(n,e){return{text:e,onAction:function(){rf(r,n,e)}}},u={getSubstituteItemsOverMax:function(e,n,t){var r=n.slice(0,t),o=n.slice(t),u=P(r,function(n){return a(e,n)}),i=P(o,function(n){return a(e,n)}),c={type:"submenu",text:"More...",getSubmenuItems:function(){return i}};return u.concat([c])},getSubstituteItems:function(e,n){return P(n,function(n){return a(e,n)})},getSeparator:function(){return{type:"separator"}},getIgnoreItem:function(n,e){return{text:"Ignore",onAction:function(){uf(r,n,e)}}},getIgnoreAllItem:function(n,e,t){return{text:"Ignore all",onAction:function(){cf(r,n,e,t,o)}}}};r.ui.registry.addContextMenu("spellchecker",{update:function(n){var t,e=on.fromDom(n);return of(t=e,o).bind(function(e){return e.suggestions.map(function(n){return af(t,e.detail.lang(),e.detail.word(),n,u)})}).getOr([])}})},pf="SpellcheckStart SpellcheckEnd",mf=function(o,n,t,r,e){var u=P(n,function(n){return _n(_n({},n),{type:"choiceitem"})}),i={tooltip:"Spellcheck...",onAction:function(){o.execCommand("mceSpellcheckDocument")},icon:"spell-check"},c={tooltip:"Spellcheck...",onAction:function(){o.execCommand("mceSpellcheckDocument")},select:function(n){return n===t.spelling().get()},icon:"spell-check",fetch:function(n){n(u)},onItemAction:function(n,e){r.changeLanguage(e)}},a={tooltip:"Spellcheck",onAction:r.toggleLanguage,icon:"spell-check",onSetup:function(n){var e=function(){n.setActive(Bi.isOn(t.spelling().get()))};return e(),o.on(pf,e),function(){return o.off(pf,e)}},select:function(n){return n===t.spelling().get()},fetch:function(n){n(u)},onItemAction:function(n,e){r.changeLanguage(e)}},f={text:"Spellcheck...",onAction:function(){o.execCommand("mceSpellcheckDocument")}};e?(o.ui.registry.addSplitButton("spellchecker",a),o.ui.registry.addToggleMenuItem("spellchecker",{text:"Spellcheck",onAction:r.toggleLanguage,onSetup:function(n){var e=function(){return n.setActive(Bi.isOn(t.spelling().get()))};return e(),o.on(pf,e),function(){return o.off(pf,e)}}}),o.ui.registry.addButton("spellcheckdialog",i),o.ui.registry.addMenuItem("spellcheckdialog",f)):(o.ui.registry.addSplitButton("spellchecker",c),o.ui.registry.addMenuItem("spellchecker",f));var s,l,g,d=function(n){return{type:"togglemenuitem",text:n.text,onAction:function(){return r.changeLanguage(n.value)},active:n.value===t.spelling().get()}};if(o.ui.registry.addNestedMenuItem("spellcheckerlanguage",{text:"Spellcheck Language",getSubmenuItems:function(){return P(u,d)}}),l=tinymce,g="5.0.3",l&&1===v(y(l),h(g))){var p=ve.getSelectContentLanguages(o),m=(s={},B(p.split(","),function(n){n=n.toLowerCase(),s[n]=tn(de,n)?de[n]:n.toUpperCase()}),s);o.ui.registry.addMenuButton("language",{tooltip:"Language",icon:"translate",fetch:function(n){var e,t,r=(e=o,t=m,ge(on.fromDom(e.selection.getNode()),"[lang]").map(function(n){var e=kn(n,"lang").toLowerCase();return tn(t,e)||(t[e]=tn(de,e)?de[e]:e.toUpperCase()),e}));n(Z(m,function(n,t){return{type:"togglemenuitem",value:t,text:n,onSetup:function(n){return r.is(t)&&n.setActive(!0),w},onAction:function(){var n,e;e=t,(n=o).formatter.has("powerspell_language_select")||n.formatter.register("powerspell_language_select",{inline:"span",attributes:{lang:"%value"}}),n.undoManager.transact(function(){n.focus(),n.formatter.toggle("powerspell_language_select",{value:e}),n.nodeChanged()})}}}))},onSetup:function(t){var n=function(n){var e;t.setActive((e=n.parents,j(e,function(n){return""!==n.lang})))};return o.on("NodeChange",n),function(){o.off("NodeChange",n)}}})}},hf=function(n,e){n.addCommand("mceSpellcheckDocument",e.open)},vf=function(t,r,n,e,o){return{title:"Spellcheck",body:{type:"panel",items:[{type:"input",name:"textlabel",label:"Misspelled word"},{type:"selectbox",name:"suggestions",label:"Suggestions",size:6,items:P(n,function(n){return{text:n,value:n}})}]},initialData:{textlabel:r,suggestions:0<n.length?n[0]:""},onClose:function(){t.close()},onAction:function(n,e){switch(e.name){case"change":t.replace(n,r);break;case"ignore":t.ignore(n);break;case"ignoreall":t.ignoreAll(n)}n.focus("textlabel")},buttons:[{type:"custom",primary:!0,name:"change",text:"Change"},{type:"custom",name:"ignore",text:"Ignore"},{type:"custom",name:"ignoreall",text:"Ignore all"},{type:"cancel",text:"Close"}]}},yf=function(i,u,n,e,o){var c=function(){var n=i.translate("No misspellings found.");i.notificationManager.open({text:n,type:"info",timeout:3e3})},a=function(n,e,t,r){n.redial(vf(g,e,t))},f=function(e,n){e.block("Finding word suggestions");var t=ff(n,u),r=F(t,function(n){return n.suggestions.isNone()});o.getWordsSuggestionsAsync(r,function(){e.unblock()},function(n){a(e,t[0].detail.word(),n,t[0].detail),e.unblock()},0)},s=function(n){var e=ff(n,u);if(0<F(e,function(n){return n.suggestions.isNone()}).length){o.getWordsSuggestionsAsync(e,function(){},function(n){},0)}},l=function(n){var t,r,e=lf(i);0<e.length?(t=n,of((r=e)[0],u).each(function(e){e.suggestions.fold(function(){f(t,r)},function(n){a(t,e.detail.word(),n,e.detail),s(r)})})):(c(),n.close())},g={replace:function(n,e){var t=n.getData(),r=t.textlabel,o=t.suggestions,u=r===e?o:r;sf(i).each(function(n){rf(i,n.element(),u)}),l(n)},ignore:function(n){sf(i).each(function(n){uf(i,n.element(),n.word())}),l(n)},ignoreAll:function(n){sf(i).each(function(n){cf(i,n.element(),n.word(),n.lang(),u)}),l(n)},close:function(){e||n.clear()}},t=function(o){var n=o[0];of(n,u).each(function(r){r.suggestions.fold(function(){var n,e,t=(n=r.detail.word(),e=[],r.detail,i.windowManager.open(vf(g,n,e)));f(t,o)},function(n){var e,t;e=r.detail.word(),t=n,r.detail,i.windowManager.open(vf(g,e,t)),s(o)})})},r={open:function(){o.getWordsAsync(function(){var n=lf(i);0<n.length?t(n):c()})}};return hf(i,r),r},wf=tinymce.dom.DOMUtils,bf=function(i,r){var o=function(r,n){return P(n,function(n){return e=r,{text:t=n,onclick:function(){rf(i,e,t)}};var e,t})},u={getSubstituteItemsOverMax:function(n,e,t){var r=e.slice(0,t);return o(n,r)},getSubstituteItems:o,getSeparator:function(){return{text:"-"}},getIgnoreItem:function(n,e){return{text:"Ignore",onclick:function(){uf(i,n,e)}}},getIgnoreAllItem:function(n,e,t){return{text:"Ignore all",onclick:function(){cf(i,n,e,t,r)}}}},c=function(n){var t;return of(t=n,r).bind(function(e){return e.suggestions.map(function(n){return af(t,e.detail.lang(),e.detail.word(),n,u)})}).getOr([])};i.on("contextmenu",function(n){var e=on.fromDom(n.target),t=c(e);0<t.length&&(n.preventDefault(),n.stopImmediatePropagation(),function(n,e){var t=tinymce.ui.Factory.create("menu",{items:e,context:"contextmenu",onautohide:function(n){-1!==n.target.className.indexOf("spellchecker")&&n.preventDefault()},onhide:function(){t.remove()}});t.renderTo(_.document.body);var r=wf.DOM.getPos(i.getContentAreaContainer()),o=i.dom.getPos(n.dom()),u=i.dom.getRoot();"BODY"===u.nodeName?(o.x-=u.ownerDocument.documentElement.scrollLeft||u.scrollLeft,o.y-=u.ownerDocument.documentElement.scrollTop||u.scrollTop):(o.x-=u.scrollLeft,o.y-=u.scrollTop),r.x+=o.x,r.y+=o.y,t.moveTo(r.x,r.y+n.dom().offsetHeight)}(e,t))},!0)},xf="SpellcheckStart SpellcheckEnd",kf=function(c,u,n,e,o){var t,r=function(){var n=c.translate("No misspellings found.");c.notificationManager.open({text:n,type:"info",timeout:3e3})},i=(t=Sn(N.none()),{clear:function(){t.set(N.none())},set:function(n){t.set(N.some(n))},isSet:function(){return t.get().isSome()},on:function(n){t.get().each(n)}}),a=function(t,r){i.on(function(n){n.find("#text")[0].value(t);var e=n.find("#suggestions")[0];e.options(r),e.getEl().selectedIndex=0,e.getEl().focus()})},f=function(n){var e=n.find("#text")[0],t=n.find("#change")[0],r=n.find("#ignore")[0],o=n.find("#ignoreall")[0];e.disabled(!1),t.disabled(!1),r.disabled(!1),o.disabled(!1)},s=function(n){i.on(function(n){var e,t,r,o,u,i;t=(e=n).find("#text")[0],r=e.find("#suggestions")[0],o=e.find("#change")[0],u=e.find("#ignore")[0],i=e.find("#ignoreall")[0],t.value("Finding word suggestions"),t.disabled(!0),r.options([]),o.disabled(!0),u.disabled(!0),i.disabled(!0)});var e=ff(n,u),t=F(e,function(n){return n.suggestions.isNone()});o.getWordsSuggestionsAsync(t,function(){i.on(function(n){f(n)})},function(n){i.on(function(n){f(n)}),a(t[0].detail.word(),n)},0)},l=function(n){var e=ff(n,u);if(0<F(e,function(n){return n.suggestions.isNone()}).length){var t=w,r=w;o.getWordsSuggestionsAsync(e,r,t,0)}},g=function(n){var t,e=lf(c);0<e.length?of((t=e)[0],u).each(function(e){e.suggestions.fold(function(){s(t)},function(n){a(e.detail.word(),n),l(t)})}):(r(),n.close())},d=function(n){i.on(function(i){sf(c).each(function(n){var e=i.find("#text")[0],t=i.find("#suggestions")[0],r=e.value(),o=t.getEl().value,u=r===n.word()?o:r;rf(c,n.element(),u),g(i)})})},p={change:d,submit:d,ignore:function(n){i.on(function(n){sf(c).each(function(n){uf(c,n.element(),n.word())}),g(n)})},ignoreall:function(n){i.on(function(n){sf(c).each(function(n){cf(c,n.element(),n.word(),n.lang(),u)}),g(n)})},close:function(n){i.on(function(n){n.close()})},cleanUp:function(){e||n.clear(),i.clear()}},m=function(n,e){return c.windowManager.open({layout:"flex",align:"stretch",direction:"column",title:"Spellcheck",spacing:10,padding:10,callbacks:t=p,minWidth:350,items:[{type:"label",name:"textlabel",text:"Misspelled word"},{type:"textbox",name:"text",ariaLabel:"Misspelled word",spellcheck:!1,value:n},{type:"label",name:"suggestionslabel",text:"Suggestions"},{type:"container",layout:"flex",direction:"row",align:"stretch",spacing:10,items:[{type:"selectbox",name:"suggestions",ariaLabel:"Suggestion",minWidth:150,flex:1,size:6,border:1,options:e},{type:"container",layout:"flex",flex:1,spacing:5,direction:"column",pack:"center",align:"stretch",items:[{type:"button",subtype:"primary",name:"change",text:"Change",onclick:"change"},{type:"button",name:"ignore",text:"Ignore",onclick:"ignore"},{type:"button",name:"ignoreall",text:"Ignore all",onclick:"ignoreall"}]}]}],onsubmit:function(n){n.preventDefault(),t.replace()},onclose:function(n){t.cleanUp()},buttons:[{text:"Close",onclick:"close"}]});var t},h={open:function(){o.getWordsAsync(function(){var o,n,e=lf(c);0<e.length?(n=(o=e)[0],of(n,u).each(function(r){r.suggestions.fold(function(){var n=m(r.detail.word(),[]);i.set(n),s(o)},function(n){var e=m(r.detail.word(),n),t=e.find("#suggestions")[0];t.options(n),t.getEl().selectedIndex=0,t.getEl().focus(),i.set(e),l(o)})})):r()})}};return hf(c,h),h},Tf=Oe("suggestions","ignore"),Of=function(n){return function(n){void 0===n&&(n={});var r={},o=function(n){return r.hasOwnProperty(n)&&void 0!==r[n]?r[n]:{}},e=function(n,e){var t=o(n);e(t),r[n]=t},u=function(n,e){return e(o(n))},i=function(n,r,o){e(n,function(n){var e=ui(r);if(!tn(n,e)||n[e].suggestions().isNone()){var t=0<o.length?N.some(o):N.none();n[e]=Tf(t,!1)}})},c=function(n,u){e(n,function(n){var e=ui(u),t=n.hasOwnProperty(e)?n[e]:void 0,r=void 0!==t?t.suggestions():N.none(),o=Tf(r,!0);n[e]=o})};$(n,function(n,t){$(n,function(n,e){!0===n.ignore&&c(t,e),void 0!==n.suggestions&&i(t,e,n.suggestions)})});return{add:i,get:function(n,t){return u(n,function(n){var e=ui(t);return n.hasOwnProperty(e)?N.from(n[e]):N.none()})},ignore:c,suggestions:function(n,t){return u(n,function(n){var e=ui(t);return(n.hasOwnProperty(e)?N.from(n[e]):N.none()).bind(function(n){return n.ignore()?N.none():n.suggestions()})})},state:function(){return G(r,function(n,e){return G(n,function(n,e){return{ignore:n.ignore(),suggestions:n.suggestions().getOr([])}})})},destroy:function(){r={}}}}(n)},Ef=function(){try{var n=sn.localStorage,e="__storage_test__";return n.setItem(e,e),n.removeItem(e),N.some(n)}catch(n){return N.none()}}().fold(function(){var t={};return{getItem:function(n){return t[n]},setItem:function(n,e){t[n]=e}}},function(t){return{getItem:function(n){return t.getItem("mce."+n)},setItem:function(n,e){t.setItem("mce."+n,e)}}}),_f=function(n,e){var t;return(t=n,N.from(Ef.getItem(t))).map(JSON.parse).getOr(e)},Sf=function(n){return _f(n,{})},Cf=function(n,e){var t=JSON.stringify(e);Ef.setItem(n,t)},If={read:Sf,readOr:_f,write:Cf,access:function(n){return{read:l(Sf,n),write:l(Cf,n)}}};tinymce.PluginManager.requireLangPack("tinymcespellchecker","ar,ca,cs,da,de,el,es,fa,fi,fr_FR,he_IL,hr,hu_HU,it,ja,kk,ko_KR,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,zh_CN,zh_TW"),tinymce.PluginManager.add("tinymcespellchecker",function(n,e){if(S(tinymce,"4.2.8"))return _.console.error('The "tinymcespellchecker" plugin requires at least version 4.2.8 of TinyMCE.'),function(){};var t,r,o,u,i,c,a,f=ve.getLanguage(n),s=ve.getRpcUrl(n),l=Of({}),g=(t=f,r=If.readOr("spelling",t),o=Sn(r),u=Sn("no.language"===r?"en_us":r),i=o.set,c=o.get,a={setAndCache:function(n,e){ve.setLanguage(n,e),i(e),If.write("spelling",e),Bi.isOn(e)&&u.set(e)},set:i,get:c},{spelling:function(){return a},nonOffSpelling:u.get});ve.isActive(n)||"no.language"===g.spelling().get()||g.spelling().set("no.language");var d,p,m,h,v,y,w,b,x,k=ve.getLanguages(n),T=!ve.useDialog(n),O=nf(n,s,l,g,T),E=gf(n,g,O,l,T);S(tinymce,"5.0.0")?(bf(n,l),d=n,p=g,m=E,h=T,v=P(k,function(n){return{selectable:!0,text:n.text,data:n.value,onclick:function(){m.changeLanguage(n.value)}}}),w={icon:"spellchecker",type:"splitbutton",tooltip:"Spellcheck...",menu:v,onclick:function(){d.execCommand("mceSpellcheckDocument")},onshow:y=function(n){var e=p.spelling().get();B(n.control.items(),function(n){n.active(n.data.data===e)})}},b={type:"splitbutton",tooltip:"Spellcheck",menu:v,onclick:m.toggleLanguage,onPostRender:function(n){var e=function(){n.control.active(Bi.isOn(p.spelling().get()))};e(),d.on(xf,e)},onshow:y},x={text:"Spellcheck...",context:"tools",onclick:function(){d.execCommand("mceSpellcheckDocument")}},h?(d.addButton("spellchecker",b),d.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:m.toggleLanguage,onPostRender:function(n){var e=function(){return n.control.active(Bi.isOn(p.spelling().get()))};e(),d.on(xf,e)},selectable:!0}),d.addButton("spellcheckdialog",w),d.addMenuItem("spellcheckdialog",x)):(d.addButton("spellchecker",w),d.addMenuItem("spellchecker",x)),d.addMenuItem("spellcheckerlanguage",{text:"Spellcheck Language",context:"tools",menu:v,onPostRender:function(n){n.control.on("show",function(n){y(n)})}}),kf(n,l,O,T,E)):(df(n,l),mf(n,k,g,E,T),yf(n,l,O,T,E))})}(window);