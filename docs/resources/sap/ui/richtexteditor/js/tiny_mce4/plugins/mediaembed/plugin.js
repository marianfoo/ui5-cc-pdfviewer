/* Ephox Media Embed
 *
 * Copyright 2010-2017 Ephox Corporation. All rights reserved.
 *
 * Version: 2.2.5-101
 */

!function(f){"use strict";var n,e,r,t,o,i,u,c,a,s=function(n){return parseInt(n,10)},l=function(n,e,r){return{major:n,minor:e,patch:r}},d=function(n){var e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(n);return e?l(s(e[1]),s(e[2]),s(e[3])):l(0,0,0)},m=function(n,e){var r=n-e;return 0===r?0:0<r?1:-1},p=function(n,e){return!!n&&-1===function(n,e){var r=m(n.major,e.major);if(0!==r)return r;var t=m(n.minor,e.minor);if(0!==t)return t;var o=m(n.patch,e.patch);return 0!==o?o:0}(d([(r=n).majorVersion,r.minorVersion].join(".").split(".").slice(0,3).join(".")),d(e));var r},h=function(){},y=function(n){return function(){return n}},v=function(n){return n},g=y(!1),w=y(!0),b=function(){return T},T=(n=function(n){return n.isNone()},t={fold:function(n,e){return n()},is:g,isSome:g,isNone:w,getOr:r=function(n){return n},getOrThunk:e=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:y(null),getOrUndefined:y(void 0),or:r,orThunk:e,map:b,each:h,bind:b,exists:g,forall:w,filter:b,equals:n,equals_:n,toArray:function(){return[]},toString:y("none()")},Object.freeze&&Object.freeze(t),t),x=function(r){var n=y(r),e=function(){return o},t=function(n){return n(r)},o={fold:function(n,e){return e(r)},is:function(n){return r===n},isSome:w,isNone:g,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return x(n(r))},each:function(n){n(r)},bind:t,exists:t,forall:t,filter:function(n){return n(r)?o:T},toArray:function(){return[r]},toString:function(){return"some("+r+")"},equals:function(n){return n.is(r)},equals_:function(n,e){return n.fold(g,function(n){return e(r,n)})}};return o},S={some:x,none:b,from:function(n){return null==n?T:x(n)}},E=function(e){return function(n){return function(n){if(null===n)return"null";var e=typeof n;return"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(n)===e}},O=E("string"),_=E("object"),N=E("array"),D=E("boolean"),C=E("function"),A=E("number"),k=Array.prototype.slice,R=Array.prototype.indexOf,I=Array.prototype.push,j=function(n,e){return r=n,t=e,-1<R.call(r,t);var r,t},F=function(n,e){for(var r=n.length,t=new Array(r),o=0;o<r;o++){var i=n[o];t[o]=e(i,o)}return t},P=function(n,e){for(var r=0,t=n.length;r<t;r++){e(n[r],r)}},M=function(n,e){for(var r=[],t=0,o=n.length;t<o;t++){var i=n[t];e(i,t)&&r.push(i)}return r},L=function(n,e){for(var r=0,t=n.length;r<t;r++){var o=n[r];if(e(o,r))return S.some(o)}return S.none()},U=function(n){for(var e=[],r=0,t=n.length;r<t;++r){if(!N(n[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+n);I.apply(e,n[r])}return e},B=function(n,e){var r=F(n,e);return U(r)},V=C(Array.from)?Array.from:function(n){return k.call(n)},q=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(e.length!==r.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+r.length+" arguments");var t={};return P(e,function(n,e){t[n]=y(r[e])}),t}},W=Object.keys,H=Object.hasOwnProperty,J=function(n,e){for(var r=W(n),t=0,o=r.length;t<o;t++){var i=r[t];e(n[i],i)}},K=function(n,t){var o={};return J(n,function(n,e){var r=t(n,e);o[r.k]=r.v}),o},z=function(n,e){return $(n,e)?S.from(n[e]):S.none()},$=function(n,e){return H.call(n,e)},X=function(n,e,r){return 0!=(n.compareDocumentPosition(e)&r)},Y=function(n,e){return X(n,e,f.Node.DOCUMENT_POSITION_CONTAINED_BY)},G=function(){return(G=Object.assign||function(n){for(var e,r=1,t=arguments.length;r<t;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)},Q=function(n){var e=n,r=function(){return e};return{get:r,set:function(n){e=n},clone:function(){return Q(r())}}},Z=function(){return nn(0,0)},nn=function(n,e){return{major:n,minor:e}},en={nu:nn,detect:function(n,e){var r=String(e).toLowerCase();return 0===n.length?Z():function(n,e){var r=function(n,e){for(var r=0;r<n.length;r++){var t=n[r];if(t.test(e))return t}}(n,e);if(!r)return{major:0,minor:0};var t=function(n){return Number(e.replace(r,"$"+n))};return nn(t(1),t(2))}(n,r)},unknown:Z},rn="Firefox",tn=function(n,e){return function(){return e===n}},on=function(n){var e=n.current;return{current:e,version:n.version,isEdge:tn("Edge",e),isChrome:tn("Chrome",e),isIE:tn("IE",e),isOpera:tn("Opera",e),isFirefox:tn(rn,e),isSafari:tn("Safari",e)}},un={unknown:function(){return on({current:void 0,version:en.unknown()})},nu:on,edge:y("Edge"),chrome:y("Chrome"),ie:y("IE"),opera:y("Opera"),firefox:y(rn),safari:y("Safari")},cn="Windows",an="Android",fn="Solaris",sn="FreeBSD",ln=function(n,e){return function(){return e===n}},dn=function(n){var e=n.current;return{current:e,version:n.version,isWindows:ln(cn,e),isiOS:ln("iOS",e),isAndroid:ln(an,e),isOSX:ln("OSX",e),isLinux:ln("Linux",e),isSolaris:ln(fn,e),isFreeBSD:ln(sn,e)}},mn={unknown:function(){return dn({current:void 0,version:en.unknown()})},nu:dn,windows:y(cn),ios:y("iOS"),android:y(an),linux:y("Linux"),osx:y("OSX"),solaris:y(fn),freebsd:y(sn)},pn=function(n,e){var r=String(e).toLowerCase();return L(n,function(n){return n.search(r)})},hn=function(n,r){return pn(n,r).map(function(n){var e=en.detect(n.versionRegexes,r);return{current:n.name,version:e}})},vn=function(n,r){return pn(n,r).map(function(n){var e=en.detect(n.versionRegexes,r);return{current:n.name,version:e}})},gn=function(n,e){return-1!==n.indexOf(e)},yn=function(n,e){return r=n,o=0,""===(t=e)||!(r.length<t.length)&&r.substr(o,o+t.length)===t;var r,t,o},wn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,bn=function(e){return function(n){return gn(n,e)}},Tn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return gn(n,"edge/")&&gn(n,"chrome")&&gn(n,"safari")&&gn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,wn],search:function(n){return gn(n,"chrome")&&!gn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return gn(n,"msie")||gn(n,"trident")}},{name:"Opera",versionRegexes:[wn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:bn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:bn("firefox")},{name:"Safari",versionRegexes:[wn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(gn(n,"safari")||gn(n,"mobile/"))&&gn(n,"applewebkit")}}],xn=[{name:"Windows",search:bn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return gn(n,"iphone")||gn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:bn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:bn("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:bn("linux"),versionRegexes:[]},{name:"Solaris",search:bn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:bn("freebsd"),versionRegexes:[]}],Sn={browsers:y(Tn),oses:y(xn)},En=Q(function(n,e){var r,t,o,i,u,c,a,f,s,l,d,m,p=Sn.browsers(),h=Sn.oses(),v=hn(p,n).fold(un.unknown,un.nu),g=vn(h,n).fold(mn.unknown,mn.nu);return{browser:v,os:g,deviceType:(t=v,o=n,i=e,u=(r=g).isiOS()&&!0===/ipad/i.test(o),c=r.isiOS()&&!u,a=r.isiOS()||r.isAndroid(),f=a||i("(pointer:coarse)"),s=u||!c&&a&&i("(min-device-width:768px)"),l=c||a&&!s,d=t.isSafari()&&r.isiOS()&&!1===/safari/i.test(o),m=!l&&!s&&!d,{isiPad:y(u),isiPhone:y(c),isTablet:y(s),isPhone:y(l),isTouch:y(f),isAndroid:r.isAndroid,isiOS:r.isiOS,isWebView:y(d),isDesktop:y(m)})}}(f.navigator.userAgent,function(n){return f.window.matchMedia(n).matches})),On=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:y(n)}},_n={fromHtml:function(n,e){var r=(e||f.document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||1<r.childNodes.length)throw f.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return On(r.childNodes[0])},fromTag:function(n,e){var r=(e||f.document).createElement(n);return On(r)},fromText:function(n,e){var r=(e||f.document).createTextNode(n);return On(r)},fromDom:On,fromPoint:function(n,e,r){var t=n.dom();return S.from(t.elementFromPoint(e,r)).map(On)}},Nn=(f.Node.ATTRIBUTE_NODE,f.Node.CDATA_SECTION_NODE,f.Node.COMMENT_NODE,f.Node.DOCUMENT_NODE),Dn=(f.Node.DOCUMENT_TYPE_NODE,f.Node.DOCUMENT_FRAGMENT_NODE,f.Node.ELEMENT_NODE),Cn=(f.Node.TEXT_NODE,f.Node.PROCESSING_INSTRUCTION_NODE,f.Node.ENTITY_REFERENCE_NODE,f.Node.ENTITY_NODE,f.Node.NOTATION_NODE,Dn),An=Nn,kn=function(n){return n.nodeType!==Cn&&n.nodeType!==An||0===n.childElementCount},Rn=(En.get().browser.isIE(),void 0!==f.window?f.window:Function("return this;")(),function(n){return n.dom().nodeName.toLowerCase()}),In=function(n,e){for(var r=[],t=function(n){return r.push(n),e(n)},o=e(n);(o=o.bind(t)).isSome(););return r},jn=function(n){return S.from(n.dom().parentNode).map(_n.fromDom)},Fn=function(n){return S.from(n.dom().previousSibling).map(_n.fromDom)},Pn=function(n){return S.from(n.dom().nextSibling).map(_n.fromDom)},Mn=function(n){return e=In(n,Fn),(r=k.call(e,0)).reverse(),r;var e,r},Ln=function(n){return F(n.dom().childNodes,_n.fromDom)},Un=function(n){return e=0,r=n.dom().childNodes,S.from(r[e]).map(_n.fromDom);var e,r},Bn=(q("element","offset"),function(n,e){return r=function(n){return function(n,e){var r=n.dom();if(r.nodeType!==Cn)return!1;var t=r;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}(n,e)},M(Ln(n),r);var r}),Vn=function(n,e){return r=e,o=void 0===(t=n)?f.document:t.dom(),kn(o)?[]:F(o.querySelectorAll(r),_n.fromDom);var r,t,o},qn=function(n){return n.dom().textContent},Wn={isBlock:(o=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"],function(n){return(i=i||function(n,e){for(var r={},t=0,o=n.length;t<o;t++){var i=n[t];r[String(i)]=e(i,t)}return r}(o,y(!0))).hasOwnProperty(Rn(n))})},Hn=function(e,r){return function(n){return e(n)||r(n)}},Jn=q("start","end","caret"),Kn=function(n){return"br"===Rn(n)},zn=function(e){return n=jn(e.start()),r=jn(e.end()),t=function(){var n=f.document.createRange();return n.setStartBefore(e.start().dom()),n.setEndAfter(e.end().dom()),n},n.isSome()&&r.isSome()?S.some(t(n.getOrDie(),r.getOrDie())):S.none();var n,r,t},$n=function(n,e){var r=e[e.length-1];return function(n,e){for(var r=0,t=n.length;r<t;r++)if(e(n[r],r))return S.some(r);return S.none()}(n,function(n){return e=r,n.dom()===e.dom();var e}).getOrDie("how is it possible you can't find a br you just found?")},Xn=function(n){return M(Bn(n,"br"),function(n){return Pn(n).isSome()})},Yn=function(n){return e=function(n,e){return n+qn(e)},r="",P(n,function(n){r=e(r,n)}),r;var e,r},Gn=Xn,Qn=$n,Zn=function(n){if(!1===n.collapsed)return S.none();var e,r,t,o,i,u,c,a=(r=(e=n).startContainer,t=e.startOffset,void 0===r?S.none():3===r.nodeType?0===t?S.some(r).map(_n.fromDom):S.none():S.from(r.childNodes[t]).map(_n.fromDom)),f=a.bind(Fn).filter(Kn),s=f.map(Mn).bind(function(n){return L(n.reverse(),Hn(Kn,Wn.isBlock)).fold(function(){return S.from(n[n.length-1])},Pn)});return i=f,u=a,c=Jn,(o=s).isSome()&&i.isSome()&&u.isSome()?S.some(c(o.getOrDie(),i.getOrDie(),u.getOrDie())):S.none()},ne=zn,ee=function(n){return zn(n).fold(y(""),function(n){return n.toString()})},re=Yn,te=function(n){var e=Xn(n);if(0<e.length){var r=Ln(n),t=$n(r,e),o=r.slice(t+1);return Yn(o)}return qn(n)},oe=function(n){return O(n.mediaembed_service_url)},ie=function(n){return A(n.mediaembed_max_width)?n.mediaembed_max_width:650},ue=function(n){var e=n.api_key;return e||n.mediaembed_api_key},ce=function(n,e){return O(n.mediaembed_content_css)?n.mediaembed_content_css:e},ae=function(n){return n.getParam("mediaembed_inline_styles",!1,"boolean")},fe=function(n,e,r){!function(n,e,r){if(!(O(r)||D(r)||A(r)))throw f.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")}(n.dom(),e,r)},se=function(n,t){Pn(n).fold(function(){jn(n).each(function(n){le(n,t)})},function(n){var e,r;r=t,jn(e=n).each(function(n){n.dom().insertBefore(r.dom(),e.dom())})})},le=function(n,e){n.dom().appendChild(e.dom())},de=function(n){var e=n.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},me=function(n){return e=n,r=!0,_n.fromDom(e.dom().cloneNode(r));var e,r},pe=function(n){return void 0!==n.style&&C(n.style.getPropertyValue)},he=function(n,e,r){if(!O(r))throw f.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);pe(n)&&n.style.setProperty(e,r)},ve=function(n,e,r){var t=n.dom();he(t,e,r)},ge=function(n,e){var r,t,o=n.dom(),i=(t=e,pe(r=o)?r.style.getPropertyValue(t):"");return S.from(i).filter(function(n){return 0<n.length})},ye=function(n){var e=_n.fromTag("div"),r=_n.fromDom(n.dom().cloneNode(!0));return le(e,r),e.dom().innerHTML},we=function(n){var e=n.dom().styleSheets;return Array.prototype.slice.call(e)},be=function(n){var e=n.cssRules;return B(e,function(n){return n.type===f.CSSRule.IMPORT_RULE?be(n.styleSheet):n.type===f.CSSRule.STYLE_RULE?[function(n){var e=n.selectorText,r=n.style.cssText;if(void 0===r)throw new Error("WARNING: Browser does not support cssText property");return{selector:e,style:r,raw:n.style}}(n)]:[]})},Te=function(n){return B(n,be)},xe={},Se={exports:xe};c=xe,a=Se,u=void 0,function(n){"object"==typeof c&&void 0!==a?a.exports=n():"function"==typeof u&&u.amd?u([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function i(u,c,a){function f(e,n){if(!c[e]){if(!u[e]){var r=!1;if(!n&&r)return r(e,!0);if(s)return s(e,!0);var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}var o=c[e]={exports:{}};u[e][0].call(o.exports,function(n){return f(u[e][1][n]||n)},o,o.exports,i,u,c,a)}return c[e].exports}for(var s=!1,n=0;n<a.length;n++)f(a[n]);return f}({1:[function(n,e,r){var t,u,o=(t=function(n){var e,r,t,o,i=[];for(t=0,o=(e=n.split(",")).length;t<o;t+=1)0<(r=e[t]).length&&i.push(u(r));return i},u=function(a){var n,e,r,f=a,s={a:0,b:0,c:0},l=[];return n=function(n,e){var r,t,o,i,u,c;if(n.test(f))for(t=0,o=(r=f.match(n)).length;t<o;t+=1)s[e]+=1,i=r[t],u=f.indexOf(i),c=i.length,l.push({selector:a.substr(u,c),type:e,index:u,length:c}),f=f.replace(i,Array(c+1).join(" "))},(e=function(n){var e,r,t,o;if(n.test(f))for(r=0,t=(e=f.match(n)).length;r<t;r+=1)o=e[r],f=f.replace(o,Array(o.length+1).join("A"))})(/\\[0-9A-Fa-f]{6}\s?/g),e(/\\[0-9A-Fa-f]{1,5}\s/g),e(/\\./g),(r=/:not\(([^\)]*)\)/g).test(f)&&(f=f.replace(r,"     $1 ")),function(){var n,e,r,t,o=/{[^]*/gm;if(o.test(f))for(e=0,r=(n=f.match(o)).length;e<r;e+=1)t=n[e],f=f.replace(t,Array(t.length+1).join(" "))}(),n(/(\[[^\]]+\])/g,"b"),n(/(#[^\#\s\+>~\.\[:]+)/g,"a"),n(/(\.[^\s\+>~\.\[:]+)/g,"b"),n(/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,"c"),n(/(:[\w-]+\([^\)]*\))/gi,"b"),n(/(:[^\s\+>~\.\[:]+)/g,"b"),f=(f=f.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),n(/([^\s\+>~\.\[:]+)/g,"c"),l.sort(function(n,e){return n.index-e.index}),{selector:a,specificity:"0,"+s.a.toString()+","+s.b.toString()+","+s.c.toString(),specificityArray:[0,s.a,s.b,s.c],parts:l}},{calculate:t,compare:function(n,e){var r,t,o;if("string"==typeof n){if(-1!==n.indexOf(","))throw"Invalid CSS selector";r=u(n).specificityArray}else{if(!Array.isArray(n))throw"Invalid CSS selector or specificity array";if(4!==n.filter(function(n){return"number"==typeof n}).length)throw"Invalid specificity array";r=n}if("string"==typeof e){if(-1!==e.indexOf(","))throw"Invalid CSS selector";t=u(e).specificityArray}else{if(!Array.isArray(e))throw"Invalid CSS selector or specificity array";if(4!==e.filter(function(n){return"number"==typeof n}).length)throw"Invalid specificity array";t=e}for(o=0;o<4;o+=1){if(r[o]<t[o])return-1;if(r[o]>t[o])return 1}return 0}});void 0!==r&&(r.calculate=o.calculate,r.compare=o.compare)},{}],2:[function(n,e,r){var t=n("specificity");e.exports={boltExport:t}},{specificity:1}]},{},[2])(2)});var Ee,Oe,_e=Se.exports.boltExport,Ne=function(e,n,r){var t=B(n,function(c){var n=Vn(e,c.selector);return P(n,function(n){var r,t,o,e,i,u=(r=c.raw,t=n,o={},P(r,function(n){if(void 0!==r[n]){var e=t.dom().style;j(e,n)||(o[n]=r[n])}}),o);e=u,i=n.dom(),J(e,function(n,e){he(i,e,n)})}),n});r&&P(t,function(n){var e;e="class",n.dom().removeAttribute(e)})},De=function(n,e,r){var t=function(n){return-1!==n.selector.indexOf(",")},o=B(M(n,t),function(e){var n=e.selector.split(",");return F(n,function(n){return{selector:n.trim(),raw:e.raw}})}),i=M(n,function(n){return!t(n)}).concat(o);i.sort(function(n,e){return _e.compare(n.selector,e.selector)}).reverse(),Ne(e,i,r)},Ce=function(n,e,r,t){var o=we(n),i=Te(o).map(function(n){var e=n.selector;return{selector:r.hasOwnProperty(e)?r[e]:e,raw:n.raw}});De(i,e,t)},Ae=function(n,e,r,t){var o=we(n),i=Te(o),u=M(i,function(n){return yn(n.selector,r)});De(u,e,t)},ke=function(n,e,r,t){var o=we(n),i=Te(o),u=M(i,function(n){return j(r,n.selector)});De(u,e,t)},Re={inlineStyles:function(n,e,r){Ce(n,e,r,!0)},inlineStylesKeepClasses:function(n,e,r){Ce(n,e,r,!1)},inlinePrefixedStyles:function(n,e,r){Ae(n,e,r,!0)},inlinePrefixedStylesKeepClasses:function(n,e,r){Ae(n,e,r,!1)},inlineSelectorsStyles:function(n,e,r){ke(n,e,r,!0)},inlineSelectorsStylesKeepClasses:function(n,e,r){ke(n,e,r,!1)}},Ie={inlineStyles:Re.inlineStyles,inlineStylesKeepClasses:Re.inlineStylesKeepClasses,inlinePrefixedStyles:Re.inlinePrefixedStyles,inlinePrefixedStylesKeepClasses:Re.inlinePrefixedStylesKeepClasses,inlineSelectorsStyles:Re.inlineSelectorsStyles,inlineSelectorsStylesKeepClasses:Re.inlineSelectorsStylesKeepClasses},je=function(n){return 1===n.dom().nodeType?n:Pn(n).fold(function(){return n},je)},Fe=function(n,e){var r=n.parser.parse(e,{isRootContent:!0,forced_root_block:!1}),t=new tinymce.html.Serializer({validate:!0},n.schema).serialize(r),o=_n.fromDom(n.dom.createFragment(t));return Le(n,o)},Pe=function(n,e){return Rn(e).toLowerCase()===n.toLowerCase()},Me=function(n,e){var r=n.dom.createFragment(e);return je(_n.fromDom(r.firstChild))},Le=function(n,e){if(ae(n)){var r=_n.fromTag("div");le(r,e);var t=n.getDoc(),o=_n.fromDom(t);Ie.inlinePrefixedStyles(o,r,".ephox-summary-card");var i=Vn(r,"*[style]");return P(i,function(n){var e,r,t=(e="style",null===(r=n.dom().getAttribute(e))?void 0:r);fe(n,"data-mce-style",t)}),u=Ln(r),a=(c||f.document).createDocumentFragment(),P(u,function(n){a.appendChild(n.dom())}),_n.fromDom(a)}return e;var u,c,a},Ue=function(n,e,r){var t=Fe(n,ye(r));n.undoManager.transact(function(){var n;(n=e).dom().textContent="",P(Ln(n),function(n){de(n)}),le(e,t)})},Be=function(n,e,r){var t=me(r);return ge(t,"max-width").isNone()&&ve(t,"max-width",e+"px"),fe(t,"data-ephox-embed-iri",n),fe(t,"contentEditable",!1),t},Ve=function(n,e,r){return Pe("DIV",e)?Be(n,r,e):Be(n,r,((Pe("VIDEO",i=e)||Pe("AUDIO",i))&&ve(i,"width","100%"),t=i,o=_n.fromTag("div"),le(o,me(t)),o));var t,o,i},qe=function(n,e,r){return Pe("A",e)?e:Ve(n,e,r)},We=function(n,e,r,t,o){var i,u,c,a,f,s,l,d,m=Ln(e),p=Qn(m,r),h=m.slice(p),v=m.slice(p+1);if(re(v)===t){var g=qe(t,Me(n,o),ie(n.settings));Pe("DIV",g)?(s=e,l=h,d=Fe(f=n,ye(g)),Un(d).each(function(n){f.undoManager.transact(function(){se(s,n),P(l,de)})})):(u=e,c=v,a=Fe(i=n,ye(g)),i.undoManager.transact(function(){P(c,de),le(u,a)}))}},He=function(n,e,r,t){var o,i,u,c=qe(r,Me(n,t),ie(n.settings));Pe("DIV",c)?(i=e,u=Fe(o=n,ye(c)),Un(u).each(function(n){o.undoManager.transact(function(){se(i,n),de(i)})})):Ue(n,e,c)},Je=function(r,n,t,o){n.filter(function(n){return jn(n).isSome()}).each(function(n){var e=Gn(n);0<e.length?We(r,n,e,t,o):He(r,n,t,o)})},Ke=function(n,e,r){var t=Me(n,r);return ye(qe(e,t,ie(n.settings)))},ze=function(u,n,e,r){n.map(function(i){ne(i).each(function(t){var n=qe(e,Me(u,r),ie(u.settings)),o=Fe(u,ye(n));u.undoManager.transact(function(){var n,e,r;t.deleteContents(),t.insertNode(o.dom()),t.collapse(!1),n=u,e=i.caret().dom(),r=n.dom.createRng(),3===e.nodeType?(r.setStart(e,0),r.setEnd(e,0)):(r.setStartBefore(e),r.setEndAfter(e)),n.selection.setRng(r)})})})},$e=function(n){var e,r,t=(e=n.split(" "),r={},P(e,function(n){r[n.toLowerCase()]=!0}),r);return function(n){return!!n&&n.nodeName.toLowerCase()in t}},Xe=$e("h1 h2 h3 h4 h5 h6 p span"),Ye=$e("strong em b span a br"),Ge=function(n){return L((e=n,e?V(e.querySelectorAll("*")):[]),(r=Ye,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!r.apply(null,n)})).isNone();var r,e},Qe=function(n){return Xe(n.dom())&&Ge(n.dom())},Ze=function(n){return/^https?:\/\/\S+$/i.test(n.trim())},nr=function(n){return S.from(n).filter(Qe).map(te).filter(Ze)},er=function(c,a,f){c.on("newBlock",function(n){var e,t,o,i,u;e=n,t=c,o=a,i=f,(u=Fn(_n.fromDom(e.newBlock))).bind(nr).map(function(r){o.getAndHandleResponse(r,function(n){var e=n.recommended().html();Je(t,u,r,e)},i.logError)})}),c.settings.forced_root_block||c.on("keydown",function(n){var t,e,o,r,i;13===n.keyCode&&(e=a,o=f,r=(t=c).selection.getRng(),(i=Zn(r)).map(ee).filter(Ze).map(function(r){e.getAndHandleResponse(r,function(n){var e=n.recommended().html();ze(t,i,r,e)},o.logError)}))})},rr=function(n){P(n,function(n){var e;(e=new tinymce.html.Node("span",1)).attr("class","mce-shim"),e.attr("data-mce-bogus","1"),n.append(e),n.attr("contenteditable","false")})},tr=function(n){P(n,function(n){n.attr("contenteditable",null)})},or=function(e){e.on("click keyup touchend",function(){var n=e.selection.getNode();n&&e.dom.getAttrib(n,"data-ephox-embed-iri")&&e.dom.getAttrib(n,"data-mce-selected")&&n.setAttribute("data-mce-selected","2")}),tinymce.Env.ceFalse&&e.on("PreInit",function(){e.parser.addAttributeFilter("data-ephox-embed-iri",rr),e.serializer.addAttributeFilter("data-ephox-embed-iri",tr)})},ir=function(n,e,r){var o,i,u;"media_url_resolver"in n.settings==0&&(n.settings.media_url_resolver=(o=n,i=e,u=r,function(r,t,e){!1!==Ze(r.url)?i.getAndHandleResponse(r.url,function(n){var e=n.recommended().html();t({html:Ke(o,r.url,e)})},function(n){u.logDialogError(n),e({msg:u.formatMessage(n.msg(),n.code())})}):t({html:""})}))},ur=function(t,o){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=t.console;r&&o in r&&r[o].apply(r,arguments)}},cr={log:ur(window,"log"),error:ur(window,"error"),warn:ur(window,"warm")},ar=[{code:404,message:"The specified url was not found."},{code:600,message:"The specified service did not respond correctly."},{code:601,message:"The specified service did not respond correctly."}],fr=function(n,e){return L(ar,function(n){return n.code===e}).fold(function(){return"Server didn't produce a valid result. ("+e+")"},function(n){return n.message})},sr=function(t){var r,o=function(n){var e,r=function(n){if("string"==typeof n)return{message:n};var e=n.code();return{message:fr(n.msg(),e),code:e}}(n);e=r,t.fire("MediaEmbedError",e),cr.error("Media embed error: "+r.message)};return{formatMessage:fr,logDialogError:function(n){var e=n.msg();e!==r&&o(n),r=e},logError:o}},lr=function(r){return{is:function(n){return r===n},isValue:w,isError:g,getOr:y(r),getOrThunk:y(r),getOrDie:y(r),or:function(n){return lr(r)},orThunk:function(n){return lr(r)},fold:function(n,e){return e(r)},map:function(n){return lr(n(r))},mapError:function(n){return lr(r)},each:function(n){n(r)},bind:function(n){return n(r)},exists:function(n){return n(r)},forall:function(n){return n(r)},toOption:function(){return S.some(r)}}},dr=function(r){return{is:g,isValue:g,isError:w,getOr:v,getOrThunk:function(n){return n()},getOrDie:function(){return n=String(r),function(){throw new Error(n)}();var n},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(r)},map:function(n){return dr(r)},mapError:function(n){return dr(n(r))},each:h,bind:function(n){return dr(r)},exists:g,forall:w,toOption:S.none}},mr={value:lr,error:dr,fromOption:function(n,e){return n.fold(function(){return dr(e)},lr)}};(Oe=Ee||(Ee={}))[Oe.Error=0]="Error",Oe[Oe.Value=1]="Value";var pr,hr,vr,gr=function(n,e,r){return n.stype===Ee.Error?e(n.serror):r(n.svalue)},yr=function(n){return{stype:Ee.Value,svalue:n}},wr=function(n){return{stype:Ee.Error,serror:n}},br=function(n){return gr(n,mr.error,mr.value)},Tr=yr,xr=function(n){var e=[],r=[];return P(n,function(n){gr(n,function(n){return r.push(n)},function(n){return e.push(n)})}),{values:e,errors:r}},Sr=wr,Er=function(n,e){return n.stype===Ee.Value?e(n.svalue):n},Or=function(n,e){return n.stype===Ee.Error?e(n.serror):n},_r=function(n,e){return n.stype===Ee.Value?{stype:Ee.Value,svalue:e(n.svalue)}:n},Nr=function(n,e){return n.stype===Ee.Error?{stype:Ee.Error,serror:e(n.serror)}:n},Dr=function(n,e){return $(r=n,t=e)?S.from(r[t]):S.none();var r,t},Cr=function(n,e){var r={};return r[n]=e,r},Ar=function(u){if(!N(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var c=[],r={};return P(u,function(n,t){var e=W(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],i=n[o];if(void 0!==r[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!N(i))throw new Error("case arguments must be an array");c.push(o),r[o]=function(){var n=arguments.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+i.length+" ("+i+"), got "+n);for(var r=new Array(n),e=0;e<r.length;e++)r[e]=arguments[e];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[t].apply(null,r)},match:function(n){var e=W(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!function(n,e){for(var r=0,t=n.length;r<t;++r)if(!0!==e(n[r],r))return!1;return!0}(c,function(n){return j(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,r)},log:function(n){f.console.log(n,{constructors:c,constructor:o,params:r})}}}}),r},kr=(Ar([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),Object.prototype.hasOwnProperty),Rr=function(u){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var r={},t=0;t<n.length;t++){var o=n[t];for(var i in o)kr.call(o,i)&&(r[i]=u(r[i],o[i]))}return r}},Ir=Rr(function(n,e){return _(n)&&_(e)?Ir(n,e):e}),jr=Rr(function(n,e){return e}),Fr=Ar([{setOf:["validator","valueType"]},{arrOf:["valueType"]},{objOf:["fields"]},{itemOf:["validator"]},{choiceOf:["key","branches"]},{thunk:["description"]},{func:["args","outputSchema"]}]),Pr=Ar([{field:["name","presence","type"]},{state:["name"]}]),Mr=function(n){return _(n)&&100<W(n).length?" removed due to size":JSON.stringify(n,null,2)},Lr=function(n,e){return Sr([{path:n,getErrorInfo:e}])},Ur=Ar([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Br=Ur.strict,Vr=function(n){return r=Sr,t=U,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r(t.apply(null,n))}(n);var r,t},qr=function(n,e){var r,t,o=xr(n);return 0<o.errors.length?Vr(o.errors):(r=o.values,t=e,0<r.length?Tr(Ir(t,jr.apply(void 0,r))):Tr(t))},Wr=Ar([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Hr=function(r,t,o){return Dr(t,o).fold(function(){return n=o,e=t,Lr(r,function(){return'Could not find valid *strict* value for "'+n+'" in '+Mr(e)});var n,e},Tr)},Jr=function(n,e,r){var t=Dr(n,e).fold(function(){return r(n)},v);return Tr(t)},Kr=function(c,a,n,f){return n.fold(function(o,r,n,t){var i=function(n){var e=t.extract(c.concat([o]),f,n);return _r(e,function(n){return Cr(r,f(n))})},u=function(n){return n.fold(function(){var n=Cr(r,f(S.none()));return Tr(n)},function(n){var e=t.extract(c.concat([o]),f,n);return _r(e,function(n){return Cr(r,f(S.some(n)))})})};return n.fold(function(){return Er(Hr(c,a,o),i)},function(n){return Er(Jr(a,o,n),i)},function(){return Er(Tr(Dr(a,o)),u)},function(n){return Er((r=n,t=Dr(e=a,o).map(function(n){return!0===n?r(e):n}),Tr(t)),u);var e,r,t},function(n){var e=n(a),r=_r(Jr(a,o,y({})),function(n){return Ir(e,n)});return Er(r,i)})},function(n,e){var r=e(a);return Tr(Cr(n,f(r)))})},zr=function(t){return{extract:function(r,n,e){return Or(t(e,n),function(n){return e=n,Lr(r,function(){return e});var e})},toString:function(){return"val"},toDsl:function(){return Fr.itemOf(t)}}},$r=function(c){return{extract:function(n,e,r){return t=n,o=r,i=e,u=F(c,function(n){return Kr(t,o,n,i)}),qr(u,{});var t,o,i,u},toString:function(){return"obj{\n"+F(c,function(n){return n.fold(function(n,e,r,t){return n+" -> "+t.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"},toDsl:function(){return Fr.objOf(F(c,function(n){return n.fold(function(n,e,r,t){return Pr.field(n,r,t)},function(n,e){return Pr.state(n)})}))}}},Xr=y(zr(Tr)),Yr=Wr.field,Gr=function(n,e,r,t){var o=e.extract([n],r,t);return Nr(o,function(n){return{input:t,errors:n}})},Qr=function(n,e,r){return br(Gr(n,e,y,r))},Zr=function(n,e,r){return br(Gr(n,e,v,r)).fold(function(n){throw new Error(nt(n))},v)},nt=function(n){return"Errors: \n"+(e=n.errors,r=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e,F(r,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))+"\n\nInput object: "+Mr(n.input);var e,r},et={},rt={exports:et};hr=et,vr=rt,pr=void 0,function(n){"object"==typeof hr&&void 0!==vr?vr.exports=n():"function"==typeof pr&&pr.amd?pr([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function i(u,c,a){function f(e,n){if(!c[e]){if(!u[e]){var r=!1;if(!n&&r)return r(e,!0);if(s)return s(e,!0);var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}var o=c[e]={exports:{}};u[e][0].call(o.exports,function(n){return f(u[e][1][n]||n)},o,o.exports,i,u,c,a)}return c[e].exports}for(var s=!1,n=0;n<a.length;n++)f(a[n]);return f}({1:[function(n,e,r){var t,o,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===u||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:u}catch(n){t=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var f,s=[],l=!1,d=-1;function m(){l&&f&&(l=!1,f.length?s=f.concat(s):d=-1,s.length&&p())}function p(){if(!l){var n=a(m);l=!0;for(var e=s.length;e;){for(f=s,s=[];++d<e;)f&&f[d].run();d=-1,e=s.length}f=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(n){try{return o.call(null,e)}catch(n){return o.call(this,e)}}}(n)}}function h(n,e){this.fun=n,this.array=e}function v(){}i.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];s.push(new h(n,e)),1!==s.length||l||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,l,e){(function(r){!function(n){var e=setTimeout;function t(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(n,this)}function o(r,t){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,i._immediateFn(function(){var n=1===r._state?t.onFulfilled:t.onRejected;if(null!==n){var e;try{e=n(r._value)}catch(n){return void c(t.promise,n)}u(t.promise,e)}else(1===r._state?u:c)(t.promise,r._value)})):r._deferreds.push(t)}function u(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var r=n.then;if(n instanceof i)return e._state=3,e._value=n,void a(e);if("function"==typeof r)return void s((t=r,o=n,function(){t.apply(o,arguments)}),e)}e._state=1,e._value=n,a(e)}catch(n){c(e,n)}var t,o}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&i._immediateFn(function(){n._handled||i._unhandledRejectionFn(n._value)});for(var e=0,r=n._deferreds.length;e<r;e++)o(n,n._deferreds[e]);n._deferreds=null}function f(n,e,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=r}function s(n,e){var r=!1;try{n(function(n){r||(r=!0,u(e,n))},function(n){r||(r=!0,c(e,n))})}catch(n){if(r)return;r=!0,c(e,n)}}i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,e){var r=new this.constructor(t);return o(this,new f(n,e,r)),r},i.all=function(n){var c=Array.prototype.slice.call(n);return new i(function(t,o){if(0===c.length)return t([]);var i=c.length;function u(e,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var r=n.then;if("function"==typeof r)return void r.call(n,function(n){u(e,n)},o)}c[e]=n,0==--i&&t(c)}catch(n){o(n)}}for(var n=0;n<c.length;n++)u(n,c[n])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(n){n(e)})},i.reject=function(r){return new i(function(n,e){e(r)})},i.race=function(o){return new i(function(n,e){for(var r=0,t=o.length;r<t;r++)o[r].then(n,e)})},i._immediateFn="function"==typeof r?function(n){r(n)}:function(n){e(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==l&&l.exports?l.exports=i:n.Promise||(n.Promise=i)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,f){(function(n,e){var t=a("process/browser.js").nextTick,r=Function.prototype.apply,o=Array.prototype.slice,i={},u=0;function c(n,e){this._id=n,this._clearFn=e}f.setTimeout=function(){return new c(r.call(setTimeout,window,arguments),clearTimeout)},f.setInterval=function(){return new c(r.call(setInterval,window,arguments),clearInterval)},f.clearTimeout=f.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},f.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},f.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},f._unrefActive=f.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},f.setImmediate="function"==typeof n?n:function(n){var e=u++,r=!(arguments.length<2)&&o.call(arguments,1);return i[e]=!0,t(function(){i[e]&&(r?n.apply(null,r):n.call(null),f.clearImmediate(e))}),e},f.clearImmediate="function"==typeof e?e:function(n){delete i[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,r){var t=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:o.Promise||t}},{"promise-polyfill":2}]},{},[4])(4)});var tt,ot,it=rt.exports.boltExport,ut=function(n){var r=S.none(),e=[],t=function(n){o()?u(n):e.push(n)},o=function(){return r.isSome()},i=function(n){P(n,u)},u=function(e){r.each(function(n){f.setTimeout(function(){e(n)},0)})};return n(function(n){r=S.some(n),i(e),e=[]}),{get:t,map:function(r){return ut(function(e){t(function(n){e(r(n))})})},isReady:o}},ct={nu:ut,pure:function(e){return ut(function(n){n(e)})}},at=function(n){f.setTimeout(function(){throw n},0)},ft=function(r){var n=function(n){r().then(n,at)};return{map:function(n){return ft(function(){return r().then(n)})},bind:function(e){return ft(function(){return r().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return ft(function(){return r().then(function(){return n.toPromise()})})},toLazy:function(){return ct.nu(n)},toCached:function(){var n=null;return ft(function(){return null===n&&(n=r()),n})},toPromise:r,get:n}},st=function(n){return ft(function(){return new it(n)})},lt=function(n){return ft(function(){return it.resolve(n)})},dt=function(i){return G(G({},i),{toCached:function(){return dt(i.toCached())},bindFuture:function(e){return dt(i.bind(function(n){return n.fold(function(n){return lt(mr.error(n))},function(n){return e(n)})}))},bindResult:function(e){return dt(i.map(function(n){return n.bind(e)}))},mapResult:function(e){return dt(i.map(function(n){return n.map(e)}))},mapError:function(e){return dt(i.map(function(n){return n.mapError(e)}))},foldResult:function(e,r){return i.map(function(n){return n.fold(e,r)})},withTimeout:function(n,o){return dt(st(function(e){var r=!1,t=f.setTimeout(function(){r=!0,e(mr.error(o()))},n);i.get(function(n){r||(f.clearTimeout(t),e(n))})}))}})},mt=function(n){return dt(st(n))},pt=function(n){return dt(lt(mr.value(n)))},ht={nu:mt,wrap:dt,pure:pt,value:pt,error:function(n){return dt(lt(mr.error(n)))},fromResult:function(n){return dt(lt(n))},fromFuture:function(n){return dt(n.map(mr.value))},fromPromise:function(n){return mt(function(e){n.then(function(n){e(mr.value(n))},function(n){e(mr.error(n))})})}},vt=function(){return(new Date).getTime()};(ot=tt||(tt={})).JSON="json",ot.Blob="blob",ot.Text="text",ot.FormData="formdata",ot.MultipartFormData="multipart/form-data";var gt,yt,wt,bt,Tt,xt,St=function(n){try{var e=JSON.parse(n);return mr.value(e)}catch(n){return mr.error("Response was not JSON.")}},Et=function(e){return st(function(r){var n=new f.FileReader;n.onload=function(n){var e=n.target?n.target.result:new f.Blob([]);r(e)},n.readAsText(e)})},Ot=function(n){return lt(n.response)},_t=function(n,e){switch(n){case tt.JSON:return St(e.response).fold(function(){return Ot(e)},lt);case tt.Blob:return r=e,S.from(r.response).map(Et).getOr(lt("no response content"));case tt.Text:default:return Ot(e)}var r},Nt=function(i,n){return n.map(function(n){var r,t,e=(r=function(n,e){return encodeURIComponent(e)+"="+encodeURIComponent(n)},t=[],J(n,function(n,e){t.push(r(n,e))}),t),o=gn(i,"?")?"&":"?";return 0<e.length?i+o+e.join("&"):i}).getOr(i)},Dt=function(n){var e,r=(e=n.body,S.from(e).bind(function(n){switch(n.type){case tt.JSON:return S.some("application/json");case tt.FormData:return S.some("application/x-www-form-urlencoded; charset=UTF-8");case tt.MultipartFormData:return S.none();case tt.Text:default:return S.some("text/plain")}})),t=!0===n.credentials?S.some(!0):S.none(),o=function(n){switch(n){case tt.Blob:return"application/octet-stream";case tt.JSON:return"application/json, text/javascript";case tt.Text:return"text/plain";default:return""}}(n.responseType)+", */*; q=0.01",i=void 0!==n.headers?n.headers:{};return{contentType:r,responseType:function(n){switch(n){case tt.JSON:return S.none();case tt.Blob:return S.some("blob");case tt.Text:return S.some("text");default:return S.none()}}(n.responseType),credentials:t,accept:o,headers:i,progress:C(n.progress)?S.some(n.progress):S.none()}},Ct=function(n){var r=new f.FormData;return J(n,function(n,e){r.append(e,n)}),r},At=function(c){return ht.nu(function(t){var o=new f.XMLHttpRequest;o.open(c.method,Nt(c.url,S.from(c.query)),!0);var r,n,e=Dt(c);r=o,(n=e).contentType.each(function(n){return r.setRequestHeader("Content-Type",n)}),r.setRequestHeader("Accept",n.accept),n.credentials.each(function(n){return r.withCredentials=n}),n.responseType.each(function(n){return r.responseType=n}),n.progress.each(function(e){return r.upload.addEventListener("progress",function(n){return e(n.loaded,n.total)})}),J(n.headers,function(n,e){return r.setRequestHeader(e,n)});var i,u=function(){var e,n,r;(e=c.url,n=c.responseType,r=o,_t(n,r).map(function(n){return{message:0===r.status?"Unknown HTTP error (possible cross-domain request)":"Could not load url "+e+": "+r.statusText,status:r.status,responseText:n}})).get(function(n){return t(mr.error(n))})};o.onerror=u,o.onload=function(){0!==o.status||yn(c.url,"file:")?o.status<100||400<=o.status?u():function(n,e){var r=function(){return ht.pure(e.response)},t=function(n){return ht.error({message:n,status:e.status,responseText:e.responseText})};switch(n){case tt.JSON:return St(e.response).fold(t,ht.pure);case tt.Blob:case tt.Text:return r();default:return t("unknown data type")}}(c.responseType,o).get(t):u()},(i=c.body,S.from(i).map(function(n){return n.type===tt.JSON?JSON.stringify(n.data):n.type===tt.FormData?Ct(n.data):n.type===tt.MultipartFormData?Ct(n.data):n})).fold(function(){return o.send()},function(n){o.send(n)})})},kt=function(){return n="",{type:tt.Text,data:n};var n},Rt=function(n){return n.fold(function(n){var e=n.responseText,r=_(e)?e:n.message;return mr.error(r)},mr.value)},It=function(s,l){var n,d=z(n=l,"tiny-api-key").orThunk(function(){return z(n,"tinymce-api-key")}).orThunk(function(){return z(n,"textbox-api-key")}).getOrUndefined();return{execute:function(n){var r,e,t,o,i,u,c=(r=function(n){return D(n)?String(n):n},K(n,function(n,e){return{k:e,v:r(n,e)}})),a=(i=c,e=s.replace(/\$\{([^{}]*)\}/g,function(n,e){var r,t=i[e];return"string"==(r=typeof t)||"number"===r?t.toString():n}),t=d,o=-1===e.indexOf("?")?"?":"&",t?e+o+"apiKey="+encodeURIComponent(t):e),f=(u={url:a,responseType:tt.JSON,credentials:!0,headers:l},At(G(G({},u),{method:"get",body:kt()}))).map(Rt);return ht.wrap(f)}}},jt=function(n){return Yr(n,n,Br(),Xr())},Ft="iframely",Pt="oembed",Mt="fallback",Lt="wikipedia",Ut=function(n){return"["+n.join(", ")+"]"},Bt=[Ft,Pt,Mt],Vt=function(e,n,r){return function(n,e){for(var r=0,t=n.length;r<t;r++)if(e(n[r],r))return!0;return!1}(n,function(n){return j(e,n)})?mr.error("Embed response source: "+Ut(e)+" contains more than one of "+Ut(Bt)):mr.value(r)},qt=$r([jt("url"),jt("maxWidth"),(gt="fresh",yt=!1,Yr(gt,gt,(wt=yt,Ur.defaultedThunk(y(wt))),Xr()))]),Wt=$r([jt("status_code"),jt("sub_code"),jt("msg")]),Ht=$r([jt("html"),(bt="rels",Tt=[Yr("source","source",Br(),(xt=function(n){return N(n)?j(e=n,Ft)?Vt(e,[Pt,Mt,Lt],Ft):j(e,Pt)?Vt(e,[Ft,Mt,Lt],Pt):j(e,Mt)?Vt(e,[Ft,Pt,Lt],Mt):j(e,Lt)?Vt(e,[Ft,Pt,Mt],Lt):mr.error("Embed response source: "+Ut(e)+" did not contain any of: "+Ut(Bt)):mr.error("Sources was not an array: "+n);var e},zr(function(n){return xt(n).fold(Sr,Tr)})))],Yr(bt,bt,Br(),$r(Tt)))]),Jt=function(n){return Qr("EmbedResponse.failure",Wt,n).fold(function(n){return mr.error({code:function(){return 600},subcode:function(){return 0},msg:function(){return nt(n)}})},function(n){return mr.error({code:n.status_code,subcode:n.sub_code,msg:n.msg})})},Kt=function(n){return Qr("EmbedResponse.success",Ht,n).fold(function(n){return mr.error({code:function(){return 601},subcode:function(){return 0},msg:function(){return nt(n)}})},function(n){return mr.value({recommended:function(){return{html:n.html,source:n.rels().source}}})})},zt=function(n,e,r){var s=function(n,r){void 0===r&&(r=36e5);var e,t,o={},i=function(n,e,r){o[n]={result:e,timestamp:r}},u=function(n,e){return n-e<r};return _(n)&&(e=n,t=vt(),J(e,function(n,e){u(t,n.timestamp)&&i(e,n.result,n.timestamp)})),{set:i,get:function(e,n){return S.from(o[n]).filter(function(n){return u(e,n.timestamp)}).map(function(n){return n.result})},dump:function(){return o}}}(r),l=It(n+"/1/embed?url=${url}&maxWidth=${maxWidth}",e);return{checkOne:function(o,i,n){void 0===n&&(n=!1);var e,r,t,u,c,a=vt(),f=(e=function(n,e){var r={url:encodeURIComponent(o),maxWidth:i,fresh:e},t=Zr("ephox.media.service.one.ajax.service.get",qt,r);return l.execute(t)},r=s,t=i+"&"+o,u=a,(!0===(c=n)?S.none():r.get(u,t)).fold(function(){return e(t,c).mapResult(function(n){return r.set(t,n,u),n})},function(n){return ht.pure(n)}));return ht.wrap(f.map(function(n){return n.fold(Jt,Kt)}))},dumpCache:s.dump}},$t=function(t){var n,e,o=(n=t.mediaembed_service_url,e=ue(t),zt(n,e?{"tinymce-api-key":e}:{})),i=function(n,e,r){return o.checkOne(n,e,r)},u={};return{getOne:i,dumpCache:function(){o.dumpCache()},getAndHandleResponse:function(r,n,e){void 0!==u[r]?u[r]=u[r].concat(n):(u[r]=[n],i(r.trim(),ie(t)).get(function(n){return n.fold(function(n){e(n),delete u[r]},function(e){P(u[r],function(n){n(e)}),delete u[r]})}))}}},Xt=function(t,o){var n=sr(t),e=$t(t.settings);return or(t),t.on("Init",function(){var n,e,r;e=o+"/content.min.css",r=ce((n=t).settings,e),n.dom.loadCSS(r)}),t.on("SkinLoaded",function(){oe(t.settings)?(er(t,e,n),ir(t,e,n)):n.logError("You need to specify the mediaembed_service_url setting")}),{}},Yt=function(n,e){return tinymce.Env.ceFalse?p(tinymce,"4.5.2")?(cr.error("The mediaembed plugin requires at least 4.5.2 version of TinyMCE."),{}):Xt(n,e):{}};tinymce.PluginManager.add("mediaembed",Yt)}(window);