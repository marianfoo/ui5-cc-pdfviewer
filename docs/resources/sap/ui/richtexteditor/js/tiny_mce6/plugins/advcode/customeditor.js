/*!
 * Tiny Advanced Code Editor plugin
 *
 * Copyright (c) 2022 Ephox Corporation DBA Tiny Technologies, Inc.
 * Licensed under the Tiny commercial license. See https://www.tiny.cloud/legal/
 *
 * Version: 3.1.0-57
 */

!function(){"use strict";const e=e=>t=>typeof t===e,t=e=>"string"===(e=>{const t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&(r=o=e,(n=String).prototype.isPrototypeOf(r)||(null===(s=o.constructor)||void 0===s?void 0:s.name)===n.name)?"string":t;var r,o,n,s})(e),r=e("boolean"),o=e=>!(e=>null==e)(e),n=e("function"),s=e("number"),i=()=>{};class l{constructor(e,t){this.tag=e,this.value=t}static some(e){return new l(!0,e)}static none(){return l.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?l.some(e(this.value)):l.none()}bind(e){return this.tag?e(this.value):l.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:l.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return o(e)?l.some(e):l.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}l.singletonNone=new l(!1);const a=Object.hasOwnProperty;"undefined"!=typeof window?window:Function("return this;")();const u=e=>t=>(e=>e.dom.nodeType)(t)===e,d=u(1),c=u(9),m=u(11),g=(e,o)=>((e,o,n)=>{const i=((e,t)=>{const r=((e,t)=>{const r=e.dom.getAttribute("class");return null===r?void 0:r})(e);return void 0===r||""===r?[]:r.split(" ")})(e);return((e,o,n)=>{((e,o,n)=>{if(!(t(n)||r(n)||s(n)))throw console.error("Invalid call to Attribute.set. Key ",o,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(o,n+"")})(e.dom,o,n)})(e,o,i.concat([n]).join(" ")),!0})(e,"class",o),h=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},v=(e,t)=>{const r=(t||document).createElement(e);return h(r)},y=h,p=e=>c(e)?e:y(e.dom.ownerDocument),f=n(Element.prototype.attachShadow)&&n(Node.prototype.getRootNode)?e=>y(e.dom.getRootNode()):p,w=()=>b(y(document)),b=e=>{const t=e.dom.body;if(null==t)throw new Error("Body is not available yet");return y(t)},C=e=>{return(t=tinymce,"get",((e,t)=>a.call(e,t))(t,"get")?l.from(t.get):l.none()).bind((t=>l.from(t.call(tinymce,e))));var t},E=(e,t,r,n="")=>{const s=(e=>{const t=C(e).map((e=>{const t=f(y(e.getElement()));return(e=>m(e)&&o(e.dom.host))(r=t)?r:y(p(r).dom.body);var r})).getOrThunk(w);if(d(t))return{element:t,destroy:i};{const e=v("div");return((e,t)=>{e.dom.appendChild(t.dom)})(t,e),{element:e,destroy:()=>(e=>{const t=e.dom;null!==t.parentNode&&t.parentNode.removeChild(t)})(e)}}})(r.editorId),l=((e,t)=>{const r=(r,o)=>(o&&!o()||setTimeout((()=>{r.state.completionActive||r.showHint({completeSingle:!1,container:t})}),100),e.Pass);return{completeAfter:r,completeIfAfterLt:t=>r(t,(()=>{const r=t.getCursor();return"<"===t.getRange(e.Pos(r.line,r.ch-1),r)})),completeIfInTag:t=>r(t,(()=>{const r=t.getTokenAt(t.getCursor());return!!("string"!==r.type||/['"]/.test(r.string.charAt(r.string.length-1))&&1!==r.string.length)&&e.innerMode(t.getMode(),r.state).state.tagName}))}})(e,s.element.dom),a={lineWrapping:r.lineWrapping,lineNumbers:r.lineNumbers,foldGutter:r.foldGutter,theme:r.theme,direction:r.direction,matchTags:{bothTags:!0},keyMap:"sublime",gutters:r.gutter?["CodeMirror-linenumbers","CodeMirror-foldgutter"]:[],extraKeys:{"Alt-F":"findPersistent","Ctrl-J":"toMatchingTag","Ctrl-B":"selectNextOccurrence","'<'":l.completeAfter,"'/'":l.completeIfAfterLt,"' '":l.completeIfInTag,"'='":l.completeIfInTag,"Ctrl-Q":e=>{e.foldCode(e.getCursor())}},mode:"text/html",value:n},u=e(t,a),c=e=>{27!==e.keyCode&&e.stopPropagation()};return t.addEventListener("keyup",c),t.addEventListener("keydown",c),t.addEventListener("keypress",c),setTimeout((()=>{u.focus(),r.cursor&&u.doc.setCursor(r.cursor)}),0),setTimeout((()=>u.refresh()),200),{getValue:()=>u.doc.getValue(),setValue:e=>u.doc.setValue(e),destroy:()=>{t.removeEventListener("keyup",c),t.removeEventListener("keydown",c),t.removeEventListener("keypress",c),s.destroy()}}},N={},A=(e,t)=>{if(N[t])return Promise.resolve();{const n=C(t),s=n.bind((e=>{var t;return l.from(null===(t=e.ui)||void 0===t?void 0:t.styleSheetLoader)})).getOr(tinymce.DOM.styleSheetLoader);return n.each((r=>{r.on("remove",(()=>{s.unload(e),delete N[t]}))})),N[t]=!0,r=e,(null!=(o=s)?o:tinymce.DOM.styleSheetLoader).load(r)}var r,o};tinymce.Resource.add("tinymce.plugins.advcode.customeditor",((e,r)=>new Promise((o=>{const s=y(e);var i;((e,r,o)=>{((e,r,o)=>{if(!t(o))throw console.error("Invalid call to CSS.set. Property ",r,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);(e=>void 0!==e.style&&n(e.style.getPropertyValue))(e)&&e.style.setProperty(r,o)})(e.dom,"width","100%")})(s),(i=s,l.from(i.dom.parentNode).map(y)).filter(d).each((e=>((e,t)=>{(e=>void 0!==e.dom.classList)(e)?e.dom.classList.add(t):g(e,t)})(e,"mce-codemirror")));const a=(u=r.codeMirrorScriptUrl,c=r.codeMirrorCssUrl,m=r.editorId,Promise.all([A(c,m),("tinymce.plugins.advcode.CodeMirror",h=u,tinymce.Resource.load("tinymce.plugins.advcode.CodeMirror",h))]).then((([e,t])=>(e,r,o)=>E(t(),e,r,o)))).then((t=>{const{setValue:o,getValue:n,destroy:s}=t(e,r,"");return{getValue:n,setValue:o,destroy:s}}));var u,c,m,h;o(a)}))))}();