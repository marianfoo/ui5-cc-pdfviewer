/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/base/Object","sap/ui/dt/Util","sap/ui/dt/DOMUtil","sap/ui/core/Element","sap/ui/core/Component","sap/base/util/isPlainObject","sap/ui/core/UIArea"],function(jQuery,e,t,n,r,i,a,g){"use strict";var o={};o.iterateOverAllPublicAggregations=function(e,t){var n=e.getMetadata().getAllAggregations();var r=Object.keys(n);r.forEach(function(r){var i=n[r];var a=this.getAggregation(e,r);t(i,a)},this)};o.getElementInstance=function(e){if(typeof e==="string"){var t=sap.ui.getCore().byId(e);return t||i.get(e)}return e};o.hasAncestor=function(e,t){t=this.fixComponentContainerElement(t);var n;while(e&&e!==t){n=this.fixComponentParent(e);if(e===n){e=e.getParent()}else{e=n}}return!!e};o.getClosestElementForNode=function(e){var t=jQuery(e).closest("[data-sap-ui]");return t.length?sap.ui.getCore().byId(t.attr("data-sap-ui")):undefined};o.fixComponentParent=function(t){if(e.isA(t,"sap.ui.core.UIComponent")){var n=t.oContainer;if(n){return n.getParent()}}else{return t}};o.fixComponentContainerElement=function(t){if(e.isA(t,"sap.ui.core.ComponentContainer")){if(!t.getComponentInstance()){return undefined}return t.getComponentInstance().getRootControl()}return t};o.getDomRef=function(e){if(e){var t;if(e.getDomRef){t=e.getDomRef()}if(!t&&e.getRenderedDomRef){t=e.getRenderedDomRef()}return t}};o.findAllSiblingsInContainer=function(e,t){var n=e&&e.getParent();if(!n){return[]}if(n!==t){var r=o.findAllSiblingsInContainer(n,t);return r.map(function(t){return o.getAggregation(t,e.sParentAggregationName)}).reduce(function(e,t){return e.concat(t)},[])}return o.getAggregation(n,e.sParentAggregationName)};o.getAggregationAccessors=function(e,t){var n=e.getMetadata();n.getJSONKeys();var r=n.getAggregation(t);if(r){var i=r._sGetter;if(r.altTypes&&r.altTypes.length&&e[r._sGetter+"Control"]){i=r._sGetter+"Control"}return{get:i,add:r._sMutator,remove:r._sRemoveMutator,insert:r._sInsertMutator,removeAll:r._sRemoveAllMutator}}return{}};o.getAggregation=function(e,t){var n;var r=this.getAggregationAccessors(e,t).get;if(r){n=e[r]()}else{n=e.getAggregation(t)}n=n&&n.splice?n:n?[n]:[];return n};o.getIndexInAggregation=function(e,t,n){return this.getAggregation(t,n).indexOf(e)};o.addAggregation=function(e,t,n){if(this.hasAncestor(e,n)){throw new Error("Trying to add an element to itself or its successors")}var r=this.getAggregationAccessors(e,t).add;if(r){e[r](n)}else{e.addAggregation(t,n)}};o.removeAggregation=function(e,t,n,r){var i=this.getAggregationAccessors(e,t).remove;if(i){e[i](n,r)}else{e.removeAggregation(t,n,r)}};o.insertAggregation=function(e,t,n,r){if(this.hasAncestor(e,n)){throw new Error("Trying to add an element to itself or its successors")}if(this.getIndexInAggregation(n,e,t)!==-1){n.__bSapUiDtSupressParentChangeEvent=true;try{this.removeAggregation(e,t,n,true)}finally{delete n.__bSapUiDtSupressParentChangeEvent}}var i=this.getAggregationAccessors(e,t).insert;if(i){e[i](n,r)}else{e.insertAggregation(t,n,r)}};o.isValidForAggregation=function(t,n,r){var i=t.getMetadata().getAggregation(n);if(this.hasAncestor(t,r)){return false}if(i){var a=i.type;if(i.multiple===false&&this.getAggregation(t,n)&&this.getAggregation(t,n).length>0){return false}return e.isA(r,a)||this.hasInterface(r,a)}};o.getAssociationAccessors=function(e,t){var n=e.getMetadata();n.getJSONKeys();var r=n.getAssociation(t);if(r){return{get:r._sGetter,add:r._sMutator,remove:r._sRemoveMutator,insert:r._sInsertMutator,removeAll:r._sRemoveAllMutator}}return{}};o.getAssociation=function(e,t){var n;var r=this.getAssociationAccessors(e,t).get;if(r){n=e[r]()}return n};o.getIndexInAssociation=function(e,t,n){return this.getAssociationInstances(t,n).indexOf(e)};o.getAssociationInstances=function(e,n){var r=t.castArray(this.getAssociation(e,n));return r.map(function(e){return this.getElementInstance(e)},this)};o.hasInterface=function(e,t){var n=e.getMetadata().getInterfaces();return n.indexOf(t)!==-1};o.isElementInTemplate=function(e){var t=o.getAggregationInformation(e);if(t.templateId){var n=o.extractTemplateId(t);if(!n){return false}}return true};o.isElementDirectTemplateChild=function(e){var t=o.getAggregationInformation(e);if(t.templateId){var n=o.extractTemplateId(t);if(n&&t.stack.length===1){return true}}return false};o.isElementValid=function(e){var t=(e instanceof r||e instanceof i)&&!e.bIsDestroyed&&o.isElementInTemplate(e);return t};o.getParent=function(t){return e.isA(t,"sap.ui.core.Component")?t.oContainer:t.getParent()};o.getLabelForElement=function(e,n){if(!o.isElementValid(e)){throw t.createError("ElementUtil#getLabelForElement","A valid managed object instance should be passed as parameter","sap.ui.dt")}if(typeof n==="function"){return n(e)}function r(e){var t=typeof e.getText==="function"&&e.getText()||typeof e.getLabelText==="function"&&e.getLabelText()||typeof e.getLabel==="function"&&e.getLabel()||typeof e.getTitle==="function"&&e.getTitle()||typeof e.getHeading==="function"&&e.getHeading()||typeof e.getDataSourceLabel==="function"&&e.getDataSourceLabel();if(o.isElementValid(t)){return r(t)}return t}var i=r(e);return typeof i!=="string"?e.getId():i};o.extractTemplateId=function(e){if(a(e)&&e.templateId){if(e.stack.length>1){var t;var n=sap.ui.getCore().byId(e.templateId);var r;var i;for(var g=e.stack.length-2;g>=0;g--){r=e.stack[g].aggregation;i=e.stack[g].index;t=o.getAggregation(n,r)[i];if(!t){return undefined}n=t}return n.getId()}else if(e.stack.length===1){return e.templateId}}else{return undefined}};o.getAggregationInformation=function(e){var t=[];return this._evaluateBinding(e,t)};o._evaluateBinding=function(e,t){var n;var r;var i;var a;var s=e.aAPIParentInfos;if(s&&s.length>0){a=s.some(function(t){i=t.parent;n=t.aggregationName;r=o.getAggregation(i,n).indexOf(e);return i.getBinding(n)})}if(!a){i=e.getParent();if(i){n=e.sParentAggregationName;r=o.getAggregation(i,n).indexOf(e)}else{r=-1}}t.push({element:e.getId(),type:e.getMetadata().getName(),aggregation:n,index:r});if(n&&i.getBinding(n)){var u=i.getBindingInfo(n);var f=u&&u.template;return{elementId:i.getId(),aggregation:n,templateId:f?f.getId():undefined,stack:t}}return!i||i instanceof g?{elementId:undefined,aggregation:undefined,templateId:undefined,stack:t}:this._evaluateBinding(i,t)};o.getAggregationBindingTemplate=function(e,t){var n=e&&e.getBindingInfo(t);return n&&n.template};o.adjustIndexForMove=function(e,t,n,r){if(e===t&&n<r&&n>-1){return r-1}return r};o.checkTargetZone=function(e,t,r){var i=e.getGeometry();var a=i&&i.size.height>0&&i.size.width>0;var g=e.getElement();var s=t.getElement();var u=e.getAggregationName();if(!s||!o.isValidForAggregation(g,u,s)){return Promise.resolve(false)}function f(e,t){var r=e.getDomRef();var i=n.isVisible(r);if(!r){return i}var a=t&&t.getDomRef&&t.getDomRef();var g=a?n.isVisible(a):true;return i||g}if(r&&!a||!r&&!f(e,g)||!(g&&g.getVisible&&g.getVisible())||!g.getParent()){return Promise.resolve(false)}return Promise.resolve(true)};return o},true);
//# sourceMappingURL=ElementUtil.js.map