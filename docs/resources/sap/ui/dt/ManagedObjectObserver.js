/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObject","sap/ui/dt/ElementUtil","sap/base/util/includes"],function(e,t,i){"use strict";var a=e.extend("sap.ui.dt.ManagedObjectObserver",{metadata:{abstract:true,library:"sap.ui.dt",properties:{aggregations:{type:"array",defaultValue:null}},associations:{target:{type:"sap.ui.base.ManagedObject"}},events:{modified:{parameters:{type:"string",name:"string",value:"any",oldValue:"any",target:"sap.ui.core.Element"}},destroyed:{}}}});a.prototype.init=function(){this._fnFireModified=function(e){var t=e.getParameters();if(e.sId==="_change"){e.sId="propertyChanged"}this.fireModified({type:e.sId,name:t.name,value:t.newValue,oldValue:t.oldValue,target:e.getSource()})}.bind(this)};a.prototype.exit=function(){this.unobserve();delete this._fnFireModified};a.prototype.setTarget=function(e){this.unobserve();this.setAssociation("target",e);var t=this.getTargetInstance();if(t){this.observe(t)}return this};a.prototype.observe=function(e){this._bIsObserved=true;e.attachEvent("_change",this._fnFireModified,this);this._fnOriginalDestroy=e.destroy;e.destroy=function(){this.unobserve(e);var t=e.destroy.apply(e,arguments);this.fireDestroyed();return t}.bind(this);this._fnOriginalBindProperty=e.bindProperty;e.bindProperty=function(){var t=this._fnOriginalBindProperty.apply(e,arguments);this.fireModified();return t}.bind(this);this._fnOriginalUnBindProperty=e.unbindProperty;e.unbindProperty=function(){var t=this._fnOriginalUnBindProperty.apply(e,arguments);this.fireModified();return t}.bind(this);this._fnOriginalBindAggregation=e.bindAggregation;e.bindAggregation=function(t){var i=this._fnOriginalBindAggregation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified()}return i}.bind(this);this._fnOriginalUnBindAggregation=e.unbindAggregation;e.unbindAggregation=function(t){var i=this._fnOriginalUnBindAggregation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified()}return i}.bind(this);this._fnOriginalSetParent=e.setParent;e.setParent=function(t,i){var a=false;if(!e._bInSetParent){a=true;e._bInSetParent=true}var n=e.getParent();var r=this._fnOriginalSetParent.apply(e,arguments);if(a){e._bInSetParent=false;if(!e.__bSapUiDtSupressParentChangeEvent&&(n!==t||i==="dependents")){this.fireModified({type:"setParent",value:t,oldValue:n,target:e})}}return r}.bind(this);this._fnOriginalAddAggregation=e.addAggregation;e.addAggregation=function(t,i){this._sAddOrSetAggregationCall=t;var a=this._fnOriginalAddAggregation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified({type:"addOrSetAggregation",name:t,value:i,target:e})}return a}.bind(this);this._fnOriginalSetAggregation=e.setAggregation;e.setAggregation=function(t,i){this._sAddOrSetAggregationCall=t;var a=this._fnOriginalSetAggregation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified({type:"addOrSetAggregation",name:t,value:i,target:e})}return a}.bind(this);this._fnOriginalRemoveAggregation=e.removeAggregation;e.removeAggregation=function(t,i){this._sRemoveAggregationCall=t;var a=this._fnOriginalRemoveAggregation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified({type:"removeAggregation",name:t,value:i,target:e})}return a}.bind(this);this._fnOriginalInsertAggregation=e.insertAggregation;e.insertAggregation=function(t,i){this._sInsertAggregationCall=t;var a=this._fnOriginalInsertAggregation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified({type:"insertAggregation",name:t,value:i,target:e})}return a}.bind(this);this._fnOriginalRemoveAllAggregation=e.removeAllAggregation;e.removeAllAggregation=function(t){this._sRemoveAllAggregationCall=t;var i=e.getAggregation(t);var a=this._fnOriginalRemoveAllAggregation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified({type:"removeAllAggregation",name:t,value:i,target:e})}return a}.bind(this);this._fnOriginalDestroyAggregation=e.destroyAggregation;e.destroyAggregation=function(t){this._sDestroyAggregationCall=t;var i=e.getAggregation(t);var a=this._fnOriginalDestroyAggregation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified({type:"destroyAggregation",name:t,value:i,target:e})}return a}.bind(this);this._fnOriginalAddAssociation=e.addAssociation;e.addAssociation=function(t,i){this._sAddOrSetAssociationCall=t;var a=this._fnOriginalAddAssociation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified({type:"addOrSetAggregation",name:t,value:i,target:e})}return a}.bind(this);this._fnOriginalSetAssociation=e.setAssociation;e.setAssociation=function(t,i){this._sAddOrSetAssociationCall=t;var a=this._fnOriginalSetAssociation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified({type:"addOrSetAggregation",name:t,value:i,target:e})}return a}.bind(this);this._fnOriginalRemoveAssociation=e.removeAssociation;e.removeAssociation=function(t,i){this._sRemoveAssociationCall=t;var a=this._fnOriginalRemoveAssociation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified({type:"removeAggregation",name:t,value:i,target:e})}return a}.bind(this);this._fnOriginalRemoveAllAssociation=e.removeAllAssociation;e.removeAllAssociation=function(t){this._sRemoveAllAssociationCall=t;var i=e.getAssociation(t);var a=this._fnOriginalRemoveAllAssociation.apply(e,arguments);if(this._isAggregationObservable(t)){this.fireModified({type:"removeAllAggregation",name:t,value:i,target:e})}return a}.bind(this);this._aOriginalAddMutators={};this._aOriginalInsertMutators={};this._aOriginalRemoveMutators={};this._aOriginalRemoveAllMutators={};this._aOriginalDestructors={};var t=e.getMetadata().getAllAggregations();Object.keys(t).forEach(function(i){var a=t[i];var n=e[a._sMutator];this._aOriginalAddMutators[a.name]=n;e[a._sMutator]=function(t){delete this._sAddOrSetAggregationCall;var i=n.apply(e,arguments);if((!this._sAddOrSetAggregationCall||this._sAddOrSetAggregationCall!==a.name)&&this._isAggregationObservable(a.name)){this.fireModified({type:"addOrSetAggregation",name:a.name,value:t,target:e})}return i}.bind(this);var r=e[a._sInsertMutator];this._aOriginalInsertMutators[a.name]=r;e[a._sInsertMutator]=function(t){delete this._sInsertAggregationCall;var i=r.apply(e,arguments);if((!this._sInsertAggregationCall||this._sInsertAggregationCall!==a.name)&&this._isAggregationObservable(a.name)){this.fireModified({type:"insertAggregation",name:a.name,value:t,target:e})}return i}.bind(this);var s=e[a._sRemoveMutator];this._aOriginalRemoveMutators[a.name]=s;e[a._sRemoveMutator]=function(t){delete this._sRemoveAggregationCall;var i=s.apply(e,arguments);if((!this._sRemoveAggregationCall||this._sRemoveAggregationCall!==a.name)&&this._isAggregationObservable(a.name)){this.fireModified({type:"removeAggregation",name:a.name,value:t,target:e})}return i}.bind(this);var g=e[a._sRemoveAllMutator];this._aOriginalRemoveAllMutators[a.name]=g;e[a._sRemoveAllMutator]=function(){delete this._sRemoveAllAggregationCall;var t=this.getAggregation(i);var n=g.apply(e,arguments);if((!this._sRemoveAllAggregationCall||this._sRemoveAllAggregationCall!==a.name)&&this._isAggregationObservable(a.name)){this.fireModified({type:"removeAllAggregation",name:a.name,value:t,target:e})}return n}.bind(this);var o=e[a._sDestructor];this._aOriginalDestructors[a.name]=o;e[a._sDestructor]=function(){delete this._sDestroyAggregationCall;var t=this.getAggregation(i);var n=o.apply(e,arguments);if((!this._sDestroyAggregationCall||this._sDestroyAggregationCall!==a.name)&&this._isAggregationObservable(a.name)){this.fireModified({type:"destroyAggregation",name:a.name,value:t,target:e})}return n}.bind(this)}.bind(this),this);var i=e.getMetadata().getAllAssociations();Object.keys(i).forEach(function(t){var a=i[t];var n=e[a._sMutator];this._aOriginalAddMutators[a.name]=n;e[a._sMutator]=function(t){delete this._sAddOrSetAssociationCall;var i;i=n.apply(e,arguments);if((!this._sAddOrSetAssociationCall||this._sAddOrSetAssociationCall!==a.name)&&this._isAggregationObservable(a.name)){this.fireModified({type:"addOrSetAggregation",name:a.name,value:t,target:e})}return i}.bind(this);var r=e[a._sRemoveMutator];this._aOriginalRemoveMutators[a.name]=r;e[a._sRemoveMutator]=function(t){delete this._sRemoveAssociationCall;var i=r.apply(e,arguments);if((!this._sRemoveAssociationCall||this._sRemoveAssociationCall!==a.name)&&this._isAggregationObservable(a.name)){this.fireModified({type:"removeAggregation",name:a.name,value:t,target:e})}return i}.bind(this);var s=e[a._sRemoveAllMutator];this._aOriginalRemoveAllMutators[a.name]=s;e[a._sRemoveAllMutator]=function(){delete this._sRemoveAllAssociationCall;var i=this.getAssociation(t);var n=s.apply(e,arguments);if((!this._sRemoveAllAssociationCall||this._sRemoveAllAssociationCall!==a.name)&&this._isAggregationObservable(a.name)){this.fireModified({type:"removeAllAggregation",name:a.name,value:i,target:e})}return n}.bind(this)}.bind(this),this)};a.prototype.unobserve=function(e){e=e||this.getTargetInstance();if(this._bIsObserved&&e){this._bIsObserved=false;e.destroy=this._fnOriginalDestroy;e.bindProperty=this._fnOriginalBindProperty;e.unbindProperty=this._fnOriginalUnBindProperty;e.bindAggregation=this._fnOriginalBindAggregation;e.unbindAggregation=this._fnOriginalUnBindAggregation;e.setParent=this._fnOriginalSetParent;e.addAggregation=this._fnOriginalAddAggregation;e.removeAggregation=this._fnOriginalRemoveAggregation;e.insertAggregation=this._fnOriginalInsertAggregation;e.setAggregation=this._fnOriginalSetAggregation;e.removeAllAggregation=this._fnOriginalRemoveAllAggregation;e.destroyAggregation=this._fnOriginalDestroyAggregation;e.addAssociation=this._fnOriginalAddAssociation;e.removeAssociation=this._fnOriginalRemoveAssociation;e.setAssociation=this._fnOriginalSetAssociation;e.removeAllAssociation=this._fnOriginalRemoveAllAssociation;var t=e.getMetadata().getAllAggregations();Object.keys(t).forEach(function(i){var a=t[i];e[a._sMutator]=this._aOriginalAddMutators[a.name];e[a._sInsertMutator]=this._aOriginalInsertMutators[a.name];e[a._sRemoveMutator]=this._aOriginalRemoveMutators[a.name];e[a._sRemoveAllMutator]=this._aOriginalRemoveAllMutators[a.name];e[a._sDestructor]=this._aOriginalDestructors[a.name]},this);var i=e.getMetadata().getAllAssociations();Object.keys(i).forEach(function(t){var a=i[t];e[a._sMutator]=this._aOriginalAddMutators[a.name];e[a._sRemoveMutator]=this._aOriginalRemoveMutators[a.name];e[a._sRemoveAllMutator]=this._aOriginalRemoveAllMutators[a.name]},this);e.detachEvent("_change",this._fnFireModified,this)}delete this._fnOriginalDestroy;delete this._fnOriginalBindProperty;delete this._fnOriginalUnBindProperty;delete this._fnOriginalBindAggregation;delete this._fnOriginalUnBindAggregation;delete this._fnOriginalSetParent;delete this._fnOriginalAddAggregation;delete this._fnOriginalRemoveAggregation;delete this._fnOriginalInsertAggregation;delete this._fnOriginalSetAggregation;delete this._fnOriginalRemoveAllAggregations;delete this._fnOriginalDestroyAggregation;delete this._aOriginalAddMutators;delete this._aOriginalInsertMutators;delete this._aOriginalRemoveMutators;delete this._aOriginalRemoveAllMutators;delete this._aOriginalDestructors};a.prototype.getTargetInstance=function(){return t.getElementInstance(this.getTarget())};a.prototype._isAggregationObservable=function(e){return this.getAggregations()===null||i(this.getAggregations(),e)};return a});
//# sourceMappingURL=ManagedObjectObserver.js.map