/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/dt/OverlayRegistry","sap/ui/dt/ElementUtil","sap/ui/core/UIArea"],function(e,n,r){"use strict";var t={};t.isInTargetZoneAggregation=function(e){var n=e.getParent();return!!n&&n.isTargetZone()};t.getParentInformation=function(e){var r=e.getParentElementOverlay();if(r){var t=r.getElement();var i=e.getParentAggregationOverlay().getAggregationName();var a=n.getAggregation(t,i);var g=e.getElement();var l=a.indexOf(g);return{parent:t,aggregation:i,index:l}}return{parent:null,aggregation:"",index:-1}};t.getClosestOverlayFor=function(n){if(!n){return null}var r=n;var t=e.getOverlay(r);while(r&&!t){r=r.getParent();t=e.getOverlay(r)}return t};t.getGeometry=function(e){var n;var r;var t;var i;e.forEach(function(e){if(e&&e.visible){if(!n||e.position.left<n){n=e.position.left}if(!t||e.position.top<t){t=e.position.top}var a=e.position.left+e.size.width;if(!r||a>r){r=a}var g=e.position.top+e.size.height;if(!i||g>i){i=g}}});if(typeof n==="number"){return{size:{width:r-n,height:i-t},position:{left:n,top:t},visible:true}}};t.getFirstDescendantByCondition=function(e,n){if(!n){throw new Error("expected condition is 'undefined' or not a function")}var r=t.getAllChildOverlays(e);for(var i=0,a=r.length;i<a;i++){var g=r[i];if(n(g)){return g}var l=this.getFirstDescendantByCondition(g,n);if(l){return l}}return undefined};t.getLastDescendantByCondition=function(e,n){if(!n){throw new Error("expected condition is 'undefined' or not a function")}var r=t.getAllChildOverlays(e);for(var i=r.length-1,a=-1;i>a;i--){var g=r[i];if(n(g)){return g}var l=this.getLastDescendantByCondition(g,n);if(l){return l}}return undefined};t.getAllChildOverlays=function(e){var n=[];var r=[];if(!e){return n}var t=e.getChildren();for(var i=0;i<t.length;i++){r=t[i].getChildren();if(r&&r.length>0){n=n.concat(r)}}return n};t.getFirstChildOverlay=function(e){var n=this.getAllChildOverlays(e);if(n.length){return n[0]}return undefined};t.getLastChildOverlay=function(e){var n=this.getAllChildOverlays(e);if(n.length){return n[n.length-1]}return undefined};t.getNextSiblingOverlay=function(e){if(!e){return undefined}var n=e.getParentAggregationOverlay();if(n){var r=n.getChildren();var t=r.indexOf(e);if(t!==r.length-1){return r[t+1]}else if(t===r.length-1){var i=e.getParentElementOverlay();r=i.getAggregationOverlays();for(t=r.indexOf(n)+1;t<r.length;t++){var a=r[t].getChildren();if(a.length){return a[0]}}}}};t.getPreviousSiblingOverlay=function(e){if(!e){return undefined}var n=e.getParentAggregationOverlay();if(n){var r=n.getChildren();var t=r.indexOf(e);if(t>0){return r[t-1]}else if(t===0){var i=e.getParentElementOverlay();r=i.getAggregationOverlays();for(t=r.indexOf(n)-1;t>=0;t--){var a=r[t].getChildren();if(a.length){return a[a.length-1]}}}}};t.getNextOverlay=function(e){if(!e){return undefined}var n=this.getFirstChildOverlay(e);if(n){return n}var r=this.getNextSiblingOverlay(e);if(r){return r}do{e=e.getParentElementOverlay();r=this.getNextSiblingOverlay(e)}while(e&&!r);return r};t.getPreviousOverlay=function(e){if(!e){return undefined}var n=e.getParentAggregationOverlay();if(!n){return undefined}var r=this.getPreviousSiblingOverlay(e);if(r){var t=r;do{r=t;t=this.getLastChildOverlay(r)}while(t);return r}return e.getParentElementOverlay()};t.iterateOverlayElementTree=function(e,n){n(e);e.getAggregationOverlays().forEach(function(e){e.getChildren().forEach(function(e){this.iterateOverlayElementTree(e,n)},this)},this)};t.getClosestOverlayForNode=function(e){var r=n.getClosestElementForNode(e);return t.getClosestOverlayFor(r)};t.findAllSiblingOverlaysInContainer=function(e,n){var r=e.getParentElementOverlay();var i=[];if(r){if(r!==n){var a=t.findAllSiblingOverlaysInContainer(r,n);i=a.map(function(n){var r=n.getAggregationOverlay(e.getParentAggregationOverlay().getAggregationName());return r?r.getChildren():[]}).reduce(function(e,n){return e.concat(n)},[])}else{var g=e.getParentAggregationOverlay().getAggregationName();var l=r.getAggregationOverlay(g);i=l&&l.getChildren()||[]}}i=i.filter(function(e){return e.getDesignTimeMetadata()});return i};t.findAllOverlaysInContainer=function(n,r){var i=n.getRelevantContainer()||n.getElement();var a=e.getOverlay(i);var g=[];if(!a){return g}var l=t._findAllSiblingsAndParents(n,a,0,r);if(l[0]){for(var o in l){g=g.concat(l[o])}var f=[];var v=r?g:l[0];v.forEach(function(e){f=f.concat(t._findAllChildrenInContainer(e,i))});g=g.concat(f)}else{g=t._findAllChildrenInContainer(n,i)}g.push(a);g=g.filter(function(e){return e.getDesignTimeMetadata()});return g};t._findAllSiblingsAndParents=function(e,n,r,i){var a=e.getParentElementOverlay();if(!a){return[]}function g(e){var n=e.getAggregationNames();var r=[];n.forEach(function(n){var t=e.getAggregationOverlay(n);var i=t?t.getChildren():[];r=i.concat(r)});return r}if(a!==n){var l;var o;l=t._findAllSiblingsAndParents(a,n,r+1,i);if(i){var f=[];l[r+1].forEach(function(e){f.concat(g(e))});l[r]=f;return l}o=l[r+1].map(function(n){var r=e.getParentAggregationOverlay().getAggregationName();var t=n.getAggregationOverlay(r);return t?t.getChildren():[]}).reduce(function(e,n){return e.concat(n)},[]);l[r]=o;return l}var v=[];if(i){v=g(a)}else{var u=e.getParentAggregationOverlay().getAggregationName();v=e.getParentElementOverlay().getAggregationOverlay(u).getChildren()}var d={};d[r]=v;return d};t._findAllChildrenInContainer=function(e,n,r){r=r||[];if(e.getChildren().length>0){e.getChildren().forEach(function(e){e.getChildren().forEach(function(e){if(e.getRelevantContainer()===n){r.push(e);t._findAllChildrenInContainer(e,n,r)}})})}return r};t.findAllUniqueAggregationOverlaysInContainer=function(e,n){var r=t.findAllSiblingOverlaysInContainer(e,n);return r.map(function(e){return e.getParentAggregationOverlay()}).filter(function(e,n,r){return r.indexOf(e)===n})};t.getIndexInAggregation=function(r,t,i){var a=n.getAggregation(t,i).filter(function(n){return!!e.getOverlay(n)||n===r});return a.indexOf(r)};function i(e,n){var t;var a;var g=e.getParent();var l=false;if(e.isA("sap.ui.dt.ElementOverlay")){var o=e.getParentElementOverlay();if(g){t=g.getAggregationName();a=g.getChildren().indexOf(e);l=o&&o.getAggregationOverlay(t,"AggregationBindingTemplateOverlays")}else{a=-1}n.push({overlayId:e.getId(),aggregation:t,index:a});if(l){return{overlayId:o.getId(),aggregation:t,stack:n}}}if(!g||g instanceof r){return{overlayId:undefined,aggregation:undefined,stack:n}}return i(g,n)}t.getClosestBoundControl=function(e){return i(e,[])};t.findParentOverlaysWithScrollbar=function(e){var n=[];function r(e){if(e._oScrollbarSynchronizers.size>0){n.push(e)}if(!e.getParent()){return n}return r(e.getParent())}return r(e)};return t},true);
//# sourceMappingURL=OverlayUtil.js.map