/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/model/resource/ResourceModel","sap/ui/model/json/JSONModel"],function(e,t){"use strict";var n=[];var i=[];var r={};var a;function s(e,t){return t.hasText(e)||t.getText(e,[],true)!==undefined}var o=function(s){return new Promise(function(o){sap.ui.getCore().loadLibraries([s]).then(function(){var u=sap.ui.getCore().getLoadedLibraries()[s];var c=u.controls.concat(u.elements);a=s;sap.ui.require(c.map(function(e){return e.replace(/\./g,"/")}),function(){var a=sap.ui.getCore().getLoadedLibraries();try{var u=new e({bundleUrl:sap.ui.require.toUrl(s,"messagebundle.properties"),bundleLocale:"en"});var c=new e({bundleUrl:sap.ui.require.toUrl(s+".designtime","messagebundle.properties"),bundleLocale:"en"});r.runtime=u.getResourceBundle();r.designtime=c.getResourceBundle();Object.keys(a).forEach(function(e){if(s!==e){u.enhance({bundleUrl:sap.ui.require.toUrl(e,"messagebundle.properties"),bundleLocale:"en"});c.enhance({bundleUrl:sap.ui.require.toUrl(e+".designtime","messagebundle.properties"),bundleLocale:"en"})}})}catch(e){}var f=[];var d=[];for(var p=0;p<arguments.length;p++){if(arguments[p].getMetadata()._oDesignTime){f.push(arguments[p].getMetadata().loadDesignTime());d.push(arguments[p].getMetadata())}}Promise.all(f).then(function(e){var r=0;n=e;i=n.map(function(e){var n=new t(e);n._oControlMetadata=d[r];r++;return n});l();o()})})})})};o.version=2;var u={"/":{optional:false,check:function(e,t,n){e.strictEqual(typeof t,"object",n+" is an object")}},"/designtimeModule":{optional:false,check:function(e,t,n){e.strictEqual(typeof t,"string",n+" defines /designtimeModule : "+t)}},"/actions":{optional:true,check:function(e,t,n){Object.keys(t).forEach(function(i){if(t[i].changeType){e.strictEqual(typeof t[i].changeType,"string",n+" defines "+i+" with changetype:"+t[i].changeType)}else if(typeof t[i]==="string"){e.strictEqual(typeof t[i],"string",n+" defines "+i+" as string")}else if(i==="settings"&&typeof t[i]==="object"){u["/actions"].check(e,t[i],n)}else{e.strictEqual(typeof t[i],"function",n+" defines "+i+" as function")}})}},"/name":{optional:true,check:function(e,t,n){if(typeof t==="string"&&t.indexOf("{")===0&&t.indexOf("}")===t.length-1){return true}var i=["singular","plural"];i.forEach(function(i){if(typeof t[i]==="function"){e.strictEqual(typeof t[i],"function",n+" defines mandatory entry /name/"+i)}else{e.strictEqual(typeof t[i],"string",n+" defines mandatory entry /name/"+i)}});i.forEach(function(i){var a=false;if(typeof t[i]==="function"){e.strictEqual(typeof t[i],"function",n+" defines function for translation of entry /name/"+i);e.strictEqual(typeof t[i](),"string","Assuming that "+i+" with "+t[i].toString()+" returns a translation at runtime");return}if(t[i].toUpperCase()!==t[i]){e.ok(true,"Assuming that "+i+" with "+t[i]+" needs currently no translation");return}if(r.designtime){a=s(t[i],r.designtime);e.strictEqual(a,true,t[i]+" found in designtime message bundle")}if(r.runtime){if(a){e.strictEqual(s(t[i],r.runtime),false,t[i]+" found in runtime message bundle and designtime message bundle, please delete the entry from the runtime message bundle (messagebundle.properties + messagebundle_en.properties)")}else{e.strictEqual(s(t[i],r.runtime),true,t[i]+" found in runtime message bundle only, consider to move this text to the designtime message bundle")}}})}},"/palette":{optional:true,check:function(e,t,n){var i=["ACTION","DISPLAY","LAYOUT","LIST","INPUT","CONTAINER","CHART","TILE","DIALOG"];e.strictEqual(typeof t,"object",n+" defines optional entry /palette/");e.strictEqual(i.indexOf(t.group)>-1,true,"palette entry defines valid group "+t.group);if(t.icons){return Promise.all(Object.keys(t.icons).map(function(n){var i=t.icons[n];e.strictEqual(typeof i,"string","palette/icons/"+n+" entry defines icon path "+i);return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",sap.ui.require.toUrl(i)+"",true);r.onload=function(){if(r.readyState===4){if(r.status===200){if(i.indexOf(".svg")===i.length-4){e.equal(r.responseXML.documentElement&&r.responseXML.documentElement.tagName,"svg","File "+i+" starts with a svg node")}t()}else{n()}}};r.send()})}))}}},"/templates":{optional:true,check:function(e,t){if(t.create){var n=t.create;e.strictEqual(typeof n,"string","templates/create entry defines fragment path to "+n);return new Promise(function(t,i){var r=new XMLHttpRequest;r.open("GET",sap.ui.require.toUrl(n)+"",true);r.onload=function(){if(r.readyState===4){if(r.status===200){e.ok(r.responseXML.documentElement&&r.responseXML.documentElement.localName==="FragmentDefinition","File "+n+" exists and starts with a FragmentDefinition node");t()}else{i()}}};r.send()})}}}};function l(){QUnit.test("Checking library.designtime.js",function(e){var t=sap.ui.getCore().getLoadedLibraries()[a];if(t.designtime){var n=e.async();sap.ui.require([t.designtime],function(i){e.ok(i!==null,t.designtime+" loaded successfully");n()})}else{e.ok(true,"No library.designtime.js "+a)}});QUnit.test("Checking loaded designtime data",function(e){n.forEach(function(t){e.strictEqual(t!==null,true,"Designtime data found and loaded successful");e.strictEqual(typeof t,"object","Designtime data returned an object")})});i.forEach(function(e){var t=e._oControlMetadata;var n=t.getName();QUnit.test(n+": Checking entries in designtime data",function(t){return Promise.all(Object.keys(u).map(function(i){var r=u[i];var a=e.getProperty(i);if(a===undefined&&!r.optional){t.equal(false,true,n+" does not define mandatory entry "+i);return Promise.resolve()}else if(a!==undefined&&r.optional){t.equal(true,true,n+" does define optional entry "+i);return r.check(t,a,n)}else if(a!==undefined&&!r.optional){t.equal(true,true,n+" does define mandatory entry "+i);return r.check(t,a,n)}}))})})}return o},true);
//# sourceMappingURL=libraryTest.js.map