/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/OverflowToolbarButton","sap/m/ButtonRenderer","sap/ui/base/ManagedObjectObserver","sap/ui/core/library","sap/m/library","sap/m/IllustratedMessage"],function(e,t,a,i,r,o){"use strict";var s=r.PlacementType;var n=i.aria.HasPopup;var c,l,p,h,d,u,b,m;var f=e.extend("sap.ui.mdc.chart.ChartTypeButton",{metadata:{library:"sap.ui.mdc"},constructor:function(t){if(!t){e.apply(this);return}this.oMDCChartModel=t.getManagedObjectModel();var i={type:"Transparent",press:function(e){this.displayChartTypes(e.getSource(),t)}.bind(this),id:t.getId()+"-btnChartType",icon:"{$chart>/getChartTypeInfo/icon}",tooltip:"{$chart>/getChartTypeInfo/text}",text:"{$chart>/getChartTypeInfo/text}",ariaHasPopup:n.ListBox};this.oMDCChart=t;e.apply(this,[i]);this.setModel(this.oMDCChartModel,"$chart");this._oObserver=new a(function(){this.oMDCChartModel.checkUpdate(true)}.bind(this));this._oObserver.observe(this.oMDCChart,{aggregations:["items"],properties:["chartType"]})},renderer:t});f.mMatchingIcon={bar:"sap-icon://horizontal-bar-chart",bullet:"sap-icon://horizontal-bullet-chart",bubble:"sap-icon://bubble-chart",column:"sap-icon://vertical-bar-chart",combination:"sap-icon://business-objects-experience",dual_bar:"sap-icon://horizontal-bar-chart",dual_column:"sap-icon://vertical-bar-chart",dual_combination:"sap-icon://business-objects-experience",dual_horizontal_combination:"sap-icon://business-objects-experience",dual_horizontal_stacked_combination:"sap-icon://business-objects-experience",dual_line:"sap-icon://line-chart",dual_stacked_bar:"sap-icon://full-stacked-chart",dual_stacked_column:"sap-icon://vertical-stacked-chart",dual_stacked_combination:"sap-icon://business-objects-experience",donut:"sap-icon://donut-chart",heatmap:"sap-icon://heatmap-chart",horizontal_stacked_combination:"sap-icon://business-objects-experience",line:"sap-icon://line-chart",pie:"sap-icon://pie-chart",scatter:"sap-icon://scatter-chart",stacked_bar:"sap-icon://full-stacked-chart",stacked_column:"sap-icon://vertical-stacked-chart",stacked_combination:"sap-icon://business-objects-experience",treemap:"sap-icon://Chart-Tree-Map",vertical_bullet:"sap-icon://vertical-bullet-chart","100_dual_stacked_bar":"sap-icon://full-stacked-chart","100_dual_stacked_column":"sap-icon://vertical-stacked-chart","100_stacked_bar":"sap-icon://full-stacked-chart","100_stacked_column":"sap-icon://full-stacked-column-chart",waterfall:"sap-icon://vertical-waterfall-chart",horizontal_waterfall:"sap-icon://horizontal-waterfall-chart"};f.prototype.displayChartTypes=function(e,t){if(!t||!e){return}if(!this.oReadyPromise){this.oReadyPromise=new Promise(function(e){if(c){e(true)}else{sap.ui.require(["sap/m/ResponsivePopover","sap/m/List","sap/m/Bar","sap/m/SearchField","sap/m/StandardListItem","sap/ui/core/InvisibleText","sap/ui/Device"],function(t,a,i,r,o,s,n){c=t;l=a;p=i;h=r;d=o;u=s;b=n;if(!m){sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc",true).then(function(t){m=t;e(true)})}else{e(true)}})}})}this.oReadyPromise.then(function(){if(!this.oPopover){this.oPopover=this._createPopover(e,t);this.oPopover.attachAfterClose(function(){this.oPopover.destroy();delete this.oPopover}.bind(this));return this.oPopover.openBy(e)}}.bind(this))};f.prototype._createPopover=function(e,t){var a=new d({title:"{$chart>text}",icon:"{$chart>icon}",selected:"{$chart>selected}"});var i=new l({mode:"SingleSelectMaster",noData:new o({title:m.getText("chart.NO_CHART_TYPES_AVAILABLE"),description:m.getText("chart.NO_CHART_TYPES_AVAILABLE_ACTION")}),items:{path:"$chart>/getAvailableChartTypes",template:a},selectionChange:function(e){if(e&&e.mParameters&&e.mParameters.listItem){var a=e.mParameters.listItem.getBinding("title");if(a){var i=a.getContext();if(i){var r=i.getObject();if(r&&r.key){sap.ui.require(["sap/ui/mdc/p13n/FlexUtil","sap/ui/mdc/flexibility/Chart.flexibility"],function(e,a){t.getEngine().createChanges({control:t,key:"Type",state:{type:r.key}})})}}}}f.close()}});var r=new p;var n=new h({placeholder:m.getText("chart.CHART_TYPE_SEARCH")});n.attachLiveChange(function(e){if(t){this._triggerSearchInPopover(e,i)}}.bind(this));r.addContentRight(n);var f=new c({id:t.getId()+"-btnChartTypePopover",placement:s.VerticalPreferredBottom,subHeader:r,contentWidth:"25rem"});f.setModel(this.oMDCChartModel,"$chart");if(b.system.desktop){var _=new u({text:m.getText("chart.CHART_TYPELIST_TEXT")});f.setShowHeader(false);f.addContent(_);f.addAriaLabelledBy(_)}else{f.setTitle(m.getText("chart.CHART_TYPELIST_TEXT"))}f.addContent(i);if(i.getItems().length<7){r.setVisible(false)}return f};f.prototype._triggerSearchInPopover=function(e,t){var a,i,r,o,s,n;if(!e||!t){return}a=e.getParameters();if(!a){return}s=a.newValue?a.newValue.toLowerCase():"";n=t.getItems();for(i=0;i<n.length;i++){o=n[i].getTooltip();r=n[i].getTitle();if(r&&r.toLowerCase().indexOf(s)>-1||o&&o.toLowerCase().indexOf(s)>-1){n[i].setVisible(true)}else{n[i].setVisible(false)}}};f.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this.oPopover){this.oPopover.destroy();this.oPopover=null}};return f});
//# sourceMappingURL=ChartTypeButton.js.map