/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/library","sap/ui/mdc/field/FieldHelpBase","sap/ui/mdc/condition/Condition","sap/ui/base/ManagedObjectObserver","sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/json/JSONModel"],function(t,e,i,s,a,o,r){"use strict";var n;var l;var p;var d;var u=e.extend("sap.ui.mdc.field.BoolFieldHelp",{metadata:{library:"sap.ui.mdc"}});u.prototype.init=function(){e.prototype.init.apply(this,arguments);this._oObserver=new s(c.bind(this));this._oObserver.observe(this,{properties:["filterValue","conditions"]});this._oModel=new r({type:"",items:[{key:true,text:"true"},{key:false,text:"false"}]});this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc")};u._init=function(){e._init.apply(this,arguments);n=undefined;l=undefined;p=undefined;d=undefined};u.prototype.exit=function(){e.prototype.exit.apply(this,arguments);this._oObserver.disconnect();this._oObserver=undefined;this._oModel.destroy();this._oModel=undefined};u.prototype.connect=function(t){e.prototype.connect.apply(this,arguments);b.call(this);return this};u.prototype._createPopover=function(){var t=e.prototype._createPopover.apply(this,arguments);if((!n||!l||!p)&&!this._bListRequested){n=sap.ui.require("sap/m/List");l=sap.ui.require("sap/m/StandardListItem");p=sap.ui.require("sap/m/library");d=sap.ui.require("sap/ui/model/Filter");if(!n||!l||!p){sap.ui.require(["sap/m/List","sap/m/StandardListItem","sap/m/library","sap/ui/model/Filter"],f.bind(this));this._bListRequested=true}}if(t){var i=this._getField();if(i){t.setInitialFocus(i)}h.call(this)}return t};function h(){if(!this._oList&&n&&l&&p&&!this._bListRequested){var t=new l(this.getId()+"-item",{type:p.ListType.Active,title:"{text}"}).addStyleClass("sapMComboBoxNonInteractiveItem");this._oList=new n(this.getId()+"-List",{width:"100%",showNoData:false,mode:p.ListMode.SingleSelectMaster,rememberSelections:false,items:{path:"/items",template:t},itemPress:v.bind(this)}).addStyleClass("sapMComboBoxBaseList").addStyleClass("sapMComboBoxList");this._oList.setModel(this._oModel);_.call(this,this.getFilterValue());g.call(this);this._setContent(this._oList);if(this._bNavigate){this._bNavigate=false;this.navigate(this._iStep);this._iStep=null}}}function f(t,e,i,s){n=t;l=e;p=i;d=s;this._bListRequested=false;if(!this._bIsBeingDestroyed){h.call(this)}}u.prototype.open=function(t){var i=this.getAggregation("_popover");if(i){var s=this._getField();i.setInitialFocus(s)}e.prototype.open.apply(this,arguments);return this};u.prototype._handleAfterClose=function(t){if(this._bUpdateFilterAfterClose){this._bUpdateFilterAfterClose=false;_.call(this)}this._oList.removeStyleClass("sapMListFocus");e.prototype._handleAfterClose.apply(this,arguments)};function c(t){if(t.name==="conditions"){y.call(this,t.current)}if(t.name==="filterValue"){if(this._oList){if(this._bClosing){this._bUpdateFilterAfterClose=true}else{_.call(this,t.current)}}}}u.prototype.openByTyping=function(){return true};u.prototype.removeFocus=function(){if(this._oList){this._oList.removeStyleClass("sapMListFocus")}};u.prototype.navigate=function(t){var e=this._getPopover();if(!e||!this._oList){this._bNavigate=true;this._iStep=t;return}this._oList.addStyleClass("sapMListFocus");var i=this._oList.getSelectedItem();var s=this._oList.getItems();var a=s.length;var o=0;var r=false;if(i){o=this._oList.indexOfItem(i);o=o+t;if(o<0){o=0;r=true}else if(o>=a-1){o=a-1}}else if(t>=0){o=t-1}else{o=a+t}var n=s[o];if(n){if(!e.isOpen()){this.open()}if(n!==i){n.setSelected(true);var l=m.call(this,n);var p=L.call(this,l);this.setProperty("conditions",[p],true);this.fireNavigate({value:n.getTitle(),key:l,condition:p,itemId:n.getId()})}else if(r){this.fireNavigate({key:undefined,value:undefined,condition:undefined,itemId:undefined,leaveFocus:r})}}};u.prototype._getTextOrKey=function(t,e,i,s,r,n,l,p){if(t===null||t===undefined||t===""){return null}else if(!t&&!e){return null}var d=this._oModel.getData()["items"];for(var u=0;u<d.length;u++){var h=d[u];if(e){if(h["key"]===t){return h["text"]}}else if(h["text"]===t){return h["key"]}}var f=this._oResourceBundle.getText("valuehelp.VALUE_NOT_EXIST",[t]);if(e){throw new a(f)}else{throw new o(f)}};function v(t){var e=t.getParameter("listItem");var i=e.getSelected();if(i){var s=m.call(this,e);var a=L.call(this,s);this.setProperty("conditions",[a],true);this.close();this.fireSelect({conditions:[a],add:true,close:true})}}function _(t){var e=this._oList.getBinding("items");if(t){var i=new d({path:"text",operator:"StartsWith",value1:t});e.filter(i)}else{e.filter()}this._oList.invalidate();g.call(this)}function g(){if(this._oList){var t=this.getConditions();var e;var i;var s=this._oList.getItems();var a=this._getOperator();if(t.length>0&&t[0].operator===a.name){e=t[0].values[0];i=this.getTextForKey(e)}for(var o=0;o<s.length;o++){var r=s[o];if(r.getTitle()===i){r.setSelected(true)}else{r.setSelected(false)}}}}function y(t){g.call(this)}function m(t){var e=t.getBindingContext();var i=e&&e.getObject();if(i){return i["key"]}}function L(t){var e;var i=this.getTextForKey(t);if(i){e=this._createCondition(t,i)}return e}function b(){if(this._oField&&this._oField._getFormatOptions){var t=this._oField._getFormatOptions().valueType;var e=this._oModel.getData();if(t&&e["type"]!==t.getMetadata().getName()){e["type"]=t.getMetadata().getName();var i=e["items"];for(var s=0;s<i.length;s++){var a=i[s];a["text"]=t.formatValue(a["key"],"string")}}}}return u});
//# sourceMappingURL=BoolFieldHelp.js.map