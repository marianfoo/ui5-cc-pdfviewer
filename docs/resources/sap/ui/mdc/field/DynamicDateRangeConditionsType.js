/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/field/ConditionsType","sap/ui/mdc/condition/FilterOperatorUtil","sap/ui/mdc/condition/Operator","sap/ui/mdc/condition/Condition","sap/ui/mdc/enum/ConditionValidated","sap/ui/mdc/enum/BaseType","sap/ui/mdc/util/DateUtil","sap/ui/model/SimpleType","sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/m/DynamicDate","sap/m/library"],function(e,t,a,r,i,o,n,s,p,l,u,d,c){"use strict";var v=e.extend("sap.ui.mdc.field.DynamicDateRangeConditionsType",{constructor:function(e,t){s.apply(this,arguments);this.sName="ConditionsDateRange";this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc")}});v.prototype.destroy=function(){s.prototype.destroy.apply(this,arguments);this._bDestroyed=true};v.prototype.formatValue=function(e,r){if(e==undefined||e==null||this._bDestroyed){return null}if(!Array.isArray(e)){throw new p("No valid conditions provided")}var i=h.call(this);var o;if(i!==1){throw new p("MaxConditions must be 1")}if(e.length===1){var n=e[0];var s=t.getOperator(n.operator);if(!n.operator||!s){throw new p("No valid condition provided, Operator wrong.")}var l=[];var u=T.call(this);var d=t.getDynamicDateOptionForOperator(s,c.StandardDynamicDateRangeKeys,u);for(var v=0;v<s.valueTypes.length;v++){if(d&&s.valueTypes[v]===a.ValueType.Self){l.push(m.call(this,n.values[v]))}else if(s.valueTypes[v]&&s.valueTypes[v]!==a.ValueType.Static){l.push(n.values[v])}}if(!d){d=t.getCustomDynamicDateOptionForOperator(s,u)}var f=y.call(this,u);o=f.formatValue({operator:d,values:l},r)}return o};function y(e){if(!this._oDynamicDateType){var t={date:{source:{pattern:"timestamp"}},int:{}};if(e===o.DateTime){t.datetime={source:{pattern:"timestamp"}}}this._oDynamicDateType=new d(t)}return this._oDynamicDateType}function m(e){var t=g.call(this);var a=t.getModelFormat();var r=a.parse(e);return r.getTime()}function f(e){var t=g.call(this);var a=t.getModelFormat();var r=new Date(e);r.setUTCMilliseconds(0);var i=a.format(r);return i}v.prototype.parseValue=function(e,o){if(this._bDestroyed){return null}if(h.call(this)!==1){throw new l("Only one condition supported for parsing")}var n=D.call(this);var s=[];if(e&&e.operator){if(e.operator==="PARSEERROR"){throw new l(e.values[0])}var p=e.operator;var u=t.getOperatorForDynamicDateOption(p,T.call(this));p=u.name;if(u){var d=T.call(this);var v=y.call(this,d);var m=v.parseValue(e,o);var g=[];for(var O=0;O<u.valueTypes.length;O++){if(c.StandardDynamicDateRangeKeys[e.operator]&&u.valueTypes[O]===a.ValueType.Self){g.push(f.call(this,m.values[O]))}else if(u.valueTypes[O]&&u.valueTypes[O]!==a.ValueType.Static){g.push(m.values[O])}}var w=r.createCondition(u.name,g,undefined,undefined,i.NotValidated);t.updateConditionValues(w);t.checkConditionsEmpty(w,n);s.push(w)}}return s};v.prototype.validateValue=function(e){if(e===undefined||e===null||this._bDestroyed){return}if(!Array.isArray(e)){throw new u("No valid conditions provided")}var a=g.call(this);var r=D.call(this);for(var i=0;i<e.length;i++){var o=e[i];if(typeof o!=="object"||!o.operator||!o.values||!Array.isArray(o.values)){throw new u(this._oResourceBundle.getText("field.VALUE_NOT_VALID"))}var n=t.getOperator(o.operator);if(!n||r.indexOf(n.name)===-1){throw new u("No valid condition provided, Operator wrong.")}n.validate(o.values,a)}};function h(){var e=1;if(this.oFormatOptions.hasOwnProperty("maxConditions")){e=this.oFormatOptions.maxConditions}return e}function g(){var e=this.oFormatOptions.valueType;if(!e){throw new Error("Type missing")}return e}function D(){var e=this.oFormatOptions.operators;if(!e||e.length===0){e=t.getOperatorsForType(T.call(this))}return e}function T(){var e=g.call(this);var t=e.getMetadata().getName();var a=e.getFormatOptions();var r=e.getConstraints();var i=this.oFormatOptions.delegate;var n=this.oFormatOptions.payload;var s=i?i.getTypeUtil(n).getBaseType(t,a,r):o.Date;return s}return v});
//# sourceMappingURL=DynamicDateRangeConditionsType.js.map