/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseContent","./WebPageContentRenderer","sap/ui/core/Core","sap/ui/integration/util/BindingHelper"],function(e,t,i,r){"use strict";var o="_frameLoaded";var n=15*1e3;var a=i.getLibraryResourceBundle("sap.ui.integration");var s=e.extend("sap.ui.integration.cards.WebPageContent",{metadata:{properties:{minHeight:{type:"sap.ui.core.CSSSize",defaultValue:t.MIN_WEB_PAGE_CONTENT_HEIGHT,bindable:true},src:{type:"sap.ui.core.URI",defaultValue:"",bindable:true},sandbox:{type:"string",defaultValue:"",bindable:true}},library:"sap.ui.integration"},renderer:t});s.prototype.init=function(){e.prototype.init.apply(this,arguments);this._onFrameLoadedBound=this._onFrameLoaded.bind(this);this._sPrevSrc=this.getSrc()};s.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this._iLoadTimeout){clearTimeout(this._iLoadTimeout)}};s.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);if(this.getDomRef()){this.getDomRef("frame").removeEventListener("load",this._onFrameLoadedBound)}};s.prototype.onAfterRendering=function(){e.prototype.onAfterRendering.apply(this,arguments);this.getDomRef("frame").addEventListener("load",this._onFrameLoadedBound);this._checkSrc()};s.prototype.setConfiguration=function(t){e.prototype.setConfiguration.apply(this,arguments);t=this.getParsedConfiguration();this.fireEvent("_actionContentReady");if(!t){return this}var i=r.formattedProperty(t.src,function(e){return this._oIconFormatter.formatSrc(e)}.bind(this));if(i){this.bindSrc(i)}if(typeof t.sandbox==="object"){this.bindSandbox(r.reuse(t.sandbox))}else{this.setSandbox(t.sandbox)}if(typeof t.minHeight==="object"){this.bindMinHeight(r.reuse(t.minHeight))}else{this.setMinHeight(t.minHeight)}return this};s.prototype._checkSrc=function(){var e=this.getSrc();if(e===""){this.handleError("Src of WebPage content is empty",a.getText("CARD_WEB_PAGE_EMPTY_URL_ERROR"));return}if(!e.startsWith("https://")){this.handleError("Please use a secure URL (https://)",a.getText("CARD_WEB_PAGE_HTTPS_URL_ERROR"));return}if(this._sPrevSrc!==e){this._raceFrameLoad();this._sPrevSrc=e}};s.prototype._raceFrameLoad=function(){this.awaitEvent(o);this._iLoadTimeout=setTimeout(function(){var e=n/1e3;this.handleError("Failed to load '"+this.getSrc()+"' after "+e+" seconds.",a.getText("CARD_WEB_PAGE_TIMEOUT_ERROR",[e]))}.bind(this),n)};s.prototype._onFrameLoaded=function(){this.fireEvent(o);clearTimeout(this._iLoadTimeout)};return s});
//# sourceMappingURL=WebPageContent.js.map