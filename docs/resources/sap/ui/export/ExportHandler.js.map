{"version":3,"file":"ExportHandler.js","names":["sap","ui","define","library","ExportUtils","ExportDialog","MessageToast","Core","EventProvider","ODataModel","openWindow","Destination","FileType","ExportHandler","extend","constructor","mCapabilities","that","this","call","_mCapabilities","Object","XLSX","_initialized","Promise","fnResolve","isGoogleSheetSupported","then","bSupported","GSHEET","_mDialogSettings","destination","REMOTE","fileType","finally","prototype","attachBeforeExport","oData","fnHandler","oListener","attachEvent","detachBeforeExport","detachEvent","initialized","destroy","apply","arguments","_oModel","_oFileShareBinding","_oExportDialog","_oFilePicker","_oDataSource","bIsDestroyed","getFileShareContexts","getFileShareModel","oModel","resolve","bindList","requestContexts","bind","getRemoteFileLocation","sFileName","fnReject","all","getResourceBundle","aResolve","oResourceBundle","require","CloudFilePicker","oFilePicker","sharedModel","suggestedFileName","enableDuplicateCheck","fileNameMandatory","confirmButtonText","getText","title","attachSelect","oEvent","aSelectedFiles","oSelectedFolder","bReplaceFile","mCloudFileInfo","getParameter","getFileShareId","getFileShareItemId","Array","isArray","length","oCloudFile","shift","open","getExportInstance","mExportSettings","mCustomSettings","oExportInstance","mEventExportSettings","fireEvent","exportSettings","userExportSettings","attachBeforeSave","aArrayBuffer","oExportDialog","getMimeType","uInt8Array","Uint8Array","stringArray","i","String","fromCharCode","btoa","join","updateStatus","preventDefault","uploadFile","show","catch","showErrorMessage","finish","oBinding","oContext","sContentProperty","sTypeProperty","sPath","getKeepAliveContext","FileShare","FileShareItem","setProperty","getProperty","ParentFileShareItem","_createFile","sUrl","fnCreateCompleted","bSuccess","detachCreateCompleted","attachCreateCompleted","create","export","reject","build","exportAs","oSettings","fnResolveColumnLabel","mUserSettings","assign","aContexts","getExportSettingsViaDialog","oDialog","mDialogSettings","validateFileSettings","splitCells","includeFilterSettings","PDF","workbook","columns","splitColumns","parseFilterConfiguration","dataSource","oFilterConfig","context","metaSheetName","name","metainfo","push","parseTechnicalConfiguration","aUserConfig","forEach","oUserConfig","unshift","LOCAL","fileName","FileShareItemName","validateFileName","validateFileShare","oFileShareContext","find","isGoogleWorkspace","fetchDataSource","oDataSource","serviceUrl","uri","synchronizationMode","autoExpandSelect","some","sDescription","sVendorType","URL","window","location","href","search","indexOf"],"sources":["ExportHandler-dbg.js"],"mappings":"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"}