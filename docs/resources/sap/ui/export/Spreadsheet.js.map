{"version":3,"file":"Spreadsheet.js","names":["sap","ui","define","Core","ExportDialog","ExportBase","Device","SpreadsheetExport","Log","ExportUtils","CLASS_NAME","Spreadsheet","extend","constructor","mSettings","call","this","_mSettings","customizing","showProgress","worker","forEach","sProperty","bind","codeListsPromise","Promise","resolve","addUnit","sCurrencyCode","oCurrency","mCurrencies","Object","isNaN","digits","scale","UnitSpecificScale","prototype","setDefaultExportSettings","mParameters","mCurrencySettings","mUnitSettings","currency","oCustomCurrencies","getConfiguration","getFormatSettings","getCustomCurrencies","then","aCodeLists","mCurrencyCodes","mUnitsOfMeasure","sUnitCode","Array","isArray","unit","getLibraryResourceBundle","oResourceBundle","oWorkbookContext","workbook","context","title","getText","sheetName","requestCodeLists","oMetaModel","isA","all","requestCurrencyCodes","requestUnitsOfMeasure","catch","oError","warning","attachBeforeSave","oData","fnHandler","oListener","attachEvent","detachBeforeSave","detachEvent","cancel","process","getMimeType","onprogress","iFetched","iTotal","iProgress","Math","round","debug","createDataSourceFromBinding","oBinding","oDataSource","aData","getModel","getProperty","getPath","data","type","error","getMetadata","getName","getDownloadUrl","oModel","sDataUrl","sServiceUrl","bV4ODataModel","interceptUrl","dataUrl","serviceUrl","headers","getHttpHeaders","getHeaders","count","getCountFromBinding","useBatch","bUseBatch","getMetaModel","processDataSource","mDataSource","sDataSourceType","createBuildPromise","that","fnResolve","fnReject","progressDialog","MAX_ROWS","nSizeLimit","system","desktop","nRows","dataSource","length","nColumns","columns","onmessage","oMessage","progress","updateStatus","fetched","total","finished","spreadsheet","executeDefaultAction","fireEvent","exportDialog","window","setTimeout","finish","saveAsFile","Blob","fileName","sError","message","showErrorMessage","startExport","execute","getProgressDialog","oDialogResolve","oncancel","open","oDialogSettings","rows","sizeLimit","cutOff","showWarningDialog"],"sources":["Spreadsheet-dbg.js"],"mappings":"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"}