/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/Control","sap/ui/core/Popup","./library","./OverlayRenderer","sap/ui/core/library","sap/ui/dom/jquery/control","sap/ui/dom/jquery/Focusable"],function(jQuery,t,e,o,i,s){"use strict";var n=s.OpenState;var r=t.extend("sap.ui.ux3.Overlay",{metadata:{deprecated:true,interfaces:["sap.ui.core.PopupInterface"],library:"sap.ui.ux3",properties:{openButtonVisible:{type:"boolean",group:"Misc",defaultValue:true},closeButtonVisible:{type:"boolean",group:"Misc",defaultValue:true}},events:{close:{allowPreventDefault:true,parameters:{id:{type:"string"}}},closed:{allowPreventDefault:true,parameters:{id:{type:"string"}}},openNew:{parameters:{id:{type:"string"}}},open:{parameters:{id:{type:"string"}}}}}});r.prototype.init=function(){var t=this;this._oPopup=new e(this,false,true);this._oPopup.attachOpened(function(e){var o=jQuery(document.getElementById(t._initialFocusId))[0];if(!o&&t._getShell()&&t.getOpenButtonVisible()){o=document.getElementById(t._getOpenButtonId())}else if(!o&&t._getShell()&&t.getCloseButtonVisible()){o=document.getElementById(t._getCloseButtonId())}else if(!o){o=t.$("content").firstFocusableDomRef()}if(!o){o=t.$().firstFocusableDomRef()}if(o){o.focus()}});this._oPopup.attachClosed(function(e){t.fireClosed({id:t.getId()})});this._overridePopupEventing()};r.prototype._overridePopupEventing=function(){this._oPopup.onmousedown=function(t){return}};r.prototype._getShell=function(){var t=jQuery(".sapUiUx3Shell").control();if(t.length>0&&!this._oShell){this._oShell=t.length?t[0]:null}return this._oShell};r.prototype._getCloseButtonId=function(){return this.getId()+"-close"};r.prototype._getOpenButtonId=function(){return this.getId()+"-openNew"};r.prototype._initDom=function(t,e,o){var i=jQuery(".sapUiUx3Shell").control();this._oShell=i.length?i[0]:null;i=this._oShell;this.$().css("position","fixed");if(i){this._bFocusEventsRegistered=true;i.syncWithCanvasSize(this.getId(),true,t,e,o);this.$("firstFocusDummyPaneFw").attr("tabindex","0").on("focusin",jQuery.proxy(i.focusFirstHdr,i));this.$("firstFocusDummyPaneBw").attr("tabindex","0").on("focusin",jQuery.proxy(i.focusLastTool,i));this.$("LastFocusDummyPane").attr("tabindex","0").on("focusin",jQuery.proxy(i.focusPaneStart,i))}else{this.$().css("bottom","0").css("top","0").css("left","0").css("right","0")}};r.prototype._cleanupDom=function(){if(this._oShell){this._oShell.syncWithCanvasSize(this.getId(),false)}if(this._bFocusEventsRegistered){this._bFocusEventsRegistered=false;this.$("firstFocusDummyPaneFw").removeAttr("tabindex").off("focusin");this.$("firstFocusDummyPaneBw").removeAttr("tabindex").off("focusin");this.$("LastFocusDummyPane").removeAttr("tabindex").off("focusin")}};r.prototype.onAfterRendering=function(){var t=this._oPopup.getOpenState();if(t===n.OPEN||t===n.OPENING){this._initDom(jQuery.proxy(this._setFocusFirst,this),jQuery.proxy(this._setFocusLast,this),jQuery.proxy(this._applyChanges,this))}};r.prototype.onBeforeRendering=function(){};r.prototype.exit=function(){this.close();this._oPopup.destroy();this._oPopup=null;this._oShell=null};r.prototype.open=function(t){this._initialFocusId=t;if(this._oPopup.isOpen()){return}if(t){this._oPopup.setInitialFocusId(t)}this._oPreviousFocus=e.getCurrentFocusInfo();this._oPopup.open(400);this._initDom(jQuery.proxy(this._setFocusFirst,this),jQuery.proxy(this._setFocusLast,this),jQuery.proxy(this._applyChanges,this));this.fireOpen({id:this.getId()})};r.prototype.close=function(){if(!this._oPopup.isOpen()){return}this._oPopup.close(400);setTimeout(this.restorePreviousFocus.bind(this),400);this._cleanupDom()};r.prototype.onclick=function(t){this._handleButtonEvent(t)};r.prototype.onsapselect=function(t){this._handleButtonEvent(t)};r.prototype._handleButtonEvent=function(t){var e=t.target.id;if(e===this._getCloseButtonId()){if(this.fireClose({id:this.getId()})){this.close()}}else if(e===this._getOpenButtonId()){this.fireOpenNew({id:this.getId()})}};r.prototype._getText=function(t,e){var o=sap.ui.getCore().getLibraryResourceBundle("sap.ui.ux3");var i;if(o){i=o.getText(t)}if(i&&e){for(var s=0;s<e.length;s++){i=i.replace("{"+s+"}",e[s])}}return i?i:t};r.prototype._setFocusFirst=function(){var t=document.getElementById(this._getOpenButtonId());if(t){t.focus()}};r.prototype._setFocusLast=function(){var t=document.getElementById(this._getCloseButtonId());if(t){t.focus()}};r.prototype._applyChanges=function(t){return this};r.prototype.isOpen=function(){return this._oPopup.isOpen()};r.prototype.restorePreviousFocus=function(){e.applyFocusInfo(this._oPreviousFocus)};return r});
//# sourceMappingURL=Overlay.js.map