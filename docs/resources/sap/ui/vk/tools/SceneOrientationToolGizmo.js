/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./Gizmo","sap/m/MenuButton","sap/m/Menu","sap/m/MenuItem","../thirdparty/three","./SceneOrientationToolGizmoRenderer","../getResourceBundle","./PredefinedView","./AxisColours"],function(e,t,i,a,n,r,s,o,l){"use strict";sap.ui.require("sap.m.Menu");var E=e.extend("sap.ui.vk.tools.SceneOrientationToolGizmo",{metadata:{library:"sap.ui.vk"}});function c(e,t){var i=64,a=.5,n=15,r=3,s=29,o=30;e.multiplyScalar(1/80);var l=new THREE.Vector3(e.y,e.z,e.x),E=new THREE.Vector3(e.z,e.x,e.y);var c=new THREE.MeshLambertMaterial({color:t}),p=new THREE.MeshBasicMaterial({color:16777215,transparent:true,opacity:.8}),d=new THREE.MeshBasicMaterial({color:0,transparent:true,opacity:.8});var h=new THREE.CylinderBufferGeometry(a,a,i-n,4);var u=(new THREE.Matrix4).makeBasis(l,e,E).setPosition(e.clone().multiplyScalar((i-n)*.5));h.applyMatrix4(u);var m=new THREE.Mesh(h,c);var T=new THREE.CylinderBufferGeometry(0,r,n,12,1);u.setPosition(e.clone().multiplyScalar(i-n*.5));T.applyMatrix4(u);m.add(new THREE.Mesh(T,c));var w=new THREE.CylinderBufferGeometry(a,a,s,4);u.makeBasis(e,E,l).setPosition(E.clone().multiplyScalar(.5).add(e).multiplyScalar(s));w.applyMatrix4(u);m.add(new THREE.Mesh(w,p));w=new THREE.CylinderBufferGeometry(a,a,s,4);u.setPosition(E.clone().multiplyScalar(.5).add(e).add(l).multiplyScalar(s));w.applyMatrix4(u);m.add(new THREE.Mesh(w,p));w=new THREE.CylinderBufferGeometry(a,a,s,4);u.makeBasis(E,l,e).setPosition(l.clone().multiplyScalar(.5).add(e).multiplyScalar(s));w.applyMatrix4(u);m.add(new THREE.Mesh(w,p));w=new THREE.CylinderBufferGeometry(a,a,o,4);u.makeBasis(e,E,l).setPosition(E.clone().multiplyScalar(.5).add(e).multiplyScalar(o));w.applyMatrix4(u);m.add(new THREE.Mesh(w,d));w=new THREE.CylinderBufferGeometry(a,a,o,4);u.setPosition(E.clone().multiplyScalar(.5).add(e).add(l).multiplyScalar(o));w.applyMatrix4(u);m.add(new THREE.Mesh(w,d));w=new THREE.CylinderBufferGeometry(a,a,o,4);u.makeBasis(E,l,e).setPosition(l.clone().multiplyScalar(.5).add(e).multiplyScalar(o));w.applyMatrix4(u);m.add(new THREE.Mesh(w,d));return m}E.prototype.init=function(){if(e.prototype.init){e.prototype.init.apply(this)}this._enableInitialView=true;this._viewport=null;this._renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});this._renderer.setPixelRatio(window.devicePixelRatio);this._renderer.setSize(1,1);this._camera=new THREE.OrthographicCamera(-1,1,1,-1,.1,100);this._scene=new THREE.Scene;var n=new THREE.DirectionalLight(16777215,.5);n.position.set(1,3,2);this._scene.add(n);this._scene.add(new THREE.AmbientLight(16777215,.5));this._scene.add(c(new THREE.Vector3(1,0,0),l.x));this._scene.add(c(new THREE.Vector3(0,1,0),l.y));this._scene.add(c(new THREE.Vector3(0,0,1),l.z));this._scene.traverse(function(e){e.matrixAutoUpdate=false});this._axisTitles=this._createAxisTitles(32,16);this._scene.add(this._axisTitles);var r=[o.Initial,o.Front,o.Back,o.Left,o.Right,o.Top,o.Bottom];this._menu=new i({items:[new a({text:s().getText("PREDEFINED_VIEW_INITIAL")}),new a({text:s().getText("PREDEFINED_VIEW_FRONT")}),new a({text:s().getText("PREDEFINED_VIEW_BACK")}),new a({text:s().getText("PREDEFINED_VIEW_LEFT")}),new a({text:s().getText("PREDEFINED_VIEW_RIGHT")}),new a({text:s().getText("PREDEFINED_VIEW_TOP")}),new a({text:s().getText("PREDEFINED_VIEW_BOTTOM")})]}).attachItemSelected(function(e){var t=e.getParameters("item").item;var i=e.getSource().indexOfItem(t);this.setView(r[i],1e3)},this);this._button=new t({icon:"sap-icon://vk-icons/predefined-views",tooltip:s().getText("PREDEFINED_VIEW_MENUBUTTONTOOLTIP"),menu:this._menu}).addStyleClass("sapUiVizKitSceneOrientationGizmoButton").addStyleClass("sapUiSizeCompact")};E.prototype.setView=function(e,t){var i;switch(e){case o.Initial:i=null;break;case o.Front:i=(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,1,0),0);break;case o.Back:i=(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,1,0),Math.PI);break;case o.Left:i=(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,1,0),-Math.PI/2);break;case o.Right:i=(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,1,0),Math.PI/2);break;case o.Top:i=(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(1,0,0),-Math.PI/2);break;case o.Bottom:i=(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(1,0,0),Math.PI/2);break;default:return this}this._viewport._viewportGestureHandler.setView(i,t||0);return this};E.prototype.setEnableInitialView=function(e){this._enableInitialView=e;var t=this._menu.getItems();t[0].setVisible(e);t[1].setStartsSection(e)};E.prototype.render=function(e){this._viewport=e;this._camera.quaternion.copy(e.getCamera().getCameraRef().quaternion);this._camera.position.set(0,0,1).applyQuaternion(this._camera.quaternion);var t=this._renderer.getSize(new THREE.Vector2).x;this._updateAxisTitles(this._axisTitles,this._scene,this._camera,t*.45,2/t);this._renderer.render(this._scene,this._camera)};E.prototype.onBeforeRendering=function(){};E.prototype.onAfterRendering=function(){var e=this.getDomRef();this._renderer.setSize(e.clientWidth,e.clientHeight);e.appendChild(this._renderer.domElement)};E.prototype.exit=function(){if(this._axisTitles){if(this._scene){this._scene.remove(this._axisTitles)}this._axisTitles=null}if(this._camera){if(this._scene){this._scene.remove(this._camera)}this._camera=null}if(this._scene){this._scene.dispose();this._scene=null}e.prototype.exit.call(this)};return E});
//# sourceMappingURL=SceneOrientationToolGizmo.js.map