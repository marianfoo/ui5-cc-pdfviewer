{"version":3,"file":"ViewportGestureHandler.js","names":["sap","ui","define","Log","EventProvider","PerspectiveCamera","OrthographicCamera","threeJs","getResourceBundle","NodeContentType","ViewportGestureHandler","extend","metadata","library","constructor","viewport","this","_matProj","_viewport","_rect","_evt","x","y","z","d","initd","_gesture","attachEvent","_onresize","_nomenu","ThreeJsCameraController","vp","gestureTarget","THREE","Vector3","zoomTarget","Vector2","ANGLE_EPSILON","MIN_PITCH","Math","PI","MAX_PITCH","isTurnTableMode","_timeIntervalForCameraAnimation","_startTimeForCameraAnimation","_newCamera","_oldCamera","_animationType","_zoomedNodeRef","_isZoomIn","beginGesture","scene","getScene","sceneRef","getSceneRef","camera","getCamera","getCameraRef","size","getRenderer","getSize","width","height","_gesturePoint","hit","userData","isRedlineActivated","hitTest","copy","point","boundingBox","Box3","_expandBoundingBox","isEmpty","getCenter","setScalar","endGesture","pan","dx","dy","getFreezeCamera","_redlineHandler","_isPanoramicActivated","rotate","view","enabled","offsetX","fullWidth","offsetY","fullHeight","updateProjectionMatrix","offset","clone","project","unproject","sub","position","add","updateMatrixWorld","fireCameraChanged","toArray","upDirs","_isPlanarActivated","undefined","scale","viewportSize","projectionMatrix","elements","deltaYaw","deltaPitch","origin","lookDir","upDir","setFromMatrixColumn","matrixWorld","normalize","rightDir","getWorldDirection","rotationX","Quaternion","rotationY","sceneUpDir","_upAxis","crossVectors","pitch","atan2","sqrt","setFromAxisAngle","clamp","multiply","applyQuaternion","up","lookAt","quaternion","zoom","zoomFactorScaler","delta","zoomOutLimit","boundingBoxSize","ignoreDynamicObjects","getBackgroundProjection","applyMatrix4","matrixWorldInverse","min","max","near","viewpostSize","sx","sy","redlineHandler","_zoomFactor","getDomRef","clientWidth","clientHeight","f","isPerspectiveCamera","fov","pow","set","moveDistance","length","setLength","isOrthographicCamera","multiplyScalar","error","getText","params","animateCameraUpdate","smootherStep","edge0","edge1","interpolateCoeff","Date","now","oldWidth","oldHeight","oldCX","oldCY","lerp","newCX","newCY","left","right","top","bottom","_transitionEffect","zoomInZoom","zoomInFOV","far","lerpVectors","oldDirection","newDirection","targetDirection","fireNodeZoomed","zoomed","isZoomIn","cameraUpdateCompleted","startCameraAnimation","timeInterval","transitionEffect","lookAtObject","nodeRef","_vkGetNodeContentType","Background","prepareForCameraUpdateAnimation","getWorldPosition","zoomObject","isIn","Symbol","setFromObject","margin","zoomBox","_vkZoomTo","startAnimatingCameraUpdate","pauseWhenNoCameraChange","notEqualCamera","tolerance","abs","aspect","w","_cameraController","prototype","_activateRedline","domRef","setViewOffset","_deactivateRedline","cameraRef","clearViewOffset","destroy","_getOffset","obj","rectangle","getBoundingClientRect","p","window","pageXOffset","pageYOffset","_inside","event","id","getIdForLabel","domobj","document","getElementById","o","offsetWidth","h","offsetHeight","avgd","avgx","avgy","debug","handled","activeElement","blur","e","focus","move","dd","n","points","avgdist","click","buttons","tap","doubleClick","contextMenu","keyEventHandler","getViewport","activateCamera","realTimeInterval","vkCamera","setCamera","update","setView","_homeCamera","zoomTo"],"sources":["ViewportGestureHandler-dbg.js"],"mappings":"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"}