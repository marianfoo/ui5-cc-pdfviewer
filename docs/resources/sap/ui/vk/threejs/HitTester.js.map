{"version":3,"file":"HitTester.js","names":["sap","ui","define","Log","three","HitTester","this","_maskMaterial","THREE","MeshBasicMaterial","side","DoubleSide","fog","_depthMaterial","ShaderMaterial","vertexShader","join","fragmentShader","clipping","_renderTarget","WebGLRenderTarget","minFilter","NearestFilter","magFilter","texture","generateMipmaps","depthBuffer","testCamera","matViewProj","Matrix4","frustum","Frustum","inverseMatrix","screenPos","Vector2","raycaster","Raycaster","ray","Ray","sphere","Sphere","objects","data","Uint8Array","point","Vector3","getMeshNode","object","parent","userData","closed","skipIt","prototype","hitTest","x","y","width","height","renderer","scene","camera","clippingPlanes","options","constructor","copy","view","w","h","setViewOffset","fullWidth","fullHeight","offsetX","offsetY","updateMatrixWorld","updateProjectionMatrix","multiplyMatrices","projectionMatrix","matrixWorldInverse","setFromProjectionMatrix","setFromCamera","set","gl","getContext","rBits","Math","min","getParameter","RED_BITS","gBits","GREEN_BITS","bBits","BLUE_BITS","rgBits","rMask","gMask","bMask","rMaskInv","gMaskInv","bMaskInv","maskMaterial","oldClearColor","getClearColor","clone","oldClearAlpha","getClearAlpha","oldAutoClear","autoClear","setRenderTarget","setClearColor","clear","color","index","length","underlayObjects","ignoreUnderlay","regularObjects","overlayObjects","ignoreOverlay","traverseVisible","node","renderStage","visible","geometry","material","intersectsObject","matrixWorld","boundingSphere","computeBoundingSphere","applyMatrix4","intersectsSphere","getInverse","boundingBox","intersectsBox","push","children","i","l","renderObject","setRGB","render","forEach","clearDepth","readRenderTargetPixels","z","projectionMatrixInverse","distance","origin","distanceTo","hitTestPrecise","pi","plane","dist","distanceToPoint","t","normal","dot","direction","near","max","far","intersects","intersectObjects","Infinity","result","isBillboard","isDetailView","hitTestPoint"],"sources":["HitTester-dbg.js"],"mappings":"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"}