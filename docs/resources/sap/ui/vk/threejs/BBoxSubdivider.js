/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define([],function(){"use strict";var t=function(){this.unpack=function(t){if(!t||t.bytelength<1){return false}try{this.nLevel=t[0];if(this.nLevel>5){return false}this.numDivision=Math.pow(2,this.nLevel);this.octree=new Uint8Array(Math.pow(this.numDivision,3));this.streamOffset=1;this._decodeRecursive(t,0,0,0,0)}catch(t){return false}return true};this.getUnpacked=function(){return this.octree};this._setValue=function(t,e,i,r){this.octree[i*this.numDivision*this.numDivision+e*this.numDivision+t]=r?1:0};this._decodeRecursive=function(t,e,i,r,n){if(n===this.nLevel){this._setValue(e,i,r,true);return true}if(this.streamOffset>=t.length){return false}var s=t[this.streamOffset];this.streamOffset++;e*=2;i*=2;r*=2;if(n>=this.nLevel){return true}for(var u=0;u<2;u++){for(var o=0;o<2;o++){for(var a=0;a<2;a++){if((s&1<<u*4+o*2+a)!==0){if(!this._decodeRecursive(t,e+a,i+o,r+u,n+1)){return false}}else{this._clearBitsRecursive(e+a,i+o,r+u,n+1)}}}}return true};this._clearBitsRecursive=function(t,e,i,r){if(r===this.nLevel){this._setValue(t,e,i,false);return}t*=2;e*=2;i*=2;if(r>=this.nLevel){return}for(var n=0;n<2;n++){for(var s=0;s<2;s++){for(var u=0;u<2;u++){this._clearBitsRecursive(t+u,e+s,i+n,r+1)}}}}};var e=function(t){this.numDivision=t;this.xyzToIndexMap=new Map;this.points=[];this.getOrCreatePointAt=function(t,e,i,r,n){var s=t+":"+e+":"+i+":"+r+":"+n;var u=this.xyzToIndexMap.get(s);if(u){return u}this.points.push(t/this.numDivision-.5,e/this.numDivision-.5,i/this.numDivision-.5);u=this.points.length/3-1;this.xyzToIndexMap.set(s,u);return u}};var i=function(t,e,i){this.level=t;this.numDivision=e;this.unpacked=i;this.getValue=function(t,e,i){if(t<0||e<0||i<0||t>=this.numDivision||e>=this.numDivision||i>=this.numDivision){return 0}return this.unpacked[i*this.numDivision*this.numDivision+e*this.numDivision+t]}};var r=function(){};r.unpackSubDividedBoundingBox=function(e){var r=new t;if(r.unpack(e)){return new i(r.nLevel,r.numDivision,r.getUnpacked())}return null};r.makeSubDividedBoundingBoxGeometry=function(t){if(!t){return null}var i=[];var r=t.level;var n=Math.pow(2,r);var s=new e(n);var u,o,a,h,f,v,l,c;for(u=0;u<=n;u++){for(o=0;o<n;o++){for(a=0;a<n;a++){h=t.getValue(u,o,a)-t.getValue(u-1,o,a);if(h!==0){f=s.getOrCreatePointAt(u,o,a,0,h);v=s.getOrCreatePointAt(u,o+1,a,0,h);l=s.getOrCreatePointAt(u,o+1,a+1,0,h);c=s.getOrCreatePointAt(u,o,a+1,0,h);if(h<0){i.push(f,v,l);i.push(f,l,c)}else{i.push(l,v,f);i.push(c,l,f)}}}}}for(o=0;o<=n;o++){for(u=0;u<n;u++){for(a=0;a<n;a++){h=t.getValue(u,o,a)-t.getValue(u,o-1,a);if(h!==0){f=s.getOrCreatePointAt(u,o,a,1,h);v=s.getOrCreatePointAt(u+1,o,a,1,h);l=s.getOrCreatePointAt(u+1,o,a+1,1,h);c=s.getOrCreatePointAt(u,o,a+1,1,h);if(h>0){i.push(f,v,l);i.push(f,l,c)}else{i.push(l,v,f);i.push(c,l,f)}}}}}for(a=0;a<=n;a++){for(u=0;u<n;u++){for(o=0;o<n;o++){h=t.getValue(u,o,a)-t.getValue(u,o,a-1);if(h!==0){f=s.getOrCreatePointAt(u,o,a,2,h);v=s.getOrCreatePointAt(u+1,o,a,2,h);l=s.getOrCreatePointAt(u+1,o+1,a,2,h);c=s.getOrCreatePointAt(u,o+1,a,2,h);if(h<0){i.push(f,v,l);i.push(f,l,c)}else{i.push(l,v,f);i.push(c,l,f)}}}}}var p=new THREE.BufferGeometry;var g=new THREE.BufferAttribute(new Uint16Array(i),1);var m=new THREE.BufferAttribute(new Float32Array(s.points),3);p.setIndex(g);p.setAttribute("position",m);p.computeFaceNormals();p.computeVertexNormals();p.computeBoundingSphere();return p};return r});
//# sourceMappingURL=BBoxSubdivider.js.map