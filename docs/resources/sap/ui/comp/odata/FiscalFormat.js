/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/base/Object","sap/ui/core/LocaleData"],function(t,e){"use strict";var r=t.extend("sap.ui.comp.odata.FiscalFormat",{metadata:{library:"sap.ui.comp"},constructor:function(r,o){t.call(this,r,o);var a,s,n,i,p=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale(),f=e.getInstance(p),u=sap.ui.getCore().getConfiguration().getFormatSettings().getCustomLocaleData(),l=/(m|y)(?:.*)(\W)(m|y)/i,m=u["dateFormats-short"];this.oFormatOptions=o;if(this.oFormatOptions.format.length>4){a="yM"}else if(this.oFormatOptions.format==="PPP"){a="M"}else{a=this.oFormatOptions.format}if(m&&a==="yM"){i=m.match(l).splice(1).join("");if(i){s=i}}else{s=f.getCustomDateTimePattern(a,this.oFormatOptions.calendarType)}s=s.replace(/([\u4e00-\u9faf\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uffef])+/gi,"");if(this.oFormatOptions.format.length>4){s=s.replace(/y+/i,this.oFormatOptions.format.slice(0,this.oFormatOptions.format.lastIndexOf("Y")+1));s=s.replace(/m+/i,this.oFormatOptions.format.slice(this.oFormatOptions.format.lastIndexOf("Y")+1))}else if(this.oFormatOptions.format==="PPP"){s="PPP"}n=this.parseCldrDatePattern(s);this.oFormatOptions.pattern=n.length>1?s:"";this._setFormatRegex(n);this._setParseRegex(n);this._setValidationRegex(n)}});r.getDateInstance=function(t){return new r(null,t)};r.prototype.getPattern=function(){return this.oFormatOptions.pattern};r.prototype.getRegExPattern=function(){return this.sFormatRegExPattern};r.prototype.getTemplate=function(){return this.sFormatRegExGroups};r.prototype._setFormatRegex=function(t){var e=[],r=[],o,a,s,n,i;for(i=0;i<t.length;i++){o=t[i];a=o.symbol||"";s=this.oSymbols[a].format;if(a===""){r[i]=o.value}else if(a==="y"||a==="Y"){e.unshift("("+s.source+")");r[i]="$"+1}else{e.push("("+s.source+")");n=t.some(function(t){return t.symbol==="y"||t.symbol==="Y"});r[i]=n?"$"+2:"$"+1}}this.sFormatRegExPattern=new RegExp(e.join(""));this.sFormatRegExGroups=r.join("")};r.prototype._setParseRegex=function(t){var e,r,a,s,n,i=[],p={},f=0;for(s=0;s<t.length;s++){e=t[s];r=e.symbol||"";a=this.oSymbols[r].parse;if(r===""){i.push("\\D+?")}else{i.push("("+a.source+")");n=++f;p[n]=e}}this.sParseRegExPattern=new RegExp("^"+i.join("")+"$");this.fnParseRegExReplacer=function(){var t,e,r=[];for(var a in p){t=p[a];e=arguments[a];if(e.length<t.digits){if(t.symbol==="y"||t.symbol==="Y"){e=o(e)}else{e=e.padStart(t.digits,"0")}}if(t.symbol==="y"||t.symbol==="Y"){r.unshift(e)}else{r.push(e)}}return r.join("")}};r.prototype._setValidationRegex=function(t){var e,r,o,a,s=[];for(e=0;e<t.length;e++){r=t[e];o=r.symbol||"";a=this.oSymbols[o].format;if(o===""){continue}else if(o==="y"||o==="Y"){s.unshift(a.source)}else{s.push(a.source)}}this.sValidationRegExPattern=new RegExp("^("+s.join(")(")+")$")};r.prototype.parseCldrDatePattern=function(t){var e,r,o,a,s=[];for(e=0;e<t.length;e++){r=t[e];if(o!==r){a={}}else{a.digits+=1;continue}if(typeof this.oSymbols[r]==="undefined"){a.value=r;a.type="text"}else{a.symbol=r;a.digits=1}o=r;s.push(a)}return s};r.prototype.format=function(t){if(t==null){return""}return t.replace(this.sFormatRegExPattern,this.sFormatRegExGroups)};r.prototype.parse=function(t){if(t){return t.replace(this.sParseRegExPattern,this.fnParseRegExReplacer)}return null};r.prototype.validate=function(t){return this.sValidationRegExPattern.test(t)};r.oRegexFormatPatterns={year:/[1-9][0-9]{3}/,period:/[0-9]{3}/,quarter:/[1-4]/,week:/0[1-9]|[1-4][0-9]|5[0-3]/,day:/371|370|3[0-6][0-9]|[1-2][0-9][0-9]|[1-9][0-9]|[1-9]/};r.oRegexParsePatterns={year:/[0-9]{1,4}/,period:/[0-9]{1,3}/,quarter:/[1-4]/,week:/[0-9]{1,2}/,day:/[1-9]/};r.prototype.oSymbols={"":"",y:{format:r.oRegexFormatPatterns.year,parse:r.oRegexParsePatterns.year},Y:{format:r.oRegexFormatPatterns.year,parse:r.oRegexParsePatterns.year},P:{format:r.oRegexFormatPatterns.period,parse:r.oRegexParsePatterns.period},W:{format:r.oRegexFormatPatterns.week,parse:r.oRegexParsePatterns.week},d:{format:r.oRegexFormatPatterns.day,parse:r.oRegexParsePatterns.day},Q:{format:r.oRegexFormatPatterns.quarter,parse:r.oRegexParsePatterns.quarter},q:{format:r.oRegexFormatPatterns.quarter,parse:r.oRegexParsePatterns.quarter}};r.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);if(this._oAnnotationValidationRegexPattern){this._oAnnotationValidationRegexPattern=null}};function o(t){var e,r=Number.parseInt(t),o=(new Date).getUTCFullYear(),a=Math.floor(o/100);e=a*100+r-o;if(t.length===3){r+=Math.floor((a-1)/10)*1e3}else if(e<-70){r+=(a+1)*100}else if(e<30){r+=a*100}else{r+=(a-1)*100}return r}return r});
//# sourceMappingURL=FiscalFormat.js.map