/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/comp/util/DateTimeUtil","sap/m/DateTimePicker","sap/m/Select","sap/ui/core/Item","sap/m/ComboBox","sap/m/DatePicker","sap/m/DateRangeSelection","sap/m/TimePicker","sap/m/Input","sap/m/MultiComboBox","sap/ui/comp/smartfilterbar/SFBMultiInput","sap/ui/comp/smartfilterbar/SortingUtil","sap/m/SearchField","sap/m/Token","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/providers/ValueHelpProvider","sap/ui/comp/providers/ValueListProvider","sap/ui/model/json/JSONModel","sap/ui/comp/odata/ODataType","sap/ui/comp/util/FormatUtil","sap/ui/base/EventProvider","sap/ui/comp/util/IdentifierUtil","sap/ui/comp/providers/TokenParser","sap/ui/core/format/DateFormat","sap/ui/comp/library","sap/ui/core/library","sap/ui/model/analytics/odata4analytics","sap/ui/model/FilterOperator","sap/base/Log","sap/base/util/UriParameters","sap/base/security/encodeURL","sap/base/util/merge","sap/ui/comp/smartfilterbar/FilterProviderUtils","sap/ui/comp/filterbar/VariantConverterFrom"],function(e,t,i,a,r,n,l,o,s,d,u,f,h,p,m,c,_,g,y,F,D,v,T,V,A,S,C,M,P,N,E,I,B,b,w){"use strict";var x=S.smartfilterbar.ControlType;var O=S.smartfilterbar.DisplayBehaviour;var L=S.smartfilterbar.FilterType;var R=C.ValueState;var k=S.smartfilterbar.MandatoryType;var H=function(e){this._bInitialized=false;this._bPending=true;this._bConsiderAnalyticalParameters=false;this._bAttachInitializedDone=false;this.aFilterAnnotations=[];if(e){this._sSmartContainerId=e.smartContainerId;this._sContext=e.context;this._oParentODataModel=e.model;this._sServiceURL=e.serviceUrl;this._sBasicSearchFieldName=e.basicSearchFieldName;this._isBasicSearchEnabled=e.enableBasicSearch;this._bUseContainsAsDefault=e.useContainsAsDefaultFilter==="true";this.sEntityType=e.entityType;this.sEntitySet=e.entitySet;this._isRunningInValueHelpDialog=e.isRunningInValueHelpDialog;this._oAdditionalConfiguration=e.additionalConfiguration;this.sDefaultDropDownDisplayBehaviour=e.defaultDropDownDisplayBehaviour;this.sDefaultTokenDisplayBehaviour=e.defaultTokenDisplayBehaviour;this.sDefaultSingleFieldDisplayBehaviour=e.defaultSingleFieldDisplayBehaviour;if(typeof e.dateFormatSettings==="string"){try{this._oDateFormatSettings=e.dateFormatSettings?JSON.parse(e.dateFormatSettings):undefined}catch(e){}}else{this._oDateFormatSettings=e.dateFormatSettings}if(!this._oDateFormatSettings){this._oDateFormatSettings={}}if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}this._oSmartFilter=e.smartFilter;this.filterBarClass=e.filterBarClass;this._bConsiderAnalyticalParameters=e.considerAnalyticalParameters;this._bUseDateRangeType=e.useDateRangeType;this._bConsiderSelectionVariants=e.considerSelectionVariants;this._aConsiderNavigations=e.considerNavigations;this._bSuppressValueListsAssociation=e.suppressValueListsAssociation}this.sFilterModelName=b.FILTER_MODEL_NAME;this._sBasicFilterAreaID=b.BASIC_FILTER_AREA_ID;this._aAnalyticalParameters=[];this._aFilterBarViewMetadata=[];this._oFilterBarViewMetadataExtend={};this._aFilterBarFieldNames=[];this._aFilterBarMultiValueFieldMetadata=[];this._aFilterBarSingleValueWithValueListFieldMetadata=[];this._aFilterBarDropdownFieldMetadata=[];this._aFilterBarStringDateFieldNames=[];this._aFilterBarDateFieldNames=[];this._aFilterBarTimeFieldNames=[];this._aFilterBarTimeIntervalFieldNames=[];this._aFilterBarDateTimeMultiValueFieldNames=[];this._aFilterBarStringFieldNames=[];this._aFilterBarDateTimeFieldNames=[];this._aFilterBarDateTimeOffsetWithTimezoneFieldNames=[];this._sSingleInputsTextArrangementData={};this._oNotValidatedSingleFields={};this._oSingleFieldSetFromFilterData={};this._aFieldGroupAnnotation=[];this._oMetadataAnalyser=new m(this._oParentODataModel||this._sServiceURL);this.oModel=new y;this._aValueListProvider=[];this._aValueHelpDialogProvider=[];this._mTokenHandler={};this._mConditionTypeFields={};this._aSelectionVariants=[];this._oParameterization=null;this._oNonAnaParameterization=null;this._aPromises=[]};H._createFilterProvider=function(e){var t=new H(e);return t._intialiseMetadata()};H.prototype._intialiseMetadata=function(){var e,t,i,a,r,n,l,o,s,d,u,f,h;this._aPromises=[];this._aFilterBarViewMetadata.push({groupName:this._sBasicFilterAreaID,index:0,fields:[]});if(!this.sEntitySet&&this.sEntityType){this.sEntitySet=this._oMetadataAnalyser.getEntitySetNameFromEntityTypeName(this.sEntityType)}this.sEntityType=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);n=this._oMetadataAnalyser.getAllFilterableFieldsByEntitySetName(this.sEntitySet,this._bConsiderAnalyticalParameters,this._aConsiderNavigations);this.aAllFields=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);if(n){this._updateDisplayBehaviour();this._aFieldGroupAnnotation=this._oMetadataAnalyser.getFieldGroupsByFilterFacetsAnnotation(this.sEntityType);a=this._oMetadataAnalyser.getSelectionFieldsAnnotation(this.sEntityType);if(a&&a.selectionFields){this._aSelectionFields=a.selectionFields}if(this._aFieldGroupAnnotation){e=this._aFieldGroupAnnotation.length;for(l=0;l<e;l++){r=this._aFieldGroupAnnotation[l];u=this._createGroupMetadata(r);u.index=this._aFilterBarViewMetadata.length;this._aFilterBarViewMetadata.push(u)}}e=n.length;for(l=0;l<e;l++){r=n[l];t=r.fields.length;u=this._createGroupMetadata(r);this._aFilterBarViewMetadata.push(u);for(o=0;o<t;o++){s=r.fields[o];if(s.type.indexOf("Edm.")===0){d=this._createFieldMetadata(s);u.fields.push(d);this._aFilterBarFieldNames.push(d.fieldName)}}i=r.hiddenFields&&r.hiddenFields.length;if(this._isRunningInValueHelpDialog&&i){for(o=0;o<i;o++){s=r.hiddenFields[o];if(s.type.indexOf("Edm.")===0){d=this._createFieldMetadata(s);u.hiddenFields.push(d)}}}}}h=this._getAdditionalConfigurationForCustomGroups(n);e=h.length;for(o=0;o<e;o++){u=this._createGroupMetadataForCustomGroup(h[o]);if(u){this._aFilterBarViewMetadata.push(u)}}f=this._getAdditionalConfigurationForCustomFilterFields();t=f.length;for(o=0;o<t;o++){d=this._createFieldMetadataForCustomFilterFields(f[o]);if(d){this._aFilterBarViewMetadata[0].fields.push(d)}}if(this._hasBasicSearch()){d=this._createBasicSearchFieldMetadata();this._aFilterBarViewMetadata[0].fields.push(d)}if(!this._isRunningInValueHelpDialog){this._createParameters()}return new Promise(function(e){Promise.all(this._aPromises).then(function(){if(this._bConsiderSelectionVariants){this._createSelectionVariants()}this._applyGroupId();this._applyIndexes();this._createInitialModel(true);this._initializeConditionTypeFields();this.setPending(this.isPending());this._bInitialized=true;e(this)}.bind(this))}.bind(this))};H.prototype._createSelectionVariants=function(){this._aSelectionVariants=this._oMetadataAnalyser.getSelectionVariantAnnotationList(this.sEntityType)};H.prototype._createParameters=function(){if(this._oMetadataAnalyser.isSemanticAggregation(this.sEntityType)){if(this._bConsiderAnalyticalParameters){var e=sap.ui.require("sap/ui/model/analytics/odata4analytics");if(e){this._createAnalyticalParameters(e)}else{var t=new Promise(function(e){sap.ui.require(["sap/ui/model/analytics/odata4analytics"],function(t){this._createAnalyticalParameters(t);e()}.bind(this))}.bind(this));this._aPromises.push(t)}}}else{this._createNonAnalyticalParameters()}};H.prototype._createAnalyticalParameters=function(e){this._oParameterization=this._getAnalyticParameterization(e);this._createAnalyticParameters(this._oParameterization)};H.prototype._getAnalyticParameterization=function(e){var t,i;try{t=new e.Model(new e.Model.ReferenceByModel(this._oParentODataModel))}catch(e){throw"Failed to instantiate analytical extensions for given OData model: "+e.message}i=t&&t.findQueryResultByName(this.sEntitySet);return i&&i.getParameterization()};H.prototype._createNonAnalyticalParameters=function(){if(this.sEntitySet){this._oNonAnaParameterization=this._oMetadataAnalyser.getParametersByEntitySetName(this.sEntitySet);if(this._oNonAnaParameterization){this._createParametersByEntitySetName(this._oNonAnaParameterization.entitySetName,this._oNonAnaParameterization.parameters)}}};H.prototype.attachPendingChange=function(e){this._attachEvent("PendingChange",e)};H.prototype.detachPendingChange=function(e){this._detachEvent("PendingChange",e)};H.prototype.setPending=function(e){var t=this._bPending!==e;this._bPending=e;if(t){var i={};i.pending=e;this._fireEvent("PendingChange",i)}};H.prototype.isPending=function(){if(!this._bInitialized){return true}for(var e in this._mConditionTypeFields){if(this._mConditionTypeFields[e].conditionType.isPending()){return true}}return false};H.prototype._updateDisplayBehaviour=function(){this._sTextArrangementDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(this.sEntityType);if(!this.sDefaultDropDownDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultDropDownDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultDropDownDisplayBehaviour=O.descriptionOnly}}if(!this.sDefaultTokenDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultTokenDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultTokenDisplayBehaviour=O.descriptionAndId}}if(!this.sDefaultSingleFieldDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultSingleFieldDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultSingleFieldDisplayBehaviour=O.descriptionAndId}}};H.prototype._hasBasicSearch=function(){return this._isBasicSearchEnabled};H.prototype._getAdditionalConfigurationForCustomFilterFields=function(){var e,t,i,a;if(!this._oAdditionalConfiguration){return[]}e=this._oAdditionalConfiguration.getControlConfiguration();if(!this._aFilterBarFieldNames||!this._aFilterBarFieldNames.length){return e}a=[];t=e.length;for(i=0;i<t;i++){if(this._aFilterBarFieldNames.indexOf(e[i].key)<0){a.push(e[i])}}return a};H.prototype._getAdditionalConfigurationForCustomGroups=function(e){var t,i,a,r,n,l,o,s;if(!this._oAdditionalConfiguration){return[]}t=this._oAdditionalConfiguration.getGroupConfiguration();if(!e||!e.length){return t}n=[];a=e.length;i=t.length;for(r=0;r<i;r++){o=false;for(l=0;l<a;l++){s=e[l].groupName||e[l].groupEntitySetName;if(s===t[r].key){o=true;break}}if(!o){n.push(t[r])}}return n};H.prototype._createInitialModelForField=function(e,t,i){var a=false,r,n,l=false,o=false,s=null,d=null,u,f=null,h=[],p=[];if(!t||t.isCustomFilterField){return}if(t.filterRestriction!==L.multiple){o=true}if((t.filterType==="date"||t.filterType==="time"||t.filterType==="datetime")&&!t.isFiscalDate){a=true}if(i){r=t.defaultFilterValues;l=r&&r.length;if(!l){if(t.defaultPropertyValue&&t.isParameter){n=t.defaultPropertyValue;if(t.filterType==="numeric"){n=this._getType(t).parseValue(n,"string")}r=[{low:n}];l=true}else if(t.defaultFilterValue){n=t.defaultFilterValue;r=[{low:n,high:n,operator:"EQ",sign:"I"}];l=true}}}var m=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(t.fieldName):null;if(t.hasFixedValues||m&&m.controlType===x.dropDownList){this._aFilterBarDropdownFieldMetadata.push(t)}if(t.filterRestriction===L.single&&!this._isSingleDynamicDateEnabled(t)){if(l){n=r[0];s=a?this._createDateTimeValue(t,n.low):n.low}if(t.type==="Edm.String"&&t.hasValueListAnnotation&&!t.hasFixedValues&&t.controlType!=="dropDownList"){this._aFilterBarSingleValueWithValueListFieldMetadata.push(t);if(!l&&t.control){t.control.setValue("")}}e[t.fieldName]=s}else if(t.filterRestriction===L.interval&&t.type!=="Edm.Time"){if(l){n=r[0];s=a?this._createDateTimeValue(t,n.low):n.low;d=a?this._createDateTimeValue(t,n.high):n.high}e[t.fieldName]={low:s,high:d}}else{if(l){u=r.length;while(u--){n=r[u];if(o){f={exclude:n.sign==="E",operation:n.operator==="CP"?"Contains":n.operator,keyField:t.fieldName,value1:a?this._createDateTimeValue(t,n.low):n.low,value2:a?null:n.high};if(t.filterType==="time"&&n.high){f.value2=new Date(n.high)}}else{f={key:a?this._createDateTimeValue(t,n.low):n.low,text:a?"":n.low}}h.push(f)}}this._aFilterBarMultiValueFieldMetadata.push(t);e[t.fieldName]={value:null};if(o){p=h.slice(0);h=[];e[t.fieldName].ranges=p}e[t.fieldName].items=h;this._updateMultiValueControl(t.control,h,p)}};H.prototype._createDateTimeValue=function(e,t){switch(e.type){case"Edm.Time":if(t.indexOf("PT")===0){return this._getTime(t)}else{N.error("Default value for "+e.fieldName+" could not be parsed.")}break;case"Edm.DateTime":if(typeof t=="string"&&e.displayFormat&&e.displayFormat.toLowerCase()=="date"){var i=t.split("T");t=i[0]+"T00:00:00";return new Date(t)}else{N.error("Default value for "+e.fieldName+" could not be parsed.")}break;case"Edm.DateTimeOffset":return new Date(t);default:N.error("Default value for "+e.fieldName+" could not be parsed.")}};H.prototype._createInitialModel=function(e){var t,i,a,r,n,l,o,s;t={};this._bCreatingInitialModel=true;this._aFilterBarMultiValueFieldMetadata=[];this._aFilterBarSingleValueWithValueListFieldMetadata=[];this._aFilterBarDropdownFieldMetadata=[];if(this._aFilterBarViewMetadata){i=this._aFilterBarViewMetadata.length;for(o=0;o<i;o++){n=this._aFilterBarViewMetadata[o];a=n.fields.length;for(l=0;l<a;l++){this._createInitialModelForField(t,n.fields[l],e)}r=n.hiddenFields&&n.hiddenFields.length;if(this._isRunningInValueHelpDialog&&r){for(l=0;l<r;l++){this._createInitialModelForField(t,n.hiddenFields[l],e)}}}}if(this._aCustomFieldMetadata){for(s=0;s<this._aCustomFieldMetadata.length;s++){this._createInitialModelForField(t,this._aCustomFieldMetadata[s],false)}}if(this._aAnalyticalParameters){a=this._aAnalyticalParameters.length;for(l=0;l<a;l++){this._createInitialModelForField(t,this._aAnalyticalParameters[l],e)}}this.oModel.setData(t);if(!e){this._clearConditionTypeFields()}this._updateConditionTypeFields();this._bCreatingInitialModel=false};H.prototype._updateMultiValueControl=function(t,i,a,r){var n=0,l=null,o=null,s=null,f=null,h=null,m,c,_,g;if(t&&i){n=i.length;if(t instanceof u){l=[];while(n--){f=i[n].text||i[n].key;var o=new p;o.setKey(i[n].key);o.setText(f);o.setTooltip(f);l.push(o)}if(a){n=a.length;while(n--){s=a[n];if((s.value1===""||s.value1===null)&&s.operation===P.EQ){g=w.convertOption(s.operation,s.value1);s.operation=g.op;s.tokenText=D.getFormattedRangeText(s.operation,null,null,s.exclude);s.value1=g.v}if(s.tokenText){f=s.tokenText}else{m=s.value1;c=s.value2;if(r){var y=true;var F=["date","datetime","time"];if(F.indexOf(r.filterType)>-1){_=this._getType(r);if(_){if(m){if(r.filterType==="time"){m=e.dateToEdmTime(e.localToUtc(m))}m=_.formatValue(m,"string",y)}if(c){if(r.filterType==="time"){c=e.dateToEdmTime(e.localToUtc(c))}c=_.formatValue(c,"string",y)}}}else if(r.filterType==="numeric"){_=this._getType(r);if(_){if(m!==""&&m!==undefined){if(typeof m==="string"&&!isNaN(m)){m=parseFloat(m);s.value1=m}m=_.formatValue(m,"string")}if(c!==""&&c!==undefined){if(typeof c==="string"&&!isNaN(c)){c=parseFloat(c);s.value2=c}c=_.formatValue(c,"string")}}}else if(r.filterType==="boolean"){_=this._getType(r);if(_){if(m!==""&&m!==undefined&&m==="false"){m=_.formatValue(false,"string")}else{m=_.formatValue(m,"string")}if(c!==""&&c!==undefined&&c==="false"){c=_.formatValue(false,"string")}else{c=_.formatValue(m,"string")}}}else{var v=r.isCalendarDate||r.isFiscalDate||(m instanceof Date||c instanceof Date);if(v){_=this._getType(r);if(m){m=_.formatValue(m,"string")}if(c){c=_.formatValue(c,"string")}}}}f=D.getFormattedRangeText(s.operation,m,c,s.exclude)}o=new p;o.setText(f);o.setTooltip(f);o.data("range",s);l.push(o)}}t.setTokens(l);t.fireTokenUpdate()}if(t instanceof d){h=[];while(n--){h.push(i[n].key)}t.setSelectedKeys(h)}}};H.prototype._updateSingleValueControl=function(e){var t=e.control,i=e.fieldName,a=e.displayBehaviour||this.sDefaultSingleFieldDisplayBehaviour,r=this.oModel.getData(),n=r[i],l=n,o=this._getSingleInputsTextArrangementData(i);if(o&&o.key===n){l=D.getFormattedExpressionFromDisplayBehaviour(a,o.key,o.text);delete this._oNotValidatedSingleFields[i]}t.setValue(l);if(n&&n===l){this._oSingleFieldSetFromFilterData[i]=true;var s=this._aValueListProvider.find(function(e){return e.sFieldName===i});if(s&&s.bInitialised){s._validateInput(n);delete this._oNotValidatedSingleFields[i]}else{this._oNotValidatedSingleFields[i]=n}}};H.prototype._applyIndexes=function(){if(!this._aFilterBarViewMetadata){return}this._aFilterBarViewMetadata=f.groupSorting(this._aFilterBarViewMetadata)};H.prototype._applyGroupId=function(){var e=Array.isArray(this._aFilterBarViewMetadata)?this._aFilterBarViewMetadata.length:0,t,i,a,r,n,l;for(r=0;r<e;r++){if(!this._aFilterBarViewMetadata[r].fields){continue}t=this._aFilterBarViewMetadata[r].fields.length;for(n=0;n<t;n++){a=this._aFilterBarViewMetadata[r].fields[n];if(a&&a.groupId&&a.groupId!==this._aFilterBarViewMetadata[r].groupName){i=undefined;for(l=0;l<e;l++){if(this._aFilterBarViewMetadata[l].groupName===a.groupId){i=this._aFilterBarViewMetadata[l];break}}if(i){this._aFilterBarViewMetadata[r].fields.splice(n,1);n--;t--;i.fields=i.fields||[];i.fields.push(a)}}}}};H.prototype._createFilterControlId=function(e){var t=this._oSmartFilter?this._oSmartFilter.getId():"FilterPanel";var i=T.replace(e.groupId||"");var a=T.replace(e.fieldName);var r=e.customColumnKey&&T.replace(e.customColumnKey);if(r){a+=r}if(this._sSmartContainerId){a=this._sSmartContainerId+"-"+a}return t+"-filterItemControl"+i+"-"+a};H.prototype._createGroupMetadata=function(e){var t,i=null,a;a=e.groupName||e.groupEntitySetName;if(this._oAdditionalConfiguration){i=this._oAdditionalConfiguration.getGroupConfigurationByKey(a)}t={};t.groupName=a;t.groupLabel=this._getGroupLabel(e,i);t.fields=[];t.hiddenFields=[];t.index=this._getGroupIndex(i);return t};H.prototype._createGroupMetadataForCustomGroup=function(e){var t;t={};t.groupName=e.key;t.groupLabel=e.label;t.fields=[];t.index=this._getGroupIndex(e);return t};H.prototype._getTime=function(e){var t=A.getTimeInstance({pattern:"'PT'hh'H'mm'M'ss'S'"});return t.parse(e)};H.prototype._checkMetadataDefaultValue=function(e){var t=e.defaultFilterValue||e.defaultPropertyValue;if(t){try{if(e.type==="Edm.Time"&&t.indexOf("PT")===0){this._getTime(t)}else{this._getType(e)}}catch(t){e.defaultPropertyValue=null;e.defaultFilterValue=null;N.error("default value for "+e.fieldName+" could not be parsed.")}}};H.prototype._getType=function(e){var t,i={},a={},r={};if(e.ui5Type){return e.ui5Type}if(e.precision||e.scale){a.precision=e.precision;a.scale=e.scale}if(e.maxLength){a.maxLength=e.maxLength}if(e.displayFormat){a.displayFormat=e.displayFormat}if(e.isDigitSequence){a.isDigitSequence=e.isDigitSequence}if(e.isCalendarDate){r.isCalendarDate=true}if(e.isFiscalDate&&e.fiscalType){r.isFiscalDate=true;r.fiscalType=e.fiscalType}if(e.filterType==="date"||e.filterType==="time"||e.filterType==="datetime"||e.isCalendarDate){i=Object.assign({},this._oDateFormatSettings,{UTC:false})}t=F.getType(e.type,i,a,r);return t};H.prototype._setControlDisplayFormat=function(e,t){var i;if(!t){return}i=t.style||t.pattern;if(!i){return}e.setDisplayFormat(i)};H.prototype._createControl=function(e){var f,h,p=false,m,c,_=e.type!=="Edm.String"||e.isFiscalDate||e.isDigitSequence;if(e.customControl){return e.customControl}h=this._getType(e);f=new e.fControlConstructor(this._createFilterControlId(e));if(e.fControlConstructor===l){this._setControlDisplayFormat(f,this._oDateFormatSettings);if(e.isCalendarDate){f.bindProperty("dateValue",{path:this.sFilterModelName+">/"+e.fieldName+"/low",type:h});f.bindProperty("secondDateValue",{path:this.sFilterModelName+">/"+e.fieldName+"/high",type:h})}else{f.bindProperty("dateValue",this.sFilterModelName+">/"+e.fieldName+"/low");f.bindProperty("secondDateValue",this.sFilterModelName+">/"+e.fieldName+"/high")}}else if(e.fControlConstructor===r||e.fControlConstructor===i){if(f.setForceSelection){f.setForceSelection(true)}if(e.fControlConstructor===i){f.addItem(new a({key:"",text:""}));f.addItem(new a({key:false,text:h.formatValue(false,"string")}));f.addItem(new a({key:true,text:h.formatValue(true,"string")}))}else{this._associateValueList(f,"items",e,false,this._getSuppressValueListsAssociation());f.attachSelectionChange(function(){if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}f.fireChange({filterChangeReason:e.fieldName,value:""})}.bind(this))}f.bindProperty("selectedKey",this.sFilterModelName+">/"+e.fieldName)}else if(e.fControlConstructor===d){this._associateValueList(f,"items",e,false,this._getSuppressValueListsAssociation());f.attachSelectionChange(function(t){if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}var i=t.getSource(),a=null,r=[],n;a=i.getSelectedItems();if(a){n=a.length;while(n--){r.push({key:a[n].getKey(),text:a[n].getText()})}}if(this.oModel){this.oModel.setProperty("/"+e.fieldName+"/items",r)}i.fireChange({filterChangeReason:e.fieldName,value:""})}.bind(this));f.bindProperty("value",this.sFilterModelName+">/"+e.fieldName+"/value")}else if(e.fControlConstructor===u){if(e.controlType===x.date||e.type==="Edm.Time"||e.type==="Edm.DateTimeOffset"){f.setValueHelpOnly(true);if(e.filterRestriction===L.interval){this._associateValueHelpDialog(f,e,false,false)}else{this._associateValueHelpDialog(f,e,true,true)}}else{if(e.hasValueHelpDialog){this._associateValueHelpDialog(f,e,e.filterRestriction!==L.multiple,true)}else{f.setShowValueHelp(false)}f.bindProperty("value",{path:this.sFilterModelName+">/"+e.fieldName+"/value",type:h})}this._handleMultiInput(f,e,h)}else if(e.fControlConstructor===s){if(e.filterRestriction===L.interval){p=true;f.bindProperty("value",this.sFilterModelName+">/"+e.fieldName+"/low");if(!this.oResourceBundle){this.oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp")}if(!this.sIntervalPlaceholder){this.sIntervalPlaceholder=this.oResourceBundle.getText("INTERVAL_PLACEHOLDER_TEXT")}f.setPlaceholder(this.sIntervalPlaceholder)}else if(e.hasValueListAnnotation){f.attachChange(function(t){var i=t.getParameter("value");f.__sValidationText="";if(!i){this.oModel.setProperty("/"+e.fieldName,"")}}.bind(this))}else{f.bindProperty("value",{path:this.sFilterModelName+">/"+e.fieldName,type:h})}if(e.hasValueHelpDialog){f.setShowValueHelp(true);if(p&&_){f.setValueHelpOnly(true)}this._associateValueHelpDialog(f,e,false,false)}}else if(e.isCalendarDate){this._setControlDisplayFormat(f,this._oDateFormatSettings);f.bindProperty("dateValue",{path:this.sFilterModelName+">/"+e.fieldName,type:h})}else if(e.fControlConstructor===n){f.bindProperty("dateValue",this.sFilterModelName+">/"+e.fieldName);this._setControlDisplayFormat(f,this._oDateFormatSettings)}else if(e.fControlConstructor===o||e.fControlConstructor===t){f.bindProperty("dateValue",this.sFilterModelName+">/"+e.fieldName);if(this._oDateFormatSettings&&this._oDateFormatSettings.style){f.setDisplayFormat(this._oDateFormatSettings.style)}}if(f instanceof n){f.attachChange(function(e){var t=e.getParameter("valid");f.data("__mandatoryEmpty",null);if(t){f.setValueState(R.None);f.setValueStateText()}else{var i=f._parseValue(e.getParameter("newValue")),a=this._getSelectedDateRange(i);f.setValueState(R.Error);if(a[0]&&a[1]){var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp"),n=this._getDateFieldOutOfRangeErrorText(f,a,h,r);f.setValueStateText(n)}else if(h){try{h.parseValue("foo","string")}catch(e){f.setValueStateText(e.message)}}}}.bind(this))}if(e.hasTypeAhead){if(e.hasValueListAnnotation){f.setShowSuggestion(true)}f.setFilterSuggests(false);this._associateValueList(f,"suggestionRows",e,true,this._getSuppressValueListsAssociation())}if(e.displayFormat==="UpperCase"&&e.controlType!==x.dropDownList&&f.attachChange&&f.getValue&&f.setValue){f.attachChange(function(t){var i=f.getValue();if(i&&e.filterRestriction!=="single"){f.setValue(i.toUpperCase())}});if(this._mTokenHandler[f.getId()]&&this._mTokenHandler[f.getId()].parser){var g=this._mTokenHandler[f.getId()].parser;g.getKeyFields()[0].displayFormat=e.displayFormat}}if(f instanceof s){if(e.maxLength){m=parseInt(e.maxLength);if(!isNaN(m)){if(this._mTokenHandler[f.getId()]&&this._mTokenHandler[f.getId()].parser){var g=this._mTokenHandler[f.getId()].parser;g.getKeyFields()[0].maxLength=m}else{if(!e.hasValueListAnnotation&&!p){f.setMaxLength(m)}}}}if(e.isFiscalDate){f.setPlaceholder(h.formatter.getPattern())}var y=e.filterRestriction==="auto"||e.filterRestriction==="multi-value"||e.filterRestriction==="multiple";if(e.type==="Edm.String"&&y&&(this._oSmartFilter&&!this._oSmartFilter.getDisableSearchMatchesPatternWarning())){f.attachLiveChange(this._oSmartFilter._onLiveChangeValidateSymbols.bind(this._oSmartFilter))}}c=function(e){var t=e.getParameter("exception");var i=e.getParameter("element");if(f&&i&&f.getId()===i.getId()){if(t){if(f.setValueStateText){f.setValueStateText(t.message)}}if(f.setValueState){f.setValueState(R.Error)}f.data("__mandatoryEmpty",null)}};f.attachParseError(c);f.attachFormatError(c);f.attachValidationError(c);f.attachValidationSuccess(function(e){var t=e.getParameter("element");if(f&&t&&f.getId()===t.getId()){if(f.setValueState){f.setValueState(R.None)}if(f.setValueStateText){f.setValueStateText()}f.data("__mandatoryEmpty",null);delete f.__sValidationText}});return f};H.prototype._getControlConstructor=function(e,a){var f=s,h,p,m;m=a?a+e.fieldName:e.fieldName;if(e.isCustomFilterField){f=undefined}else{h=e.filterRestriction===L.single;p=e.filterRestriction===L.interval;if(e.controlType===x.date){if(h&&!this._isSingleDynamicDateEnabled(e)){f=n}else{f=p?l:u}if(e.isCalendarDate){this._aFilterBarStringDateFieldNames.push(m)}else{this._aFilterBarDateFieldNames.push(m)}if(e.filterRestriction===L.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(m)}}else if(e.controlType===x.dropDownList){if(h){f=this._isBooleanWithFixedValuedButWithoutValueListAnnotation(e)?i:r}else{f=d}if(!h){e.filterRestriction=L.multiple}}else if(e.type==="Edm.Time"){if(h){f=o}else{f=u}this._aFilterBarTimeFieldNames.push(m);if(p){this._aFilterBarTimeIntervalFieldNames.push(m)}else if(e.filterRestriction===L.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(m)}}else if(!p&&e.controlType===x.dateTimePicker){if(h){f=t}else{f=u}this._aFilterBarDateTimeFieldNames.push(m);if(e.filterRestriction===L.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(m)}}else if(p&&e.type==="Edm.DateTimeOffset"){var c=this._getFilterTimeZone(m);if(c){var _={key:m,value:c};this._aFilterBarDateTimeOffsetWithTimezoneFieldNames.push(_)}this._aFilterBarDateTimeFieldNames.push(m)}else if(!h&&!p){f=u}}return f};H.prototype._handleTokenUpdate=function(e,t){this._tokenUpdate({control:t.control,fieldViewMetadata:t.fieldViewMetadata,removedTokens:e&&e.getParameter("removedTokens")})};H.prototype._tokenUpdate=function(t){var i=t.removedTokens,a=t.control,r=t.fieldViewMetadata,n,l=[],o,s,d,u=[],f="/"+r.fieldName;if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}n=a.getTokens();if(i){n=n.filter(function(e){return i.indexOf(e)===-1})}if(Array.isArray(n)&&n.length>0){o=n.length;while(o--){s=n[o];d=s.data("range");if(d){d.tokenText=s.getText();if(r.customColumnKey){d.customColumnKey=r.customColumnKey}if(d&&s.getKey().indexOf("range_")===0){if(r.type==="Edm.Time"){if(d.value1&&(d.value1.ms||d.value1.ms===0)){d.value1=e.utcToLocal(e.edmTimeToDate(d.value1))}if(d.value2&&(d.value2.ms||d.value2.ms===0)){d.value2=e.utcToLocal(e.edmTimeToDate(d.value2))}}}u.push(d)}else{l.push({key:s.getKey(),text:s.getText()})}}}if(this.oModel){this.oModel.setProperty(f+"/items",l);this.oModel.setProperty(f+"/ranges",u)}if(a.__bValidatingToken){delete a.__bValidatingToken}if(!a._pendingAutoTokenGeneration){a.fireChange({filterChangeReason:r.fieldName,value:""})}};H.prototype._handleMultiInput=function(e,t,i){e._setFilterProvider(this);e._setFieldViewMetadata(t);e.attachTokenUpdate({control:e,fieldViewMetadata:t},this._handleTokenUpdate,this);var a,r=t.type==="Edm.DateTime"&&t.displayFormat==="Date";if(t.hasValueListAnnotation||t.type==="Edm.String"||r){e.attachEvent("_validateOnPaste",function(n){var l=n.getParameter("texts"),o,s,d,u,f;s=l?l.length:0;if(s>1){n.preventDefault();o=this.oModel.getProperty("/"+t.fieldName);f=o.ranges||[];e.setValue("");while(s--){d=l[s];if(d){u=null;if(r){a=this._getDateValue(d,i);if(isNaN(a.getDate())){continue}else{u=d;d=a}}var h=V._createRangeByText(d);f.push(Object.assign({keyField:t.fieldName,tokenText:u,value1:d,value2:null},h))}}this.oModel.setProperty("/"+t.fieldName+"/ranges",f);this._updateMultiValueControl(e,o.items,f,t)}}.bind(this));e._shouldSkipTokenCreationOnPaste=function(){return false}}};H.prototype._associateValueHelpDialog=function(e,t,i,a){var r=t.visibleInAdvancedArea||t.groupId===b.BASIC_FILTER_AREA_ID;if(this._getSuppressValueListsAssociation()&&r){this._attachEventOnce(b.ASSOCIATE_VALUE_LISTS,function(){this._associateValueHelpDialogHandler(e,t,i,a)}.bind(this))}else{this._associateValueHelpDialogHandler(e,t,i,a)}};H.prototype._associateValueHelpDialogHandler=function(e,t,i,a){var r,n,l={fieldName:t.fieldName,control:e,model:this._oParentODataModel,filterModel:this.oModel,filterProvider:this,dateFormatSettings:this._oDateFormatSettings,fieldViewMetadata:t,displayFormat:t.displayFormat,displayBehaviour:t.displayBehaviour,loadAnnotation:t.hasValueListAnnotation,fullyQualifiedFieldName:t.fullName,metadataAnalyser:this._oMetadataAnalyser,preventInitialDataFetchInValueHelpDialog:t.preventInitialDataFetchInValueHelpDialog,supportMultiSelect:a,supportRanges:i,isSingleIntervalRange:t.filterRestriction===L.interval,isSearchExpressionFilterRestriction:t.filterRestriction===L.searchExpression,isUnrestrictedFilter:t.filterRestriction!==L.multiple,type:t.filterType,maxLength:t.maxLength,scale:t.scale,precision:t.precision,context:"SmartFilterBar",filterBarClass:this.filterBarClass,defaultOperation:t.conditionPanelDefaultOperation,_onBeforeOpenValueHelpDialog:function(e){if(this._oSmartFilter){this._oSmartFilter.fireEvent("_beforeOpenVHD",e)}}.bind(this)};if(l.isSearchExpressionFilterRestriction){n={defaultOperation:m._getSearchExpressionTypeOperations().string[0],typeOperations:m._getSearchExpressionTypeOperations(),rangeOperationsKeys:m._getSearchExpressionRangeOperationsKeys()}}if(t.isCalendarDate){l.oType=this._getType(t)}var o=new _(l);o.attachValueListChanged(function(e){if(this._oSmartFilter){this._oSmartFilter.fireFilterChange(e);this._oSmartFilter.validateMandatoryFields()}}.bind(this));if(t.visibleInAdvancedArea||t.groupId===b.BASIC_FILTER_AREA_ID){this.aFilterAnnotations.push(o.loadAnnotation().then(function(e){this._enrichFieldViewMetadata(t,e)}.bind(this)))}this._aValueHelpDialogProvider.push(o);if(i&&e.addValidator){r=new V(n);r.addKeyField({key:t.fieldName,label:t.label,type:t.filterType,oType:t.ui5Type});if(t.filterType==="numeric"){r.setDefaultOperation("EQ")}r.associateInput(e);this._mTokenHandler[e.getId()]={parser:r}}};H.prototype._determineFieldLabel=function(e){var t,i=e.label;if(this._oSmartFilter&&this._oSmartFilter.determineFilterItemByName){t=this._oSmartFilter.determineFilterItemByName(e.name,e.groupName);if(t){i=t.getLabel()}}return i};H.prototype._associateValueList=function(e,t,i,a,r){var n=i.visibleInAdvancedArea||i.groupId===b.BASIC_FILTER_AREA_ID,l={control:e,aggregation:t,fieldViewMetadata:i,hasTypeAhead:a,annotaionIsToBeLoaded:n};if(r&&n){this._attachEventOnce(b.ASSOCIATE_VALUE_LISTS,function(){this._associateValueListHandler(l)}.bind(this))}else{this._associateValueListHandler(l)}};H.prototype._associateValueListHandler=function(e){var t,i=e.control,a=e.aggregation,r=e.fieldViewMetadata,n=e.hasTypeAhead,l=e.annotaionIsToBeLoaded;if(this._oSmartFilter&&!this._bAttachInitializedDone&&E.fromQuery(window.location.search).get("sap-ui-comp-filterbar-data-defer")){var o=this._oParentODataModel;this._sDeferredGroupId="sapUiCompFilterBarData";var s=o.getDeferredGroups?this._oParentODataModel.getDeferredGroups():null;if(s!==null){s.push(this._sDeferredGroupId);o.setDeferredGroups(s);var d=function(){o.submitChanges({groupId:this._sDeferredGroupId});var e=o.getDeferredGroups().filter(function(e){return e!==this._sDeferredGroupId}.bind(this));o.setDeferredGroups(e);delete this._sDeferredGroupId;this._oSmartFilter.detachInitialized(d)}.bind(this);this._oSmartFilter.attachInitialized(d);this._bAttachInitializedDone=true}}if(r.hasValueListAnnotation){t=new g({fieldName:r.fieldName,control:i,model:this._oParentODataModel,filterModel:this.oModel,filterProvider:this,displayFormat:r.displayFormat,dateFormatSettings:this._oDateFormatSettings,fieldViewMetadata:r,displayBehaviour:r.displayBehaviour,loadAnnotation:true,fullyQualifiedFieldName:r.fullName,metadataAnalyser:this._oMetadataAnalyser,type:r.filterType,aggregation:a,typeAheadEnabled:n,enableShowTableSuggestionValueHelp:r.hasValueHelpDialog,deferredGroupId:this._sDeferredGroupId,context:this._sContext?this._sContext:"SmartFilterBar",fieldHistoryEnabled:r.historyEnabled!==undefined?r.historyEnabled:true,fieldHistoryEnabledInitial:r.historyEnabledInitial!==undefined?r.historyEnabledInitial:true});t.attachValueListChanged(function(e){if(this._oSmartFilter){this._oSmartFilter.fireFilterChange(e);this._oSmartFilter.validateMandatoryFields()}}.bind(this));if(l){this.aFilterAnnotations.push(t.loadAnnotation().then(function(e){this._enrichFieldViewMetadata(r,e)}.bind(this)))}this._aValueListProvider.push(t)}else if(this._mTokenHandler[i.getId()]&&this._mTokenHandler[i.getId()].parser&&r.filterRestriction!=="searchExpression"){this._mTokenHandler[i.getId()].parser.setDefaultOperation("EQ")}};H.prototype._createAnalyticParameters=function(e){var t,i;if(e){i=e.getAllParameterNames();t=e.getEntitySet();if(t){this._createParametersByEntitySetName(t.getQName(),i)}}};H.prototype._createParametersByEntitySetName=function(e,t){var i,a=this._oMetadataAnalyser.getFieldsByEntitySetName(e);for(var r=0;r<a.length;r++){if(t.indexOf(a[r].name)>=0){i=this._createAnalyticParameterMetadata(a[r]);if(i&&i.visible){if(this._oNonAnaParameterization&&i.isCustomFilterField){continue}this._aAnalyticalParameters.push(i)}}}};H.prototype._createAnalyticParameterMetadata=function(e){var t,i=S.ANALYTICAL_PARAMETER_PREFIX,a=function(e){return e.type==="Edm.String"&&e["sap:parameter"]==="optional"};e.filterRestriction="single-value";t=this._createFieldMetadata(e,i);if(t){t.fieldName=i+e.name;t.isMandatory=a(t)?false:true;t.isParameter=true;t.visibleInAdvancedArea=true}else{N.error("_createAnalyticParameterMetadata issue with property: "+e.name)}return t};H.prototype.getAnalyticParameters=function(){return this._aAnalyticalParameters};H.prototype.getSelectionVariants=function(){return this._aSelectionVariants};H.prototype.getAnalyticBindingPath=function(){var e,t=[],i=this.getAnalyticParameters();i.forEach(function(e){t.push(e.fieldName)});e=this.getFilledFilterData(t);if(this._oParameterization){return this._createAnalyticBindingPath(i,e)}else{return this._createNonAnalyticBindingPath(i,e)}};H.prototype._createAnalyticBindingPath=function(t,i){var a,r="",n;n=this._getParameterizationRequest(this._oParameterization);if(n){t.forEach(function(t){a=i[t.fieldName];if(!a){a=""}else if(t.type==="Edm.Time"&&a instanceof Date){if(this._oDateFormatSettings&&!this._oDateFormatSettings.UTC){a=e.utcToLocal(a)}a=e.localToUtc(a);a={__edmType:"Edm.Time",ms:a.valueOf()}}else if(t.type==="Edm.DateTime"&&i[t.fieldName]&&i[t.fieldName].conditionTypeInfo&&i[t.fieldName].ranges&&i[t.fieldName].ranges[0]){a=i[t.fieldName].ranges[0].value1;if(this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=e.localToUtc(a)}}else if(t.type!=="Edm.DateTimeOffset"&&this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=e.localToUtc(a)}n.setParameterValue(t.name,a)}.bind(this));r=n.getURIToParameterizationEntry()+"/"+this._oParameterization.getNavigationPropertyToQueryResult()}return r};H.prototype._createNonAnalyticBindingPath=function(t,i){var a,r="",n="";if(this._oNonAnaParameterization){r="/"+this._oNonAnaParameterization.entitySetName+"(";t.forEach(function(t){a=i[t.fieldName];if(!a){a=""}else if(t.type==="Edm.Time"&&a instanceof Date){a=e.localToUtc(a);a={__edmType:"Edm.Time",ms:a.valueOf()}}else if(t.type==="Edm.DateTime"&&i[t.fieldName]&&i[t.fieldName].conditionTypeInfo&&i[t.fieldName].ranges&&i[t.fieldName].ranges[0]){a=i[t.fieldName].ranges[0].value1;if(this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=e.localToUtc(a)}}else if(t.type!=="Edm.DateTimeOffset"&&this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=e.localToUtc(a)}r+=n+t.name+"="+I(this._oParentODataModel.formatValue(a,t.type));n=","}.bind(this));r+=")/"+this._oNonAnaParameterization.navPropertyName}return r};H.prototype._getParameterizationRequest=function(){return this._oParameterization?new M.ParameterizationRequest(this._oParameterization):null};H.prototype._constructContextUrl=function(e,t){var i=e._getServerUrl();if(i&&i.lastIndexOf("/")===i.length-1){i=i.substr(0,i.length-1)}return i+e.sServiceUrl+"/$metadata#"+t};H.prototype.getFilterContextUrl=function(){var e,t=null;if(this._oParentODataModel&&this._oParentODataModel.isA("sap.ui.model.odata.v2.ODataModel")&&this._oParentODataModel.getMetaModel()){e=this._oParentODataModel.getMetaModel().getODataEntitySet(this.sEntitySet);if(e){t=this._constructContextUrl(this._oParentODataModel,e.name)}}return t};H.prototype.getParameterContextUrl=function(){var e,t=null;if(this._oParentODataModel&&this._oParentODataModel.isA("sap.ui.model.odata.v2.ODataModel")&&this._oParentODataModel.getMetaModel()){if(this._oParameterization&&this._oParameterization.getEntitySet()){e=this._oParameterization.getEntitySet().getQName()}else if(this._oNonAnaParameterization){e=this._oNonAnaParameterization.entitySetName}if(e){t=this._constructContextUrl(this._oParentODataModel,e)}}return t};H.prototype._createFieldMetadata=function(e,t){var i,a,r,n,o;e.fieldName=this._getFieldName(e);e.fieldNameOData=e.fieldName.replace(b.FIELD_NAME_REGEX,"/");a=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(e.fieldName):null;i=Object.assign({},e);i.filterRestriction=this._getFilterRestriction(e.filterRestriction,a);this._updateValueListMetadata(i,e);i.hasValueHelpDialog=this._hasValueHelpDialog(i,a);if(a){i.disableNewDateRangeControl=a.disableNewDateRangeControl;i.preventInitialDataFetchInValueHelpDialog=this._getPreventInitialDataFetchInValueHelpDialog(i,a);i.conditionPanelDefaultOperation=a.conditionPanelDefaultOperation;if(a.displayBehaviour&&a.displayBehaviour!=="auto"){i.displayBehaviour=a.displayBehaviour}i.isCustomFilterField=!!a.customControl;i.visibleInAdvancedArea=!!a.visibleInAdvancedArea;i.defaultFilterValues=a.defaultFilterValues;i.customControl=a.customControl;r=a.conditionType;i.width=this._getWidth(a);i.isVisible=this._isVisible(a);i.historyEnabled=a.historyEnabled;i.historyEnabledInitial=a.historyEnabledInitial}else{i.preventInitialDataFetchInValueHelpDialog=this._getPreventInitialDataFetchInValueHelpDialog(i);i.isVisible=true;i.isCustomFilterField=false;i.visibleInAdvancedArea=false}i.controlType=this._getControlType(i,a);i.label=this._getLabel(e,a);i.isMandatory=this._isMandatory(e,a);i.groupId=this._getGroupID(e,a);i.index=this._getIndex(e,a);i.fControlConstructor=this._getControlConstructor(i,t);i.isFiscalDate=c.isFiscalValue(i);i.fiscalType=c.getFiscalAnotationType(i);if(i.isFiscalDate){c.updateViewMetadata(i)}i.filterType=this._getFilterType(i);i.hasTypeAhead=this._hasTypeAhead(i,e,a);i.ui5Type=this._getType(i);if(i.ui5Type&&i.ui5Type.isA("sap.ui.model.odata.type.DateTime")){i.ui5Type.formatValue(new Date,"string");i.ui5Type.oFormat.oFormatOptions.UTC=false}i.fCreateControl=function(e){var t;e.control=this._createControl(e);t=this.oModel.getData()[e.fieldName];if(t){this._updateMultiValueControl(e.control,t.items,t.ranges,e);var a=this._aFilterBarSingleValueWithValueListFieldMetadata.some(function(t){return t.name===e.fieldName||S.ANALYTICAL_PARAMETER_PREFIX+t.name===i.fieldName});if(a){this._updateSingleValueControl(e)}}}.bind(this);this._applyWidth(i);if(i.type==="Edm.String"){this._aFilterBarStringFieldNames.push(i.fieldName)}i.conditionType=null;var s=i.filterRestriction===L.single&&(i.type==="Edm.DateTime"&&i.displayFormat==="Date"||i.type==="Edm.String"&&i.isCalendarDate);var d=i.type==="Edm.DateTimeOffset"&&i.filterRestriction==="interval";if(!r&&this._bUseDateRangeType&&(i.fControlConstructor===l||s||d)){r="sap.ui.comp.config.condition.DateRangeType"}if(r){n="";if(typeof r==="object"){if(this._bUseDateRangeType&&!r.module&&i.fControlConstructor===l||s||d){r.module="sap.ui.comp.config.condition.DateRangeType"}n=r.module}else{n=r;r=null}try{n=n.replace(/\./g,"/");var u=sap.ui.require(n);if(u){this._enhanceConditionTypeInfo(u,n,r,i,t)}else{o=new Promise(function(e){sap.ui.require([n],function(a){this._enhanceConditionTypeInfo(a,n,r,i,t);e()}.bind(this))}.bind(this));this._aPromises.push(o)}}catch(e){N.error("Module "+n+" could not be loaded")}}else{this._checkMetadataDefaultValue(i)}return i};H.prototype._requireConditionType=function(e,t,i){var e=e.replace(/\./g,"/");var a=sap.ui.require(e);if(a){this._enhanceConditionTypeInfo(a,e,t,i)}else{sap.ui.require([e],function(a){this._enhanceConditionTypeInfo(a,e,t,i)}.bind(this))}};H.prototype._enhanceConditionTypeInfo=function(e,t,i,a,r){var n=e;var l=r===S.ANALYTICAL_PARAMETER_PREFIX&&a.fieldName.indexOf(S.ANALYTICAL_PARAMETER_PREFIX)===-1?r+a.fieldName:a.fieldName;a.conditionType=new n(l,this,a);this._mConditionTypeFields[l]=a;if(i&&!this._bUseDateRangeType){if(a.defaultValue&&r===S.ANALYTICAL_PARAMETER_PREFIX){i=Object.assign({},i,{defaultDate:a.defaultValue})}a.conditionType.applySettings(i)}if(this._bUseDateRangeType&&i&&r!==S.ANALYTICAL_PARAMETER_PREFIX){var o={};if(i.defaultOperation){o=Object.assign({},o,{defaultOperation:i.defaultOperation})}if(i.operations){o=Object.assign({},o,{operations:i.operations})}a.conditionType.applySettings(o)}if(this._bUseDateRangeType&&r===S.ANALYTICAL_PARAMETER_PREFIX&&a.defaultValue){var o={defaultDate:a.defaultValue};if(i){o=Object.assign({},o,{operations:i.operations,defaultOperation:i.defaultOperation})}a.conditionType.applySettings(o)}this._checkMetadataDefaultValue(a)};H.prototype._getFilterType=function(e){return D._getFilterType(e)};H.prototype._updateValueListMetadata=function(e,t){e.hasValueListAnnotation=t["sap:value-list"]!==undefined;if(e.hasValueListAnnotation){e.hasFixedValues=t["sap:value-list"]==="fixed-values"}else if(t["com.sap.vocabularies.Common.v1.ValueList"]){e.hasValueListAnnotation=true;e.hasFixedValues=this._oMetadataAnalyser.getValueListSemantics(t["com.sap.vocabularies.Common.v1.ValueList"])==="fixed-values";if(!e.hasFixedValues){e.hasFixedValues=m.isValueListWithFixedValues(t)}}};H.prototype._createBasicSearchFieldMetadata=function(){var e;var t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");e={};e.filterRestriction=L.single;e.name=b.BASIC_SEARCH_FIELD_ID;e.fieldName=b.BASIC_SEARCH_FIELD_ID;e.label=undefined;e.isMandatory=false;e.isVisible=true;e.groupId=b.BASIC_FILTER_AREA_ID;e.index=-1;e.control=new h(this._oSmartFilter.getId()+"-btnBasicSearch",{showSearchButton:true});if(!this._isRunningInValueHelpDialog){e.control.setPlaceholder(t.getText("FILTER_BAR_BSEARCH_PLACE_HOLDER"))}e.control.bindProperty("value",this.sFilterModelName+">/"+e.fieldName);this._oBasicSearchControl=e.control;return e};H.prototype._applyWidth=function(e){if(e&&e.width&&e.control&&typeof e.control.setWidth==="function"){e.control.setWidth(e.width)}};H.prototype._createFieldMetadataForCustomFilterFields=function(e){var t;if(!e||!e.customControl){return undefined}t={};t.name=e.key;t.fieldName=e.key;t.label=e.label;t.visibleInAdvancedArea=!!(e&&e.visibleInAdvancedArea);t.isVisible=this._isVisible(e);t.groupId=e.groupId;t.isMandatory=this._isMandatory(undefined,e);t.index=e.index;t.width=this._getWidth(e);t.control=e.customControl;t.isCustomFilterField=true;this._applyWidth(t);return t};H.prototype._getFieldName=function(e){if(!e.parentPropertyName){return e.name}else{return e.parentPropertyName+"."+e.name}};H.prototype._getPreventInitialDataFetchInValueHelpDialog=function(e,t){if(t&&!t.isSetPreventInitialDataFetchInValueHelpDialog){return t.preventInitialDataFetchInValueHelpDialog}if(m.isValueList(e)&&e["com.sap.vocabularies.Common.v1.ValueList"]&&e["com.sap.vocabularies.Common.v1.ValueList"].FetchValues){return e["com.sap.vocabularies.Common.v1.ValueList"].FetchValues.Int!=="1"}return false};H.prototype._hasValueHelpDialog=function(e,t){var i=true;if(t){if(t.controlType===x.dropDownList){i=false}else if(t.hasValueHelpDialog!==true){i=false}}if(e&&!e.hasValueListAnnotation){if(e.filterRestriction===L.single||e.filterRestriction===L.multiple){i=false}}return i};H.prototype._isVisible=function(e){if(e&&e.isVisible===false){return false}return true};H.prototype._getWidth=function(e){if(e&&e.width){return e.width}return undefined};H.prototype._isMandatory=function(e,t){if(t&&t.mandatory!==k.auto){return t.mandatory===k.mandatory}if(e){return e.requiredFilterField}return false};H.prototype._getFilterRestriction=function(e,t){if(t&&t.filterType&&t.filterType!==L.auto){return t.filterType}switch(e){case"single-value":return L.single;case"multi-value":return L.multiple;case"interval":return L.interval;case"search-expression":return L.searchExpression;default:return L.auto}};H.prototype._getControlType=function(e,t){var i;if(t&&t.controlType&&t.controlType!==x.auto){i=t.controlType}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.isCalendarDate){i=x.date}else if(e.type==="Edm.DateTimeOffset"){i=x.dateTimePicker}else if(e.hasValueListAnnotation&&e.hasFixedValues){i=x.dropDownList}else if(this._isBooleanWithFixedValuedButWithoutValueListAnnotation(e)){i=x.dropDownList}else{i=x.input}return i};H.prototype._isBooleanWithFixedValuedButWithoutValueListAnnotation=function(e){if(e.type==="Edm.Boolean"&&!e.hasFixedValues&&!e.hasValueListAnnotation&&e.filterRestriction==="single"){return true}return false};H.prototype._getGroupID=function(e,t){if(t&&t.groupId){return t.groupId}else if(e&&(e.requiredFilterField||this._aSelectionFields&&this._aSelectionFields.indexOf(e.fieldNameOData)>-1)){return this._sBasicFilterAreaID}return this._getGroupIDFromFieldGroup(e)};H.prototype._getGroupIDFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields&&i.fields.indexOf(e.fieldNameOData)>-1){a=i.groupName;break}}}return a};H.prototype._getLabel=function(e,t){if(t&&t.label){return t.label}return this._getLabelFromFieldGroup(e)||e.fieldLabel||e.fieldName};H.prototype._getLabelFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields&&i.fields.indexOf(e.fieldNameOData)>-1){a=i.labels[e.fieldNameOData];break}}}return a};H.prototype._getIndex=function(e,t){if(t&&t.index>=0){return t.index}else if(this._aSelectionFields&&this._aSelectionFields.indexOf(e.fieldNameOData)>-1){return this._aSelectionFields.indexOf(e.fieldNameOData)}return this._getIndexFromFieldGroup(e)};H.prototype._getIndexFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields){a=i.fields.indexOf(e.fieldNameOData);if(a>-1){break}a=undefined}}}return a};H.prototype._getGroupIndex=function(e){if(e&&(e.index||e.index===0)){return e.index}};H.prototype._getGroupLabel=function(e,t){if(t&&t.label){return t.label}return e.groupLabel||e.groupName||e.groupEntitySetName};H.prototype._hasTypeAhead=function(e,t,i){var a;a=true;if(i){a=i.hasTypeAhead}else if(t.type!=="Edm.String"){return false}if(!(e.fControlConstructor===s||e.fControlConstructor===u)){return false}return a};H.prototype.getModel=function(){return this.oModel};H.prototype.getFilterBarViewMetadata=function(){return this._aFilterBarViewMetadata};H.prototype._getFilterBarViewMetadataExtend=function(){return this._oFilterBarViewMetadataExtend};H.prototype.getAssociatedValueHelpProviders=function(){return this._aValueHelpDialogProvider};H.prototype.getAssociatedValueListProviders=function(){return this._aValueListProvider};H.prototype.getParameters=function(){var e,t=null;if(this.oModel){t=this.oModel.getProperty("/"+b.BASIC_SEARCH_FIELD_ID)}if(this._sBasicSearchFieldName||t){e={custom:{}};if(this._sBasicSearchFieldName){e.custom["search-focus"]=this._sBasicSearchFieldName}e.custom["search"]=t||""}return e};H.prototype.getFilters=function(e){var t=null;if(this.oModel){t=this.oModel.getData()}return b.generateFilters(e,t,{dateSettings:this._oDateFormatSettings,useContainsAsDefault:this._bUseContainsAsDefault,stringFields:this._aFilterBarStringFieldNames,timeFields:this._aFilterBarTimeFieldNames,dateTimeOffsetValueFields:this._aFilterBarDateTimeFieldNames,dateTimeOffsetWithTimeZone:this._aFilterBarDateTimeOffsetWithTimezoneFieldNames,viewMetadataData:this._aFilterBarViewMetadata})};H.prototype.getFilterData=function(){return this.oModel?this.oModel.getData():null};H.prototype.getFilterDataAsString=function(){return this.oModel?this.oModel.getJSON():null};H.prototype.getFilledFilterData=function(e){var t,i={},a,r,n;t=this.oModel?this.oModel.getData():null;if(t&&e){a=e.length;while(a--){r=e[a];if(r&&r!==b.BASIC_SEARCH_FIELD_ID){n=t[r];if(n&&n.hasOwnProperty("low")){if(n.low){i[r]=n}}else if(n&&n.hasOwnProperty("items")){if(n.value&&typeof n.value==="string"){n.value=n.value.trim()}if(n.items.length||n.ranges&&n.ranges.length||n.value||typeof n.value==="boolean"){i[r]=n}}else if(n){if(typeof n==="string"){n=n.trim()}if(n){i[r]=n}}}if(a===0){r=b.CUSTOM_FIELDS_MODEL_PROPERTY;n=t[r];if(n){i[r]=n}}}}return B({},i)};H.prototype.getFilledFilterDataAsString=function(e){return JSON.stringify(this.getFilledFilterData(e))};H.prototype.setFilterData=function(e,t){var i=null,a=null,r=null;if(this.oModel&&e){this._bUpdatingFilterData=true;try{if(t){this._createInitialModel(false)}i=this._parseFilterData(e,t);if(i){this.oModel.setData(i,true);a=[];var n=arguments[2];if(n){a.push(n)}for(r in i){a.push(r)}this._handleFilterDataUpdate(a)}}finally{this._bUpdatingFilterData=false}}};H.prototype.setFilterDataAsString=function(e,t){if(e){this.setFilterData(JSON.parse(e),t)}};H.prototype._parseFilterData=function(e,t){return H.parseFilterData(this.oModel.getData(),e,{stringDateFields:this._aFilterBarStringDateFieldNames,dateFields:this._aFilterBarDateFieldNames,timeFields:this._aFilterBarTimeFieldNames,timeIntervalFields:this._aFilterBarTimeIntervalFieldNames,dateTimeMultiValueFields:this._aFilterBarDateTimeMultiValueFieldNames,conditionTypeFields:this._mConditionTypeFields,dateTimeOffsetValueFields:this._aFilterBarDateTimeFieldNames,dateTimeOffsetWithTimeZone:this._aFilterBarDateTimeOffsetWithTimezoneFieldNames,viewMetadataData:this._aFilterBarViewMetadata,filterProvider:this},t)};H.prototype._handleFilterDataUpdate=function(e){var t=0,i,a,r=this.oModel.getData();var n=function(e,t){var i=t;e.forEach(function(e){t.forEach(function(a){if(a.operation===P.EQ&&a.value1===e.key){i.splice(t.indexOf(a),1)}})});return i};if(this._aFilterBarMultiValueFieldMetadata){t=this._aFilterBarMultiValueFieldMetadata.length;while(t--){if(r){i=this._aFilterBarMultiValueFieldMetadata[t];if(e.indexOf(i.fieldName)>-1){a=r[i.fieldName];if(a){if(a.items&&a.items.length>0&&a.ranges&&a.ranges.length>0){a.ranges=n(a.items,a.ranges)}this._updateMultiValueControl(i.control,a.items,a.ranges,i)}}}}this._updateConditionTypeFields()}if(this._aFilterBarSingleValueWithValueListFieldMetadata&&r){this._aFilterBarSingleValueWithValueListFieldMetadata.forEach(function(t){var i=t.control,a=t.fieldName;if(!i||m.isHiddenFilter(t)){return}if(e.includes(a)){this._updateSingleValueControl(t)}else if(!r[a]){i.setValue("");i.__sValidationText=""}}.bind(this))}};H.prototype.clear=function(){this._createInitialModel(false)};H.prototype.reset=function(){this._createInitialModel(true)};H.prototype._initializeConditionTypeFields=function(){var e=function(e){this.setPending(this.isPending())}.bind(this);for(var t in this._mConditionTypeFields){this._mConditionTypeFields[t].conditionType.initialize(this.oModel.getData()[t]);if(this._mConditionTypeFields[t].conditionType.getAsync()){this._mConditionTypeFields[t].conditionType.attachPendingChange(e)}}};H.prototype._updateConditionTypeFields=function(){var e=this._oldData;var t=this.oModel.getData();this._oldData=B({},t);if(e!==undefined){var i=[],a;for(a in t){var r=JSON.stringify(t[a]);var n=JSON.stringify(e[a]);if(r!==n){i.push(a)}}if(i.length>0){for(a in this._mConditionTypeFields){this._mConditionTypeFields[a].conditionType.providerDataUpdated(i,t)}}}};H.prototype._clearConditionTypeFields=function(){var e=this.oModel.getData();for(var t in this._mConditionTypeFields){if(!e[t]){this._mConditionTypeFields[t].conditionType.initialize({})}else{this._mConditionTypeFields[t].conditionType.initialize(e[t])}}};H.prototype._validateConditionTypeFields=function(){var e=false;for(var t in this._mConditionTypeFields){var i=this._mConditionTypeFields[t].conditionType.validate();if(!i&&!e){e=true}}return e};H.prototype._getFieldMetadata=function(e){return b._getFieldMetadata(this.getFilterBarViewMetadata(),e)};H.prototype._getSelectedDateRange=function(e){if(!Array.isArray(e)){e=[e,e]}return e};H.prototype._getDateFieldOutOfRangeErrorText=function(e,t,i,a){var r=e.getMinDate()||e._oMinDate,n=e.getMaxDate()||e._oMaxDate;if(t[0].getTime()<r.getTime()){return a.getText("FILTER_BAR_DATE_FIELD_MIN_DATE_ERROR",[i.formatValue(r,"string")])}if(t[1].getTime()>n.getTime()){return a.getText("FILTER_BAR_DATE_FIELD_MAX_DATE_ERROR",[i.formatValue(n,"string")])}};H.generateFilters=function(e,t,i){return b.generateFilters(e,t,i)};H.parseFilterData=function(e,t,i,a){var r={},n=null,l=null,o=null,s,d,u,f,h,p,m,c,_,g,y,F,D,v,T;if(i){p=i.stringDateFields;m=i.dateFields;c=i.timeFields;_=i.timeIntervalFields;g=i.dateTimeMultiValueFields;n=i.conditionTypeFields||{};y=i.dateTimeOffsetValueFields;F=i.viewMetadataData||[];v=i.filterProvider||null}if(!p){p=[]}if(!m){m=[]}if(!c){c=[]}if(!_){_=[]}if(!g){g=[]}if(!y){y=[]}if(e&&t){d=Object.assign({},t,true);for(l in d){D=b._getFieldMetadata(F,l);if(e.hasOwnProperty(l)&&l!==b.CUSTOM_FIELDS_MODEL_PROPERTY){o=e[l];s=d[l];if(l in n){if(n[l]&&typeof s==="string"){var V=new Date(s);if(V instanceof Date&&!isNaN(V)){n[l].conditionType.initialize({value1:V})}else if(n[l].type==="Edm.String"&&n[l].ui5Type&&typeof n[l].ui5Type.formatValue==="function"){var V=n[l].ui5Type.formatValue(s);n[l].conditionType.initialize({value1:V})}}else if(s&&(s.low||s.low===0)&&(s.high||s.high===0)){var A=new Date(s.low),S=new Date(s.high);if(A instanceof Date&&!isNaN(A)&&S instanceof Date&&!isNaN(S)){n[l].conditionType.initialize({value1:A,value2:S})}else if(n[l].type==="Edm.String"&&n[l].ui5Type&&typeof n[l].ui5Type.formatValue==="function"){var A=n[l].ui5Type.formatValue(s.low),S=n[l].ui5Type.formatValue(s.high);n[l].conditionType.initialize({value1:A,value2:S})}}else if(s&&("conditionTypeInfo"in s||!("conditionTypeInfo"in s)&&s.ranges)){if(s.ranges&&s.ranges.length>1&&n[l].isParameter){var C=s.ranges.find(function(e){return e.semantic!==undefined});if(C){s.ranges=[C]}}n[l].conditionType.initialize(s)}}else if(o&&o.hasOwnProperty("low")){r[l]=s;if(s){if((s.low||s.low===0)&&(s.high||s.high===0)){if(m.indexOf(l)>-1||c.indexOf(l)>-1){if(!(s.low instanceof Date)){r[l].low=new Date(s.low)}if(!(s.high instanceof Date)){r[l].high=new Date(s.high)}}else if(v&&D&&y.indexOf(l)>-1){r[l].low=D.ui5Type.formatValue(new Date(s.low),"string")+"-"+D.ui5Type.formatValue(new Date(s.high),"string");r[l].high=null}else if(p.indexOf(l)===-1){r[l].low=s.low+"-"+s.high;r[l].high=null}}else if((s.low||s.low===0||s.value)&&!s.high){if(!s.low&&s.value){s.low=s.value}if((m.indexOf(l)>-1||c.indexOf(l)>-1||y.indexOf(l)>-1)&&!(s.low instanceof Date)){T=Date.parse(s.low);if(!Number.isNaN(T)){r[l].low=new Date(T)}}r[l].low=s.low;r[l].high=null}}}else if(o&&o.hasOwnProperty("items")){if(s&&(s.items||s.ranges)){if(s.ranges&&s.ranges.length){if(_.indexOf(l)>-1){f=s.ranges.length;for(u=0;u<f;u++){h=s.ranges[u];if(!h.exclude&&(h.operation==="EQ"||h.operation==="BT")){break}h=null}if(h){if(h.value1&&typeof h.value1==="string"){h.value1=new Date(h.value1)}if(h.value2&&typeof h.value2==="string"){h.value2=new Date(h.value2)}r[l]={ranges:[h],items:[],value:""}}continue}else if(m.indexOf(l)>-1||c.indexOf(l)>-1||y.indexOf(l)>-1){f=s.ranges.length;for(u=0;u<f;u++){h=s.ranges[u];if(h.value1&&typeof h.value1==="string"){h.value1=new Date(h.value1)}if(h.value2&&typeof h.value2==="string"){h.value2=new Date(h.value2)}}}else if(D&&D.isCalendarDate){f=s.ranges.length;for(u=0;u<f;u++){h=s.ranges[u];if(h.value1&&typeof h.value1==="string"&&!h.value1.match(/([1-9][0-9]{3,}|0[0-9]{3})(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|3[01])/)){h.value1=D.ui5Type.parseValue(new Date(h.value1),"date")}if(h.value2&&typeof h.value2==="string"&&!h.value2.match(/([1-9][0-9]{3,}|0[0-9]{3})(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|3[01])/)){h.value2=D.ui5Type.parseValue(new Date(h.value2),"date")}}}else if(D&&D.filterType==="boolean"){f=s.ranges.length;for(u=0;u<f;u++){h=s.ranges[u];if(h.hasOwnProperty("value1")){if(typeof h.value1==="string"){h.value1=h.value1==="true"}}if(h.hasOwnProperty("value2")){if(typeof h.value2==="string"){h.value2=h.value2==="true"}}}}}r[l]=s;if(!a&&r[l].ranges){for(u=0;u<r[l].ranges.length;u++){r[l].ranges[u].tokenText=null}}}else if(typeof s==="string"||typeof s==="boolean"||typeof s==="number"||s instanceof Date){if(s&&(m.indexOf(l)>-1||c.indexOf(l)>-1)){if(typeof s==="string"){s=new Date(s)}r[l]={ranges:[{exclude:false,operation:"EQ",keyField:l,value1:s,value2:null}],items:[],value:""}}else{r[l]={value:s,items:[]}}}}else{r[l]=null;if(typeof s==="string"||typeof s==="boolean"||typeof s==="number"||s instanceof Date){if(typeof s==="string"&&(m.indexOf(l)>-1||c.indexOf(l)>-1||y.indexOf(l)>-1)){r[l]=new Date(s)}else{r[l]=s}}else if(s&&(s.value||s.value===0||s.value===false)){r[l]=s.value}else if(s&&s.items&&s.items.length){r[l]=s.items[0].key}else if(s&&s.ranges&&s.ranges.length){f=s.ranges.length;for(u=0;u<f;u++){h=s.ranges[u];if(!h.exclude&&h.operation==="EQ"){break}h=null}if(h&&h.value1){if(typeof h.value1==="string"&&(m.indexOf(l)>-1||c.indexOf(l)>-1||y.indexOf(l)>-1)){r[l]=new Date(h.value1)}else{r[l]=h.value1}}}}}else if(a||l===b.CUSTOM_FIELDS_MODEL_PROPERTY){r[l]=d[l]}}}return r};H.prototype._attachEvent=function(e,t){if(!this._oEventProvider){this._oEventProvider=new v}this._oEventProvider.attachEvent(e,t)};H.prototype._attachEventOnce=function(e,t){if(!this._oEventProvider){this._oEventProvider=new v}this._oEventProvider.attachEventOnce(e,t)};H.prototype._detachEvent=function(e,t){if(!this._oEventProvider){return}this._oEventProvider.detachEvent(e,t)};H.prototype._fireEvent=function(e,t){if(!this._oEventProvider){return}this._oEventProvider.fireEvent(e,t||{})};H.prototype._getSuppressValueListsAssociation=function(){return this._bSuppressValueListsAssociation};H.prototype._getCurrentValidationPromises=function(){return this._aValueListProvider.concat(this._aValueHelpDialogProvider).reduce(function(e,t){return e.concat(t._getCurrentValidationPromises())},[])};H.prototype._enrichFieldViewMetadata=function(e,t){var i,a,r,n,l,o,s={},d="com.sap.vocabularies.Common.v1.ValueList";if(t===undefined||e===undefined){return}a=e["groupName"];r=e["fullName"];n=t.primaryValueListAnnotation!==undefined;l=Array.isArray(t.additionalAnnotations)&&t.additionalAnnotations.length>0;if(n){s[d]=t.primaryValueListAnnotation.annotation}if(l){for(i=0;i<t.additionalAnnotations.length;i++){o=t.additionalAnnotations[i];s[d+"#"+o.qualifier]=o.annotation}}if(n||l){if(this._oFilterBarViewMetadataExtend[a]===undefined){this._oFilterBarViewMetadataExtend[a]={}}if(this._oFilterBarViewMetadataExtend[a][r]===undefined){this._oFilterBarViewMetadataExtend[a][r]={}}this._oFilterBarViewMetadataExtend[a][r]=s}};H.prototype._isSingleDynamicDateEnabled=function(e){var t=this._bUseDateRangeType&&(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.type==="Edm.String"&&e.isCalendarDate);if(t){return true}var i=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(e.fieldName)||this._oAdditionalConfiguration.getControlConfigurationByKey(e.name):null;var a=i&&(i.conditionType==="sap.ui.comp.config.condition.DateRangeType"||i.conditionType&&i.conditionType&&typeof i.conditionType==="object"&&i.conditionType.module==="sap.ui.comp.config.condition.DateRangeType")&&(e.type==="Edm.DateTime"||e.type==="Edm.String"&&e.isCalendarDate);return a};H.prototype._setSingleInputsTextArrangementData=function(e){this._sSingleInputsTextArrangementData=Object.assign({},e);return this};H.prototype._setSingleInputsTextArrangementFieldData=function(e,t,i){this._sSingleInputsTextArrangementData[e]={key:t,text:i};return this};H.prototype._getSingleInputsTextArrangementData=function(e){if(e){return this._sSingleInputsTextArrangementData[e]}return this._sSingleInputsTextArrangementData};H.prototype._getFilterTimeZone=function(e){var t=this._oAdditionalConfiguration,i=t?t.getControlConfigurationByKey(e):null,a=null;if(i){a=i.timezone}return a};H.prototype.destroy=function(){var e=function(e){var t;if(e){t=e.length;while(t--){e[t].destroy()}}};this._oParentODataModel=null;this._aAnalyticalParameters=null;this._aFilterBarViewMetadata=null;this._oFilterBarViewMetadataExtend=null;this._oParameterization=null;this._oNonAnaParameterization=null;this._aFilterBarFieldNames=null;this._aFilterBarStringDateFieldNames=null;this._aFilterBarDateFieldNames=null;this._aFilterBarTimeFieldNames=null;this._aFilterBarTimeIntervalFieldNames=null;this._aFilterBarDateTimeMultiValueFieldNames=null;this._aFilterBarStringFieldNames=null;this._aFilterBarMultiValueFieldMetadata=null;this._aFilterBarDropdownFieldMetadata=null;this._sSingleInputsTextArrangementData=null;this._oNotValidatedSingleFields={};this._oSingleFieldSetFromFilterData={};this._aFilterBarDateTimeFieldNames=null;this._aFilterBarDateTimeOffsetWithTimezoneFieldNames=null;this._aFieldGroupAnnotation=null;this._aSelectionFields=null;this._aSelectionVariants=null;if(this._oBasicSearchControl&&this._oBasicSearchControl.destroy){this._oBasicSearchControl.destroy()}this._oBasicSearchControl=null;if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;e(this._aValueHelpDialogProvider);this._aValueHelpDialogProvider=null;e(this._aValueListProvider);this._aValueListProvider=null;if(this._mTokenHandler){for(var t in this._mTokenHandler){var i=this._mTokenHandler[t];if(i.parser){i.parser.destroy();i.parser=null}}delete this._mTokenHandler}this.oResourceBundle=null;this.sIntervalPlaceholder=null;this.sDefaultDropDownDisplayBehaviour=null;this.sDefaultTokenDisplayBehaviour=null;this.sDefaultSingleFieldDisplayBehaviour=null;this._oSmartFilter=null;if(this._oEventProvider){if(this._oEventProvider.destroy){this._oEventProvider.destroy()}this._oEventProvider=null}for(var a in this._mConditionTypeFields){this._mConditionTypeFields[a].conditionType.destroy()}this._mConditionTypeFields=null;if(this.oModel){this.oModel.destroy();this.oModel=null}this._aPromises=[];this.bIsDestroyed=true};return H},true);
//# sourceMappingURL=FilterProvider.js.map