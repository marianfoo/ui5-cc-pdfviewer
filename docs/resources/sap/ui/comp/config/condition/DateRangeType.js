/*!
 * SAPUI5
 * (c) Copyright 2009-2022 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/comp/config/condition/Type","sap/ui/Device","sap/ui/core/library","sap/ui/comp/library","sap/m/library","sap/m/Input","sap/m/DatePicker","sap/m/Text","sap/m/Select","sap/ui/core/ListItem","sap/m/Label","sap/ui/core/date/UniversalDate","sap/ui/core/format/DateFormat","sap/ui/core/Locale","sap/ui/core/LocaleData","sap/ui/model/type/Integer","sap/ui/model/Sorter","sap/ui/model/Filter","sap/base/Log","sap/ui/core/date/UniversalDateUtils","sap/m/DynamicDateRange","sap/m/DynamicDateUtil","sap/m/DynamicDateFormat","sap/m/CustomDynamicDateOption","sap/m/DynamicDateValueHelpUIType","sap/m/StandardDynamicDateOption","sap/base/util/UriParameters","sap/ui/comp/util/DateTimeUtil","sap/ui/dom/jquery/cursorPos"],function(jQuery,e,t,a,n,i,r,o,s,l,u,g,T,p,f,E,d,c,D,I,h,y,v,m,_,N,O,A,R){"use strict";var S=a.ValueState;var C=i.PlacementType;var F=Object.keys(i.StandardDynamicDateRangeKeys).concat(["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS","NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"]);var x;var P;var M;var Y=d.extend("sap.ui.model.type.NullableInteger",{parseValue:function(e,t){if(this.getPrimitiveType(t)=="string"){if(e===""){return null}}return d.prototype.parseValue.apply(this,arguments)}});var L=e.extend("sap.ui.comp.config.condition.DateRangeType",{constructor:function(t,a,i){e.apply(this,[t,a,i]);this.oDateFormat=a&&a._oDateFormatSettings?a._oDateFormatSettings:{UTC:true};this._bIgnoreTime=false;this._maxIntValue=1e4;this.bMandatory=this.oFieldMetadata?this.oFieldMetadata.isMandatory:false;var r=this.oFieldMetadata&&this.oFieldMetadata.name,o=a&&a._oAdditionalConfiguration&&a._oAdditionalConfiguration.getControlConfigurationByKey(t)||r&&a._oAdditionalConfiguration.getControlConfigurationByKey(r);this._bSingleFilterRestriction=i&&i.filterRestriction===n.smartfilterbar.FilterType.single&&(a._bUseDateRangeType||o&&(o.conditionType===this.getName()||typeof o.conditionType==="object"&&o.conditionType.module===this.getName()));this._bDTOffset=i&&i.filterRestriction===n.smartfilterbar.FilterType.interval&&i.type==="Edm.DateTimeOffset";this._customSemanticOperation=null}});L.prototype.applySettings=function(t){e.prototype.applySettings.apply(this,arguments);if(t&&t.ignoreTime){this._bIgnoreTime=t.ignoreTime}};L.setStartTime=function(e){e=L.toUniversalDate(e);return h.resetStartTime(e)};L.setEndTime=function(e,t){e=L.toUniversalDate(e);if(!t){return h.resetEndTime(e)}else{return h.resetStartTime(e)}};L.toUniversalDate=function(e){if(e instanceof Date){return T.getInstance(e)}if(!e){return T.getInstance()}if(!(e instanceof T)){return L.toUniversalDate(new Date(e))}return e};L.getWeekStartDate=function(e){return h.getWeekStartDate(e)};L.getMonthStartDate=function(e){return h.getMonthStartDate(e)};L.getQuarterStartDate=function(e){return h.getQuarterStartDate(e)};L.getYearStartDate=function(e){return h.getYearStartDate(e)};L.getDateRange=function(e,t,a,n,i){if(a===true){n=true;a=null}if(!a){a=new T}else{a=new T(a)}if(n){switch(t){case"DAY":break;case"WEEK":a=h.getWeekStartDate(a);break;case"MONTH":a=h.getMonthStartDate(a);break;case"QUARTER":a=h.getQuarterStartDate(a);break;case"YEAR":a=h.getYearStartDate(a);break}}if(!i&&e>0){if(e!==0&&!isNaN(e)){var r=-1;switch(t){case"DAY":a.setDate(a.getDate()+r);break;case"WEEK":a.setDate(a.getDate()+r*7);break;case"MONTH":a.setMonth(a.getMonth()+r);break;case"QUARTER":a.setMonth(a.getMonth()+r*3);break;case"YEAR":a.setFullYear(a.getFullYear()+r);break}}}return h.getRange(e,t,a,false)};L.getTextField=function(t,a){var n=e._createStableId(t,"text");if(t._oOperationSelect){var i=t._oOperationSelect.getAriaLabelledBy();var r=false;for(var o=0;o<i.length;o++){if(n===i[o]){r=true;break}}if(!r){t._oOperationSelect.addAriaLabelledBy(n)}}if(a){return new s(n,{text:"{path: '$smartEntityFilter>value1', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:t.oDateFormat.style,pattern:t.oDateFormat.pattern})+"} - {path: '$smartEntityFilter>value2', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:t.oDateFormat.style,pattern:t.oDateFormat.pattern})+"}"})}else{return new s(n,{text:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Date",formatOptions:{style:t.oDateFormat.style,pattern:t.oDateFormat.pattern}}})}};L.getIntField=function(t){return new r(e._createStableId(t,"field"),{ariaLabelledBy:t._oOperationSelect||null,value:{path:"$smartEntityFilter>value1",type:new Y({},{minimum:0,maximum:t._maxIntValue})},textAlign:"End",width:"100%"})};L.getIntFromToField=function(t,a,n){var i=new g({text:e.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);var r=t._createIntFromToControl(t,"fieldFrom","value1");i.setLabelFor(r);a.push(r);i=new g({text:e.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);var o=t._createIntFromToControl(t,"fieldTo","value2");i.setLabelFor(o);a.push(o);t._setIntControlBinding(r,n,"value1");t._setIntControlBinding(o,n,"value2")};L.ControlFactory=function(t,a,n){if(n.type==="range"){var i=L.getTextField(t,n.display!=="start");i.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(i);return}if(n.type==="int"){var i=L.getIntField(t);a.push(i);if(n.descriptionTextKeys){i.setFieldWidth("auto");i.bindProperty("description",{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer",formatter:function(){var t=n.descriptionTextKeys[0];var a=n.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return e.getTranslatedText(t)}else{return e.getTranslatedText(a||t)}}})}}if(n.type==="[int,int]"){L.getIntFromToField(t,a,n)}};L._defaultOnChangeHandler=function(e,t){if(e.toLowerCase()===this.languageText.toLowerCase()){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("inputstate","NONE",t.getContext());if(this.category.indexOf("FIXED")!==0){t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}return false};L._IntOnChangeHandler=function(e,t){if(this.basicLanguageText.indexOf("{0}")>=0){var a=new RegExp(this.basicLanguageText.replace("+","\\+").replace("{0}","([a-zA-Z0-9_]+)")+"$","i");if(e.match(a)){var e=e.match(a)[1];if(e){var n=parseInt(e);if(!isNaN(n)&&n<=t._maxIntValue){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",n);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}}return false};L._IntFromToOnChangeHandler=function(e,t){if(this.basicLanguageText.indexOf("-{0}")>=0&&this.basicLanguageText.indexOf("+{1}")>=0){var a=new RegExp(this.basicLanguageText.replace("/","\\/").replace("-{0}","(\\- (\\()?((-)?([a-zA-Z0-9_]+))(\\))?)").replace("+{1}","(\\+ (\\()?((-)?([a-zA-Z0-9_]+))(\\))?)")+"$","i");var n=e.match(a);if(n){var i=n[3];var r=n[9];if(i&&r){var o=parseInt(i);var s=parseInt(r);if(t._isValidFromToPeriod(o,s)){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",o);t.oModel.setProperty("/condition/value2",s);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}}return false};L._DateOnChangeHandler=function(e,t){if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var a=e.slice(this.languageText.length);if(a.length>0&&a[0]===" "){a=a.trim();if(a[0]==="("&&a[a.length-1]===")"){a=a.slice(1,a.length-1)}var n=t._getDateFormatter(true);var i=n.parse(a);if(i){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",i);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}return false};L._DateWithDefaultsOnChangeHandler=function(e,t){var a,n,i,r,o,s=e.toLowerCase().indexOf(this.languageText.toLowerCase())===0;if(s){a=t._getDateFormatter(true);n=typeof this.defaultValues==="function"&&this.defaultValues();i=n[0]&&n[0].oDate;if(e.indexOf(this.languageText+" ")===0){r=e.slice(this.languageText.length+1);if(r[0]==="("&&r[r.length-1]===")"){r=r.slice(1,r.length-1)}}o=a.parse(r);if(o instanceof Date&&o.getTime()!==i.getTime()){return false}}return L._DateOnChangeHandler.apply(this,arguments)};L._DateRangeOnChangeHandler=function(e,t){if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){var a=e.slice(this.languageText.length).trim();if(a[0]==="("&&a[a.length-1]===")"){a=a.slice(1,a.length-1)}var n=a.split("-")[0];var i=a.split("-")[1];var r=t._getDateFormatter(true);var o=r.parse(n);var s=r.parse(i);if(o&&s){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",o);t.oModel.setProperty("/condition/value2",s);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}return false};L._MonthOnChangeHandler=function(e,t){var a;var n=false;if(e.toLowerCase().indexOf(this.languageText.toLowerCase())===0){a=e.slice(this.languageText.length).trim();if(a.indexOf("(")==0){a=a.slice(1);a=a.slice(0,a.length-1)}n=true}else{a=e}var i=this.getValueList();var r=-1;i.some(function(e,t){var n=e.text.toLowerCase()===a.toLowerCase();if(n){r=t}return n});if(r>-1){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",r);t.oModel.setProperty("inputstate","NONE",t.getContext());return true}else{if(n){t.oModel.setProperty("inputstate","ERROR",t.getContext())}return n}};L._DefaultFilterSuggestItem=function(e,t,a){var n=false;if(this.languageText.toLowerCase().startsWith(e.toLowerCase())){n=true}else{var i=this.languageText.split(" ");for(var r=0;r<i.length;r++){var o=i[r];if(o.toLowerCase().startsWith(e.toLowerCase())){n=true}}}t.setAdditionalText(this.textValue);t.setText(this.languageText);return n};L._HideFilterSuggestItem=function(e,t,a){return false};L._IntFilterSuggestItem=function(t,a,n){if(!this.basicLanguageText){this.basicLanguageText=n.basicLanguageText}if(!this.basicLanguageText){this.basicLanguageText=this.languageText||e.getTranslatedText(this.textKey)}var i=this.basicLanguageText.indexOf("{0}");var r;var o;if(i>=0){r=this.basicLanguageText.slice(0,i).trim();o=this.basicLanguageText.slice(i+3).trim()}var s=t.split(" ");if(s.length<1||s.length>3){return false}var l=false;var u;var g=function(e){return!!e.match(/(^[0-9]+$)/)&&parseInt(e)>=0};if(r.toLowerCase().startsWith(s[0].toLowerCase())){if(s[1]){if(g(s[1])){u=s[1];if(s[2]){if(o.toLowerCase().startsWith(s[2].toLowerCase())){l=true}}else{l=true}}}else{l=true}}else if(g(s[0])&&s.length<3){u=s[0];if(s[1]){if(o.toLowerCase().startsWith(s[1].toLowerCase())){l=true}}else{l=true}}else if(o.toLowerCase().startsWith(s[0].toLowerCase())&&s.length==1){l=true}if(l&&u){var T;switch(this.category){case"DYNAMIC.DATE.INT":T="DAY";break;case"DYNAMIC.WEEK.INT":T="WEEK";break;case"DYNAMIC.MONTH.INT":T="MONTH";break;case"DYNAMIC.QUARTER.INT":T="QUARTER";break;case"DYNAMIC.YEAR.INT":T="YEAR";break;default:T="DAY";break}var p=parseInt(u),f=true;if(!n._maxIntValue){n._maxIntValue=n.getControls(n.key)[0].getBindingInfo("value").type.oConstraints.maximum}if(p>n._maxIntValue){l=false}if(this.key.startsWith("LAST")){p=p*-1;f=false}var E;if(this.getDateRange){var d=this.getDateRange({operation:this.key,value1:p});E=[d.value1,d.value2]}else{E=L.getDateRange(p,T,true,f,f)}var c=n._getDateFormatter(true);if(Math.abs(p)===1&&this.singulareBasicLanguageText){a.setText(this.singulareBasicLanguageText);if(T!=="DAY"){a.setAdditionalText(c.format(E[0])+" - "+c.format(E[1]))}else{a.setAdditionalText(c.format(E[0]))}}else{a.setText(n._fillNumberToText(this.basicLanguageText,u));a.setAdditionalText(c.format(E[0])+" - "+c.format(E[1]))}a._value1=parseInt(u)}else{a.setAdditionalText(null);a.setText(this.languageText);a._value1=null}return l};L._IntFromToFilterSuggestItem=function(e,t,a){var n=new RegExp("(\\- ([0-9]+))","i"),i=new RegExp("(\\+ ([0-9]+))","i"),r=new RegExp("(\\- ((\\(-)?([0-9]+)(\\)))?)","i"),o=new RegExp("(\\+ ((\\(-)?([0-9]+)(\\)))?)","i"),s=e.match(n),l=e.match(i),u=e.match(r),g=e.match(o);if(!s&&!u||!l&&!g){t.setAdditionalText(null);t.setText(this.languageText);t._value1=null;t._value2=null;return false}var T=function(e,t){if(e&&!isNaN(e[2])){return parseInt(e[2])}else if(t&&t[2]){var a=t[2].replace("(","").replace(")","");if(!isNaN(a)){return parseInt(a)}}return null},p,f;p=T(s,u);f=T(l,g);if(!a._isValidFromToPeriod(p,f)){t.setAdditionalText(null);t.setText(this.languageText);t._value1=null;t._value2=null;return false}var E=a._getDateFormatter(true),d,c;d=a._getTodayFromToValueFrom(p);c=a._getTodayFromToValueTo(f);t.setText(a._fillNumberToText(this.basicLanguageText,p,f));t.setAdditionalText(E.format(d)+" - "+E.format(c));t._value1=p;t._value2=f;return true};L._DateFilterSuggestItem=function(e,t,a){var n=a._getDateFormatter(true);var i=n.parse(e);if(i){t.setText(this.languageText+" ("+n.format(i)+")");t._value1=i;return true}else{t.setText(this.languageText);t._value1=null;return false}};L._DateRangeFilterSuggestItem=function(e,t,a){var n=a._getDateFormatter(true);var i,r;var o="-";var s=false;var l=e.split(o);if(l.length===2){if(l[0].slice(l[0].length-1,l[0].length)==" "){l[0]=l[0].slice(0,l[0].length-1)}if(l[1].slice(0,1)==" "){l[1]=l[1].slice(1)}}else{l=e.split(" "+o+" ")}if(l.length<2){var u=e.split(" ");if(u.length===2){l=u}}if(l.length>=1&&l.length<=2){i=n.parse(l[0]);if(i){t._value1=i;if(l.length==2&&l[1]===""){l.splice(1,1)}if(l.length==2){r=n.parse(l[1]);if(r){t._value2=r;s=true;t.setText(this.languageText+" ("+n.format(i)+" "+o+" "+n.format(r)+")")}}else{s=true;t.setText(this.languageText+" ("+n.format(i)+" "+o+")")}}}if(!s){t.setText(this.languageText);t._value1=null;t._value2=null}return s};L._MonthFilterSuggestItem=function(e,t,a){var n=false;t._value1=null;var i=this.getValueList();for(var r=0;r<i.length;r++){var o=i[r];n=o.text.toLowerCase().startsWith(e.toLowerCase());if(n){t.setText(this.languageText+" ("+o.text+")");t._value1=r;break}}return n};L._DefaultOnItemSelected=function(e,t,a){a.oModel.setProperty("/condition/operation",this.key);if("value1"in this){a.oModel.setProperty("/condition/value1",t._value1)}if("value2"in this){a.oModel.setProperty("/condition/value2",t._value2)}a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};L._IntOnItemSelected=function(e,t,a){var n=t._value1;a.oModel.setProperty("/condition/operation",this.key);a.oModel.setProperty("/condition/value1",n);a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};L._IntOnItemsSelected=function(e,t,a){var n=t._value1;var i=t._value2;a.oModel.setProperty("/condition/operation",this.key);a.oModel.setProperty("/condition/value1",n);a.oModel.setProperty("/condition/value2",i);a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};L.getFixedRangeOperation=function(e,t,a,n,i,r){return{key:e,textKey:t,category:a,order:r||100,defaultValues:n||null,type:"range",display:"range",filterSuggestItem:i||L._DefaultFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory}};L.createSingleIntRangeOperation=function(e,t,a,n,i,r,o,s){return{key:e,textKey:t,singularTextKey:a,zeroNumberTextKey:s,category:n,order:o,defaultValues:[i],value1:null,type:"int",descriptionTextKeys:r,onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory,_getInitialValues:function(e){return[e.value1,e.value2]}}};L.Operations={DATERANGE:{key:"DATERANGE",textKey:"CONDITION_DATERANGETYPE_DATERANGE",category:"DYNAMIC.DATERANGE",order:2,defaultOperation:true,defaultValues:[null,null],value1:null,value2:null,onChange:L._DateRangeOnChangeHandler,filterSuggestItem:L._DateRangeFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(t,a){var n=false,i=false,r=new g({text:e.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});r.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(r);var s=new o(e._createStableId(t,"field1"),{dateValue:{path:"$smartEntityFilter>value1"},maxDate:{path:"$smartEntityFilter>value2"},displayFormat:t.oDateFormat.style||t.oDateFormat.pattern||"",change:function(e){var a=e.getSource(),i=e.getParameter("valid");a.setValueState(i?S.None:S.Error);if(!n){n=true;a.getBinding("maxDate").attachChange(function(e){t.datePickerValidateLastValue(a)})}}});r.setLabelFor(s);a.push(s);r=new g({text:e.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});r.addStyleClass("sapUiCompFilterBarCTPaddingTop");a.push(r);var l=new o(e._createStableId(t,"field2"),{dateValue:{path:"$smartEntityFilter>value2"},minDate:{path:"$smartEntityFilter>value1"},displayFormat:t.oDateFormat.style||t.oDateFormat.pattern||"",change:function(e){var a=e.getSource(),n=e.getParameter("valid");a.setValueState(n?S.None:S.Error);if(!i){i=true;a.getBinding("minDate").attachChange(function(e){t.datePickerValidateLastValue(a)})}}});r.setLabelFor(l);a.push(l)}},DATE:{key:"DATE",textKey:"CONDITION_DATERANGETYPE_DATE",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:L._DateOnChangeHandler,filterSuggestItem:L._DateFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(t,a){var n=new o(e._createStableId(t,"field"),{ariaLabelledBy:t._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:t.oDateFormat.style||t.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});a.push(n)}},FROM:{key:"FROM",textKey:"CONDITION_DATERANGETYPE_FROM",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null,onChange:L._DateOnChangeHandler,filterSuggestItem:L._DateFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(t,a){var n=new o(e._createStableId(t,"field"),{ariaLabelledBy:t._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:t.oDateFormat.style||t.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});a.push(n)}},TO:{key:"TO",textKey:"CONDITION_DATERANGETYPE_TO",category:"DYNAMIC.DATE",order:1,defaultValues:[null],value1:null,onChange:L._DateOnChangeHandler,filterSuggestItem:L._DateFilterSuggestItem,onItemSelected:L._DefaultOnItemSelected,getControls:function(t,a,n){var i=new o(e._createStableId(t,"field"),{ariaLabelledBy:t._oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:t.oDateFormat.style||t.oDateFormat.pattern||"",change:function(e){var t=e.getParameter("valid");if(t){this.getModel("$smartEntityFilter").setProperty("inputstate","NONE",this.getModel("$smartEntityFilter").getContext("/"))}else{this.getModel("$smartEntityFilter").setProperty("inputstate","ERROR",this.getModel("$smartEntityFilter").getContext("/"))}}});a.push(i)}},LASTDAYS:L.createSingleIntRangeOperation("LASTDAYS","CONDITION_DATERANGETYPE_LASTDAYS","CONDITION_DATERANGETYPE_YESTERDAY","DYNAMIC.DATE.INT",1,["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],4,"CONDITION_DATERANGETYPE_TODAY"),LASTWEEKS:L.createSingleIntRangeOperation("LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEKS","CONDITION_DATERANGETYPE_LASTWEEK","DYNAMIC.WEEK.INT",1,["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],8,"CONDITION_DATERANGETYPE_THISWEEK"),LASTMONTHS:{key:"LASTMONTHS",textKey:"CONDITION_DATERANGETYPE_LASTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_LASTMONTH",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISMONTH",category:"DYNAMIC.MONTH.INT",order:14,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},LASTQUARTERS:{key:"LASTQUARTERS",textKey:"CONDITION_DATERANGETYPE_LASTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_LASTQUARTER",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISQUARTER",category:"DYNAMIC.QUARTER.INT",order:19,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},LASTYEARS:{key:"LASTYEARS",textKey:"CONDITION_DATERANGETYPE_LASTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_LASTYEAR",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISYEAR",category:"DYNAMIC.YEAR.INT",order:28,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTDAYS:{key:"NEXTDAYS",textKey:"CONDITION_DATERANGETYPE_NEXTDAYS",singularTextKey:"CONDITION_DATERANGETYPE_TOMORROW",zeroNumberTextKey:"CONDITION_DATERANGETYPE_TODAY",category:"DYNAMIC.DATE.INT",order:5,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTWEEKS:{key:"NEXTWEEKS",textKey:"CONDITION_DATERANGETYPE_NEXTWEEKS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTWEEK",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISWEEK",category:"DYNAMIC.WEEK.INT",order:10,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTMONTHS:{key:"NEXTMONTHS",textKey:"CONDITION_DATERANGETYPE_NEXTMONTHS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTMONTH",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISMONTH",category:"DYNAMIC.MONTH.INT",order:16,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTQUARTERS:{key:"NEXTQUARTERS",textKey:"CONDITION_DATERANGETYPE_NEXTQUARTERS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTQUARTER",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISQUARTER",category:"DYNAMIC.QUARTER.INT",order:21,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},NEXTYEARS:{key:"NEXTYEARS",textKey:"CONDITION_DATERANGETYPE_NEXTYEARS",singularTextKey:"CONDITION_DATERANGETYPE_NEXTYEAR",zeroNumberTextKey:"CONDITION_DATERANGETYPE_THISYEAR",category:"DYNAMIC.YEAR.INT",order:30,defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],onChange:L._IntOnChangeHandler,filterSuggestItem:L._IntFilterSuggestItem,onItemSelected:L._IntOnItemSelected,getControls:L.ControlFactory},SPECIFICMONTH:{key:"SPECIFICMONTH",textKey:"CONDITION_DATERANGETYPE_SPECIFICMONTH",category:"DYNAMIC.MONTH",order:11,defaultValues:function(){var e=new T;return[e.getMonth()]},value1:null,onChange:L._MonthOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,filterSuggestItem:L._MonthFilterSuggestItem,getControls:function(t,a,n){var i=new l(e._createStableId(t,"field"),{ariaLabelledBy:t._oOperationSelect||null,width:"100%",selectedKey:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer"}});i.bindAggregation("items",{path:"$smartEntityFilter>/currentoperation/valueList",template:new u({text:{path:"$smartEntityFilter>text"},key:{path:"$smartEntityFilter>key"}}),templateShareable:false});a.push(i)},getValueList:function(){var e=new T,t=[],a=p.getDateInstance({pattern:"LLLL"});e.setDate(15);e.setMonth(0);for(var n=0;n<12;n++){t.push({text:a.format(e),key:n});e.setMonth(e.getMonth()+1)}return t}},YESTERDAY:{key:"YESTERDAY",textKey:"CONDITION_DATERANGETYPE_YESTERDAY",category:"FIXED.DATE",order:3.1,defaultValues:function(){return h.ranges.yesterday()},type:"range",display:"start",onChange:L._DateWithDefaultsOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory},TODAY:{key:"TODAY",textKey:"CONDITION_DATERANGETYPE_TODAY",category:"FIXED.DATE",order:3,defaultValues:function(){return h.ranges.today()},type:"range",display:"start",onChange:L._DateWithDefaultsOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory},TOMORROW:{key:"TOMORROW",textKey:"CONDITION_DATERANGETYPE_TOMORROW",category:"FIXED.DATE",order:3.2,defaultValues:function(){var e=h.ranges.tomorrow();return e},type:"range",display:"start",onChange:L._DateWithDefaultsOnChangeHandler,onItemSelected:L._DefaultOnItemSelected,getControls:L.ControlFactory},THISWEEK:L.getFixedRangeOperation("THISWEEK","CONDITION_DATERANGETYPE_THISWEEK","FIXED.WEEK",function(){return h.ranges.currentWeek()},L._DefaultFilterSuggestItem,6),LASTWEEK:L.getFixedRangeOperation("LASTWEEK","CONDITION_DATERANGETYPE_LASTWEEK","FIXED.WEEK",function(){return h.ranges.lastWeek()},L._DefaultFilterSuggestItem,7),LAST2WEEKS:L.getFixedRangeOperation("LAST2WEEKS","CONDITION_DATERANGETYPE_LAST2WEEKS","FIXED.WEEK",function(){return h.ranges.lastWeeks(-2)},L._HideFilterSuggestItem,-1),LAST3WEEKS:L.getFixedRangeOperation("LAST3WEEKS","CONDITION_DATERANGETYPE_LAST3WEEKS","FIXED.WEEK",function(){return h.ranges.lastWeeks(-3)},L._HideFilterSuggestItem,-1),LAST4WEEKS:L.getFixedRangeOperation("LAST4WEEKS","CONDITION_DATERANGETYPE_LAST4WEEKS","FIXED.WEEK",function(){return h.ranges.lastWeeks(-4)},L._HideFilterSuggestItem,-1),LAST5WEEKS:L.getFixedRangeOperation("LAST5WEEKS","CONDITION_DATERANGETYPE_LAST5WEEKS","FIXED.WEEK",function(){return h.ranges.lastWeeks(-5)},L._HideFilterSuggestItem,-1),NEXTWEEK:L.getFixedRangeOperation("NEXTWEEK","CONDITION_DATERANGETYPE_NEXTWEEK","FIXED.WEEK",function(){return h.ranges.nextWeek()},L._DefaultFilterSuggestItem,9),NEXT2WEEKS:L.getFixedRangeOperation("NEXT2WEEKS","CONDITION_DATERANGETYPE_NEXT2WEEKS","FIXED.WEEK",function(){return h.ranges.nextWeeks(2)},L._HideFilterSuggestItem,-1),NEXT3WEEKS:L.getFixedRangeOperation("NEXT3WEEKS","CONDITION_DATERANGETYPE_NEXT3WEEKS","FIXED.WEEK",function(){return h.ranges.nextWeeks(3)},L._HideFilterSuggestItem,-1),NEXT4WEEKS:L.getFixedRangeOperation("NEXT4WEEKS","CONDITION_DATERANGETYPE_NEXT4WEEKS","FIXED.WEEK",function(){return h.ranges.nextWeeks(4)},L._HideFilterSuggestItem,-1),NEXT5WEEKS:L.getFixedRangeOperation("NEXT5WEEKS","CONDITION_DATERANGETYPE_NEXT5WEEKS","FIXED.WEEK",function(){return h.ranges.nextWeeks(5)},L._HideFilterSuggestItem,-1),THISMONTH:L.getFixedRangeOperation("THISMONTH","CONDITION_DATERANGETYPE_THISMONTH","FIXED.MONTH",function(){return h.ranges.currentMonth()},L._DefaultFilterSuggestItem,12),LASTMONTH:L.getFixedRangeOperation("LASTMONTH","CONDITION_DATERANGETYPE_LASTMONTH","FIXED.MONTH",function(){return h.ranges.lastMonth()},L._DefaultFilterSuggestItem,13),NEXTMONTH:L.getFixedRangeOperation("NEXTMONTH","CONDITION_DATERANGETYPE_NEXTMONTH","FIXED.MONTH",function(){return h.ranges.nextMonth()},L._DefaultFilterSuggestItem,15),THISQUARTER:L.getFixedRangeOperation("THISQUARTER","CONDITION_DATERANGETYPE_THISQUARTER","FIXED.QUARTER",function(){return h.ranges.currentQuarter()},L._DefaultFilterSuggestItem,17),LASTQUARTER:L.getFixedRangeOperation("LASTQUARTER","CONDITION_DATERANGETYPE_LASTQUARTER","FIXED.QUARTER",function(){return h.ranges.lastQuarter()},L._DefaultFilterSuggestItem,18),NEXTQUARTER:L.getFixedRangeOperation("NEXTQUARTER","CONDITION_DATERANGETYPE_NEXTQUARTER","FIXED.QUARTER",function(){return h.ranges.nextQuarter()},L._DefaultFilterSuggestItem,20),YEARTODATE:L.getFixedRangeOperation("YEARTODATE","CONDITION_DATERANGETYPE_YEARTODATE","FIXED.YEAR",function(){return h.ranges.yearToDate()},L._DefaultFilterSuggestItem,31),THISYEAR:L.getFixedRangeOperation("THISYEAR","CONDITION_DATERANGETYPE_THISYEAR","FIXED.YEAR",function(){return h.ranges.currentYear()},L._DefaultFilterSuggestItem,26),LASTYEAR:L.getFixedRangeOperation("LASTYEAR","CONDITION_DATERANGETYPE_LASTYEAR","FIXED.YEAR",function(){return h.ranges.lastYear()},L._DefaultFilterSuggestItem,27),NEXTYEAR:L.getFixedRangeOperation("NEXTYEAR","CONDITION_DATERANGETYPE_NEXTYEAR","FIXED.YEAR",function(){return h.ranges.nextYear()},L._DefaultFilterSuggestItem,29),QUARTER1:L.getFixedRangeOperation("QUARTER1","CONDITION_DATERANGETYPE_QUARTER1","FIXED.QUARTER",function(){return h.ranges.quarter(1)},L._DefaultFilterSuggestItem,22),QUARTER2:L.getFixedRangeOperation("QUARTER2","CONDITION_DATERANGETYPE_QUARTER2","FIXED.QUARTER",function(){return h.ranges.quarter(2)},L._DefaultFilterSuggestItem,23),QUARTER3:L.getFixedRangeOperation("QUARTER3","CONDITION_DATERANGETYPE_QUARTER3","FIXED.QUARTER",function(){return h.ranges.quarter(3)},L._DefaultFilterSuggestItem,24),QUARTER4:L.getFixedRangeOperation("QUARTER4","CONDITION_DATERANGETYPE_QUARTER4","FIXED.QUARTER",function(){return h.ranges.quarter(4)},L._DefaultFilterSuggestItem,25),TODAYFROMTO:{key:"TODAYFROMTO",textKey:"CONDITION_DATERANGETYPE_TODAYFROMTO",singularTextKey:"CONDITION_DATERANGETYPE_TODAYFROMTO",category:"DYNAMIC.DATE.INT",order:3.3,defaultValues:[1,1],type:"[int,int]",display:"int",value1:null,value2:null,descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],onChange:L._IntFromToOnChangeHandler,filterSuggestItem:L._IntFromToFilterSuggestItem,onItemSelected:L._IntOnItemsSelected,getControls:L.ControlFactory}};L.SingleOperations={DATE:Object.assign({},L.Operations.DATE,{defaultOperation:true}),YESTERDAY:L.Operations.YESTERDAY,TODAY:L.Operations.TODAY,TOMORROW:L.Operations.TOMORROW,FIRSTDAYWEEK:{key:"FIRSTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"FIRSTDAYWEEK",values:[]})}},LASTDAYWEEK:{key:"LASTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"LASTDAYWEEK",values:[]})}},FIRSTDAYMONTH:{key:"FIRSTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"FIRSTDAYMONTH",values:[]})}},LASTDAYMONTH:{key:"LASTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"LASTDAYMONTH",values:[]})}},FIRSTDAYQUARTER:{key:"FIRSTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"FIRSTDAYQUARTER",values:[]})}},LASTDAYQUARTER:{key:"LASTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"LASTDAYQUARTER",values:[]})}},FIRSTDAYYEAR:{key:"FIRSTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"FIRSTDAYYEAR",values:[]})}},LASTDAYYEAR:{key:"LASTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new O).toDates({operator:"LASTDAYYEAR",values:[]})}}};L.NewDynamicDateRangeOperations={DATETOYEAR:{key:"DATETOYEAR",category:"FIXED.YEAR",type:"range",display:"range",defaultValues:function(){return(new O).toDates({operator:"DATETOYEAR",values:[]})}}};L.DTOffsetOperations=Object.assign({},L.Operations,L.NewDynamicDateRangeOperations,{DATERANGE:Object.assign({},L.Operations.DATERANGE,{defaultOperation:false}),DATETIME:{key:"DATETIME",category:"DYNAMIC.DATETIME",type:"range",display:"range",value1:null,defaultValues:[null]},DATETIMERANGE:{key:"DATETIMERANGE",category:"DYNAMIC.DATETIMERANGE",type:"range",display:"range",defaultOperation:true,value1:null,value2:null,defaultValues:[null,null]}});L.prototype.getControls=function(e){var t=[];if(!e){return}if(!e.getControls){e.getControls=L.ControlFactory}e.getControls(this,t,e);return t};L.prototype.setIgnoreTime=function(e){this._bIgnoreTime=e};e.prototype.getIgnoreTime=function(e){return this._bIgnoreTime};L.prototype.getDefaultValues=function(e){if(!e){return[]}var t=e.defaultValues||[];if(typeof t==="function"){t=e.defaultValues()}var a=this.getCondition(),n=t[0]||null,i=t[1]||null;if(e.key==="DATERANGE"&&a&&a.value1&&a.value2&&(a.value1 instanceof Date&&a.value2 instanceof Date||a.value1.oDate&&a.value2.oDate)){n=a.value1.oDate||a.value1;i=a.value2.oDate||a.value2}else{if(n instanceof Date){n=new T(n)}if(i instanceof Date){i=new T(i)}}return[n,i]};L.prototype.getOperations=function(){if(this._bSingleFilterRestriction){return this.getSingleOperations()}if(this._bDTOffset){return this.getDTOffsetOperations()}var e=[];var t=L.Operations;if(this._isNewDynamicDateRangeEnabled()){t=Object.assign({},t,L.NewDynamicDateRangeOperations)}for(var a in t){var n=t[a];if(this._filterOperation(n)){e.push(n)}}return e};L.prototype.getSingleOperations=function(){var e=[];for(var t in L.SingleOperations){var a=L.SingleOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};L.prototype.getDTOffsetOperations=function(){var e=[];for(var t in L.DTOffsetOperations){var a=L.DTOffsetOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};L.prototype._updateOperation=function(t){e.prototype._updateOperation.apply(this,[t]);if(t.languageText&&!t.basicLanguageText){t.basicLanguageText=t.languageText;if(!t.singulareBasicLanguageText&&t.singularTextKey){t.singulareBasicLanguageText=this.getTranslatedText(t.singularTextKey)}if(!t.zeroNumberLanguageText&&t.zeroNumberTextKey){t.zeroNumberLanguageText=this.getTranslatedText(t.zeroNumberTextKey)}t.languageText=this._fillNumberToText(t.languageText)}if(t.display){var a=this.getDefaultValues(t);var n=this._getDateFormatter(false);if(t.display==="start"&&a[0]!==null){t.textValue=n.format(a[0].oDate)}else if(t.display==="range"&&a&&a[0]&&a[1]){t.textValue=n.format(a[0].oDate)+" - "+n.format(a[1].oDate)}}t.suggestText=t.languageText};L.prototype.isValidCondition=function(){var e=this.getCondition(),t=this.getOperation(e.operation);if(t&&e&&e.key&&e.operation){if("value1"in t&&"value2"in t){return"value1"in e&&e.value1!==null&&"value2"in e&&e.value2!==null}else if("value1"in t){return"value1"in e&&e.value1!==null}else if("value2"in t){return"value2"in e&&e.value2!==null}else if(!("value1"in t)&&!("value2"in t)){return true}}return false};L.prototype.hasSemanticDate=function(e){var t=this.getOperations();if(e.ranges[0].semantic&&e.ranges[0].semantic.operation){var a=0;for(a=0;a<t.length;a++){if(t[a].key.indexOf(e.ranges[0].semantic.operation)!==-1){return true}}return false}};L.prototype.hasCustomSemanticDate=function(e){return e.ranges[0]&&e.ranges[0].semantic&&e.ranges[0].semantic.operation&&e.ranges[0].semantic.operation!==this.getDefaultOperation().key};L.prototype.providerDataUpdated=function(e,t){};L.prototype.initialize=function(t){e.prototype.initialize.apply(this,[t]);this.oModel.suspend();var a=Object.assign({},t,true),n,i;var r=(new T).getCalendarType();if(!t.conditionTypeInfo){if(t.ranges&&t.ranges.length==1){var o;if(this.hasSemanticDate(t)&&!this._bSingleFilterRestriction){o=t.ranges[0].semantic.operation;if(t.ranges[0].semantic.value1||t.ranges[0].semantic.value1==0){n=t.ranges[0].semantic.value1}if(t.ranges[0].semantic.value2||t.ranges[0].semantic.value2==0){i=t.ranges[0].semantic.value2}if(this.getDefaultOperation().key===o){var s=this.getOperation(o),l=s&&s._getInitialValues?s._getInitialValues(t):null;if(!l){l=this.getDefaultValues(s)}if(l[0]&&l[0].oDate&&l[0].oDate.toISOString()!==t.ranges[0].value1||l[1]&&l[1].oDate&&l[1].oDate.toISOString()!==t.ranges[0].value2){o="DATERANGE"}}}else if(this.hasSemanticDate(t)&&this._bSingleFilterRestriction){o=t.ranges[0].semantic.operation;if(t.ranges[0].semantic.value1||t.ranges[0].semantic.value1==0){n=t.ranges[0].semantic.value1}t.ranges[0].value2=null;if(t.ranges[0].semantic.value2||t.ranges[0].semantic.value2==0){i=null}if(this.getDefaultOperation().key===o){var s=this.getOperation(o),l=s&&s._getInitialValues?s._getInitialValues(t):null;if(!l){l=this.getDefaultValues(s)}if(l[0]&&l[0].oDate&&l[0].oDate.toISOString()!==t.ranges[0].value1||l[1]&&l[1].oDate&&l[1].oDate.toISOString()!==t.ranges[0].value2){o="DATE"}if(l[0]&&l[0].oDate&&l[0].oDate.toISOString()===n){n=t.ranges[0].value1?t.ranges[0].value1:t.ranges[0].semantic.value1}}}else if(this.hasCustomSemanticDate(t)){this._customSemanticOperation=t.ranges[0].semantic.operation;if(this._bSingleFilterRestriction){o="DATE"}else{o="DATERANGE"}}else if(this._bSingleFilterRestriction){o="DATE"}else{o="DATERANGE"}if(t.ranges[0].operation==="GE"){o="FROM"}if(t.ranges[0].operation==="LE"){o="TO"}t.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:o,value1:n||n==0?n:t.ranges[0].value1,value2:i||i==0?i:t.ranges[0].value2,calendarType:r}}}else{var s=this.getDefaultOperation(),u=s?s.key:"";if(t.value1){var g=t.value1}if(t.value2){var p=t.value2}t.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:u,calendarType:r}};if(g){t.conditionTypeInfo.data.value1=g}if(p){t.conditionTypeInfo.data.value2=p}}}if(t.conditionTypeInfo){t=t.conditionTypeInfo}if(t.name&&t.data){if(t.name!==this.getName()){I.debug("ConditionType "+this.getName()+" tries to deserialize data from "+t.name)}t=t.data}if(!t.operation){return}if(this.getOperation(t.operation)&&this.getOperation(t.operation).order<0){var f=["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS"].indexOf(t.operation);if(f>=0){t.operation="LASTWEEKS";t.value1=f+2}f=["NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"].indexOf(t.operation);if(f>=0){t.operation="NEXTWEEKS";t.value1=f+2}}var E=this.getOperation(t.operation);if(!E){if(this.getAsync()){this.setPending(true);var d=this,c=function(e){if(e.getParameter("pending")===false){d.oFilterProvider.detachPendingChange(c);d.initialize(a)}};this.oFilterProvider.attachPendingChange(c);this.oModel.resume();return}}var D;if(r!==t.calendarType&&(t.calendarType==="Islamic"||r==="Islamic")&&t.operation==="SPECIFICMONTH"){t.operation="DATERANGE";var y=parseInt(t.value1),v=T.getInstance(new Date,t.calendarType);v.setMonth(y);v=h.getMonthStartDate(v);D=h.getRange(0,"MONTH",v);t.value1=D[0].oDate.toISOString();t.value2=D[1].oDate.toISOString()}var m=this.getConditionContext().getObject();m.operation=t.operation;m.key=t.key;m.value1=null;m.value2=null;if(t.operation==="DATERANGE"){if(typeof t.value1==="string"){t.value1=t.value1===""?null:new T(t.value1).oDate}if(typeof t.value2==="string"){t.value2=t.value2===""?null:new T(t.value2).oDate}m.value1=t.value1;m.value2=t.value2}else if(["DATE","FROM","TO"].indexOf(t.operation)!==-1){if(typeof t.value1==="string"){t.value1=t.value1===""?null:new T(t.value1).oDate}m.value1=t.value1}else if(["DATETIME","DATETIMERANGE"].indexOf(t.operation)!==-1){if(typeof t.value1==="string"){t.value1=t.value1===""?null:new T(t.value1).oDate}m.value1=t.value1;if(typeof t.value2==="string"){t.value2=t.value2===""?null:new T(t.value2).oDate}m.value2=t.value2}else if(["LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS","NEXTDAYS","NEXTWEEKS","NEXTMONTHS","NEXTQUARTERS","NEXTYEARS"].indexOf(t.operation)>-1){m.value1=t.value1}else if(t.operation==="SPECIFICMONTH"){m.value1=t.value1+""}else if(t.operation==="TODAYFROMTO"){m.value1=t.value1;m.value2=t.value2}else{E=this.getOperation(t.operation);D=E&&E._getInitialValues?E._getInitialValues(t):null;if(!D){D=this._getValuesFromCurrentOperation(t)}if(!D){D=this.getDefaultValues(E)}m.value1=D[0];m.value2=D[1]}this.bIgnoreBindingChange=true;this.oModel.resume();delete this.bIgnoreBindingChange;this.serialize(true,false);this._setDDROperation.call(this,t)};L.prototype._getValuesFromCurrentOperation=function(e){var t=[];if(Number.isInteger(e.value1)){t.push(e.value1)}if(Number.isInteger(e.value2)){t.push(e.value2)}if(t.length>0){return t}return null};L.prototype.serialize=function(e,t){var a={},n=this.getCondition();if(!n.operation){return null}var i=this.getOperation(n.operation);if(!i||!("value1"in i)){n.value1=null}if(!i||!("value2"in i)){n.value2=null}n.calendarType=(new T).getCalendarType();a.conditionTypeInfo={name:this.getName(),data:n};if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}if(e){this._updateProvider(a,true,t)}else{this.iChangeTimer=setTimeout(this._updateProvider.bind(this,a,false,t),0)}return a};L.prototype._updateProvider=function(e,t,a){e.ranges=this.getFilterRanges();e.items=[];var n;var i=false;var r=0;var o=0;var s=0;var l=this.oModel.getData(),u=l.currentoperation;if(u&&u.languageText){var g=u.languageText;if(this._isIntIntInterval(u)){if(e.conditionTypeInfo.data.value1!=null&&e.conditionTypeInfo.data.value1!==""&&e.conditionTypeInfo.data.value2!=null&&e.conditionTypeInfo.data.value2!==""){g=this._formatIntIntInterval(u,e)}n="NONE";if(!this._isValidFromToPeriod(e.conditionTypeInfo.data.value1,e.conditionTypeInfo.data.value2)){n="ERROR"}}else if(this._isIntInterval(u)){if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){g=this._formatIntInterval(u,e);n="NONE"}else if(this._bSuggestItemSelected){g=this._fillNumberToText(u.basicLanguageText);var T=u.basicLanguageText.indexOf("{0}");r=T+1;o=T;s=T+1;i=true}else{g="";n="NONE"}}else if(this._isFixedRange(u)){g=this._formatFixedRange(u,u.textValue);n="NONE"}else{if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){var p=this._calculateDateRangeValueText(u,e);var f=p.value;i=p.bSetCursor;if(f){g=this._formatFixedRange(u,f);r=g.length-1;n="NONE"}else{g=""}}else{g=""}}this._bSuggestItemSelected=false;this.oModel.setProperty("/formattedText",g);if(n&&!this._isNewDynamicDateRangeEnabled()){this.oModel.setProperty("inputstate",n,this.getContext())}if(i&&!(this._oPopup&&this._oPopup.isOpen())&&this._oInput){this._oInput.$("inner").cursorPos(r);if(o<s){this._oInput.selectText(o,s)}this._oInput._lastValue=""}}if(this.oFilterProvider){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,e);this.oFilterProvider.setFilterData({},false,this.sFieldName);if(a&&this.oFilterProvider._oSmartFilter){this.oFilterProvider._oSmartFilter.fireFilterChange()}}};L.prototype.getFilterRanges=function(){var e,t=this.getCondition(),a=[],n;if(this._bSingleFilterRestriction){t.operation="EQ";delete t.value2}else if(t.operation==="LASTDAYS"){if(!isNaN(t.value1)){a=h.ranges.lastDays(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTWEEKS"){if(!isNaN(t.value1)){a=h.ranges.lastWeeks(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTMONTHS"){if(!isNaN(t.value1)){a=h.ranges.lastMonths(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTQUARTERS"){if(!isNaN(t.value1)){a=h.ranges.lastQuarters(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="LASTYEARS"){if(!isNaN(t.value1)){a=h.ranges.lastYears(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTDAYS"){if(!isNaN(t.value1)){a=h.ranges.nextDays(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTWEEKS"){if(!isNaN(t.value1)){a=h.ranges.nextWeeks(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTMONTHS"){if(!isNaN(t.value1)){a=h.ranges.nextMonths(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTQUARTERS"){if(!isNaN(t.value1)){a=h.ranges.nextQuarters(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="NEXTYEARS"){if(!isNaN(t.value1)){a=h.ranges.nextYears(t.value1)}t.value1=a[0];t.value2=a[1]}else if(t.operation==="SPECIFICMONTH"){var i=parseInt(t.value1),r=new T;if(Number.isFinite(i)){r.setDate(1);r.setMonth(i);r=h.getMonthStartDate(r);a=h.getRange(0,"MONTH",r);t.value1=a[0];t.value2=a[1]}}else if(t.operation==="TODAYFROMTO"){if(!isNaN(parseInt(t.value1))){t.value1=this._getTodayFromToValueFrom(t.value1)}if(!isNaN(parseInt(t.value2))){t.value2=this._getTodayFromToValueTo(t.value2)}}else{var o=this.getOperation(t.operation);if(o&&o.getDateRange){n=o.getDateRange(t);if(!n){return[]}t.value1=n&&n.value1?n.value1:null;t.value2=n&&n.value2?n.value2:null}}if(t.value1 instanceof T){t.value1=t.value1.oDate}if(t.value2 instanceof T){t.value2=t.value2.oDate}if(t.operation==="DATE"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="BT";t.value2=t.value1;t.value1=L.setStartTime(t.value1).oDate;t.value2=L.setEndTime(t.value2,this._bIgnoreTime,this._Precision).oDate}else if(t.operation==="FROM"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="GE";delete t.value2;t.value1=L.setStartTime(t.value1,this._bIgnoreTime).oDate}else if(t.operation==="TO"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="LE";delete t.value2;t.value1=L.setEndTime(t.value1,this._bIgnoreTime).oDate}else if(this._bSingleFilterRestriction){if(!(this.isValidCondition()&&t.value1)){return[]}}else if(t.operation==="DATETIME"){if(!(this.isValidCondition()&&t.value1)){return[]}t.operation="EQ";delete t.value2}else if(t.operation==="DATETIMERANGE"){if(!(this.isValidCondition()&&t.value1&&t.value2)){return[]}t.operation="BT"}else{if(n){t.operation=n.operation;t.value1=t.value1?L.setStartTime(t.value1).oDate:null;t.value2=t.value2?L.setEndTime(t.value2,this._bIgnoreTime).oDate:null}else{if(!(this.isValidCondition()&&t.value1&&t.value2)){return[]}t.operation="BT";t.value1=L.setStartTime(t.value1).oDate;t.value2=L.setEndTime(t.value2,this._bIgnoreTime).oDate}}t.exclude=false;t.keyField=t.key;delete t.key;if(this._isNewDynamicDateRangeEnabled()&&t.value2){if(typeof t.value1.getTime==="function"&&typeof t.value2.getTime==="function"&&t.value1.getTime()>t.value2.getTime()){e=t.value2;t.value2=t.value1;t.value1=e}}return[t]};L.prototype.getTokenText=function(){return""};L.prototype.getName=function(){return this.getMetadata().getName()};L.prototype.getType=function(){return"Edm.Date"};L.prototype._bindValueState=function(e){e.bindProperty("valueState",{path:"$smartEntityFilter>inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return S.Error}else{return S.None}}})};L.prototype.initializeFilterItem=function(){if(this._isNewDynamicDateRangeEnabled()){return this._initializeFilterItemNew.apply(this,arguments)}return this._initializeFilterItemOld.apply(this,arguments)};L.prototype._initializeFilterItemOld=function(){this._oInput=new r(e._createStableId(this),{value:"{$smartEntityFilter>formattedText}",showValueHelp:true,showSuggestion:true,maxSuggestionWidth:"auto",valueHelpRequest:this._toggleOpen.bind(this)});this._oInput._highlightListText=function(){var e,t,a=this._oList.$().find(".sapMDLILabel, .sapMSLITitleOnly");for(e=0;e<a.length;e++){t=a[e];t.innerHTML=this._createHighlightedText(t)}};this._bindValueState(this._oInput);this._oInput.bindAggregation("suggestionItems",{path:"$smartEntityFilter>operations",sorter:new c("order",false,false),filters:new D("order",function(e){return e!==undefined&&e>-1}),template:new u({key:{path:"$smartEntityFilter>key"}}),templateShareable:false});this._oInput.setFilterFunction(function(e,t){if(this._oPopup&&this._oPopup.isOpen()){return false}var a=this.getOperation(t.getKey());e=e.trim();if(e==="?"){L._DefaultFilterSuggestItem.call(a,e,t,this);return a.category!=="DYNAMIC.DATERANGE"&&a.category!=="DYNAMIC.DATE"}if(a.filterSuggestItem){return a.filterSuggestItem(e,t,this)}else{return L._DefaultFilterSuggestItem.call(a,e,t,this)}}.bind(this));this._oInput.attachSuggestionItemSelected(function(e){var t=e.getParameter("selectedItem");if(!t){return}var a=t.getKey();var n=this.getOperation(a);var i=e.oSource.getValue().trim();if(n.onItemSelected){n.onItemSelected(i,t,this);return}else{L._DefaultOnItemSelected.call(n,i,t,this)}}.bind(this));this._oInput.attachChange(function(e){var t=e.getParameter("value");if(t){var a=this.getOperations();var n=a.some(function(e){if(e.onChange){return e.onChange(t,this)}else{return L._defaultOnChangeHandler.call(e,t,this)}},this);if(!n){this.oModel.setProperty("inputstate","ERROR",this.getContext())}}else{this.setCondition({key:this.sFieldName,operation:"FROM",value1:null,value2:null});this.oModel.setProperty("inputstate","NONE",this.getContext())}}.bind(this));this._oInput.attachBrowserEvent("focusin",function(e){if(jQuery(e.target).hasClass("sapMInputBaseInner")&&this._oPopup&&this._oPopup.isOpen()){this._oPopup.close()}}.bind(this));this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput};L.prototype._toggleOpen=function(a){if(!this._oPopup){if((!x||!P||t.system.phone&&!M)&&!this._bPopoverRequested){x=sap.ui.require("sap/m/ResponsivePopover");P=sap.ui.require("sap/m/VBox");if(t.system.phone){M=sap.ui.require("sap/m/Button");if(!x||!P||!M){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox","sap/m/Button"],b.bind(this));this._bPopoverRequested=true}}else if(!x||!P){sap.ui.require(["sap/m/ResponsivePopover","sap/m/VBox"],b.bind(this));this._bPopoverRequested=true}}if(!x||!P||t.system.phone&&!M){return}this._oPopupLayout=new P;this._oPopupLayout.addStyleClass("sapUiCompDateRangeType");this._initializeFilterItemPopoverContent(this._oPopupLayout);this._oPopup=new x({showCloseButton:false,showArrow:true,showHeader:false,horizontalScrolling:false,placement:C.VerticalPreferedBottom,content:this._oPopupLayout,contentWidth:"18rem",afterClose:function(){if(K(this._oPopup)){this._oPopup.getModel("$smartEntityFilter").refresh(true)}if(this.oFilterProvider._oSmartFilter.getLiveMode()){var e=sap.ui.require("sap/ui/comp/smartfilterbar/SmartFilterBar");this.oFilterProvider._oSmartFilter.triggerSearch(e.LIVE_MODE_INTERVAL)}}.bind(this)});this._oPopup.addAriaLabelledBy(this._oOperationLabel);if(t.system.phone){this._oPopup.setBeginButton(new M({text:e.getTranslatedText("CONDITION_DATERANGETYPE_POPOVER_CLOSEBUTTON"),type:"Emphasized",press:function(e){this._oPopup.close()}.bind(this)}))}sap.ui.getCore().getMessageManager().registerObject(this._oPopup,true);this._oPopup.setModel(this.getModel(),"$smartEntityFilter");this._oPopup._oControl.oPopup.setAutoCloseAreas([this._oInput.getDomRef()])}if(!this._oPopup.isOpen()){this._oPopup.openBy(this._oInput._getValueHelpIcon())}else{this._oPopup.close()}};function b(e,t,a){x=e;P=t;M=a;this._bPopoverRequested=false;if(!this._bIsBeingDestroyed){this._toggleOpen()}}function K(e){var t,a,n=false,i=e.getContent()[0].getItems();for(t=0;t<i.length;t++){a=i[t];if(a.getMetadata().getName()==="sap.m.DatePicker"&&a.getValueState()!==S.None){n=true;break}}return n}L.prototype.datePickerValidateLastValue=function(e){var t;if(!e.isValidValue()){t=e.getValue();e.resetProperty("value");e.setValue(t);if(e.isValidValue()){e.setValueState(e.isValidValue()?S.None:S.Error)}}};L.prototype._getDateFormatter=function(e){var t={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:e};if(JSON.stringify(t)!==this._sFormatSettings){this._sFormatSettings=JSON.stringify(t);this._oDateFormatter=p.getInstance(t)}return this._oDateFormatter};L.prototype._fillNumberToText=function(e,t,a){var n="X",i="Y";if(t||t===0){n=String(t)}if(a||a===0){i=String(a);if(t<0){n="("+n+")"}if(a<0){i="("+i+")"}}e=e.replace("{0}",n);e=e.replace("{1}",i);return e};L.prototype._setIntControlBinding=function(t,a,n){t.setFieldWidth("auto");t.bindProperty("description",{path:"$smartEntityFilter>"+n,type:"sap.ui.model.type.Integer",formatter:function(){var t=a.descriptionTextKeys[0];var n=a.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return e.getTranslatedText(t)}else{return e.getTranslatedText(n||t)}}})};L.prototype._createIntFromToControl=function(t,a,n){return new r(e._createStableId(t,a),{value:{path:"$smartEntityFilter>"+n,type:new Y({},{minimum:-t._maxIntValue,maximum:t._maxIntValue})},ariaLabelledBy:t._oOperationSelect||null,textAlign:"End",width:"100%"})};L.prototype._isValidFromToPeriod=function(e,t){if(!e&&e!==0||isNaN(e)){return false}if(!t&&t!==0||isNaN(t)){return false}if(e<-this._maxIntValue||e>this._maxIntValue){return false}if(t<-this._maxIntValue||t>this._maxIntValue){return false}if(e<0&&Math.abs(e)>Math.abs(t)||e===0&&t<0||t<0&&Math.abs(t)>Math.abs(e)||t===0&&e<0||e<0&&t<0){return false}return true};L.prototype._getTodayFromToValueFrom=function(e){if(e<0){var t=h.getRange(-1*e,"DAY")[1];t.setHours(0,0,0);return t}return h.getRange(-e,"DAY")[0]};L.prototype._getTodayFromToValueTo=function(e){if(e<0){var t=h.getRange(e,"DAY")[0];t.setHours(23,59,59);return t}return h.getRange(e,"DAY")[1]};L.prototype._getInputValueState=function(){if(this._oInput){return this._oInput.getValueState()}};L.prototype.destroy=function(){if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}if(this._oPopup){sap.ui.getCore().getMessageManager().unregisterObject(this._oPopup);this._oPopup.destroy()}e.prototype.destroy.apply(this,arguments)};L.prototype._initializeFilterItemNew=function(){this._createCustomDDOptions(this.getOperations());var t={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:false};this._oInput=new y(e._createStableId(this),{name:this.sFieldName,formatter:m.getInstance({date:t}),enableGroupHeaders:!this._bSingleFilterRestriction,options:{path:"$smartEntityFilter>/operations",formatter:function(e){return e.map(function(e){if(F.includes(e.key)){return e.key}return this._getCustomDDOptionName(e.key)}.bind(this))}.bind(this)},value:this._getDefaultValueDDR(),change:this._onDDRChange.bind(this)});this._bindValueState(this._oInput);this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput};L.prototype.updateOperations=function(){var e=this.getOperations();for(var t=0;t<e.length;t++){this._updateOperation(e[t])}if(this._isNewDynamicDateRangeEnabled()){this._createCustomDDOptions(e)}this.oModel.setProperty("operations",e,this.getContext(),true);if(this._customSemanticOperation){var a=e.find(function(e){return e.key===this._customSemanticOperation}.bind(this));if(a){this.setOperation(this._customSemanticOperation);this._customSemanticOperation=null}}return};L.prototype.setCondition=function(t){e.prototype.setCondition.apply(this,arguments);this._setDDROperation.call(this,t);return this};L.prototype._onDDRChange=function(e){var t,a,n=e.getParameter("value"),i=e.getParameter("valid");if(i&&n){var r=this._getOptionName(n.operator);t=this.getOperation(r);a=this._prepareDDRValues(t,n,r);this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation",r);this.oModel.setProperty("/condition/value1",a[0]);this.oModel.setProperty("/condition/value2",a[1])}else if(i){t=this.getOperation("DATERANGE");this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation","DATERANGE");this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null)}this.oModel.setProperty("inputstate",i?"NONE":"ERROR",this.getContext())};L.prototype._getDefaultValueDDR=function(){var e=this.getDefaultOperation(),t=e&&e.key;if(!this._getDDROption(t)){return null}var a=typeof e.defaultValues==="function"?e.defaultValues():e.defaultValues;if(!F.includes(t)){t=this._getCustomDDOptionName(t)}if(Array.isArray(a)&&a.length>0&&a[0]!==null){return{operator:t,values:a}}return null};L.prototype._getDDROption=function(e){if(F.includes(e)){return v.getOption(e)}return v.getOption(this._getCustomDDOptionName(e))};L.prototype._getCustomDDOptionName=function(e){return this.sFieldName+"__custom__"+e};L.prototype._getOptionName=function(e){var t=e.split("__custom__");if(t.length>1){return t[1]}return t[0]};L.prototype._createCustomDDOptions=function(e){e.forEach(this._createCustomDDOption,this)};L.prototype._createCustomDDOption=function(e){if(F.includes(e.key)){return}var t;var a=typeof e.category==="object"?e.category.key:e.category;if(a.toLowerCase().startsWith("fixed")||e.type==="range"){t=this._createCustomFixedDDOption(e)}else{t=this._createCustomDynamicDDOption(e)}t.getGroupHeader=function(){if(typeof e.category==="object"){var t=e.category.bundle;var a=e.category.key;if(sap.ui.getCore().getLibraryResourceBundle(t).hasText(a)){return sap.ui.getCore().getLibraryResourceBundle(t).getText(a)}}if(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").hasText(e.category)){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText(e.category)}if(sap.ui.getCore().getLibraryResourceBundle("sap.m").hasText(e.category)){return sap.ui.getCore().getLibraryResourceBundle("sap.m").getText(e.category)}return sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("DDR_OPTIONS_GROUP_0")};t.getGroup=function(){return e.order};v.addOption(t)};L.prototype._createCustomFixedDDOption=function(t){var a=this;var n=new _({key:this._getCustomDDOptionName(t.key),getText:function(){return t.languageText||e.getTranslatedText(t.textKey)},getValueHelpUITypes:function(){return[]},enhanceFormattedValue:function(){if(!a.getOperation(a._getOptionName(t.key))){return false}var e=typeof t.category==="object"?t.category.key:t.category;if(e.toUpperCase().startsWith("FIXED.")&&t.type==="int"){return false}return true},format:this._customDDOptionFormatter.bind(this),toDates:function(){var e=t.defaultValues;if(typeof e==="function"){e=e()}return e},parse:function(a){var n=t.basicLanguageText||t.languageText||e.getTranslatedText(t.textKey);if(a&&n&&n.toLowerCase().startsWith(a.toLowerCase())){return{operator:this.getKey(),values:this.toDates()}}return null}});return n};L.prototype._createCustomDynamicDDOption=function(t){var a=this;var n=new _({key:this._getCustomDDOptionName(t.key),getText:function(){var n=t.languageText||e.getTranslatedText(t.textKey);if(n.indexOf("{0}")>=0){return a._fillNumberToText(n)}return n},getValueHelpUITypes:function(){if(t.type==="int"){return[new N({type:"int"})]}else if(t.type==="[int,int]"){return[new N({type:"int"}),new N({type:"int"})]}},createValueHelpUI:function(e,n){e.aControlsByParameters={};e.aControlsByParameters[this.getKey()]=[];a.setControls([]);var i=a.getControls(t),r=t.defaultValues.length,o=t.defaultValues;if(typeof o==="function"){o=o()}i.forEach(function(t){if(!t.getValue()&&o&&o[0]){if(typeof o==="function"){o=o()}t.setValue(o[0]);o.shift();a.oModel.setProperty("/condition/value"+(r-o.length),t.getValue())}if(typeof n==="function"){t.attachChange(function(){n(this)},this)}e.aControlsByParameters[this.getKey()].push(t)},this);a.setControls(i);return i},format:this._customDDOptionFormatter.bind(this),toDates:function(e){var t=a.oModel.getProperty("",a.oConditionContext),n=t.operation,i=t.value1,r=t.value2;t.operation=a._getOptionName(e.operator);t.value1=!isNaN(e.values[0])?parseInt(e.values[0]):e.values[0];t.value2=!isNaN(e.values[1])?parseInt(e.values[1]):e.values[1];var o=a.getFilterRanges();t.operation=n;t.value1=i;t.value2=r;if(o.length===0){return[]}return[o[0].value1,o[0].value2]},parse:function(e){var n=new u({key:t.key}),i=t.filterSuggestItem.call(t,e,n,a);if(i){return{operator:this.getKey(),values:[n._value1,n._value2||null]}}return null},validateValueHelpUI:function(e){var t=function(e){var t=e.getValue(),a=this._maxIntValue,n=-this._maxIntValue;if(!t&&t!==0||isNaN(t)){return false}if(r&&r.getBindingInfo("value")&&r.getBindingInfo("value").type&&r.getBindingInfo("value").type.oConstraints){if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("minimum")){n=r.getBindingInfo("value").type.oConstraints.minimum}if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("maximum")){a=r.getBindingInfo("value").type.oConstraints.maximum}}if(t<n||t>a){return false}return true};var n=this.getValueHelpUITypes();for(var i=0;i<n.length;i++){var r=e.aControlsByParameters[this.getKey()][i];switch(n[i].getType()){case"int":return t.call(a,r);case"month":case"date":case"daterange":if(!r.getSelectedDates()||r.getSelectedDates().length==0){return false}break;case"options":if(r.getSelectedIndex()<0){return false}break}}return true}});return n};L.prototype._customDDOptionFormatter=function(e){var t=this._getOptionName(e.operator),a=this.getOperation(t);if(!a){this._oInput.setValue(null);this._oInput._oInput.setValue(null);this.oModel.setProperty("/currentoperation",null);this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null);return""}var n=this._prepareDDRValues(a,e,t);var i={conditionTypeInfo:{data:{value1:n[0],value2:n[1]}}};if(a.languageText){var r=a.languageText;if(this._isIntIntInterval(a)){if(i.conditionTypeInfo.data.value1!=null&&i.conditionTypeInfo.data.value1!==""&&i.conditionTypeInfo.data.value2!=null&&i.conditionTypeInfo.data.value2!==""){r=this._formatIntIntInterval(a,i)}}else if(this._isIntInterval(a)){if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){r=this._formatIntInterval(a,i)}else{r=""}}else if(this._isFixedRange(a)){r=this._formatFixedRange(a,a.textValue)}else{if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){var o=this._calculateDateRangeValueText(a,i);var s=o.value;if(s){r=this._formatFixedRange(a,s)}else{r=""}}else{r=""}}}return r};L.prototype._isNewDynamicDateRangeEnabled=function(){if(!this.oFieldMetadata||this._bSingleFilterRestriction){return true}return!this.oFieldMetadata.disableNewDateRangeControl};L.prototype._isIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0};L.prototype._formatIntInterval=function(e,t){if(t.conditionTypeInfo.data.value1===0&&e.zeroNumberTextKey){return e.zeroNumberLanguageText}if(t.conditionTypeInfo.data.value1===1&&e.singulareBasicLanguageText){return e.singulareBasicLanguageText}return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1)};L.prototype._isIntIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0&&e.basicLanguageText.indexOf("{1}")>=0};L.prototype._formatIntIntInterval=function(e,t){return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1,t.conditionTypeInfo.data.value2)};L.prototype._isFixedRange=function(e){return e.textValue};L.prototype._formatFixedRange=function(e,t){if(this._isNewDynamicDateRangeEnabled()){return e.languageText}return e.languageText+" ("+t+")"};L.prototype._calculateDateRangeValueText=function(e,t){var a=t.conditionTypeInfo.data.value1;var n=t.conditionTypeInfo.data.value2;var i;var r=false;if((typeof a==="number"||typeof a==="string"&&!isNaN(parseInt(a)))&&e.valueList){i=e.valueList[a].text}else if(a instanceof Date){var o=this._getDateFormatter(false);if(t.conditionTypeInfo.data.operation!=="DATERANGE"&&(a&&!n)){i=o.format(a)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&n){i=o.format(a)+" - "+o.format(n)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&!n&&!(this._oPopup&&this._oPopup.isOpen())){i=o.format(a)+" - ";r=true}else{i=""}}else{i=t.conditionTypeInfo.data.value1}return{value:i,bSetCursor:r}};L.prototype._convertUniversalDateToDate=function(e){return e.map(function(e){if(e.getJSDate){return e.getJSDate()}return e})};L.prototype._prepareDDRValues=function(e,t,a){var n=typeof e.category==="object"?e.category.key:e.category;if(e.type==="int"&&!n.toUpperCase().startsWith("FIXED.")){return[parseInt(t.values[0]),null]}if(e.type==="[int,int]"){return[parseInt(t.values[0]),parseInt(t.values[1])]}var i=this._getDDROption(a).toDates(t);if(this._bDTOffset&&(a==="DATETIME"||a==="DATETIMERANGE")){if(i[0]){i[0]=R.localToUiTimezone(i[0].oDate)}if(i[1]){i[1]=R.localToUiTimezone(i[1].oDate)}}return this._convertUniversalDateToDate(i)};L.prototype._setDDROperation=function(e){if(this._isNewDynamicDateRangeEnabled()&&this._oInput&&e.key&&e.operation){var t=[];if(e.value1||e.value1===0){t[0]=e.value1;if(e.value2||e.value2===0){t[1]=e.value2}}var a=this._getDDROption(e.operation),n=this.getOperation(e.operation),i=function(e,t){if(!e){return false}if(e.hasOwnProperty("value1")&&!t[0]&&t[0]!==0){return false}if(e.hasOwnProperty("value2")&&!t[1]&&t[1]!==0){return false}return true};if(this._bDTOffset&&(a.getKey()==="DATETIME"||a.getKey()==="DATETIMERANGE")){if(t[0]){t[0]=R.uiTimezoneToLocal(t[0])}if(t[1]){t[1]=R.uiTimezoneToLocal(t[1])}}if(i(n,t)){this._oInput.setValue({key:e.key,operator:a.getKey(),values:t})}else{this._oInput.setValue(null);this._oInput._oInput.setValue(null)}}};return L});
//# sourceMappingURL=DateRangeType.js.map