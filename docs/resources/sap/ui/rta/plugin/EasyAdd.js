/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/rta/plugin/additionalElements/AdditionalElementsPlugin","sap/ui/dt/OverlayRegistry","sap/m/Button","sap/ui/thirdparty/jquery"],function(e,t,a,jQuery){"use strict";var s=e.extend("sap.ui.rta.plugin.EasyAdd",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});s.prototype.registerElementOverlay=function(a){var s=a.getElement();if(s.getMetadata().getName()==="sap.uxap.ObjectPageSection"&&this.hasStableId(a)){a.addStyleClass("sapUiRtaPersAdd");s.addStyleClass("sapUiRtaMarginBottom")}else if(s.getMetadata().getName()==="sap.uxap.ObjectPageLayout"&&this.hasStableId(a)){a.addStyleClass("sapUiRtaPersAddTop");s.$("sectionsContainer").addClass("sapUiRtaPaddingTop")}var i=function(e,t,a){var s;var i="sections";if(e){s=t.getDesignTimeMetadata().getName().plural}else{s=t.getDesignTimeMetadata().getAggregation(i).childNames.plural()}this.clearCachedElements();this.showAvailableElements(e,i,[t],a,s)}.bind(this);var n=function(e,a,s,n,r){var o=function(e){var a=t.getOverlay(e.currentTarget.id.replace("-AddButton",""));i(s,a,r);e.stopPropagation()};var d=typeof n==="function"?n():n;this._addButton(e,o,a,d,s)}.bind(this);if(a.hasStyleClass("sapUiRtaPersAdd")){var r=a.hasStyleClass("sapUiRtaPersAdd")&&a.$().children(".sapUiRtaPersAddIconOuter").length<=0;if(r){n(a,a.$(),true,a.getDesignTimeMetadata().getName().singular)}}else if(a.hasStyleClass("sapUiRtaPersAddTop")){if(a.getAggregationOverlay("sections").$().children(".sapUiRtaPersAddIconOuter").length<=0){var o=a.getAggregationOverlay("sections").$();n(a,o,false,a.getDesignTimeMetadata().getAggregation("sections").childNames.singular,0)}}e.prototype.registerElementOverlay.apply(this,arguments)};s.prototype.deregisterElementOverlay=function(t){var a=t.getElement();if(t._oAddButton){t._oAddButton.destroy()}if(a.getMetadata().getName()==="sap.uxap.ObjectPageSection"){t.removeStyleClass("sapUiRtaPersAdd");a.removeStyleClass("sapUiRtaMarginBottom")}else if(a.getMetadata().getName()==="sap.uxap.ObjectPageLayout"){t.removeStyleClass("sapUiRtaPersAddTop");a.$("sectionsContainer").removeClass("sapUiRtaPaddingTop")}e.prototype.deregisterElementOverlay.apply(this,arguments)};s.prototype._isEditable=function(t){return e.prototype._isEditable.apply(this,arguments).then(function(e){if(t._oAddButton){var a=t.hasStyleClass("sapUiRtaPersAddTop");var s=a?"asChild":"asSibling";t._oAddButton.setEnabled(e[s]);if(a){var i=t.getElement();i.attachEventOnce("onAfterRenderingDOMReady",function(){i.$("sectionsContainer").addClass("sapUiRtaPaddingTop")})}}return e})};s.prototype._addButton=function(e,s,i,n,r){var o=e.getEditableByPlugins().indexOf(this._retrievePluginName(r))>-1;var d=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta");var l=e.getId()+"-AddButton";var p=jQuery("<div class='sapUiRtaPersAddIconOuter' draggable='true' tabindex='-1'> </div>");e._oAddButton=new a(l,{text:d.getText("CTX_ADD_ELEMENTS",n),icon:"sap-icon://add",enabled:o}).placeAt(p.get(0)).attachBrowserEvent("click",s).attachBrowserEvent("tap",s);i.append(p);p[0].addEventListener("mouseover",function(e){e.stopPropagation();var a=e.fromElement?t.getOverlay(e.fromElement.id):null;if(a&&a.getMetadata().getName()==="sap.ui.dt.ElementOverlay"){var s=a.getParentElementOverlay();s.removeStyleClass("sapUiRtaOverlayHover")}});p[0].addEventListener("mouseleave",function(e){e.stopPropagation();var a=e.toElement?t.getOverlay(e.toElement.id):null;if(a&&a.getMetadata().getName()==="sap.ui.dt.ElementOverlay"){var s=a.getParentElementOverlay();if(s.getMovable()){s.addStyleClass("sapUiRtaOverlayHover")}}});p[0].addEventListener("click",function(e){e.stopPropagation()});p[0].addEventListener("contextmenu",function(e){e.stopPropagation();e.preventDefault()});p[0].addEventListener("dragstart",function(e){e.stopPropagation();e.preventDefault()})};return s});
//# sourceMappingURL=EasyAdd.js.map