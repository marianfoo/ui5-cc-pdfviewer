/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/rta/plugin/Plugin","sap/ui/rta/Utils","sap/ui/fl/Utils","sap/ui/dt/Util","sap/base/util/uid"],function(e,t,n,i,r){"use strict";var a=e.extend("sap.ui.rta.plugin.Combine",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});a.prototype._isEditable=function(e){var t=this.getAction(e);if(!e.isRoot()&&t&&t.changeOnRelevantContainer){return this._checkChangeHandlerAndStableId(e)}return Promise.resolve(false)};a.prototype._checkForSameRelevantContainer=function(e){var t=[];for(var n=0,i=e.length;n<i;n++){t[n]=e[n].getRelevantContainer();var r=this.getAction(e[n]);if(!r||!r.changeType){return false}if(n>0){if(t[0]!==t[n]||this.getAction(e[0]).changeType!==r.changeType){return false}}}return true};a.prototype._checkBindingCompatibilityOfControls=function(e,n){return e.every(function(i){return e.every(function(e){return i!==e?t.checkSourceTargetBindingCompatibility(i,e,n):true})})};a.prototype.isAvailable=function(e){if(e.length<=1){return false}return e.every(function(e){return this._isEditableByPlugin(e)},this)&&this._checkForSameRelevantContainer(e)};a.prototype.isEnabled=function(e){if(!this.isAvailable(e)||e.length<=1){return false}var t=e.map(function(e){return e.getElement()});var n=e.every(function(e){var n=this.getAction(e);if(!n){return false}if(typeof n.isEnabled!=="undefined"){if(typeof n.isEnabled==="function"){return n.isEnabled(t)}return n.isEnabled}return true},this);if(n){var i=t[0]&&t[0].getModel();return this._checkBindingCompatibilityOfControls(t,i)}return n};a.prototype.handleCombine=function(e,t){var a;var o=e.map(function(e){if(e.getElement().getId()===t.getId()){a=e}return e.getElement()});var u=a.getDesignTimeMetadata();var s=this.getVariantManagementReference(a);var c=n.getViewForControl(t);var l=c.createId(r());return this.getCommandFactory().getCommandFor(t,"combine",{newElementId:l,source:t,combineElements:o},u,s).then(function(e){this.fireElementModified({command:e})}.bind(this)).catch(function(e){throw i.createError("Combine#handleCombine",e,"sap.ui.rta")})};a.prototype.getMenuItems=function(e){return this._getMenuItems(e,{pluginId:"CTX_GROUP_FIELDS",rank:90,icon:"sap-icon://combine"})};a.prototype.getActionName=function(){return"combine"};a.prototype.handler=function(e,t){this.handleCombine(e,t.contextElement)};return a});
//# sourceMappingURL=Combine.js.map