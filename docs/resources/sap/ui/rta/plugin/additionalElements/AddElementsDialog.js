/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObject","sap/ui/core/Fragment","sap/ui/fl/write/api/FieldExtensibility","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/resource/ResourceModel","sap/ui/model/Sorter","sap/ui/rta/Utils"],function(e,t,i,o,s,n,l,r,a){"use strict";var u=e.extend("sap.ui.rta.plugin.additionalElements.AddElementsDialog",{metadata:{library:"sap.ui.rta",properties:{customFieldEnabled:{type:"boolean",defaultValue:false},businessContextVisible:{type:"boolean",defaultValue:false},title:{type:"string"}},events:{opened:{},openCustomField:{}}}});var d;u.prototype.init=function(){this._oDialogPromise=t.load({id:this.getId(),name:"sap.ui.rta.plugin.additionalElements.AddElementsDialog",controller:this});this._oDialogModel=new o({elements:[],customFieldEnabled:false,customFieldVisible:false,businessContextVisible:false,customFieldButtonTooltip:"",businessContextTexts:[{text:""}]});this._oDialogPromise.then(function(e){e.setModel(this._oDialogModel);if(!d){d=new l({bundleName:"sap.ui.rta.messagebundle"})}e.setModel(d,"i18n");e.addStyleClass(a.getRtaStyleClassName());this._oDialogModel.setProperty("/listNoDataText",d.getProperty("MSG_NO_FIELDS").toLowerCase());this._oList=sap.ui.getCore().byId(this.getId()+"--rta_addElementsDialogList");this._bDescendingSortOrder=false}.bind(this))};u.prototype.exit=function(){this._oDialogPromise.then(function(e){e.destroy()});if(e.prototype.exit){e.prototype.exit.apply(this,arguments)}};u.prototype.setCustomFieldButtonVisible=function(e){this._oDialogModel.setProperty("/customFieldVisible",e)};u.prototype._submitDialog=function(){return this._oDialogPromise.then(function(e){e.close();this._fnResolveOnDialogConfirm()}.bind(this))};u.prototype._cancelDialog=function(){this._oDialogModel.getObject("/elements").forEach(function(e){e.selected=false});this._oDialogPromise.then(function(e){e.close()});this._fnRejectOnDialogCancel()};u.prototype.setElements=function(e){this._oDialogModel.setProperty("/elements",e)};u.prototype.getElements=function(){return this._oDialogModel.getProperty("/elements")};u.prototype.getSelectedElements=function(){return this._oDialogModel.getObject("/elements").filter(function(e){return e.selected})};u.prototype.open=function(){return new Promise(function(e,t){this._fnResolveOnDialogConfirm=e;this._fnRejectOnDialogCancel=t;this._oDialogPromise.then(function(e){e.attachAfterOpen(function(){this.fireOpened()}.bind(this));e.open()}.bind(this))}.bind(this))};u.prototype._resortList=function(){this._bDescendingSortOrder=!this._bDescendingSortOrder;var e=this._oList.getBinding("items");var t=[];t.push(new r("label",this._bDescendingSortOrder));e.sort(t)};u.prototype._updateModelFilter=function(e){var t=e.getParameter("newValue");var i=this._oList.getBinding("items");if(typeof t==="string"){var o=new s("label",n.Contains,t);var l=new s("originalLabel",n.Contains,t);var r=new s("parentPropertyName",n.Contains,t);var a=new s("duplicateName",n.EQ,true);var u=new s({filters:[r,a],and:true});var d=new s({filters:[o,l,u],and:false});i.filter([d])}else{i.filter([])}};u.prototype._redirectToCustomFieldCreation=function(){this.fireOpenCustomField();this._oDialogPromise.then(function(e){e.close()})};u.prototype.setTitle=function(t){e.prototype.setProperty.call(this,"title",t,true);this._oDialogPromise.then(function(e){e.setTitle(t)})};u.prototype.setCustomFieldEnabled=function(e){this.setProperty("customFieldEnabled",e,true);this._oDialogModel.setProperty("/customFieldEnabled",this.getProperty("customFieldEnabled"))};u.prototype._setBusinessContextVisible=function(e){this.setProperty("businessContextVisible",e,true);this._oDialogModel.setProperty("/businessContextVisible",e)};u.prototype.addExtensionData=function(e){this._removeExtensionDataTexts();var t=this._oDialogModel.getObject("/businessContextTexts");if(e&&e.length>0){e.forEach(function(e){t.push({text:e.description})},this)}else{t.push({text:d.getProperty("MSG_NO_BUSINESS_CONTEXTS")})}this._setBusinessContextVisible(true);return i.getTexts().then(function(e){if(e){this._oDialogModel.setProperty("/customFieldButtonTooltip",e.tooltip);this._oDialogModel.setProperty("/businessContextTexts/0/text",e.headerText)}}.bind(this))};u.prototype._removeExtensionDataTexts=function(){var e=this._oDialogModel.getObject("/businessContextTexts");e.splice(1)};return u});
//# sourceMappingURL=AddElementsDialog.js.map