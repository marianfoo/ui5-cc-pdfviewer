/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/rta/plugin/Plugin","sap/ui/dt/Util","sap/ui/fl/Utils","sap/ui/fl/write/api/LocalResetAPI","sap/ui/rta/command/CompositeCommand","sap/m/MessageToast","sap/ui/dt/OverlayRegistry"],function(e,t,a,r,n,i,o){"use strict";function s(e,t){return t?e.getCurrentVariantReference(t):""}var u=e.extend("sap.ui.rta.plugin.LocalReset",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});u.prototype._isEditable=function(e){var t=this.getAction(e);return!!t};u.prototype.isEnabled=function(e){if(e.length!==1){return false}var t=e[0];var n=t.getElement();var i=this.getAction(t);if(!i){return false}var u=true;if(typeof i.isEnabled!=="undefined"){if(typeof i.isEnabled==="function"){u=i.isEnabled(n)}else{u=i.isEnabled}}var l=i.changeOnRelevantContainer?t.getRelevantContainer():n;var d=o.getOverlay(l);var p=a.getAppComponentForControl(l);var g=p.getModel(a.VARIANT_MODEL_NAME);var c=s(g,this.getVariantManagementReference(d));return u&&r.isResetEnabled(l,{layer:this.getCommandFactory().getFlexSettings().layer,currentVariant:c})};u.prototype.getMenuItems=function(e){return this._getMenuItems(e,{pluginId:"CTX_LOCAL_RESET",rank:61,icon:"sap-icon://reset"})};u.prototype.getActionName=function(){return"localReset"};u.prototype.handler=function(e){var r=e[0];var o=r.getElement();var u=r.getDesignTimeMetadata();var l=this.getVariantManagementReference(r);var d=a.getAppComponentForControl(o);var p=d.getModel(a.VARIANT_MODEL_NAME);var g=s(p,l);var c=!!g;var f=c?d.byId(l)||sap.ui.getCore().byId(l):undefined;var m=this.getCommandFactory();var v=new n;return Promise.all([m.getCommandFor(o,"localReset",{currentVariant:g},u,l),c&&m.getCommandFor(f,"save",{model:p},u,l)].filter(Boolean)).then(function(e){e.forEach(function(e){v.addCommand(e)});this.fireElementModified({command:v});if(c){var t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta").getText("MSG_LOCAL_RESET_VARIANT_SAVE");i.show(t,{duration:5e3})}}.bind(this)).catch(function(e){throw t.propagateError(e,"LocalReset#handler","Error occurred during handler execution","sap.ui.rta.plugin")})};return u});
//# sourceMappingURL=LocalReset.js.map