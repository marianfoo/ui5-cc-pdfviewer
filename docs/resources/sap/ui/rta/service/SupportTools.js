/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/write/api/ChangesWriteAPI"],function(e,n,t){"use strict";function r(e,r,i){var a=e.getAction(r);if(a&&a.changeType){var u=a.changeOnRelevantContainer?r.getRelevantContainer():r.getElement();return t.getChangeHandler({changeType:a.changeType,element:u,modifier:n,layer:i.getLayer()}).then(function(e){return e}).catch(function(){return})}return Promise.resolve(undefined)}function i(e){if(e.endsWith(".asSibling")){return true}if(e.endsWith(".asChild")){return false}return undefined}function a(e,n){var t=i(n);var r=e.getPlugins();return Object.values(r).find(function(e){var r=e._retrievePluginName?e._retrievePluginName(t):e.getMetadata().getName();return r===n})}function u(n,t){var u=e.byId(t.overlayId);var o=u.getElement();return Promise.all(u.getEditableByPlugins().map(function(e){var t=a(n,e);var o=i(e);return r(t,u,n).then(function(n){return{name:e,isAvailable:t.isAvailable([u],o),hasChangeHandler:!!n}})})).then(function(e){return{elementId:o.getId(),elementControlType:o.getMetadata().getName(),overlayId:u.getId(),plugins:e}})}function o(n,t){var i=e.byId(t.overlayId);var u=a(n,t.pluginName);r(u,i,n).then(console.log)}var l={getOverlayInfo:{handler:u,returnMessageType:"overlayInfo",id:"ui5FlexibilitySupport.submodules.overlayInfo"},printChangeHandler:{handler:o,id:"ui5FlexibilitySupport.submodules.overlayInfo"}};function s(e,n){if(n.source!==window){return}var t=Object.entries(l).find(function(e){return e[0]===n.data.type&&e[1].id===n.data.id});var r=t&&t[1];if(r){Promise.resolve(r.handler(e,n.data.content)).then(function(e){if(r.returnMessageType){n.source.postMessage({id:r.id,type:r.returnMessageType,content:e})}})}}return function(e){var n=s.bind(null,e);window.addEventListener("message",n);return{destroy:function(){window.removeEventListener("message",n)}}}});
//# sourceMappingURL=SupportTools.js.map