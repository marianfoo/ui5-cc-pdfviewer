/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/dt/Util","sap/ui/dt/OverlayRegistry","sap/ui/fl/Utils","sap/ui/fl/apply/api/FlexRuntimeInfoAPI","sap/ui/fl/write/api/ChangesWriteAPI","sap/ui/fl/write/api/PersistenceWriteAPI","sap/ui/thirdparty/jquery"],function(e,r,t,o,a,n,jQuery){"use strict";return function(i){function s(e){return new Promise(function(r,t){var o;jQuery.ajax({url:o=sap.ui.require.toUrl(e)+".js",async:true,success:function(e){r(e)},error:function(r,a,n){var i=new Error("resource "+e+" could not be loaded from "+o+". Check for 'file not found' or parse errors. Reason: "+n);i.status=a;i.error=n;i.statusCode=r.status;t(n)},dataType:"text"})})}return{exports:{add:function(r,s){var l=i.getFlexSettings();if(!l.developerMode){throw e.createError("service.ControllerExtension#add","code extensions can only be created in developer mode","sap.ui.rta")}if(!r){throw e.createError("service.ControllerExtension#add","can't create controller extension without codeRef","sap.ui.rta")}if(!r.endsWith(".js")){throw e.createError("service.ControllerExtension#add","codeRef has to end with 'js'")}var c=sap.ui.getCore().byId(s);var u=t.getAppComponentForControl(c);var d=c.getControllerName&&c.getControllerName()||c.getController()&&c.getController().getMetadata().getName();var p=o.getFlexReference({element:u});var f=p.replace(/\.Component/g,"").replace(/\./g,"/");f+="/changes/";f+=r.replace(/\.js/g,"");var g={codeRef:r,controllerName:d,changeType:"codeExt",layer:l.layer,namespace:l.namespace,reference:p,moduleName:f,generator:"rta.service.ControllerExtension"};var v=a.create({changeSpecificData:g,selector:u});n.add({change:v,selector:u});return v.convertToFileContent()},getTemplate:function(t){var o=r.getOverlay(t);if(!o){throw e.createError("service.ControllerExtension#getTemplate","no overlay found for the given view ID","sap.ui.rta")}var a=o.getDesignTimeMetadata().getControllerExtensionTemplate();return s(a+"-dbg").catch(function(){return s(a)})}}}}});
//# sourceMappingURL=ControllerExtension.js.map