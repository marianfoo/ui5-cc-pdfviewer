/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/dt/OverlayRegistry","sap/ui/dt/Util","sap/base/util/isEmptyObject","sap/base/util/merge","sap/base/util/restricted/_omit"],function(e,t,n,r,i){"use strict";var a="[NOT SERIALIZABLE]";function o(e,t,n){if(Object(e)!==e){return true}if(typeof e==="function"){return false}if(typeof e==="object"){if(Array.isArray(e)){return e.every(o)}else if(e instanceof Map){var r={};e.forEach(function(e,t){r[t]=e});if(n){n[t]=r}e=r}return Object.keys(e).every(function(t){return o(e[t],t,e)})}return false}function u(e){return o(e)?e:a}return function(){var a={};a._getDesignTimeProperties=function(i){var o=e.getOverlay(i);if(!o){return t.createError("service.Property#get","A valid control id was not passed","sap.ui.rta")}var s=o.getElement();var l=s.getMetadata().getAllProperties();var g=o.getDesignTimeMetadata();var f=r({},g.getData());var c=f.properties||{};var d=f.annotations||{};var p=f.getLabel;return Promise.all([a._getConsolidatedAnnotations(d,s),a._getConsolidatedProperties(c||{},l,s),a._getResolvedFunction(p,s),a._getResolvedLinks(f.links,s)]).then(function(e){return Object.assign({},e[0]&&!n(e[0])&&{annotations:e[0]},e[1]&&{properties:e[1]},e[2]&&{label:u(e[2])},f.name&&{name:g.getName(s)},!n(e[3])&&{links:e[3]})})};a._getConsolidatedProperties=function(e,n,o){var s=Object.keys(n).reduce(function(e,t){e[t]={value:u(o.getProperty(t)),virtual:false,type:n[t].type,name:n[t].name,ignore:false,group:n[t].group,deprecated:n[t].deprecated,defaultValue:n[t].defaultValue,visibility:n[t].visibility};var r=a._getBindingInfo(t,o);Object.assign(e[t],r&&{binding:r});return e},{});return a._getResolvedFunction(e,o).then(function(e){return Promise.all(Object.keys(e).map(function(n){return a._getResolvedFunction(e[n].ignore,o).then(function(r){if(typeof r!=="boolean"){throw t.createError("services.Property#get","Invalid ignore property value found in designtime for element with id "+o.getId()+" .","sap.ui.rta")}var l={};if(!s[n]){if(e[n].virtual===true){l=a._getEvaluatedVirtualProperty(e,n,o,r)}else{l[n]={value:u(i(e[n],"ignore")),virtual:false,ignore:r}}}else{l[n]={ignore:r}}return l})}))}).then(function(e){return e.reduce(function(e,t){return r(e,t)},s)})};a._getEvaluatedVirtualProperty=function(e,t,n,r){var i={};i[t]={value:u(e[t].get(n)),virtual:true,type:e[t].type,name:e[t].name,group:e[t].group,ignore:r};var o=a._getBindingInfo(t,n);return a._getResolvedFunction(e[t].possibleValues,n).then(function(n){Object.assign(i[t],o&&{binding:o},n&&{possibleValues:u(n)},typeof e[t].nullable==="boolean"&&{nullable:e[t].nullable});return i})};a._getConsolidatedAnnotations=function(e,r){return Promise.all(Object.keys(e).map(function(i){return a._getResolvedFunction(e[i].ignore,r).then(function(o){var u={};if(typeof o!=="boolean"&&typeof o!=="undefined"){throw t.createError("services.Property#get","Invalid ignore property value found in designtime for element with id "+r.getId()+" .","sap.ui.rta")}e[i].ignore=o;if(!o){u[i]=Object.assign({},e[i]);return a._getResolvedLinks(u[i].links,r).then(function(e){if(!n(e)){u[i].links=e}return u})}})})).then(function(e){return e.reduce(function(e,t){return Object.assign(e,t)},{})})};a._getResolvedLinks=function(e,n){var r=[];var i=Object.assign({},e);Object.keys(i).forEach(function(e){if(Array.isArray(i[e])){i[e].forEach(function(e){r.push(t.wrapIntoPromise(function(){if(typeof e.text==="function"){return e.text(n)}})(e).then(function(t){e.text=u(t||e.text)}))})}});return Promise.all(r).then(function(){return i})};a._getBindingInfo=function(e,t){var n=t.getBindingInfo(e);if(!n){return}return r({},n.parts&&{parts:n.parts},n.binding&&{bindingValues:{values:n.binding.getValue()}},n.binding&&n.binding.getOriginalValue&&{bindingValues:{originalValues:n.binding.getOriginalValue()}},n.bindingString&&{bindingString:n.bindingString})};a._getResolvedFunction=function(e,n){return t.wrapIntoPromise(function(){return typeof e==="function"?e(n)||false:e||false})(e,n)};return{exports:{get:a._getDesignTimeProperties.bind(a)}}}});
//# sourceMappingURL=Property.js.map