/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/write/api/PersistenceWriteAPI","sap/ui/fl/write/api/ChangesWriteAPI","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/Change","sap/ui/fl/Utils","sap/ui/fl/ChangePersistenceFactory","sap/base/util/restricted/_union"],function(e,r,t,n,a,i,u){"use strict";var o={};function s(e,r,t){var a={includeDirtyChanges:true,layer:r};var u=i.getChangePersistenceForControl(e);return u.getAllUIChanges(a).filter(function(e){return e.getState()!==n.states.DELETED&&e.getVariantReference()===(t||"")})}function c(e){var r=a.getAppComponentForControl(e);var n=[];var i=[];function o(r,t){var a=(t||[]).concat(r);if(r===e||n.includes(r)){n=u(n,a);return true}var s=r.getParent();if(i.includes(r)||!s){i=u(i,a);return false}return o(s,a)}function s(e){return e.getDependentSelectorList().map(function(e){return t.bySelector(e,r)}).filter(Boolean).some(function(e){return o(e)})}return s}o.resetChanges=function(n,i){var u=n.slice().reverse();var o=u.map(function(n){var a=t.bySelector(n.getSelector(),i);return function(){return e.remove({change:n,selector:a}).then(function(){n.setQueuedForRevert();return r.revert({change:n,element:a})})}});return a.execPromiseQueueSequentially(o)};o.restoreChanges=function(u,o){var s=u.map(function(a){return function(){a.restorePreviousState();var u=t.bySelector(a.getSelector(),o);e.add({change:a,selector:u});if(a.getState()===n.states.PERSISTED){var s=i.getChangePersistenceForControl(o);var c=s.getDirtyChanges();var l=c.indexOf(a);if(l>=0){c.splice(l,1)}}return r.apply({change:a,element:u,modifier:t})}});return a.execPromiseQueueSequentially(s)};o.getNestedUIChangesForControl=function(e,r){var t=s(e,r.layer,r.currentVariant);var n=c(e);return t.filter(n)};o.isResetEnabled=function(e,r){var t=s(e,r.layer,r.currentVariant);var n=c(e);return t.some(n)};return o});
//# sourceMappingURL=LocalResetAPI.js.map