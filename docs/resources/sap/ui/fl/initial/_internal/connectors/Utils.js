/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/security/encodeURLParameters","sap/ui/core/Configuration"],function(e,t){"use strict";var n=0;var s=function(e,t){var n=new Error(e.statusText);n.status=e.status;n.userMessage=t;return n};var r=function(e){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl").getText(e)};return{addLanguageInfo:function(e){if(!e){e={}}e["sap-language"]=t.getLanguage()},addSAPLogonLanguageInfo:function(e){if(!e){e={}}e["sap-language"]=t.getSAPLogonLanguage()},getUrl:function(t,n,s){if(!t||!n.url){throw new Error("Not all necessary parameters were passed")}var r=n.url+t;if(n.cacheKey){r+="~"+n.cacheKey+"~/"}if(n.reference){r+=n.reference}else if(n.fileName){r+=n.fileName}if(s){Object.keys(s).forEach(function(e){if(s[e]===undefined){delete s[e]}});var a=e(s);if(a.length>0){r+="?"+a}}return r},sendRequest:function(e,t,a){t=t||"GET";t=t.toUpperCase();return new Promise(function(o,i){var f=new XMLHttpRequest;f.open(t,e);f.timeout=n;if((t==="GET"||t==="HEAD")&&(!a||!a.initialConnector||!a.initialConnector.xsrfToken)){f.setRequestHeader("X-CSRF-Token","fetch")}if((t==="POST"||t==="PUT"||t==="DELETE")&&a&&a.initialConnector&&a.initialConnector.xsrfToken){f.setRequestHeader("X-CSRF-Token",a.initialConnector.xsrfToken)}if(a&&a.contentType){f.setRequestHeader("Content-Type",a.contentType)}if(a&&a.siteId){f.setRequestHeader("X-LRep-Site-Id",a.siteId)}if(a&&a.sAppDescriptorId){f.setRequestHeader("X-LRep-AppDescriptor-Id",a.sAppDescriptorId)}if(a&&a.dataType){f.responseType=a.dataType}f.onload=function(){if(f.status>=200&&f.status<400){try{var t={};if(f.status!==204&&f.status!==205){if(!f.response&&f.responseText){f.response=f.responseText}t.response=f.response;if(t.response&&typeof t.response==="string"&&f.getResponseHeader("content-type")&&f.getResponseHeader("content-type").indexOf("json")>0){t.response=JSON.parse(t.response)}}t.status=f.status;if(f.getResponseHeader("X-CSRF-Token")){if(!e.match(/\/~.*~/g)){t.xsrfToken=f.getResponseHeader("X-CSRF-Token");if(a&&a.initialConnector){a.initialConnector.xsrfToken=t.xsrfToken}}}if(f.getResponseHeader("Etag")){t.etag=f.getResponseHeader("Etag")}o(t)}catch(e){e.userMessage=r("MSG_LOADING_SERVER_RESPONSE_ERROR");i(e)}}else{var n="";try{var p=typeof f.response==="string"?JSON.parse(f.response):f.response;if(Array.isArray(p.messages)&&p.messages.length){n=p.messages.reduce(function(e,t){return e.concat(t.severity==="Error"?t.text+"\n":"")},n)}}catch(e){}i(s(f,n))}};f.ontimeout=function(){i(s(f,r("MSG_CONNECTION_TIMEOUT_ERROR")))};f.onerror=function(){i(s(f,r("MSG_NETWORK_ERROR")))};if(a&&a.payload){f.send(a.payload)}else{f.send()}})}}});
//# sourceMappingURL=Utils.js.map