/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../tree/TreeNodeFactory","./SearchHierarchyStaticTreeNode"],function(e,t){function r(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}function n(e,t){var r=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=o(e))||t&&e&&typeof e.length==="number"){if(r)e=r;var n=0;var i=function(){};return{s:i,n:function(){if(n>=e.length)return{done:true};return{done:false,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a=true,u=false,f;return{s:function(){r=r.call(e)},n:function(){var e=r.next();a=e.done;return e},e:function(e){u=true;f=e},f:function(){try{if(!a&&r.return!=null)r.return()}finally{if(u)throw f}}}}function o(e,t){if(!e)return;if(typeof e==="string")return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}function i(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function f(e,t,r){if(t)u(e.prototype,t);if(r)u(e,r);Object.defineProperty(e,"prototype",{writable:false});return e}function c(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var l=r(e);var d=r(t);function s(e,t,r){if(r){return t?t(e):e}if(!e||!e.then){e=Promise.resolve(e)}return t?e.then(t):e}function h(e,t,r){if(r){return t?t(e()):e()}try{var n=Promise.resolve(e());return t?n.then(t):n}catch(e){return Promise.reject(e)}}function y(){}function v(e,t){if(!t){return e&&e.then?e.then(y):Promise.resolve()}}var N=function(){function e(t){a(this,e);this.model=t.model;this.sina=this.model.sinaNext;this.attributeId=t.attributeId;this.dataSource=t.dataSource;this.filter=t.filter;this.facetType="hierarchyStatic";this.title=t.title;this.facetIndex=-1;this.position=-1;this.treeNodeFactory=l.create({model:this.model,rootTreeNodePath:"/facets/".concat(this.facetIndex,"/rootTreeNode"),treeNodeConstructor:d});this.rootTreeNode=this.treeNodeFactory.createRootTreeNode({id:e.rootNodeId,label:"Root",facet:this});this.rootTreeNode.addChildTreeNode(this.treeNodeFactory.createTreeNode({id:"test",facet:this,label:"test"}))}f(e,[{key:"setFacetIndex",value:function e(t){this.facetIndex=t;this.treeNodeFactory.setRootTreeNodePath("/facets/".concat(this.facetIndex,"/rootTreeNode"))}},{key:"initAsync",value:function e(){var t=this;return h(function(){return s(t.rootTreeNode.fetchChildTreeNodes(),function(e){t.rootTreeNode.addChildTreeNodes(e)})})}},{key:"activateFilters",value:function e(){this.model._firePerspectiveQuery({preserveFormerResults:false});this.model.notifyFilterChanged()}},{key:"updateTree",value:function e(){var t=this;return h(function(){return s(t.treeNodeFactory.updateRecursively(),function(){return s(t.mixinFilterNodes(),function(){t.treeNodeFactory.updateUI()})})})}},{key:"getComplexConditionOfFacet",value:function e(){var t=n(this.filter.rootCondition.conditions),r;try{for(t.s();!(r=t.n()).done;){var o=r.value;if(o.containsAttribute(this.attributeId)){return o}}}catch(e){t.e(e)}finally{t.f()}return null}},{key:"getFilterConditions",value:function e(){var t=[];var r=this.getComplexConditionOfFacet();if(!r){return t}var o=n(r.conditions),i;try{for(o.s();!(i=o.n()).done;){var a=i.value;t.push(a)}}catch(e){o.e(e)}finally{o.f()}return t}},{key:"mixinFilterNodes",value:function e(){var t=this;return h(function(){t.rootTreeNode.hasFilter=false;t.rootTreeNode.visitChildNodesRecursively(function(e){e.hasFilter=false});var e=t.getFilterConditions();var r=n(e),o;try{for(r.s();!(o=r.n()).done;){var i=o.value;var a=t.treeNodeFactory.getTreeNode(i.value);if(!a){continue}a.hasFilter=true}}catch(e){r.e(e)}finally{r.f()}return s(v(t.autoExpandFirstFilterNode()))})}},{key:"handleModelUpdate",value:function e(){this.treeNodeFactory.updateUI()}},{key:"delete",value:function e(){this.treeNodeFactory["delete"]()}},{key:"autoExpandFirstFilterNode",value:function e(){var t=this;return h(function(){var e=null;t.rootTreeNode.visitChildNodesRecursively(function(t){if(t.hasFilter&&!e){e=t}});if(!e){return s()}if(e.isVisible()){return s()}var r=e.getParentTreeNode();while(r){r.expanded=true;r=r.getParentTreeNode()}return s(v(t.treeNodeFactory.updateRecursively()))})}},{key:"updateNodesFromHierarchyNodePaths",value:function e(t){for(var r=0;r<t.length;++r){var n=t[r];if(n.name!==this.attributeId){continue}this.rootTreeNode.updateNodePath(n.path,0)}}}]);return e}();c(N,"rootNodeId","$$ROOT$$");return N})})();
//# sourceMappingURL=SearchHierarchyStaticFacet.js.map