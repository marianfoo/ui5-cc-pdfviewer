/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["./SearchShellHelperHorizonTheme"],function(e){function t(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function i(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function a(e,t,s){if(t)i(e.prototype,t);if(s)i(e,s);Object.defineProperty(e,"prototype",{writable:false});return e}var n=t(e);var u=function(){function e(t){s(this,e);this.isSearchInputFocused=t.isSearchInputFocused;this.isNoResultsScreen=t.isNoResultsScreen;this.isSearchFieldExpandedByDefault=t.isSearchFieldExpandedByDefault}a(e,[{key:"equals",value:function e(t){return this.isSearchInputFocused===t.isSearchInputFocused&&this.isNoResultsScreen===t.isNoResultsScreen&&this.isSearchFieldExpandedByDefault===t.isSearchFieldExpandedByDefault}},{key:"toString",value:function e(){return"focused:".concat(this.isSearchInputFocused," no-results:").concat(this.isNoResultsScreen," shall-be-expanded:").concat(this.isSearchFieldExpandedByDefault)}}]);return e}();var r=function(){function e(t){s(this,e);this.shellHeader=t.shellHeader;this.cancelButton=t.cancelButton;this.searchInput=t.searchInput;this.model=t.model;this.isNoResultsScreen=t.isNoResultsScreen;setInterval(this.checkStateChange.bind(this),100)}a(e,[{key:"checkStateChange",value:function e(){var t=this.getState();if(!this.checkMode){if(!this.state||!t.equals(this.state)){this.checkMode=true;this.checkState=t}}else{if(t.equals(this.checkState)){this.handleStateChanged(t)}this.checkMode=false}}},{key:"getState",value:function e(){return new u({isNoResultsScreen:this.isNoResultsScreen(),isSearchInputFocused:this.isSearchInputFocused(),isSearchFieldExpandedByDefault:n.isSearchFieldExpandedByDefault()})}},{key:"isOverlayShown",value:function e(){return!!document.querySelector(".sapUshellShellShowSearchOverlay")}},{key:"isSearchInputFocused",value:function e(){if(!this.searchInput||!this.searchInput.getDomRef()){return false}return this.searchInput.getDomRef().contains(document.activeElement)}},{key:"handleStateChanged",value:function e(t){var s=this.state;this.state=t;if(this.model){this.model.calculateSearchButtonStatus()}var i=t.isSearchInputFocused&&!t.isNoResultsScreen;switch(this.shellHeader.getSearchState()){case"EXP":if(!t.isSearchFieldExpandedByDefault&&s&&s.isSearchFieldExpandedByDefault&&this.searchInput.getValue()===""){this.collapseSearch();return}if(i&&!this.isOverlayShown()){this.shellHeader.setSearchState("EXP_S",35,false);this.shellHeader.setSearchState("EXP",35,true)}if(!i&&this.isOverlayShown){this.shellHeader.setSearchState("EXP_S",35,false);this.shellHeader.setSearchState("EXP",35,false)}break;case"COL":if(t.isSearchFieldExpandedByDefault){this.expandSearch()}break}}},{key:"getShellSearchButton",value:function e(){return sap.ui.getCore().byId("sf")}},{key:"expandSearch",value:function e(t){var s=this.getShellSearchButton();if(!s){return}this.shellHeader.setSearchState("EXP",35,false);this.cancelButton.setVisible(true);s.setVisible(false);if(t){this.focusInputField({selectContent:false})}}},{key:"collapseSearch",value:function e(t){var s=this.getShellSearchButton();if(!s){return}this.model.abortSuggestions();this.shellHeader.setSearchState("COL",35,false);this.cancelButton.setVisible(false);s.setVisible(true);if(t){window.setTimeout(function(){sap.ui.getCore().byId("sf").focus()},1e3)}}},{key:"focusInputField",value:function e(){var t=this;var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(this.focusInputFieldTimeout){window.clearTimeout(this.focusInputFieldTimeout);this.focusInputFieldTimeout=null}var i=function e(i){if(!t.searchInput){return}t.focusInputFieldTimeout=null;var a=t.searchInput.getDomRef();if(a&&jQuery(a).is(":visible")&&!sap.ui.getCore().getUIDirty()){if(t.searchInput.getEnabled()){t.searchInput.focus();if(s.selectContent){t.searchInput.selectText(0,9999)}return}}if(i>0){t.focusInputFieldTimeout=window.setTimeout(function(){if(!t.model.getProperty("/initializingObjSearch")){i--}e(i)},100)}};i(10)}}]);return e}();return r})})();
//# sourceMappingURL=SearchFieldStateManager.js.map