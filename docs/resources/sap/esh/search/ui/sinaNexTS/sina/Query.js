/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../core/core","../core/util","./SinaObject","./Filter","./LogicalOperator","../core/errors","./FilteredDataSource"],function(e,t,r,n,i,o,u){function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function a(e,t,r){if(t)s(e.prototype,t);if(r)s(e,r);Object.defineProperty(e,"prototype",{writable:false});return e}function c(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});Object.defineProperty(e,"prototype",{writable:false});if(t)f(e,t)}function f(e,t){f=Object.setPrototypeOf||function e(t,r){t.__proto__=r;return t};return f(e,t)}function d(e){var t=v();return function r(){var n=p(e),i;if(t){var o=p(this).constructor;i=Reflect.construct(n,arguments,o)}else{i=n.apply(this,arguments)}return h(this,i)}}function h(e,t){if(t&&(typeof t==="object"||typeof t==="function")){return t}else if(t!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return y(e)}function y(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function v(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function p(e){p=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return p(e)}function S(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var m=r["SinaObject"];var b=n["Filter"];var _=i["LogicalOperator"];var k=o["QueryIsReadOnlyError"];var O=u["FilteredDataSource"];function C(e,t,r){if(r){return t?t(e()):e()}try{var n=Promise.resolve(e());return t?n.then(t):n}catch(e){return Promise.reject(e)}}function R(e,t,r){if(r){return t?t(e):e}if(!e||!e.then){e=Promise.resolve(e)}return t?e.then(t):e}var P=function(r){c(i,r);var n=d(i);function i(e){var r,o,u,s,a;var c;l(this,i);c=n.call(this,e);S(y(c),"requestTimeout",false);c.top=(r=e.top)!==null&&r!==void 0?r:10;c.skip=(o=e.skip)!==null&&o!==void 0?o:0;c.sortOrder=(u=e.sortOrder)!==null&&u!==void 0?u:[];c.filter=(s=(a=e.filter)!==null&&a!==void 0?a:c.filter)!==null&&s!==void 0?s:new b({sina:c.sina});c.icon=e.icon;c.label=e.label;if(e.dataSource){c.filter.setDataSource(e.dataSource)}if(e.searchTerm){c.filter.setSearchTerm(e.searchTerm)}if(e.rootCondition){c.filter.setRootCondition(e.rootCondition)}if(c.requestTimeout){}c._execute=t.refuseOutdatedResponsesDecorator(c._execute);return c}a(i,[{key:"setTop",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:10;this.top=t}},{key:"setSkip",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;this.skip=t}},{key:"setSortOrder",value:function e(t){this.sortOrder=t}},{key:"_execute",value:function e(){return C(function(){return Promise.resolve()})}},{key:"clone",value:function e(){return}},{key:"equals",value:function t(r){return r instanceof i&&this.icon===r.icon&&this.label===r.label&&this.top===r.top&&this.skip===r.skip&&this.filter.equals(r.filter)&&e.equals(this.sortOrder,r.sortOrder)}},{key:"abort",value:function e(){}},{key:"getResultSetAsync",value:function e(){var t=this;return C(function(){if(t._lastQuery){if(t.equals(t._lastQuery)){return R(t._resultSetPromise)}if(!t.filter.equals(t._lastQuery.filter)){t.setSkip(0)}}t._lastQuery=t._createReadOnlyClone();var e;t._resultSetPromise=Promise.resolve().then(function(){return this._execute(this._lastQuery)}.bind(t)).then(function(t){e=t;return this._formatResultSetAsync(e)}.bind(t)).then(function(){return e}.bind(t));return R(t._resultSetPromise)})}},{key:"_genericFilteredQueryTransform",value:function e(t){if(!(t.filter.dataSource instanceof O)){return t}var r;if(t.filter.dataSource.filterCondition){if(t.filter.rootCondition.conditions.length>0){r=this.sina.createComplexCondition({operator:_.And,conditions:[t.filter.dataSource.filterCondition,t.filter.rootCondition]})}else{r=t.filter.dataSource.filterCondition}}else{r=t.filter.rootCondition}var n=this.sina.createFilter({dataSource:t.filter.dataSource.dataSource,searchTerm:t.filter.searchTerm,rootCondition:r});var i=t.clone();i.filter=n;return i}},{key:"_formatResultSetAsync",value:function e(t){return Promise.resolve()}},{key:"_setResultSet",value:function e(t){this._lastQuery=this._createReadOnlyClone();this._resultSetPromise=Promise.resolve().then(function(){return this._formatResultSetAsync(t)}.bind(this)).then(function(){return t});return this._resultSetPromise}},{key:"_createReadOnlyClone",value:function e(){var t=this.clone();t.getResultSetAsync=function(){throw new k("this query is readonly")};return t}},{key:"resetResultSet",value:function e(){this._lastQuery=null;this._resultSetPromise=null}},{key:"getSearchTerm",value:function e(){return this.filter.searchTerm}},{key:"getDataSource",value:function e(){return this.filter.dataSource}},{key:"getRootCondition",value:function e(){return this.filter.rootCondition}},{key:"setSearchTerm",value:function e(t){this.filter.setSearchTerm(t)}},{key:"setDataSource",value:function e(t){this.filter.setDataSource(t)}},{key:"setRootCondition",value:function e(t){this.filter.setRootCondition(t)}},{key:"resetConditions",value:function e(){this.filter.resetConditions()}},{key:"autoInsertCondition",value:function e(t){this.filter.autoInsertCondition(t)}},{key:"autoRemoveCondition",value:function e(t){this.filter.autoRemoveCondition(t)}},{key:"setFilter",value:function e(t){if(!this.filter.equals(t)){this.setSkip(0)}this.filter=t}}]);return i}(m);var g={__esModule:true};g.Query=P;return g})})();
//# sourceMappingURL=Query.js.map