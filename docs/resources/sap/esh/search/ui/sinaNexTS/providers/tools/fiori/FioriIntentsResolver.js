/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../../../sina/SinaObject","../../../sina/AttributeType"],function(e,t){function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function i(e,t,n){if(t)r(e.prototype,t);if(n)r(e,n);Object.defineProperty(e,"prototype",{writable:false});return e}function a(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});Object.defineProperty(e,"prototype",{writable:false});if(t)o(e,t)}function o(e,t){o=Object.setPrototypeOf||function e(t,n){t.__proto__=n;return t};return o(e,t)}function s(e){var t=l();return function n(){var r=c(e),i;if(t){var a=c(this).constructor;i=Reflect.construct(r,arguments,a)}else{i=r.apply(this,arguments)}return u(this,i)}}function u(e,t){if(t&&(typeof t==="object"||typeof t==="function")){return t}else if(t!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return f(e)}function f(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function l(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function c(e){c=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return c(e)}
/*!
   * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
   */var g=e["SinaObject"];var d=t["AttributeType"];var v;if(typeof window!=="undefined"&&typeof window.sap!=="undefined"&&window.sap.ushell&&window.sap.ushell.Container&&window.sap.ushell.Container.getServiceAsync){var y=window.sap.ushell.Container;y.getServiceAsync("SmartNavigation").then(function(e){v=e})["catch"](function(){y.getServiceAsync("CrossApplicationNavigation").then(function(e){v=e})})}var p=function(e){a(r,e);var t=s(r);function r(e){var i;n(this,r);i=t.call(this,e);if(typeof window!=="undefined"&&window.sap&&window.sap.ushell&&window.sap.ushell.Container){i._fioriFrontendSystemInfo={systemId:window.sap.ushell.Container.getLogonSystem().getName(),client:window.sap.ushell.Container.getLogonSystem().getClient()};i._primaryIntentAction="-displayFactSheet";i._suppressInSearchTag="suppressInEnterpriseSearch".toLowerCase()}else{i._fioriFrontendSystemInfo={systemId:i.getLogonSystem().getName(),client:i.getLogonSystem().getClient()}}return i}i(r,[{key:"resolveIntents",value:function e(t){var n=this;if(!v||!t){return Promise.resolve({defaultNavigationTarget:t.fallbackDefaultNavigationTarget})}if(Array.isArray(t)){var r=[];for(var i=0;i<t.length;i++){var a=n._doResolveIntents(t[i]);r.push(a)}return Promise.all(r)}return n._doResolveIntents(t)}},{key:"_doResolveIntents",value:function e(t){var n=this;var r=t.semanticObjectType;var i=t.semanticObjectTypeAttributes;var a=t.systemId;var o=t.client;var s=t.fallbackDefaultNavigationTarget;if(!r||r.length===0){return Promise.resolve({defaultNavigationTarget:s})}if(!i||i.length===0){return Promise.resolve()}var u={};var f;for(var l=0;l<i.length;l++){f=this.convertAttributeValueToUI5DataTypeFormats(i[l].value,i[l].type);u[i[l].name]=f}var c={systemId:a||n._fioriFrontendSystemInfo&&n._fioriFrontendSystemInfo.systemId,client:o||n._fioriFrontendSystemInfo.client&&n._fioriFrontendSystemInfo.client};if(window.sap&&window.sap.cf||a&&a.trim().length>0&&o&&o.trim().length>0&&(!n._fioriFrontendSystemInfo||!(n._fioriFrontendSystemInfo.systemId===a&&n._fioriFrontendSystemInfo.client===o))){c.urlParameter="sap-system=sid("+a+"."+o+")"}var g=new Promise(function(e){if(v&&v.getPrimaryIntent){n.convertJQueryDeferredToPromise(v.getPrimaryIntent(r,u)).then(function(t){e(t)})["catch"](function(){e()})}else{e()}});var d=new Promise(function(e){var t;if(v&&v.getLinks){t=v.getLinks({semanticObject:r,params:u,withAtLeastOneUsedParam:true,sortResultOnTexts:true})}else{t=v.getSemanticObjectLinks(r,u)}n.convertJQueryDeferredToPromise(t).then(function(t){e(t)})["catch"](function(){e()})});return Promise.all([g,d]).then(function(e){var t;var r=e[0];var i;var a=e[1];var o;var s={navigationTargets:[]};var u;if(r&&!n._shallIntentBeSuppressed(r)){u=n._getNavigationTargetForIntent(r,c);s.defaultNavigationTarget=u}var f=s.defaultNavigationTarget!==undefined;s.navigationTargets=[];if(a){for(t=0;t<a.length;t++){i=a[t];if(n._shallIntentBeSuppressed(i)){continue}o=n._getNavigationTargetForIntent(i,c);if(!f&&i.intent.substring(i.intent.indexOf("-"),i.intent.indexOf("?"))===n._primaryIntentAction){s.defaultNavigationTarget=o;f=true}else if(!u||!o.isEqualTo(u)){s.navigationTargets.push(o)}}}return s})}},{key:"_shallIntentBeSuppressed",value:function e(t){if(t.tags){for(var n=0;n<t.tags.length;n++){if(t.tags[n].toLowerCase()===this._suppressInSearchTag){return true}}}return false}},{key:"_getNavigationTargetForIntent",value:function e(t,n){var r=this;var i=t.intent;if(n.urlParameter){if(i.indexOf("?")===-1){i+="?"}else{i+="&"}i+=n.urlParameter}var a={target:{shellHash:i}};var o=v.hrefForExternal(a);var s=r.sina._createNavigationTargetForIntent({label:t.text,targetUrl:o,externalTarget:a,systemId:n.systemId,client:n.client});return s}},{key:"convertAttributeValueToUI5DataTypeFormats",value:function e(t,n){var r,i,a,o,s,u,f;switch(n){case d.Timestamp:r=t.getUTCFullYear();i=t.getUTCMonth()+1;a=t.getUTCDate();o=t.getUTCHours();s=t.getUTCMinutes();u=t.getUTCSeconds();f=t.getUTCMilliseconds()*1e3;t=this.addLeadingZeros(r.toString(),4)+"-"+this.addLeadingZeros(i.toString(),2)+"-"+this.addLeadingZeros(a.toString(),2)+"T"+this.addLeadingZeros(o.toString(),2)+":"+this.addLeadingZeros(s.toString(),2)+":"+this.addLeadingZeros(u.toString(),2)+"."+this.addLeadingZeros(f.toString(),3);break;case d.Date:t=t.slice(0,4)+"-"+t.slice(5,7)+"-"+t.slice(8,10);break}return t}},{key:"addLeadingZeros",value:function e(t,n){return"00000000000000".slice(0,n-t.length)+t}},{key:"getLogonSystem",value:function e(){return{getName:function e(){return},getClient:function e(){return},getPlatform:function e(){return}}}},{key:"convertJQueryDeferredToPromise",value:function e(t){if(t.always){return new Promise(function(e,n){t.then(e,n)})}else{return t}}}]);return r}(g);var h={__esModule:true};h.FioriIntentsResolver=p;return h})})();
//# sourceMappingURL=FioriIntentsResolver.js.map