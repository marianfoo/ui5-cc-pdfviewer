/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../../sina/SinaObject","../../sina/AttributeType","../abap_odata/Provider"],function(t,e,r){function n(t,e){var r=typeof Symbol!=="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=u(t))||e&&t&&typeof t.length==="number"){if(r)t=r;var n=0;var a=function(){};return{s:a,n:function(){if(n>=t.length)return{done:true};return{done:false,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i=true,o=false,s;return{s:function(){r=r.call(t)},n:function(){var t=r.next();i=t.done;return t},e:function(t){o=true;s=t},f:function(){try{if(!i&&r.return!=null)r.return()}finally{if(o)throw s}}}}function a(t){return s(t)||o(t)||u(t)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t,e){if(!t)return;if(typeof t==="string")return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor)r=t.constructor.name;if(r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(t,e)}function o(t){if(typeof Symbol!=="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function s(t){if(Array.isArray(t))return l(t)}function l(t,e){if(e==null||e>t.length)e=t.length;for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(t,n.key,n)}}function p(t,e,r){if(e)f(t.prototype,e);if(r)f(t,r);Object.defineProperty(t,"prototype",{writable:false});return t}function v(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});Object.defineProperty(t,"prototype",{writable:false});if(e)d(t,e)}function d(t,e){d=Object.setPrototypeOf||function t(e,r){e.__proto__=r;return e};return d(t,e)}function h(t){var e=m();return function r(){var n=g(t),a;if(e){var i=g(this).constructor;a=Reflect.construct(n,arguments,i)}else{a=n.apply(this,arguments)}return b(this,a)}}function b(t,e){if(e&&(typeof e==="object"||typeof e==="function")){return e}else if(e!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return y(t)}function y(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function m(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(t){return false}}function g(t){g=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return g(t)}
/*!
   * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
   */var _=t["SinaObject"];var S=e["AttributeType"];var I=r["Provider"];function A(t,e,r){if(r){return e?e(t):t}if(!t||!t.then){t=Promise.resolve(t)}return e?t.then(e):t}function R(t,e,r){if(r){return e?e(t()):t()}try{var n=Promise.resolve(t());return e?n.then(e):n}catch(t){return Promise.reject(t)}}var T=function(t){v(r,t);var e=h(r);function r(t){var n;c(this,r);n=e.call(this,t);n._searchResultSetItem=t.searchResultSetItem;n._dataSource=t.searchResultSetItem.dataSource;n._allAttributesMap=t.searchResultSetItem._private.allAttributesMap;n._intentsResolver=n.sina._createFioriIntentsResolver({sina:t.sina});return n}p(r,[{key:"postParseResultSetItem",value:function t(){var e=this;return R(function(){var t=e.enhanceResultSetItemWithNavigationTargets();e.enhanceResultSetItemWithGroups();return A(t)})}},{key:"enhanceResultSetItemWithNavigationTargets",value:function t(){var e=this;return R(function(){var t,r,n,i;var u=e;var o=u._dataSource._private.semanticObjectType;var s=u._searchResultSetItem._private.semanticObjectTypeAttributes;var l=(t=u._dataSource.system)===null||t===void 0?void 0:(r=t.id)===null||r===void 0?void 0:r.split(".")[0];var c=(n=u._dataSource.system)===null||n===void 0?void 0:(i=n.id)===null||i===void 0?void 0:i.split(".")[1];return A(u._intentsResolver.resolveIntents({semanticObjectType:o,semanticObjectTypeAttributes:s,systemId:l,client:c,fallbackDefaultNavigationTarget:u._searchResultSetItem.defaultNavigationTarget}),function(t){var r=t&&t.defaultNavigationTarget;var n=t&&t.navigationTargets;var i=[];if(r){i.push(r);u._searchResultSetItem.defaultNavigationTarget=r;r.parent=u._searchResultSetItem}if(n){u._searchResultSetItem.navigationTargets=n;i=[].concat(a(i),a(n));for(var o=0;o<n.length;o++){n[o].parent=u._searchResultSetItem}}e.enhanceNavigationTargetsWithContentProviderId(i);return u._searchResultSetItem})})}},{key:"enhanceNavigationTargetsWithContentProviderId",value:function t(e){if(!(this.sina.provider instanceof I)){return}if(!this.sina.provider.contentProviderId){return}var r=n(e),a;try{for(r.s();!(a=r.n()).done;){var i=a.value;i.targetUrl+="&sap-app-origin-hint="+this.sina.provider.contentProviderId}}catch(t){r.e(t)}finally{r.f()}}},{key:"enhanceResultSetItemWithGroups",value:function t(){var e=this._searchResultSetItem.dataSource.attributesMetadata;for(var r=0;r<e.length;r++){var n=e[r];if(n.type===S.Group){var a=this._addAttributeGroup(n);if(n.usage.Detail){this._searchResultSetItem.detailAttributes.push(a)}if(n.usage.Title){this._searchResultSetItem.titleAttributes.push(a)}if(n.usage.TitleDescription){this._searchResultSetItem.titleDescriptionAttributes.push(a)}}}this.sortAttributes()}},{key:"sortAttributes",value:function t(){var e=function t(e){return function(t,r){var n=t.metadata.usage&&t.metadata.usage[e]?t.metadata.usage[e].displayOrder:undefined;var a=r.metadata.usage&&r.metadata.usage[e]?r.metadata.usage[e].displayOrder:undefined;if(n===undefined||a===undefined){if(a!==undefined){return 1}return-1}return n-a}};this._searchResultSetItem.titleAttributes.sort(e("Title"));this._searchResultSetItem.titleDescriptionAttributes.sort(e("TitleDescription"));this._searchResultSetItem.detailAttributes.sort(e("Detail"))}},{key:"_addAttributeGroup",value:function t(e){var r=this.sina._createSearchResultSetItemAttributeGroup({id:e.id,metadata:e,label:e.label,template:e.template,attributes:[],groups:[],displayAttributes:e.displayAttributes||[]});var n,a;if(e._private){n=e._private.parentAttribute;a=e._private.childAttribute}for(var i=0;i<e.attributes.length;i++){var u=e.attributes[i];var o=u.attribute;var s=void 0;if(o.type===S.Group){s=this._addAttributeGroup(o)}else{s=this._allAttributesMap[o.id]}if(s){var l=this.sina._createSearchResultSetItemAttributeGroupMembership({group:r,attribute:s,metadata:u});r.attributes.push(l);s.groups.push(l)}if(o==n){r._private.parentAttribute=s}else if(o==a){r._private.childAttribute=s}}return r}}]);return r}(_);var O={__esModule:true};O.ItemPostParser=T;return O})})();
//# sourceMappingURL=ItemPostParser.js.map