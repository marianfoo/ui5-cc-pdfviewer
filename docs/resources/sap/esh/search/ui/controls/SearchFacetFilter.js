/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../i18n","sap/m/IconTabFilter","sap/m/Button","sap/m/VBox","sap/m/GroupHeaderListItem","./../error/errors","sap/esh/search/ui/controls/SearchFacetQuickSelectDataSource","sap/esh/search/ui/controls/SearchFacetHierarchyDynamic","sap/esh/search/ui/controls/SearchFacetHierarchyStatic","sap/esh/search/ui/SearchFacetDialogModel","sap/esh/search/ui/controls/SearchFacet","sap/esh/search/ui/controls/SearchFacetBarChart","sap/esh/search/ui/controls/SearchFacetPieChart","sap/ui/core/Control","./SearchFacetDialog","./SearchFacetTabBarRoles","../sinaNexTS/providers/abap_odata/UserEventLogger","./OpenShowMoreDialog","sap/m/Toolbar","sap/m/List","sap/m/library","sap/m/Title","sap/m/ToolbarSpacer"],function(e,t,a,r,o,n,i,s,c,l,d,h,u,p,f,g,S,v,F,y,b,w,C){function T(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}var B=T(e);var x=T(n);var m=T(f);var D=T(g);var U=S["UserEventType"];var H=v["openShowMoreDialog"];var _=b["ListSeparators"];var A=p.extend("sap.esh.search.ui.controls.SearchFacetFilter",{renderer:{apiVersion:2,render:function e(t,r){var o;var n=function e(){return function(){var e=sap.ui.getCore().byId($($(r.getDomRef()).closest(".sapUshellSearchFacet")[0]).attr("id"));var t=new l({searchModel:r.getModel()});t.initBusinessObjSearch().then(function(){var a;var o=r.getModel();t.setData(o.getData());t.config=o.config;t.sinaNext=o.sinaNext;t.prepareFacetList();var n=null;if(e!==null&&e!==void 0&&(a=e.getBindingContext())!==null&&a!==void 0&&a.getObject()["dimension"]){n=e.getBindingContext().getObject()["dimension"]}var i=new m("".concat(o.config.id,"-SearchFacetDialog"),{selectedAttribute:n});i.setModel(t);i.setModel(o,"searchModel");i.open();var s=r.getParent().getParent().getParent().getParent();s.oFacetDialog=i;o.eventLogger.logEvent({type:U.FACET_SHOW_MORE})})}};t.openStart("div",r);t["class"]("sapUshellSearchFacetFilter");t.openEnd();var i=true;var s=r.getModel();for(var c=0,d=r.getAggregation("facets").length;c<d;c++){var h=r.getAggregation("facets")[c];var u=h.getBindingContext().getObject();switch(u.facetType){case"attribute":h.setEshRole("attribute");h.attachSelectionChange(null,function(){jQuery(r._showAllBtn.getDomRef()).hide()});if(u.position>999){if(i){h.setHeaderText(B.getText("filterBy"));i=false}}else{h.setHeaderText(u.title);h.addStyleClass("sapUshellSearchFacetSearchInAttribute")}t.renderControl(h);break;case"datasource":h.setEshRole("datasource");h.addStyleClass("sapUshellSearchFacetDataSource");t.renderControl(h);break;case"quickSelectDataSource":if(s.config&&s.config.FF_facetPanelUnifiedHeaderStyling){}else{h.setHeaderText(B.getText("quickSelectDataSourcesHeader"))}h.addStyleClass("sapUshellSearchFacetQuickSelectDataSource");t.renderControl(h);break;case"hierarchy":if(u.position>999){if(i){h.setHeaderToolbar(r._headToolBar4FirstFacet(s));i=false}}else{h.setHeaderText(u.title);h.addStyleClass("sapUshellSearchFacetSearchInAttribute")}t.renderControl(h);break;case"hierarchyStatic":t.renderControl(h);break;default:throw"program error: unknown facet type :"+u.facetType}}if(((o=s.getDataSource())===null||o===void 0?void 0:o.type)==="BusinessObject"){var p=s.oFacetFormatter.hasDialogFacetsFromMetaData(r.getModel());var f=r.getModel().getProperty("/boCount")>0;if(p&&f){t.openStart("div",r.getId()+"-showAllFilters");t.openEnd();r._showAllBtn=new a("",{text:"{showAllFilters}",press:n(),visible:true});r._showAllBtn.setModel(r.getModel("i18n"));r._showAllBtn.addStyleClass("sapUshellSearchFacetFilterShowAllFilterBtn");t.renderControl(r._showAllBtn);t.close("div")}}t.close("div")}},metadata:{properties:{title:"string"},aggregations:{facets:{multiple:true}}},constructor:function e(a,n){p.prototype.constructor.call(this,a,n);this.data("sap-ui-fastnavgroup","true",true);this.bindAggregation("facets",{path:"/facets",factory:function e(a,n){var l=n.getObject();var p=n.getModel();var f=p.config;switch(l.facetType){case"attribute":{var g="".concat(a,"-attribute_facet");if(typeof(f===null||f===void 0?void 0:f.getSpaceFacetId)==="function"){g=f.getSpaceFacetId(l.dimension,g)}var S=new D(g,{items:[new t({text:B.getText("facetList"),icon:"sap-icon://list",key:"list".concat(a),content:new d("list".concat(a),{})}),new t({text:B.getText("facetBarChart"),icon:"sap-icon://horizontal-bar-chart",key:"barChart".concat(a),content:new h("barChart".concat(a))}),new t({text:B.getText("facetPieChart"),icon:"sap-icon://pie-chart",key:"pieChart".concat(a),content:new u("pieChart".concat(a))})]});S.addStyleClass("sapUshellSearchFacetIconTabBar");return S}case"datasource":return new d((f!==null&&f!==void 0&&f.id?f.id+"-":"")+"dataSourceFacet");case"quickSelectDataSource":{var v=new i((f!==null&&f!==void 0&&f.id?f.id+"-":"")+"sapUshellSearchFacetQuickSelectDataSource",{});if(f!==null&&f!==void 0&&f.FF_facetPanelUnifiedHeaderStyling){var F=new o({title:B.getText("quickSelectDataSourcesHeader")});F.addStyleClass("sapUshellSearchFacetTabBarHeader");F.addStyleClass("sapElisaSearchFacetTabBarHeaderUl");return new r("",{items:[F,v]})}return v}case"hierarchy":{var y="".concat(a,"-attribute_facet");var b=new s(y,{openShowMoreDialogFunction:H});return b}case"hierarchyStatic":{var w="".concat(a,"-attribute_facet");return new c(w,{})}default:{var C=new Error("program error: unknown facet type "+l.facetType);throw new x.UnknownFacetType(C)}}}})},onAfterRendering:function e(){var t=$(".searchFacetFilter .searchFacet").first().find("ul");var a=t.find("li");t.attr("role","tree");a.attr("role","treeitem")},_headToolBar4FirstFacet:function e(t){var r=this;var o=new y("",{});o.setShowNoData(false);o.setShowSeparators(_.None);o.data("sap-ui-fastnavgroup","false",true);var n=new a("",{icon:"sap-icon://clear-filter",tooltip:B.getText("resetFilterButton_tooltip"),type:"Transparent",enabled:{parts:[{path:"/uiFilter/rootCondition"}],formatter:function e(a){var r=false;if(a.hasFilters()){r=true;if(t.filterWithoutFilterByConditions()){r=false}if(typeof t.config.hasSpaceFiltersOnly==="function"){if(t.config.hasSpaceFiltersOnly(a)===true){r=false}}}else{r=false}return r}},press:function e(){var a=t;a.eventLogger.logEvent({type:U.CLEAR_ALL_FILTERS});t.resetFilterByFilterConditions(true)}});n.addStyleClass("sapUshellSearchFilterByResetButton");n.onAfterRendering=function(){$(r.getDomRef()).attr("aria-label",B.getText("resetFilterButton_tooltip"))};var i=new w("",{text:B.getText("filterBy")});var s=new C;var c=new F("",{content:[i,s,n]});c.data("sap-ui-fastnavgroup","false",true);c.addStyleClass("sapUshellSearchFilterByHeaderListToolbarinToolbar");o.setHeaderToolbar(c);o.addStyleClass("sapUshellSearchFilterByHeaderList");o.onAfterRendering=function(){$(".sapUshellSearchFilterByHeaderList").find("ul").attr("tabindex","-1");$(".sapUshellSearchFilterByHeaderList").find("div").attr("tabindex","-1")};var l=new F("",{content:o});l.addStyleClass("sapUshellSearchFilterByHeaderListToolbar");return l}});return A})})();
//# sourceMappingURL=SearchFacetFilter.js.map