/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../i18n","sap/m/Toolbar","sap/m/library","sap/m/Button","sap/m/Link","sap/m/ToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/ActionSheet","sap/ui/core/InvisibleText","sap/ui/core/IconPool","sap/ui/core/delegate/ItemNavigation","sap/ui/core/Control"],function(e,t,a,o,r,i,s,n,l,h,c,d){function u(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}var g=u(e);var v=a["ToolbarDesign"];var f=a["ButtonType"];var p=a["PlacementType"];var b=d.extend("sap.esh.search.ui.controls.SearchRelatedObjectsToolbar",{renderer:{apiVersion:2,render:function e(t,a){t.openStart("div",a);t["class"]("sapUshellSearchResultListItem-RelatedObjectsToolbar");var o=a.getModel();if(o.config.FF_optimizeForValueHelp){t["class"]("sapUshellSearchResultListItem-RelatedObjectsToolbarValueHelp")}t.openEnd();t.renderControl(a.getAggregation("_ariaDescriptionForLinks"));a._renderToolbar(t);t.close("div")}},metadata:{properties:{itemId:"string",navigationObjects:{type:"object",multiple:true},positionInList:"int"},aggregations:{_relatedObjectActionsToolbar:{type:"sap.m.Toolbar",multiple:false,visibility:"hidden"},_ariaDescriptionForLinks:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"}}},constructor:function e(a,o){d.prototype.constructor.call(this,a,o);b._allOfMyCurrentInstances.push(this);var r=new t({design:v.Solid});r.data("sap-ui-fastnavgroup","false",true);r.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Toolbar");this.setAggregation("_relatedObjectActionsToolbar",r);this.setAggregation("_ariaDescriptionForLinks",new l({text:g.getText("result_list_item_aria_has_more_links")}));$(window).on("resize",function(){for(var e=0;e<b._allOfMyCurrentInstances.length;e++){b._allOfMyCurrentInstances[e].layoutToolbarElements()}})},exit:function e(){if(sap.ui.core.Control.prototype.exit){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++){a[o]=arguments[o]}sap.ui.core.Control.prototype.exit.apply(this,a)}var r=b._allOfMyCurrentInstances;for(var i=0;i<r.length;i++){if(r[i]===this){r.splice(i,1);break}}if(this._searchLayoutChangedIsSubscribed){this._searchLayoutChangedIsSubscribed=false;this.getModel().unsubscribe("ESHSearchLayoutChanged",this.layoutToolbarElements,this)}},_renderToolbar:function e(t){var a=this;var l=this.getModel();var c=this.getAggregation("_relatedObjectActionsToolbar");c.destroyContent();if(l.config.FF_optimizeForValueHelp){c.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-ToolbarValueHelp")}var d=function e(t){return function(e){a._performNavigation(t,{trackingOnly:true,event:e})}};var u=this.getProperty("navigationObjects");if(u.length>0){var g=[];for(var v=0;v<u.length;v++){var b=u[v];var m=new r({text:b.getText(),href:b.getHref(),layoutData:new i({shrinkable:false}),press:d(b)});var y=b.getTarget();if(y){m.setTarget(y)}m.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");g.push(m)}var _=new s;_.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Spacer");c.addContent(_);for(var T=0;T<g.length;T++){c.addContent(g[T])}this._overFlowButton=new o({icon:h.getIconURI("overflow")});this._overFlowButton.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-OverFlowButton");c.addContent(this._overFlowButton);this._overFlowSheet=new n({placement:p.Top});this._overFlowButton.attachPress(function(){a._overFlowSheet.openBy(a._overFlowButton)});if(l.config.FF_optimizeForValueHelp){this._overFlowButton.addStyleClass("sapUiSmallMarginBegin");this._overFlowButton.addStyleClass("sapUiTinyMarginEnd");this._overFlowButton.setType(f.Transparent)}t.renderControl(c)}},onAfterRendering:function e(){if(this.getAggregation("_relatedObjectActionsToolbar")){this.layoutToolbarElements();this._addAriaInformation()}if(!this._searchLayoutChangedIsSubscribed){this.getModel().subscribe("ESHSearchLayoutChanged",this.layoutToolbarElements,this);this._searchLayoutChangedIsSubscribed=true}},layoutToolbarElements:function e(){var t=this;var a=this.getAggregation("_relatedObjectActionsToolbar");if(!(this.getDomRef()&&a.getDomRef())){return}var r=$(a.getDomRef());var i=r.width();if($(this.getDomRef()).css("display")==="none"||r.css("display")==="none"){return}this.toolbarWidth=i;var s=$(this._overFlowButton.getDomRef());s.css("display","none");var n=0;var l=function e(a,o){t._performNavigation(o,{event:a})};var h=r.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");for(var c=0;c<h.length;c++){var d=$(h[c]);d.css("display","");var u=n+d.outerWidth(true);if(u>i){if(c<h.length){s.css("display","");var g=s.outerWidth(true);for(;c>=0;c--){d=$(h[c]);u-=d.outerWidth(true);if(u+g<=i){break}}}var v=this.getProperty("navigationObjects");this._overFlowSheet.destroyButtons();c=c>=0?c:0;for(;c<h.length;c++){d=$(h[c]);d.css("display","none");var f=v[c];var p=new o({text:f.getText()});p.attachPress(f,l);this._overFlowSheet.addButton(p)}break}n=u}this._setupItemNavigation()},_setupItemNavigation:function e(){if(!this._theItemNavigation){this._theItemNavigation=new c(null,[]);this["addDelegate"](this._theItemNavigation)}this._theItemNavigation.setCycling(false);this._theItemNavigation.setRootDomRef(this.getDomRef());var t=[];var a=this.getAggregation("_relatedObjectActionsToolbar");var o=a.getContent();for(var r=0;r<o.length;r++){if(!o[r].hasStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Element")){continue}if(!$(o[r].getDomRef()).attr("tabindex")){var i="-1";if(o[r]["getPressed"]&&o[r]["getPressed"]()){i="0"}$(o[r].getDomRef()).attr("tabindex",i)}t.push(o[r].getDomRef())}var s=this._overFlowButton.getDomRef();t.push(s);$(s).attr("tabindex","-1");this._theItemNavigation.setItemDomRefs(t)},_addAriaInformation:function e(){var t=$(this.getAggregation("_relatedObjectActionsToolbar").getDomRef());var a=t.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");var o=$(this._overFlowButton.getDomRef());if(a.length>0||o.is(":visible")){var r=this.getAggregation("_ariaDescriptionForLinks").getId();a.each(function(){var e=$(this);var t=e.attr("aria-describedby")||"";t+=" "+r;e.attr("aria-describedby",t)});if(o.is(":visible")){var i=o.attr("aria-describedby")||"";i+=" "+r;o.attr("aria-describedby",i)}}},_performNavigation:function e(t,a){var o=(a===null||a===void 0?void 0:a.trackingOnly)||false;var r=a===null||a===void 0?void 0:a.event;t.performNavigation({trackingOnly:o,event:r})}});b._allOfMyCurrentInstances=[];return b})})();
//# sourceMappingURL=SearchRelatedObjectsToolbar.js.map